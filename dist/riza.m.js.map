{"mappings":"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","sources":["src/router.js","src/element.js","src/api.js","src/data-source.js","src/data-list.js","src/easing.js","src/anim.js","src/elems/r-tabs.js","src/elems/r-form.js","src/elems/r-panel.js","src/elems/r-list.js","src/elems/r-item.js","src/elems/r-paginator.js","src/elems/r-table.js","src/elems/r-select.js","src/utils.js","src/elems/r-image-cropper.js","src/main.js","src/elements.js","src/db.js"],"sourcesContent":["\r\nimport { EventDispatcher } from 'rinn';\r\n\r\n/*\r\n**\tThe Router is a special module that detects local URL changes (when a hash-change occurs) and\r\n**\tforwards events to the appropriate handlers.\r\n*/\r\n\r\nconst _Router =\r\n{\r\n\tRoute: EventDispatcher.extend\r\n\t({\r\n\t\t/*\r\n\t\t**\tRegular expression for the route. This is generated from a simpler expression provided\r\n\t\t**\tin the constructor.\r\n\t\t*/\r\n\t\trouteRegex: null,\r\n\r\n\t\t/*\r\n\t\t**\tOriginal route string value.\r\n\t\t*/\r\n\t\tvalue: null,\r\n\r\n\t\t/*\r\n\t\t**\tMap with the indices and the names of each paremeter obtained from the route expression.\r\n\t\t*/\r\n\t\tparams: null,\r\n\r\n\t\t/*\r\n\t\t**\tArguments obtained from the current route (uses `params` to determine name of arguments).\r\n\t\t*/\r\n\t\targs: null,\r\n\r\n\t\t/*\r\n\t\t**\tArguments string obtained from the last route dispatch. Used to check if the arguments changed.\r\n\t\t*/\r\n\t\ts_args: null,\r\n\r\n\t\t/*\r\n\t\t**\tIndicates if the route is active because of a past positive dispatch.\r\n\t\t*/\r\n\t\tactive: false,\r\n\r\n\t\t/*\r\n\t\t**\tIndicates if the params have changed since last event. Transition from inactive to active route will always set this value to true.\r\n\t\t*/\r\n\t\tchanged: false,\r\n\r\n\t\t/*\r\n\t\t**\tConstructor of the route, the specified argument is a route expression.\r\n\t\t**\r\n\t\t**\t>> void __ctor (string route);\r\n\t\t*/\r\n\t\t__ctor: function (route)\r\n\t\t{\r\n\t\t\tthis._super.EventDispatcher.__ctor();\r\n\t\t\tthis._compileRoute (this.value = route);\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tTransforms the specified route expression into a regular expression and a set of parameter\r\n\t\t**\tnames and stores them in the 'param' array.\r\n\t\t**\r\n\t\t**\t>> void _compileRoute (string route);\r\n\t\t*/\r\n\t\t_compileRoute: function (route)\r\n\t\t{\r\n\t\t\tthis.params = [];\r\n\r\n\t\t\troute = route.replace(/\\/\\*\\//g, '/.+/');\r\n\r\n\t\t\twhile (true)\r\n\t\t\t{\r\n\t\t\t\tvar m = /:([!@A-Za-z0-9_-]+)/.exec(route);\r\n\t\t\t\tif (!m) break;\r\n\t\r\n\t\t\t\troute = route.replace(m[0], '([^/]+)');\r\n\t\t\t\tthis.params.push (m[1]);\r\n\t\t\t}\r\n\r\n\t\t\tthis.routeRegex = '^' + route.replace(/##/g, '');\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tAdds a handler to the route dispatcher. The handler can be removed later using removeHandler and\r\n\t\t**\tspecifying the same parameters. If unrouted boolean is specified the event to listen to will be\r\n\t\t**\tthe unrouted event (when the route changes and the route is not activated).\r\n\t\t**\r\n\t\t**\tvoid addHandler (handler: function, unrouted: bool, context:object=null);\r\n\t\t*/\r\n\t\taddHandler: function (handler, unrouted=false, context=null)\r\n\t\t{\r\n\t\t\tthis.addEventListener ((unrouted === true ? 'un' : '') + 'routed', handler, context);\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tRemoves a handler from the route dispatcher.\r\n\t\t**\r\n\t\t**\tvoid removeHandler (handler: function, unrouted: bool, context: object=null);\r\n\t\t*/\r\n\t\tremoveHandler: function (handler, unrouted=false, context=null)\r\n\t\t{\r\n\t\t\tthis.removeEventListener ((unrouted === true ? 'un' : '') + 'routed', handler, context);\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tVerifies if the specified route matches the internal route and if so dispatches a (depends on doUnroute parameter) \"routed\" or \"unrouted\" event with the\r\n\t\t**\tparameters obtained from the location to all attached handlers.\r\n\t\t**\r\n\t\t**\tvoid dispatch (route:string, doUnroute:bool);\r\n\t\t*/\r\n\t\tdispatch: function (route)\r\n\t\t{\r\n\t\t\tvar matches = route.match(this.routeRegex);\r\n\t\t\tif (!matches)\r\n\t\t\t{\r\n\t\t\t\tthis.s_args = null;\r\n\r\n\t\t\t\tif (this.active)\r\n\t\t\t\t\tthis.dispatchEvent ('unrouted', { route: this });\r\n\r\n\t\t\t\tthis.active = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar args = { route: this };\r\n\t\t\tvar str = '';\r\n\r\n\t\t\tfor (var i = 0; i < this.params.length; i++)\r\n\t\t\t{\r\n\t\t\t\targs[this.params[i]] = matches[i+1];\r\n\t\t\t\tstr += '_' + matches[i+1];\r\n\t\t\t}\r\n\r\n\t\t\tthis.changed = str != this.s_args;\r\n\t\t\tthis.s_args = str;\r\n\r\n\t\t\tthis.dispatchEvent ('routed', this.args = args);\r\n\t\t\tthis.active = true;\r\n\t\t}\r\n\t}),\r\n\r\n\t/*\r\n\t**\tMap with route objects. The key of the map is the route and the value a handler.\r\n\t*/\r\n\troutes: { },\r\n\r\n\t/*\r\n\t**\tSorted list of routes. Smaller routes are processed first than larger ones. This array stores\r\n\t**\tonly the keys to the Router.routes map.\r\n\t*/\r\n\tsortedRoutes: [ ],\r\n\r\n\t/*\r\n\t**\tIndicates the number of times the onLocationChanged handler should ignore the hash change event.\r\n\t*/\r\n\tignoreHashChangeEvent: 0,\r\n\r\n\t/*\r\n\t**\tCurrent relative location (everything after the location hash symbol).\r\n\t*/\r\n\tlocation: '',\r\n\r\n\t/*\r\n\t**\tCurrent relative location as an array of elements (obtained by splitting the location by slash).\r\n\t*/\r\n\targs: [],\r\n\r\n\t/*\r\n\t**\tInitializes the router module. Ensure to call `refresh` once to force a hashchange when the page loads.\r\n\t*/\r\n\tinit: function ()\r\n\t{\r\n\t\tif (this.alreadyAttached)\r\n\t\t\treturn;\r\n\r\n\t\tthis.alreadyAttached = true;\r\n\r\n\t\tif ('onhashchange' in globalThis)\r\n\t\t\tglobalThis.onhashchange = this.onLocationChanged.bind(this);\r\n\t},\r\n\r\n\t/*\r\n\t**\tRefreshes the current route by forcing a hashchange event.\r\n\t*/\r\n\trefresh: function ()\r\n\t{\r\n\t\tthis.onLocationChanged();\r\n\t},\r\n\r\n\t/*\r\n\t**\tChanges the current location and optionally prevents a trigger of the hashchange event.\r\n\t*/\r\n\tsetRoute: function (route, silent)\r\n\t{\r\n\t\tvar location = this.realLocation (route);\r\n\t\tif (location == this.location) return;\r\n\r\n\t\tif (silent) this.ignoreHashChangeEvent++;\r\n\t\tglobalThis.location.hash = location;\r\n\t},\r\n\r\n\t/*\r\n\t**\tAdds the specified route to the routing map. When the specified route is detected, the `onRoute` handler will be called, and then\r\n\t**\twhen the route exits `onUnroute` will be called.\r\n\t*/\r\n\taddRoute: function (route, onRoute, onUnroute=null)\r\n\t{\r\n\t\tif (!this.routes[route])\r\n\t\t{\r\n\t\t\tthis.routes[route] = new this.Route (route);\r\n\t\t\tthis.sortedRoutes.push (route);\r\n\r\n\t\t\tthis.sortedRoutes.sort ((a, b) => {\r\n\t\t\t\treturn this.routes[a].routeRegex.length - this.routes[b].routeRegex.length;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (onUnroute !== null)\r\n\t\t{\r\n\t\t\tthis.routes[route].addHandler (onRoute, false);\r\n\t\t\tthis.routes[route].addHandler (onUnroute, true);\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis.routes[route].addHandler (onRoute, false);\r\n\r\n\t\treturn this.routes[route];\r\n\t},\r\n\r\n\t/*\r\n\t**\tReturns the Route object for the specified route.\r\n\t*/\r\n\tgetRoute: function (route)\r\n\t{\r\n\t\tif (!this.routes[route])\r\n\t\t{\r\n\t\t\tthis.routes[route] = new this.Route (route);\r\n\t\t\tthis.sortedRoutes.push (route);\r\n\r\n\t\t\tthis.sortedRoutes.sort ((a, b) => {\r\n\t\t\t\treturn this.routes[a].routeRegex.length - this.routes[b].routeRegex.length;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this.routes[route];\r\n\t},\r\n\r\n\t/*\r\n\t**\tAdds the specified routes to the routing map. The routes map should contain the route expression\r\n\t**\tin the key of the map and a handler function in the value.\r\n\t*/\r\n\taddRoutes: function (routes)\r\n\t{\r\n\t\tfor (var i in routes)\r\n\t\t{\r\n\t\t\tif (!this.routes[i])\r\n\t\t\t{\r\n\t\t\t\tthis.routes[i] = new this.Route (i);\r\n\t\t\t\tthis.sortedRoutes.push (i);\r\n\t\t\t}\r\n\r\n\t\t\tthis.routes[i].addHandler (routes[i], false);\r\n\t\t}\r\n\r\n\t\tthis.sortedRoutes.sort ((a, b) => {\r\n\t\t\treturn this.routes[a].routeRegex.length - this.routes[b].routeRegex.length;\r\n\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t**\tRemoves the specified route from the routing map.\r\n\t*/\r\n\tremoveRoute: function (route, onRoute, onUnroute)\r\n\t{\r\n\t\tif (!this.routes[route]) return;\r\n\r\n\t\tif (onUnroute !== undefined)\r\n\t\t{\r\n\t\t\tthis.routes[route].removeHandler (onRoute, false);\r\n\t\t\tthis.routes[route].removeHandler (onUnroute, true);\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis.routes[route].removeHandler (onRoute);\r\n\t},\r\n\r\n\t/*\r\n\t**\tRemoves the specified routes from the routing map. The routes map should contain the route\r\n\t**\texpression in the key of the map and a handler function in the value.\r\n\t*/\r\n\tremoveRoutes: function (routes)\r\n\t{\r\n\t\tfor (var i in routes)\r\n\t\t{\r\n\t\t\tif (!this.routes[i]) continue;\r\n\r\n\t\t\tthis.routes[i].removeHandler (routes[i]);\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t**\tGiven a formatted location and a previous one it will return the correct real location.\r\n\t*/\r\n\trealLocation: function (cLocation, pLocation)\r\n\t{\r\n\t\tif (!pLocation) pLocation = this.location;\r\n\t\tif (!pLocation) pLocation = ' ';\r\n\r\n\t\tvar state = 0, i = 0, j = 0, k;\r\n\t\tvar rLocation = '';\r\n\r\n\t\twhile (state != -1 && i < cLocation.length && j < pLocation.length)\r\n\t\t{\r\n\t\t\tswitch (state)\r\n\t\t\t{\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tif (cLocation.substr(i++, 1) == '*')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstate = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (cLocation.substr(i-1, 1) != pLocation.substr(j++, 1))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trLocation += cLocation.substr(i-1);\r\n\t\t\t\t\t\tstate = -1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trLocation += pLocation.substr(j-1, 1);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tif (cLocation.substr(i, 1) == '*')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstate = 3;\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate = 2;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tk = pLocation.indexOf(cLocation.substr(i, 1), j);\r\n\t\t\t\t\tif (k == -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trLocation += pLocation.substr(j) + cLocation.substr(i);\r\n\t\t\t\t\t\tstate = -1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trLocation += pLocation.substr(j, k-j);\r\n\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t\tj = k;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tk = pLocation.lastIndexOf(cLocation.substr(i, 1));\r\n\t\t\t\t\tif (k == -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trLocation += cLocation.substr(i);\r\n\t\t\t\t\t\tstate = -1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trLocation += pLocation.substr(j, k-j);\r\n\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t\tj = k;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (state != -1)\r\n\t\t\trLocation += cLocation.substr(i);\r\n\r\n\t\treturn rLocation.trim();\r\n\t},\r\n\r\n\t/*\r\n\t**\tEvent handler called when the location hash changes.\r\n\t*/\r\n\tonLocationChanged: function ()\r\n\t{\r\n\t\tvar cLocation = location.hash.substr(1);\r\n\t\tvar rLocation = this.realLocation (cLocation);\r\n\r\n\t\tif (cLocation != rLocation)\r\n\t\t{\r\n\t\t\tglobalThis.location.replace('#' + rLocation);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.location = cLocation;\r\n\t\tthis.args = this.location.split ('/');\r\n\r\n\t\tif (this.ignoreHashChangeEvent > 0)\r\n\t\t{\r\n\t\t\tthis.ignoreHashChangeEvent--;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < this.sortedRoutes.length; i++)\r\n\t\t\tthis.routes[this.sortedRoutes[i]].dispatch (this.location);\r\n\t},\r\n\r\n\t/*\r\n\t**\tNavigates to the given hash-based URL.\r\n\t*/\r\n\tnavigate: function (location, replace=false)\r\n\t{\r\n\t\tlocation = this.realLocation(location);\r\n\r\n\t\tif (globalThis.location.hash == '#'+location)\r\n\t\t{\r\n\t\t\tthis.refresh();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (replace)\r\n\t\t\tglobalThis.location.replace('#'+location);\r\n\t\telse\r\n\t\t\tglobalThis.location.hash = location;\r\n\t}\r\n};\r\n\r\n_Router.init();\r\n\r\nexport default _Router;\r\n","\r\nimport { Rinn, Model, Template } from 'rinn';\r\nimport Router from './router.js';\r\n\r\n/**\r\n * Map containing the original prototypes for all registered elements.\r\n */\r\nconst elementPrototypes = { };\r\n\r\n/**\r\n * Map containing the final classes for all registered elements.\r\n */\r\nconst elementClasses = { };\r\n\r\n/**\r\n * Base class for custom elements. Provides support for model-triggered events, easy definition of handlers for events originated in\r\n * self or child-elements, and several utility methods.\r\n */\r\n\r\nconst Element = \r\n{\r\n\t/**\r\n\t * Internal element ID. Added as namespace to model events. Ensures that certain model events are run locally only, not affecting other event handlers.\r\n\t */\r\n\teid: null,\r\n\r\n\t/**\r\n\t * Indicates if the element is a root element, that is, the target element to attach child elements having `data-ref` attribute.\r\n\t */\r\n\tisRoot: true,\r\n\r\n\t/**\r\n\t * Root element to which this element is attached (when applicable).\r\n\t */\r\n\troot: null,\r\n\r\n\t/**\r\n\t * Indicates ready-state of the element. Possible values are: 0: \"Not ready\", 1: \"Children Initialized\", and 2: \"Parent Ready\".\r\n\t */\r\n\tisReady: 0,\r\n\treadyReenter: 0,\r\n\treadyLocked: 0,\r\n\r\n\t/**\r\n\t * Model type (class) for the element's model.\r\n\t */\r\n\tmodelt: Model,\r\n\r\n\t/**\r\n\t * Data model related to the element.\r\n\t */\r\n\tmodel: null,\r\n\r\n\t/**\r\n\t * Contents of the element. When set, the innerHTML will be set to this value.\r\n\t */\r\n\tcontents: null,\r\n\r\n\t/**\r\n\t * \tEvents map.\r\n\t */\r\n\tevents:\r\n\t{\r\n\t\t'mousedown [data-long-press]': function (evt)\r\n\t\t{\r\n\t\t\tevt.continuePropagation = true;\r\n\t\t\tif (evt.source._long_press) return;\r\n\r\n\t\t\tlet elem = evt.source;\r\n\r\n\t\t\telem._long_press = setTimeout(() =>\r\n\t\t\t{\r\n\t\t\t\tlet dx = elem._pos_fx - elem._pos_sx;\r\n\t\t\t\tlet dy = elem._pos_fy - elem._pos_sy;\r\n\r\n\t\t\t\telem._long_press = null;\r\n\r\n\t\t\t\tlet d = Math.sqrt(dx*dx + dy*dy);\r\n\t\t\t\tif (d < 5) {\r\n\t\t\t\t\telem._long_press = false;\r\n\t\t\t\t\tthis.dispatchOn (elem, 'long-press');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t500);\r\n\r\n\t\t\telem._pos_sx = evt.clientX;\r\n\t\t\telem._pos_sy = evt.clientY;\r\n\r\n\t\t\telem._pos_fx = evt.clientX;\r\n\t\t\telem._pos_fy = evt.clientY;\r\n\t\t},\r\n\r\n\t\t'mousemove [data-long-press]': function (evt)\r\n\t\t{\r\n\t\t\tevt.continuePropagation = true;\r\n\t\t\tif (!evt.source._long_press) return;\r\n\r\n\t\t\tevt.source._pos_fx = evt.clientX;\r\n\t\t\tevt.source._pos_fy = evt.clientY;\r\n\t\t},\r\n\r\n\t\t'touchstart [data-long-press]': function (evt)\r\n\t\t{\r\n\t\t\tevt.continuePropagation = true;\r\n\t\t\tif (evt.source._long_press) return;\r\n\r\n\t\t\tlet elem = evt.source;\r\n\r\n\t\t\telem._long_press = setTimeout(() => {\r\n\t\t\t\tlet dx = elem._pos_fx - elem._pos_sx;\r\n\t\t\t\tlet dy = elem._pos_fy - elem._pos_sy;\r\n\r\n\t\t\t\telem._long_press = null;\r\n\r\n\t\t\t\tlet d = Math.sqrt(dx*dx + dy*dy);\r\n\t\t\t\tif (d < 5) {\r\n\t\t\t\t\telem._long_press = false;\r\n\t\t\t\t\tthis.dispatchOn (elem, 'long-press');\r\n\t\t\t\t}\r\n\t\t\t}, 500);\r\n\r\n\t\t\telem._pos_sx = evt.touches[0].clientX;\r\n\t\t\telem._pos_sy = evt.touches[0].clientY;\r\n\r\n\t\t\telem._pos_fx = evt.touches[0].clientX;\r\n\t\t\telem._pos_fy = evt.touches[0].clientY;\r\n\t\t},\r\n\r\n\t\t'touchmove [data-long-press]': function (evt)\r\n\t\t{\r\n\t\t\tevt.continuePropagation = true;\r\n\t\t\tif (!evt.source._long_press) return;\r\n\r\n\t\t\tevt.source._pos_fx = evt.touches[0].clientX;\r\n\t\t\tevt.source._pos_fy = evt.touches[0].clientY;\r\n\t\t},\r\n\r\n\t\t'mouseup [data-long-press]': function (evt)\r\n\t\t{\r\n\t\t\tif (evt.source._long_press === false)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif (evt.source._long_press) {\r\n\t\t\t\tclearTimeout(evt.source._long_press);\r\n\t\t\t\tevt.source._long_press = null;\r\n\t\t\t}\r\n\t\r\n\t\t\tevt.continuePropagation = true;\r\n\t\t},\r\n\t\r\n\t\t'touchend [data-long-press]': function (evt)\r\n\t\t{\r\n\t\t\tif (evt.source._long_press === false)\r\n\t\t\t\treturn;\r\n\t\r\n\t\t\tif (evt.source._long_press) {\r\n\t\t\t\tclearTimeout(evt.source._long_press);\r\n\t\t\t\tevt.source._long_press = null;\r\n\t\t\t}\r\n\t\r\n\t\t\tevt.continuePropagation = true;\r\n\t\t},\r\n\r\n\t\t'click [data-action]': function(evt)\r\n\t\t{\r\n\t\t\tif (evt.source._long_press === false)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tlet opts = evt.source.dataset.action.split(' ');\r\n\r\n\t\t\tif (opts[0] in this)\r\n\t\t\t\tthis[opts[0]] ({ ...evt.params, ...evt.source.dataset, ...opts, length: opts.length }, evt);\r\n\t\t\telse\r\n\t\t\t\tevt.continuePropagation = true;\r\n\t\t},\r\n\r\n\t\t'long-press [data-long-press]': function(evt)\r\n\t\t{\r\n\t\t\tlet opts = evt.source.dataset.longPress.split(' ');\r\n\r\n\t\t\tif (opts[0] in this)\r\n\t\t\t\tthis[opts[0]] ({ ...evt.params, ...evt.source.dataset, ...opts, length: opts.length }, evt);\r\n\t\t\telse\r\n\t\t\t\tevt.continuePropagation = true;\r\n\t\t},\r\n\r\n\t\t'keyup(13) input[data-enter]': function(evt)\r\n\t\t{\r\n\t\t\tlet opts = evt.source.dataset.enter.split(' ');\r\n\r\n\t\t\tif (opts[0] in this)\r\n\t\t\t\tthis[opts[0]] ({ ...evt.params, ...evt.source.dataset, ...opts, length: opts.length }, evt);\r\n\t\t\telse\r\n\t\t\t\tevt.continuePropagation = true;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Internal routes map, set by `bindRoutes`.\r\n\t */\r\n\troutes: null,\r\n\r\n\t/**\r\n\t * \tElement constructor.\r\n\t */\r\n\t__ctor: function()\r\n\t{\r\n\t\tthis._list_watch = [];\r\n\t\tthis._list_visible = [];\r\n\t\tthis._list_property = [];\r\n\r\n\t\tif ('root' in this.dataset)\r\n\t\t{\r\n\t\t\tif (this.dataset.root == 'false')\r\n\t\t\t\tthis.isRoot = false;\r\n\t\t}\r\n\r\n\t\tthis.style.display = 'block';\r\n\r\n\t\tthis.eid = Math.random().toString().substr(2);\r\n\r\n\t\tif (this.model != null)\r\n\t\t{\r\n\t\t\tlet tmp = this.model;\r\n\t\t\tthis.model = null;\r\n\t\t\tthis.setModel (tmp, false);\r\n\t\t}\r\n\r\n\t\tObject.keys(this._super).reverse().forEach(i =>\r\n\t\t{\r\n\t\t\tif ('init' in this._super[i])\r\n\t\t\t\tthis._super[i].init();\r\n\t\t});\r\n\r\n\t\tif (Element.debug)\r\n\t\t\tconsole.log('>> ' + this.tagName + ' INIT ON ' + this.parentElement.tagName);\r\n\r\n\t\tthis.init();\r\n\r\n\t\tif (this.events)\r\n\t\t\tthis.bindEvents (this.events);\r\n\r\n\t\tif (this.contents)\r\n\t\t\tthis.setInnerHTML(this.contents);\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tif (this.tagName.toLowerCase() !== 'r-dom-probe')\r\n\t\t\t\tthis.appendChild(document.createElement('r-dom-probe'));\r\n\t\t\telse\r\n\t\t\t\tthis.markReady();\r\n\t\t}, 0);\r\n\t},\r\n\r\n\t/**\r\n\t * \tInitializes the element. Called after construction of the instance.\r\n\t */\r\n\tinit: function()\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t * \tExecuted when the children of the element are ready.\r\n\t */\r\n\tready: function()\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t * \tExecuted after ready and after the root is also ready.\r\n\t */\r\n\trready: function()\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t * \tMarks the element as ready.\r\n\t */\r\n\tmarkReady: function (list=null)\r\n\t{\r\n\t\tthis.readyLocked++;\r\n\r\n\t\tif (!this.isReady)\r\n\t\t{\r\n\t\t\tthis.isReady = 1;\r\n\r\n\t\t\t// Set model is `model` property was set in the element.\r\n\t\t\tif ('model' in this.dataset)\r\n\t\t\t{\r\n\t\t\t\tlet ref = this.getFieldByPath(this.dataset.model);\r\n\t\t\t\tif (ref) this.setModel(ref);\r\n\t\t\t}\r\n\r\n\t\t\t// Run ready methods in class hierarchy.\r\n\t\t\tObject.keys(this._super).reverse().forEach(i =>\r\n\t\t\t{\r\n\t\t\t\tif ('ready' in this._super[i])\r\n\t\t\t\t\tthis._super[i].ready();\r\n\t\t\t});\r\n\r\n\t\t\tif (Element.debug)\r\n\t\t\t\tconsole.log('>> ' + this.tagName + ' READY');\r\n\r\n\t\t\tthis.ready();\r\n\t\t\tthis.collectWatchers();\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis.collectWatchers();\r\n\r\n\t\tlet root = this.findCustomParent(this);\r\n\r\n\t\tif (Element.debug)\r\n\t\t\tconsole.log(this.tagName + ' ROOT IS ' + (root ? root.tagName : 'NULL'));\r\n\r\n\t\tif (root && root.isReady === 0 && this.isReady != 0)\r\n\t\t\troot.checkReady();\r\n\r\n\t\tlet rootReady = false;\r\n\r\n\t\tif (root && root.isReady === 2 && this.isReady !== 2)\r\n\t\t{\r\n\t\t\tthis.getRoot();\r\n\r\n\t\t\tif (this.root && this.dataset.ref)\r\n\t\t\t{\r\n\t\t\t\tif (Element.debug)\r\n\t\t\t\t\tconsole.log(this.tagName + ' REF AS `' + this.dataset.ref + '` ON ' + this.root.tagName);\r\n\r\n\t\t\t\tthis.root[this.dataset.ref] = this;\r\n\t\t\t\tthis.root.onRefAdded (this.dataset.ref, this);\r\n\t\t\t}\r\n\r\n\t\t\trootReady = true;\r\n\t\t}\r\n\r\n\t\tif (!root && this.isReady !== 2)\r\n\t\t{\r\n\t\t\trootReady = true;\r\n\t\t}\r\n\r\n\t\tif (rootReady)\r\n\t\t{\r\n\t\t\tthis.isReady = 2;\r\n\r\n\t\t\tif (list !== null) {\r\n\t\t\t\tfor (let elem of list)\r\n\t\t\t\t\telem.checkReady();\r\n\t\t\t}\r\n\r\n\t\t\tif (Element.debug)\r\n\t\t\t\tconsole.log('>> ' + this.tagName + ' RREADY');\r\n\r\n\t\t\tObject.keys(this._super).reverse().forEach(i =>\r\n\t\t\t{\r\n\t\t\t\tif ('rready' in this._super[i])\r\n\t\t\t\t\tthis._super[i].rready();\r\n\t\t\t});\r\n\t\t\r\n\t\t\tthis.rready();\r\n\t\t}\r\n\r\n\t\tthis.readyLocked--;\r\n\r\n\t\tif (this.readyReenter && !this.readyLocked)\r\n\t\t{\r\n\t\t\tthis.readyReenter = false;\r\n\t\t\tthis.checkReady();\r\n\t\t}\r\n\r\n\t\tif (this.tagName.toLowerCase() === 'r-dom-probe')\r\n\t\t\tthis.remove();\r\n\t},\r\n\r\n\t/**\r\n\t *\tChecks if all children are ready and fires the appropriate function (`ready` and/or `rready`).\r\n\t */\r\n\tcheckReady: function()\r\n\t{\r\n\t\tif (this.childNodes.length == 0)\r\n\t\t\treturn;\r\n\r\n\t\tif (this.readyLocked)\r\n\t\t{\r\n\t\t\tthis.readyReenter = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet isReady = true;\r\n\t\tlet list = [];\r\n\r\n\t\tlet result = document.evaluate(\".//*[contains(name(),'-')]\", this, null, XPathResult.ANY_TYPE, null);\r\n\r\n\t\tif (Element.debug)\r\n\t\t\tconsole.log('# CHECKING ' + this.tagName);\r\n\r\n\t\twhile (true)\r\n\t\t{\r\n\t\t\tlet elem = result.iterateNext();\r\n\t\t\tif (!elem) break;\r\n\r\n\t\t\tif (elem === this)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tlet root = this.findCustomParent(elem);\r\n\t\t\tif (root !== this) continue;\r\n\r\n\t\t\tif (Element.debug)\r\n\t\t\t\tconsole.log('   ' + elem.tagName + ' = ' + elem.isReady);\r\n\r\n\t\t\tif (!elem.isReady)\r\n\t\t\t\tisReady = false;\r\n\r\n\t\t\tlist.push(elem);\r\n\t\t}\r\n\r\n\t\tif (!isReady) return;\r\n\r\n\t\tthis.markReady(list);\r\n\t},\r\n\r\n\t/**\r\n\t * \tReturns the value of a field given its path. Starts from `global`, unless the first item in the path is `this`, in which case it will start from the element.\r\n\t */\r\n\tgetFieldByPath: function(path)\r\n\t{\r\n\t\tif (!path) return null;\r\n\r\n\t\tlet tmp = path.split('.');\r\n\t\tlet ref = global;\r\n\r\n\t\tif (tmp.length && tmp[0] == 'this')\r\n\t\t{\r\n\t\t\tref = this;\r\n\t\t\ttmp.shift();\r\n\t\t}\r\n\r\n\t\tif (tmp.length && tmp[0] == 'root')\r\n\t\t{\r\n\t\t\tref = this.getRoot();\r\n\t\t\ttmp.shift();\r\n\t\t}\r\n\r\n\t\twhile (ref != null && tmp.length != 0)\r\n\t\t\tref = ref[tmp.shift()];\r\n\r\n\t\treturn ref;\r\n\t},\r\n\r\n\t/**\r\n\t * \tReturns the root of the element (that is, the `root` property). If not set it will attempt to find the root first.\r\n\t */\r\n\tgetRoot: function()\r\n\t{\r\n\t\treturn this.root ? this.root : (this.root = this.findRoot());\r\n\t},\r\n\r\n\t/**\r\n\t * \tSets the model of the element and executes the `modelChanged` event handler (unless `update` is set to false).\r\n\t */\r\n\tsetModel: function (model, update=true)\r\n\t{\r\n\t\tif (!model) return this;\r\n\r\n\t\tmodel = Rinn.ensureTypeOf(this.modelt, model);\r\n\r\n\t\tif (this.model !== model)\r\n\t\t{\r\n\t\t\tif (this.model != null)\r\n\t\t\t{\r\n\t\t\t\tthis.model.removeEventListener (this.eid+':modelChanged', this.onModelPreChanged, this);\r\n\t\t\t\tthis.model.removeEventListener (this.eid+':propertyChanging', this.onModelPropertyChanging, this);\r\n\t\t\t\tthis.model.removeEventListener (this.eid+':propertyChanged', this.onModelPropertyPreChanged, this);\r\n\t\t\t\tthis.model.removeEventListener (this.eid+':propertyRemoved', this.onModelPropertyRemoved, this);\r\n\t\t\t}\r\n\r\n\t\t\tthis.model = model;\r\n\r\n\t\t\tthis.model.addEventListener (this.eid+':modelChanged', this.onModelPreChanged, this);\r\n\t\t\tthis.model.addEventListener (this.eid+':propertyChanging', this.onModelPropertyChanging, this);\r\n\t\t\tthis.model.addEventListener (this.eid+':propertyChanged', this.onModelPropertyPreChanged, this);\r\n\t\t\tthis.model.addEventListener (this.eid+':propertyRemoved', this.onModelPropertyRemoved, this);\r\n\t\t}\r\n\r\n\t\tif (update !== false)\r\n\t\t\tthis.model.setNamespace(this.eid).update(true).setNamespace(null);\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * \tReturns the model of the element. Added for symmetry only, exactly the same as accesing public property `model` of this class.\r\n\t */\r\n\tgetModel: function ()\r\n\t{\r\n\t\treturn this.model;\r\n\t},\r\n\r\n\t/**\r\n\t * \tAdds one or more CSS classes (separated by space) to the element.\r\n\t */\r\n\taddClass: function (classString)\r\n\t{\r\n\t\tif (!classString) return this;\r\n\r\n\t\tclassString.split(' ').forEach(i =>\r\n\t\t{\r\n\t\t\ti = i.trim();\r\n\t\t\tif (!i) return;\r\n\r\n\t\t\tif (i[0] == '-' || i[0] == '+')\r\n\t\t\t\tthis.classList[i[0] == '-' ? 'remove' : 'add'](i.substr(1));\r\n\t\t\telse\r\n\t\t\t\tthis.classList.add(i);\r\n\t\t});\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * \tRemoves one or more CSS classes (separated by space) from the element.\r\n\t */\r\n\tremoveClass: function (classString)\r\n\t{\r\n\t\tif (!classString) return this;\r\n\r\n\t\tclassString.split(' ').forEach(i =>\r\n\t\t{\r\n\t\t\ti = i.trim();\r\n\t\t\tif (!i) return;\r\n\r\n\t\t\tif (i[0] == '-' || i[0] == '+')\r\n\t\t\t\tthis.classList[i[0] == '-' ? 'remove' : 'add'](i.substr(1));\r\n\t\t\telse\r\n\t\t\t\tthis.classList.remove(i);\r\n\t\t});\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * \tSets one or more style properties to the element (separated by semi-colon).\r\n\t */\r\n\tsetStyle: function (styleString)\r\n\t{\r\n\t\tif (!styleString) return this;\r\n\r\n\t\tstyleString.split(';').forEach(i => {\r\n\t\t\tlet j = (i = i.trim()).indexOf(':');\r\n\t\t\tif (j == -1) return;\r\n\r\n\t\t\tlet name = i.substr(0, j).trim();\r\n\t\t\tfor (let k = name.indexOf('-'); k != -1; k = name.indexOf('-')) {\r\n\t\t\t\tname = name.substr(0, k) + name.substr(k+1, 1).toUpperCase() + name.substr(k+2);\r\n\t\t\t}\r\n\r\n\t\t\tthis.style[name] = i.substr(j+1).trim();\r\n\t\t});\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * \tReturns the width of the specified element (or of itself it none provided), uses `getBoundingClientRect`.\r\n\t */\r\n\tgetWidth: function (elem=null)\r\n\t{\r\n\t\treturn (elem || this).getBoundingClientRect().width;\r\n\t},\r\n\r\n\t/**\r\n\t * \tReturns the height of the specified element (or of itself it none provided), uses `getBoundingClientRect`.\r\n\t */\r\n\tgetHeight: function (elem=null)\r\n\t{\r\n\t\treturn (elem || this).getBoundingClientRect().height;\r\n\t},\r\n\r\n\t/**\r\n\t**\tBinds all events in the specified map to the element, the events map can have one of the following forms:\r\n\t**\r\n\t**\t\t\"click .button\": \"doSomething\",\t\t(Delegated Event)\r\n\t**\t\t\"click .button\": function() { },\t(Delegated Event)\r\n\t**\t\t\"myevt &this\": \"...\",\t\t\t\t(Self Event)\r\n\t**\t\t\"myevt\": \"...\",\t\t\t\t\t\t(Element Event)\r\n\t**\t\t\"myevt @objName\": \"...\",\t\t\t(EventDispatcher Event)\r\n\t**\t\t\"#propname\": \"...\",\t\t\t\t\t(Property Changed Event)\r\n\t**\t\t\"keyup(10) .input\": \"...\"\t\t\t(Delegated Event with Parameters)\r\n\t**\r\n\t**\t>> Element bindEvents (object events);\r\n\t*/\r\n\tbindEvents: function (events)\r\n\t{\r\n\t\tfor (let evtstr in events)\r\n\t\t{\r\n\t\t\tlet hdl = events[evtstr];\r\n\r\n\t\t\tif (Rinn.typeOf(hdl) == 'string')\r\n\t\t\t\thdl = this[hdl];\r\n\r\n\t\t\thdl = hdl.bind(this);\r\n\r\n\t\t\tvar i = evtstr.indexOf(' ');\r\n\r\n\t\t\tvar name = i == -1 ? evtstr : evtstr.substr(0, i);\r\n\t\t\tvar selector = i == -1 ? '' : evtstr.substr(i + 1);\r\n\r\n\t\t\tlet args = null;\r\n\r\n\t\t\tvar j = name.indexOf('(');\r\n\t\t\tif (j != -1)\r\n\t\t\t{\r\n\t\t\t\targs = name.substr(j+1, name.length-j-2).split(',');\r\n\t\t\t\tname = name.substr(0, j);\r\n\t\t\t}\r\n\r\n\t\t\tif (selector[0] == '@')\r\n\t\t\t{\r\n\t\t\t\tif (selector != '@this')\r\n\t\t\t\t{\r\n\t\t\t\t\tthis[selector.substr(1)].addEventListener(name, hdl);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tselector = this;\r\n\t\t\t}\r\n\t\t\telse if (selector[0] == '&')\r\n\t\t\t{\r\n\t\t\t\tif (selector != '&this')\r\n\t\t\t\t\tselector = \"[data-ref='\"+selector.substr(1)+\"']\";\r\n\t\t\t\telse\r\n\t\t\t\t\tselector = this;\r\n\t\t\t}\r\n\r\n\t\t\tif (name.substr(0, 1) == '#')\r\n\t\t\t{\r\n\t\t\t\tthis.listen('propertyChanged.'+name.substr(1), this, hdl);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (args != null)\r\n\t\t\t{\r\n\t\t\t\tswitch (name)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase 'keyup': case 'keydown':\r\n\t\t\t\t\t\tthis.listen (name, selector, function (evt)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (Rinn.indexOf(args, evt.keyCode.toString()) != -1)\r\n\t\t\t\t\t\t\t\treturn hdl (evt, args);\r\n\r\n\t\t\t\t\t\t\tevt.continuePropagation = true;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.listen (name, selector, hdl);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t**\tBinds all routes in the specified map to the Router object.\r\n\t**\r\n\t**\t\t\"route-path\": \"doSomething\"\t\t\t\t\t\tOn-Route\r\n\t**\t\t\"route-path\": function (evt, args) { }\t\t\tOn-Route\r\n\t**\t\t\"!route-path\": \"doSomething\"\t\t\t\t\tOn-UnRoute\r\n\t**\t\t\"!route-path\": function (evt, args) { }\t\t\tOn-UnRoute\r\n\t**\r\n\t**\t>> Element bindRoutes ();\r\n\t*/\r\n\tbindRoutes: function ()\r\n\t{\r\n\t\tif (!this.routes)\r\n\t\t\treturn;\r\n\r\n\t\tfor (let routeStr in this.routes)\r\n\t\t{\r\n\t\t\tlet route = routeStr[0] === '!' ? Router.getRoute(routeStr.substr(1)) : Router.getRoute(routeStr);\r\n\t\t\tlet handler = this.routes[routeStr];\r\n\r\n\t\t\tif (Rinn.typeOf(handler) === 'string')\r\n\t\t\t\thandler = this[handler];\r\n\r\n\t\t\tif (routeStr[0] === '!')\r\n\t\t\t\troute.addHandler(handler, true, this);\r\n\t\t\telse\r\n\t\t\t\troute.addHandler(handler, false, this);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Unbinds all routes added by bindRoutes.\r\n\t */\r\n\tunbindRoutes: function ()\r\n\t{\r\n\t\tif (!this.routes)\r\n\t\t\treturn;\r\n\r\n\t\tfor (let routeStr in this.routes)\r\n\t\t{\r\n\t\t\tlet route = routeStr[0] === '!' ? Router.getRoute(routeStr.substr(1)) : Router.getRoute(routeStr);\r\n\t\t\tlet handler = this.routes[routeStr];\r\n\r\n\t\t\tif (Rinn.typeOf(handler) === 'string')\r\n\t\t\t\thandler = this[handler];\r\n\r\n\t\t\tif (routeStr[0] === '!')\r\n\t\t\t\troute.removeHandler(handler, true, this);\r\n\t\t\telse\r\n\t\t\t\troute.removeHandler(handler, false, this);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t**\tExecutes the underlying event handler given an event and a selector. Called internally by listen().\r\n\t**\r\n\t**\t>> void _eventHandler (event evt, string selector, function handler);\r\n\t*/\r\n\t_eventHandler: function (evt, selector, handler)\r\n\t{\r\n\t\tif (evt.continuePropagation === false)\r\n\t\t\treturn;\r\n\r\n\t\tevt.continuePropagation = true;\r\n\t\tevt.source = evt.target;\r\n\r\n\t\tif (selector && selector instanceof HTMLElement)\r\n\t\t{\r\n\t\t\tif (evt.source === selector)\r\n\t\t\t{\r\n\t\t\t\tevt.continuePropagation = false;\r\n\r\n\t\t\t\tif (handler.call (this, evt, evt.detail) === true)\r\n\t\t\t\t\tevt.continuePropagation = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (selector && selector != '*')\r\n\t\t{\r\n\t\t\tlet elems = this.querySelectorAll(selector);\r\n\r\n\t\t\twhile (evt.source !== this)\r\n\t\t\t{\r\n\t\t\t\tlet i = Rinn.indexOf (elems, evt.source, true);\r\n\t\t\t\tif (i !== -1)\r\n\t\t\t\t{\r\n\t\t\t\t\tevt.continuePropagation = false;\r\n\r\n\t\t\t\t\tif (handler.call (this, evt, evt.detail) === true)\r\n\t\t\t\t\t\tevt.continuePropagation = true;\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tevt.source = evt.source.parentElement;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tevt.continuePropagation = false;\r\n\r\n\t\t\tif (handler.call (this, evt, evt.detail) === true)\r\n\t\t\t\tevt.continuePropagation = true;\r\n\t\t}\r\n\r\n\t\tif (evt.continuePropagation === false)\r\n\t\t{\r\n\t\t\tevt.preventDefault();\r\n\t\t\tevt.stopPropagation();\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t**\tListens for an event on elements matching the specified selector, returns an object with a single method `remove` used\r\n\t**\tto remove the listener when it is no longer needed.\r\n\t**\r\n\t**\t>> object listen (string eventName, string selector, function handler);\r\n\t**\t>> object listen (string eventName, function handler);\r\n\t*/\r\n\tlisten: function (eventName, selector, handler)\r\n\t{\r\n\t\tlet eventCatcher = false;\r\n\t\tlet eventImmediate = false;\r\n\r\n\t\tif (Rinn.typeOf(selector) == 'function')\r\n\t\t{\r\n\t\t\thandler = selector;\r\n\t\t\tselector = null;\r\n\t\t}\r\n\r\n\t\tif (eventName[eventName.length-1] == '!')\r\n\t\t{\r\n\t\t\teventName = eventName.substr(0, eventName.length-1);\r\n\t\t\teventCatcher = true;\r\n\t\t}\r\n\r\n\t\tif (eventName[0] == '!')\r\n\t\t{\r\n\t\t\teventName = eventName.substr(1);\r\n\t\t\teventImmediate = true;\r\n\t\t}\r\n\r\n\t\tlet callback0 = null;\r\n\t\tlet callback1 = null;\r\n\t\tlet self = this;\r\n\r\n\t\tthis.addEventListener (eventName, callback0 = (evt) =>\r\n\t\t{\r\n\t\t\tif (evt.continuePropagation === false)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif (!evt.firstCapture)\r\n\t\t\t{\r\n\t\t\t\tevt.firstCapture = this;\r\n\t\t\t\tevt.firstCaptureCount = 0;\r\n\t\t\t\tevt.queue = [];\r\n\t\t\t}\r\n\r\n\t\t\tif (evt.firstCapture === this)\r\n\t\t\t\tevt.firstCaptureCount++;\r\n\r\n\t\t\tif (eventCatcher == true)\r\n\t\t\t\tevt.queue.push([this, selector, handler]);\r\n\r\n\t\t\tif (eventImmediate == true)\r\n\t\t\t\tthis._eventHandler(evt, selector, handler);\r\n\t\t},\r\n\t\ttrue);\r\n\r\n\t\tthis.addEventListener (eventName, callback1 = (evt) =>\r\n\t\t{\r\n\t\t\tif (evt.continuePropagation === false)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif (eventCatcher != true && eventImmediate != true)\r\n\t\t\t\tthis._eventHandler(evt, selector, handler);\r\n\r\n\t\t\tif (evt.firstCapture === this && evt.continuePropagation !== false)\r\n\t\t\t{\r\n\t\t\t\tif (--evt.firstCaptureCount == 0)\r\n\t\t\t\t{\r\n\t\t\t\t\twhile (evt.queue.length)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlet q = evt.queue.pop();\r\n\t\t\t\t\t\tq[0]._eventHandler(evt, q[1], q[2]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tevt.continuePropagation = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tfalse);\r\n\r\n\t\treturn {\r\n\t\t\tremoved: false,\r\n\t\t\tremove: function() {\r\n\t\t\t\tif (this.removed) return;\r\n\t\t\t\tthis.removed = true;\r\n\t\t\t\tself.removeEventListener(eventName, callback0, true);\r\n\t\t\t\tself.removeEventListener(eventName, callback1, false);\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t**\tCreates an event object for later dispatch.\r\n\t*/\r\n\tcreateEventObject: function(eventName, args, bubbles)\r\n\t{\r\n\t\tlet evt;\r\n\r\n\t\tif (eventName == 'click')\r\n\t\t\tevt = new MouseEvent(eventName, { bubbles: bubbles, detail: args });\r\n\t\telse\r\n\t\t\tevt = new CustomEvent (eventName, { bubbles: bubbles, detail: args });\r\n\r\n\t\treturn evt;\r\n\t},\r\n\r\n\t/**\r\n\t**\tDispatches a new event with the specified name and the given arguments.\r\n\t*/\r\n\tdispatch: function (eventName, args=null, bubbles=true)\r\n\t{\r\n\t\tthis.dispatchEvent (this.createEventObject(eventName, args, bubbles));\r\n\t},\r\n\r\n\t/**\r\n\t**\tDispatches a new event on the specified element with the given name and arguments (uses `CustomEvent`).\r\n\t*/\r\n\tdispatchOn: function (elem, eventName, args=null, bubbles=true)\r\n\t{\r\n\t\telem.dispatchEvent (this.createEventObject(eventName, args, bubbles));\r\n\t},\r\n\r\n\t/**\r\n\t**\tSets the innerHTML property of the element and runs some post set-content tasks.\r\n\t**\r\n\t**\t>> void setInnerHTML (value);\r\n\t*/\r\n\tsetInnerHTML: function (value)\r\n\t{\r\n\t\tthis.readyLocked++;\r\n\t\tthis.innerHTML = value;\r\n\t\tthis.readyLocked--;\r\n\t},\r\n\r\n\t/**\r\n\t**\tCollects all watchers (data-watch, data-visible, data-property), that depend on the model, should be invoked when the structure\r\n\t**\tof the element changed (added/removed children). This is automatically called when the setInnerHTML method is called.\r\n\t**\r\n\t**\tNote that for 3rd party libs that add children to this element (which could probably have a watcher) will possibly result in\r\n\t**\tduplication of the added elements when compiling the innerHTML template. To prevent this add the 'pseudo' CSS class to any\r\n\t**\telement that should not be added to the HTML template.\r\n\t**\r\n\t**\t>> void collectWatchers ();\r\n\t*/\r\n\tcollectWatchers: function ()\r\n\t{\r\n\t\tlet self = this;\r\n\t\tlet modified = false;\r\n\t\tlet list;\r\n\r\n\t\tif (!this.isRoot) return;\r\n\r\n\t\tlet _list_watch_length = this._list_watch.length;\r\n\t\tlet _list_visible_length = this._list_visible.length;\r\n\t\tlet _list_property_length = this._list_property.length;\r\n\r\n\t\t/* *** */\r\n\t\tlist = this.querySelectorAll('[data-watch]');\r\n\t\tfor (let i = 0; i < list.length; i++)\r\n\t\t{\r\n\t\t\tfor (let j of list[i].querySelectorAll('.pseudo'))\r\n\t\t\t\tj.remove();\r\n\r\n\t\t\tlist[i]._template = Template.compile(list[i].innerHTML);\r\n\t\t\tlist[i]._watch = new RegExp('^(' + list[i].dataset.watch + ')$');\r\n\t\t\tlist[i].innerHTML = '';\r\n\r\n\t\t\tlist[i].removeAttribute('data-watch');\r\n\t\t\tthis._list_watch.push(list[i]);\r\n\t\t}\r\n\r\n\t\tif ('selfWatch' in this.dataset)\r\n\t\t{\r\n\t\t\tfor (let j of this.querySelectorAll('.pseudo'))\r\n\t\t\t\tj.remove();\r\n\r\n\t\t\tthis._template = Template.compile(this.innerHTML);\r\n\t\t\tthis._watch = new RegExp('^(' + this.dataset.selfWatch + ')$');\r\n\t\t\tthis.innerHTML = '';\r\n\r\n\t\t\tthis.removeAttribute('data-self-watch');\r\n\t\t\tthis._list_watch.push(this);\r\n\t\t}\r\n\r\n\t\t/* *** */\r\n\t\tlist = this.querySelectorAll('[data-visible]');\r\n\t\tfor (let i = 0; i < list.length; i++)\r\n\t\t{\r\n\t\t\tlist[i]._visible = Template.compile(list[i].dataset.visible);\r\n\r\n\t\t\tlist[i].removeAttribute('data-visible');\r\n\t\t\tthis._list_visible.push(list[i]);\r\n\t\t}\r\n\r\n\t\tif ('selfVisible' in this.dataset)\r\n\t\t{\r\n\t\t\tthis._visible = Template.compile(this.dataset.selfVisible);\r\n\r\n\t\t\tthis.removeAttribute('data-self-visible');\r\n\t\t\tthis._list_visible.push(this);\r\n\t\t}\r\n\r\n\t\t/* *** */\r\n\t\tlist = this.querySelectorAll('[data-property]');\r\n\t\tfor (let i = 0; i < list.length; i++)\r\n\t\t{\r\n\t\t\tlist[i].onchange = list[i].onblur = function()\r\n\t\t\t{\r\n\t\t\t\tswitch (this.type)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase 'radio':\r\n\t\t\t\t\t\tif (this.checked) self.getModel().set(this.name, this.value);\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'checkbox':\r\n\t\t\t\t\t\tself.getModel().set(this.name, this.checked ? '1' : '0');\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'field':\r\n\t\t\t\t\t\tself.getModel().set(this.name, this.getValue());\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tself.getModel().set(this.name, this.value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tif (list[i].tagName == 'SELECT')\r\n\t\t\t{\r\n\t\t\t\tlist[i].onmouseup = function()\r\n\t\t\t\t{\r\n\t\t\t\t\tself.getModel().set(this.name, this.value);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tlist[i].name = list[i].dataset.property;\r\n\r\n\t\t\tlist[i].removeAttribute('data-property');\r\n\t\t\tthis._list_property.push(list[i]);\r\n\t\t}\r\n\r\n\t\tif ('selfProperty' in this.dataset)\r\n\t\t{\r\n\t\t\tthis.onchange = this.onblur = function()\r\n\t\t\t{\r\n\t\t\t\tswitch (this.type)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase 'radio':\r\n\t\t\t\t\t\tif (this.checked) self.getModel().set(this.name, this.value);\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'checkbox':\r\n\t\t\t\t\t\tself.getModel().set(this.name, this.checked ? '1' : '0');\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'field':\r\n\t\t\t\t\t\tself.getModel().set(this.name, this.getValue());\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tself.getModel().set(this.name, this.value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tif (this.tagName == 'SELECT')\r\n\t\t\t{\r\n\t\t\t\tthis.onmouseup = function()\r\n\t\t\t\t{\r\n\t\t\t\t\tself.getModel().set(this.name, this.value);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tthis.name = this.dataset.selfProperty;\r\n\r\n\t\t\tthis.removeAttribute('data-self-property');\r\n\t\t\tthis._list_property.push(this);\r\n\t\t}\r\n\r\n\t\t/* *** */\r\n\t\tthis._list_watch = this._list_watch.filter(i => i.parentElement != null);\r\n\t\tif (_list_watch_length != this._list_watch.length) modified = true;\r\n\r\n\t\tthis._list_visible = this._list_visible.filter(i => i.parentElement != null);\r\n\t\tif (_list_visible_length != this._list_visible.length) modified = true;\r\n\r\n\t\tthis._list_property = this._list_property.filter(i => i.parentElement != null);\r\n\t\tif (_list_property_length != this._list_property.length) modified = true;\r\n\r\n\t\tif (this.model != null && modified)\r\n\t\t\tthis.model.setNamespace(this.eid).update(true).setNamespace(null);\r\n\t},\r\n\r\n\t/**\r\n\t**\tExecuted when the element is created and yet not attached to the DOM tree.\r\n\t*/\r\n\tonCreated: function()\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t * Executed when the element is attached to the DOM tree.\r\n\t */\r\n\telementConnected: function()\r\n\t{\r\n\t\tthis.bindRoutes();\r\n\t\tthis.onConnected();\r\n\t},\r\n\r\n\t/**\r\n\t * Executed when the element is no longer a part of the DOM tree.\r\n\t */\r\n\telementDisconnected: function()\r\n\t{\r\n\t\tthis.unbindRoutes();\r\n\t},\r\n\r\n\t/**\r\n\t**\tExecuted when the element is attached to the DOM tree.\r\n\t*/\r\n\tonConnected: function()\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t**\tExecuted when the element is no longer a part of the DOM tree.\r\n\t*/\r\n\tonDisconnected: function()\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t**\tExecuted on the root element when a child element has `data-ref` attribute and it was added to it.\r\n\t*/\r\n\tonRefAdded: function (name, element)\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t**\tExecuted on the root element when a child element has `data-ref` attribute and it was removed from it.\r\n\t*/\r\n\tonRefRemoved: function (name, element)\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t**\tEvent handler invoked when the model has changed, executed before onModelChanged() to update internal dependencies,\r\n\t**\tshould not be overriden or elements watching the model will not be updated.\r\n\t**\r\n\t**\t>> void onModelPreChanged (evt, args);\r\n\t*/\r\n\tonModelPreChanged: function (evt, args)\r\n\t{\r\n\t\tlet data = this.getModel().get();\r\n\r\n\t\tfor (let i = 0; i < this._list_watch.length; i++)\r\n\t\t{\r\n\t\t\tfor (let j of args.fields)\r\n\t\t\t{\r\n\t\t\t\tif (!this._list_watch[i]._watch.test(j))\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\tthis._list_watch[i].innerHTML = this._list_watch[i]._template(data);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < this._list_visible.length; i++)\r\n\t\t{\r\n\t\t\tif (!!this._list_visible[i]._visible(data, 'arg'))\r\n\t\t\t\tthis._list_visible[i].style.removeProperty('display');\r\n\t\t\telse\r\n\t\t\t\tthis._list_visible[i].style.setProperty('display', 'none', 'important');\r\n\t\t}\r\n\r\n\t\tthis.onModelChanged(evt, args);\r\n\t},\r\n\r\n\t/**\r\n\t**\tEvent handler invoked when the model has changed.\r\n\t*/\r\n\tonModelChanged: function (evt, args) // @override\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t**\tEvent handler invoked when a property of the model is changing. Fields `name` and `value` can be found in the `args` object.\r\n\t*/\r\n\tonModelPropertyChanging: function (evt, args) // @override\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t**\tEvent handler invoked when a property of the model has changed, executed before onModelPropertyChanged() to update internal\r\n\t**\tdependencies. Automatically triggers internal events named `propertyChanged.<propertyName>` and `propertyChanged`.\r\n\t**\tShould not be overriden or elements depending on the property will not be updated.\r\n\t*/\r\n\tonModelPropertyPreChanged: function (evt, args)\r\n\t{\r\n\t\tfor (let i = 0; i < this._list_property.length; i++)\r\n\t\t{\r\n\t\t\tif (this._list_property[i].name == args.name)\r\n\t\t\t{\r\n\t\t\t\tlet trigger = true;\r\n\r\n\t\t\t\tswitch (this._list_property[i].type)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase 'radio':\r\n\t\t\t\t\t\tif (this._list_property[i].value != args.value)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis._list_property[i].parentElement.classList.remove('active');\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis._list_property[i].checked = true;\r\n\t\t\t\t\t\tthis._list_property[i].parentElement.classList.add('active');\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'checkbox':\r\n\t\t\t\t\t\tif (~~args.value)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis._list_property[i].checked = true;\r\n\t\t\t\t\t\t\tthis._list_property[i].parentElement.classList.add('active');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis._list_property[i].checked = false;\r\n\t\t\t\t\t\t\tthis._list_property[i].parentElement.classList.remove('active');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'field':\r\n\t\t\t\t\t\tthis._list_property[i].val = this._list_property[i].dataset.value = args.value;\t\r\n\t\t\t\t\t\tthis._list_property[i].setValue (args.value);\r\n\t\t\t\t\t\ttrigger = false;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tthis._list_property[i].value = args.value;\r\n\t\t\t\t\t\tthis._list_property[i].val = this._list_property[i].dataset.value = args.value;\t\r\n\r\n\t\t\t\t\t\tif (this._list_property[i].value != args.value)\r\n\t\t\t\t\t\t\ttrigger = false;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (trigger && this._list_property[i].onchange)\r\n\t\t\t\t\tthis._list_property[i].onchange();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.dispatch ('propertyChanged.' + args.name, args, false);\r\n\t\tthis.dispatch ('propertyChanged', args, false);\r\n\r\n\t\tthis.onModelPropertyChanged(evt, args);\r\n\t},\r\n\r\n\t/**\r\n\t**\tEvent handler invoked when a property of the model has changed.\r\n\t*/\r\n\tonModelPropertyChanged: function (evt, args) // @override\r\n\t{\r\n\t},\r\n\r\n\t/**\r\n\t**\tEvent handler invoked when a property of the model is removed. Field `name` can be found in the `args` object.\r\n\t*/\r\n\tonModelPropertyRemoved: function (evt, args) // @override\r\n\t{\r\n\t},\r\n\r\n\t/*\r\n\t**\tRuns the following preparation procedures on the specified prototype:\r\n\t**\t\t- All functions named 'event <event-name> [event-selector]' will be moved to the 'events' map.\r\n\t**\t\t- All functions named 'route <route-path>' will be moved to the 'routes' map.\r\n\t**\r\n\t**\t>> void preparePrototype (object proto);\r\n\t*/\r\n\tpreparePrototype: function (proto)\r\n\t{\r\n\t\tif (proto.__prototypePrepared === true)\r\n\t\t\treturn;\r\n\r\n\t\tproto.__prototypePrepared = true;\r\n\r\n\t\tif (!proto.hasOwnProperty('events') || !proto.events)\r\n\t\t\tproto.events = { };\r\n\r\n\t\tif (!proto.hasOwnProperty('routes') || !proto.routes)\r\n\t\t\tproto.routes = { };\r\n\r\n\t\tfor (let i in proto)\r\n\t\t{\r\n\t\t\tif (i.startsWith('event '))\r\n\t\t\t{\r\n\t\t\t\tproto.events[i.substr(6)] = proto[i];\r\n\t\t\t\tdelete proto[i];\r\n\t\t\t}\r\n\t\t\telse if (i.startsWith('route '))\r\n\t\t\t{\r\n\t\t\t\tproto.routes[i.substr(6)] = proto[i];\r\n\t\t\t\tdelete proto[i];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t**\tRegisters a new custom element with the specified name. Extra functionality can be added with one or more prototypes, by default\r\n\t**\tall elements also get the `Element` prototype. Note that the final prototypes of all registered elements are stored, and if you want\r\n\t**\tto inherit another element's prototype just provide its name (string) in the protos argument list.\r\n\t**\r\n\t**\t>> class register (string name, ...(object|string) protos);\r\n\t*/\r\n\tregister: function (name, ...protos)\r\n\t{\r\n\t\tconst newElement = class extends HTMLElement\r\n\t\t{\r\n\t\t\tconstructor()\r\n\t\t\t{\r\n\t\t\t\tsuper();\r\n\t\t\t\tthis.invokeConstructor = true;\r\n\r\n\t\t\t\tif (Element.debug)\r\n\t\t\t\t\tconsole.log('CREATED ' + this.tagName);\r\n\r\n\t\t\t\tthis._super = { };\r\n\r\n\t\t\t\tfor (let i of Object.entries(this.constructor.prototype._super))\r\n\t\t\t\t{\r\n\t\t\t\t\tthis._super[i[0]] = { };\r\n\r\n\t\t\t\t\tfor (let j of Object.entries(i[1])) {\r\n\t\t\t\t\t\tthis._super[i[0]][j[0]] = j[1].bind(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.onCreated();\r\n\t\t\t}\r\n\r\n\t\t\tfindRoot (srcElement)\r\n\t\t\t{\r\n\t\t\t\tlet elem = srcElement ? srcElement : this.parentElement;\r\n\r\n\t\t\t\twhile (elem != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tif ('isRoot' in elem && elem.isRoot === true)\r\n\t\t\t\t\t\treturn elem;\r\n\r\n\t\t\t\t\telem = elem.parentElement;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tfindCustomParent (srcElement)\r\n\t\t\t{\r\n\t\t\t\tlet elem = srcElement ? srcElement.parentElement : this.parentElement;\r\n\r\n\t\t\t\twhile (elem != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (elem.tagName.indexOf('-') !== -1)\r\n\t\t\t\t\t\treturn elem;\r\n\r\n\t\t\t\t\telem = elem.parentElement;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tconnectReference (root=null, flags=255)\r\n\t\t\t{\r\n\t\t\t\tif (!this.root && (flags & 1) == 1)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (root == null) root = this.findRoot();\r\n\t\t\t\t\tif (root != null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.dataset.ref)\r\n\t\t\t\t\t\t\troot[this.dataset.ref] = this;\r\n\r\n\t\t\t\t\t\tthis.root = root;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconnectedCallback ()\r\n\t\t\t{\r\n\t\t\t\tthis.connectReference(null, 1);\r\n\r\n\t\t\t\tif (this.invokeConstructor)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.invokeConstructor = false;\r\n\t\t\t\t\tthis.__ctor();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.connectReference(null, 2);\r\n\t\t\t\tthis.elementConnected();\r\n\r\n\t\t\t\tif (this.dataset.xref)\r\n\t\t\t\t\tglobalThis[this.dataset.xref] = this;\r\n\t\t\t}\r\n\r\n\t\t\tdisconnectedCallback()\r\n\t\t\t{\r\n\t\t\t\tif (this.root)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.dataset.ref)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.root.onRefRemoved (this.dataset.ref, this);\r\n\r\n\t\t\t\t\t\tdelete this.root[this.dataset.ref];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.root = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.elementDisconnected();\r\n\r\n\t\t\t\tif (this.dataset.xref)\r\n\t\t\t\t\tdelete globalThis[this.dataset.xref];\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tRinn.override (newElement.prototype, Element);\r\n\r\n\t\tconst proto = { };\r\n\t\tconst _super = { };\r\n\t\tconst events = Rinn.clone(Element.events);\r\n\r\n\t\tlet __init = true;\r\n\t\tlet __ready = true;\r\n\t\tlet __rready = true;\r\n\t\tlet __check;\r\n\r\n\t\tfor (let i = 0; i < protos.length; i++)\r\n\t\t{\r\n\t\t\tif (!protos[i]) continue;\r\n\r\n\t\t\tif (Rinn.typeOf(protos[i]) == 'string')\r\n\t\t\t{\r\n\t\t\t\tconst name = protos[i];\r\n\r\n\t\t\t\tprotos[i] = elementPrototypes[name];\r\n\t\t\t\tif (!protos[i]) continue;\r\n\r\n\t\t\t\t_super[name] = { };\r\n\r\n\t\t\t\tfor (let f in protos[i])\r\n\t\t\t\t{\r\n\t\t\t\t\tif (Rinn.typeOf(protos[i][f]) != 'function')\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t_super[name][f] = protos[i][f];\r\n\t\t\t\t}\r\n\r\n\t\t\t\t__init = false;\r\n\t\t\t\t__ready = false;\r\n\t\t\t\t__rready = false;\r\n\t\t\t\t__check = false;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tElement.preparePrototype(protos[i]);\r\n\t\t\t\t__check = true;\r\n\t\t\t}\r\n\r\n\t\t\tif ('_super' in protos[i])\r\n\t\t\t\tRinn.override (_super, protos[i]._super);\r\n\r\n\t\t\tif ('events' in protos[i])\r\n\t\t\t\tRinn.override (events, protos[i].events);\r\n\r\n\t\t\tRinn.override (newElement.prototype, protos[i]);\r\n\t\t\tRinn.override (proto, protos[i]);\r\n\r\n\t\t\tif (__check)\r\n\t\t\t{\r\n\t\t\t\tif (!__init && 'init' in protos[i]) __init = true;\r\n\t\t\t\tif (!__ready && 'ready' in protos[i]) __ready = true;\r\n\t\t\t\tif (!__rready && 'rready' in protos[i]) __rready = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet dummy = function(){};\r\n\r\n\t\tif (!__init)\r\n\t\t{\r\n\t\t\tnewElement.prototype.init = dummy;\r\n\t\t\tproto.init = dummy;\r\n\t\t}\r\n\r\n\t\tif (!__ready)\r\n\t\t{\r\n\t\t\tnewElement.prototype.ready = dummy;\r\n\t\t\tproto.ready = dummy;\r\n\t\t}\r\n\r\n\t\tif (!__rready)\r\n\t\t{\r\n\t\t\tnewElement.prototype.rready = dummy;\r\n\t\t\tproto.rready = dummy;\r\n\t\t}\r\n\r\n\t\tnewElement.prototype._super = _super;\r\n\t\tnewElement.prototype.events = events;\r\n\r\n\t\tproto._super = _super;\r\n\t\tproto.events = events;\r\n\r\n\t\tcustomElements.define (name, newElement);\r\n\r\n\t\telementPrototypes[name] = proto;\r\n\t\telementClasses[name] = newElement;\r\n\r\n\t\treturn newElement;\r\n\t},\r\n\r\n\t/*\r\n\t**\tExpands an already created custom element with the specified prototype(s).\r\n\t**\r\n\t**\t>> void expand (string elementName, ...object protos);\r\n\t*/\r\n\texpand: function (name, ...protos)\r\n\t{\r\n\t\tif (!(name in elementPrototypes))\r\n\t\t\treturn;\r\n\r\n\t\tconst self = elementPrototypes[name];\r\n\t\tconst elem = elementClasses[name];\r\n\r\n\t\tconst _super = self._super;\r\n\t\tconst events = self.events;\r\n\r\n\t\tfor (let proto of protos)\r\n\t\t{\r\n\t\t\tElement.preparePrototype(proto);\r\n\r\n\t\t\tif ('_super' in proto)\r\n\t\t\t\tRinn.override (_super, proto._super);\r\n\r\n\t\t\tif ('events' in proto)\r\n\t\t\t\tRinn.override (events, proto.events);\r\n\r\n\t\t\tRinn.override (elem.prototype, proto);\r\n\t\t\tRinn.override (self, proto);\r\n\t\t}\r\n\r\n\t\telem.prototype._super = _super;\r\n\t\telem.prototype.events = events;\r\n\r\n\t\tself._super = _super;\r\n\t\tself.events = events;\r\n\t},\r\n\r\n\t/*\r\n\t**\tAppends a hook to a function of a custom element.\r\n\t*/\r\n\thookAppend: function (name, functionName, newFunction)\r\n\t{\r\n\t\tif (!(name in elementPrototypes))\r\n\t\t\treturn;\r\n\r\n\t\tlet hook1 = Rinn.hookAppend(elementPrototypes[name], functionName, newFunction);\r\n\t\tlet hook2 = Rinn.hookAppend(elementClasses[name].prototype, functionName, newFunction);\r\n\r\n\t\treturn { \r\n\t\t\tunhook: function() {\r\n\t\t\t\thook1.unhook();\r\n\t\t\t\thook2.unhook();\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\r\n\t/*\r\n\t**\tPrepends a hook to a function of a custom element.\r\n\t*/\r\n\thookPrepend: function (name, functionName, newFunction)\r\n\t{\r\n\t\tif (!(name in elementPrototypes))\r\n\t\t\treturn;\r\n\r\n\t\tlet hook1 = Rinn.hookPrepend(elementPrototypes[name], functionName, newFunction);\r\n\t\tlet hook2 = Rinn.hookPrepend(elementClasses[name].prototype, functionName, newFunction);\r\n\r\n\t\treturn { \r\n\t\t\tunhook: function() {\r\n\t\t\t\thook1.unhook();\r\n\t\t\t\thook2.unhook();\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t**\tBuilt-in action handlers.\r\n\t*/\r\n\r\n\t/**\r\n\t**\t:toggleClass <className> [<selector>]\r\n\t**\r\n\t**\tToggles a CSS class on the element.\r\n\t*/\r\n\t':toggleClass': function (args, evt)\r\n\t{\r\n\t\tlet elem = evt.source;\r\n\r\n\t\tif ('2' in args)\r\n\t\t\telem = document.querySelector(args[2]);\r\n\r\n\t\tif (!elem) return;\r\n\r\n\t\tif (elem.classList.contains(args[1]))\r\n\t\t\telem.classList.remove(args[1]);\r\n\t\telse\r\n\t\t\telem.classList.add(args[1]);\r\n\t},\r\n\r\n\t/**\r\n\t**\t:setClass <className> [<selector>]\r\n\t**\r\n\t**\tSets a CSS class on the element.\r\n\t*/\r\n\t':setClass': function (args, evt)\r\n\t{\r\n\t\tlet elem = evt.source;\r\n\r\n\t\tif ('2' in args)\r\n\t\t\telem = document.querySelector(args[2]);\r\n\r\n\t\tif (!elem) return;\r\n\r\n\t\telem.classList.add(args[1]);\r\n\t},\r\n\r\n\t/**\r\n\t**\t:volatileClass <className> [<selector>]\r\n\t**\r\n\t**\tAdds the CSS class to the element and any click outside will cause it to be removed.\r\n\t*/\r\n\t':volatileClass': function (args, evt)\r\n\t{\r\n\t\tlet elem = evt.source;\r\n\r\n\t\tif ('2' in args)\r\n\t\t\telem = document.querySelector(args[2]);\r\n\r\n\t\tif (!elem) return;\r\n\r\n\t\telem.classList.add(args[1]);\r\n\r\n\t\tlet fn = () => {\r\n\t\t\twindow.removeEventListener('click', fn, true);\r\n\t\t\telem.classList.remove(args[1]);\r\n\t\t};\r\n\r\n\t\twindow.addEventListener('click', fn, true);\r\n\t},\r\n\r\n\t/**\r\n\t**\t:toggleClassUnique <className> <parentSelector> <childSelector>\r\n\t**\r\n\t**\tToggles a CSS class on the element and only one element in the selected parent can have the class.\r\n\t*/\r\n\t':toggleClassUnique': function (args, evt)\r\n\t{\r\n\t\tlet elem = evt.source;\r\n\t\tif (!elem) return;\r\n\r\n\t\tif (elem.classList.contains(args[1]))\r\n\t\t{\r\n\t\t\telem.classList.remove(args[1]);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\telem.querySelectorParent(args[2]).querySelectorAll(args[3]).forEach(elem => elem.classList.remove(args[1]));\r\n\t\t\telem.classList.add(args[1]);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t**\t:setClassUnique <className> <parentSelector> <childSelector>\r\n\t**\r\n\t**\tSets a CSS class on the element and only that element in the selected parent can have the class.\r\n\t*/\r\n\t':setClassUnique': function (args, evt)\r\n\t{\r\n\t\tlet elem = evt.source;\r\n\t\tif (!elem) return;\r\n\r\n\t\telem.querySelectorParent(args[2]).querySelectorAll(args[3]).forEach(elem => elem.classList.remove(args[1]));\r\n\t\telem.classList.add(args[1]);\r\n\t}\r\n};\r\n\r\nElement.debug = false;\r\n\r\nElement.register('r-elem', {\r\n});\r\n\r\nElement.register ('r-dom-probe', {\r\n});\r\n\r\n/* ****************************************** */\r\n\r\n/**\r\n * Finds the parent element given a selector.\r\n */\r\nHTMLElement.prototype.querySelectorParent = function (selector)\r\n{\r\n\tlet elem = this;\r\n\r\n\twhile (elem != null)\r\n\t{\r\n\t\tif (elem.matches(selector))\r\n\t\t\tbreak;\r\n\r\n\t\telem = elem.parentElement;\r\n\t}\r\n\r\n\treturn elem;\r\n};\r\n\r\nexport default Element;\r\n","\r\nimport base64 from 'base-64';\r\nimport _fetch from 'node-fetch';\r\n\r\nif (!('fetch' in global))\r\n\tglobal.fetch = _fetch;\r\n\r\n/**\r\n * API interface utility functions.\r\n */\r\n\r\nconst Api =\r\n{\r\n\t/**\r\n\t * Flags constants.\r\n\t */\r\n\tREQUEST_PACKAGE_SUPPORTED:\t0x01,\r\n\tREQ64_SUPPORTED: \t\t\t0x02,\r\n\tJSON_RESPONSE_SUPPORTED: \t0x04,\r\n\tXML_RESPONSE_SUPPORTED: \t0x08,\r\n\tINCLUDE_CREDENTIALS:\t\t0x10,\r\n\tUNIQUE_STAMP:\t\t\t\t0x20,\r\n\r\n\t/**\r\n\t * Target URL for all the API requests. Set by calling `setEndPoint`.\r\n\t */\r\n\tapiUrl: \"/api\",\r\n\r\n\t/**\r\n\t * Capabilities flag.\r\n\t */\r\n\tflags: 0x01 | 0x02 | 0x04 | 0x08 | 0x10 | 0x20,\r\n\r\n\t/**\r\n\t * Indicates if all request data will be packed into a req64 parameter instead of individual fields.\r\n\t */\r\n\tuseReq64: false,\r\n\r\n\t/**\r\n\t * Number of retries to execute each API call before giving up and invoking error handlers.\r\n\t */\r\n\tretries: 0,\r\n\r\n\t/**\r\n\t * Headers for the request.\r\n\t */\r\n\theaders: { },\r\n\r\n\t/**\r\n\t * Level of the current request. Used to detect nested requests.\r\n\t */\r\n\t_requestLevel: 0,\r\n\r\n\t/**\r\n\t * Indicates if all API calls should be bundled in a request package. Activated by calling the packageBegin() function and finished with packageEnd().\r\n\t */\r\n\t_requestPackage: 0,\r\n\r\n\t/**\r\n\t * When in package-mode, this contains the package data to be sent upon a call to packageEnd().\r\n\t */\r\n\t_packageData: [],\r\n\r\n\t/**\r\n\t * Sets the API end-point URL address.\r\n\t */\r\n\tsetEndPoint: function (apiUrl, flags=null)\r\n\t{\r\n\t\tthis.apiUrl = apiUrl;\r\n\t\tthis.flags = flags ?? this.flags;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * Overridable filter that processes the response from the server and returns true if it was successful. The `res` parameter indicates the response data, and `req` the request data.\r\n\t */\r\n\tresponseFilter: function (res, req)\r\n\t{\r\n\t\treturn true;\r\n\t},\r\n\r\n\t/**\r\n\t * Starts \"package-mode\" (using the `rpkg` field). Any API calls after this will be bundled together.\r\n\t */\r\n\tpackageBegin: function ()\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t\treturn;\r\n\r\n\t\tthis._requestPackage++;\r\n\t},\r\n\r\n\t/**\r\n\t * Finishes \"package-mode\" and a single API request with the currently constructed package will be sent.\r\n\t */\r\n\tpackageEnd: function (callback)\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t\treturn;\r\n\r\n\t\tif (!this._requestPackage)\r\n\t\t\treturn;\r\n\r\n\t\tif (--this._requestPackage)\r\n\t\t\treturn;\r\n\r\n\t\tthis.packageSend(callback);\r\n\t},\r\n\r\n\t/**\r\n\t * Starts package-mode, executes the callback and finishes package-mode. Therefore any requests made by the callback will be packed together.\r\n\t */\r\n\tpackRequests: function (callback, responseCallback=null)\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.packageBegin();\r\n\t\tcallback();\r\n\t\tthis.packageEnd(responseCallback);\r\n\t},\r\n\r\n\t/**\r\n\t * Sends a single API request with the currently constructed package and maintains package-mode.\r\n\t */\r\n\tpackageSend: function (callback)\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t\treturn;\r\n\r\n\t\tif (!this._packageData.length)\r\n\t\t\treturn;\r\n\r\n\t\tlet _packageData = this._packageData;\r\n\t\tthis._packageData = [];\r\n\r\n\t\tvar rpkg = \"\";\r\n\r\n\t\tfor (var i = 0; i < _packageData.length; i++)\r\n\t\t\trpkg += \"r\"+i+\",\"+base64.encode(this.encodeParams(_packageData[i][2]))+\";\";\r\n\r\n\t\tthis._showProgress();\r\n\r\n\t\tthis.apiCall (\r\n\t\t\t{ rpkg: rpkg },\r\n\r\n\t\t\t(res, req) =>\r\n\t\t\t{\r\n\t\t\t\tthis._hideProgress();\r\n\r\n\t\t\t\tfor (let i = 0; i < _packageData.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar response = res[\"r\"+i];\r\n\t\t\t\t\t\tif (!response)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (_packageData[i][1] != null) _packageData[i][1] (_packageData[i][2]);\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (_packageData[i][0] != null)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (this.responseFilter (response, _packageData[i][2]))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t_packageData[i][0] (response, _packageData[i][2]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (e) {\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (callback) callback();\r\n\t\t\t},\r\n\r\n\t\t\t(req) =>\r\n\t\t\t{\r\n\t\t\t\tthis._hideProgress();\r\n\r\n\t\t\t\tfor (let i = 0; i < _packageData.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (_packageData[i][1] != null) _packageData[i][1] (_packageData[i][2]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t},\r\n\r\n\t/**\r\n\t * Adds CSS class 'busy' to the HTML root element, works only if running inside a browser.\r\n\t */\r\n\t_showProgress: function ()\r\n\t{\r\n\t\tif ('document' in global) {\r\n\t\t\tthis._requestLevel++;\r\n\t\t\tif (this._requestLevel > 0) global.document.documentElement.classList.add('busy');\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Removes the 'busy' CSS class from the HTML element.\r\n\t */\r\n\t_hideProgress: function ()\r\n\t{\r\n\t\tif ('document' in global)\r\n\t\t{\r\n\t\t\tthis._requestLevel--;\r\n\t\t\tif (this._requestLevel) return;\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (this._requestLevel === 0)\r\n\t\t\t\t\tglobal.document.documentElement.classList.remove('busy');\r\n\t\t\t}, 250);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Sets an HTTP header.\r\n\t */\r\n\theader: function (name, value)\r\n\t{\r\n\t\tif (value === null)\r\n\t\t\tdelete this.headers[name];\r\n\t\telse\r\n\t\t\tthis.headers[name] = value;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * Returns a parameter string for a GET request given an object with fields.\r\n\t */\r\n\tencodeParams: function (obj)\r\n\t{\r\n\t\tlet s = [];\r\n\r\n\t\tif (obj instanceof FormData)\r\n\t\t{\r\n\t\t\tfor (let i of obj.entries())\r\n\t\t\t\ts.push(encodeURIComponent(i[0]) + '=' + encodeURIComponent(i[1]));\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tfor (let i in obj)\r\n\t\t\t\ts.push(encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]));\r\n\t\t}\r\n\r\n\t\treturn s.join('&');\r\n\t},\r\n\r\n\t/**\r\n\t * Returns a URL given a relative or absolute URL.\r\n\t */\r\n\tgetUrl: function (url)\r\n\t{\r\n\t\tif (url.indexOf('//') !== -1)\r\n\t\t\treturn url;\r\n\r\n\t\treturn this.apiUrl + url;\r\n\t},\r\n\r\n\t/**\r\n\t * Appends a parameter to the URL.\r\n\t */\r\n\tappendParam: function (url, param)\r\n\t{\r\n\t\treturn url + (url.indexOf('?') == -1 ? '?' : '&') + param;\r\n\t},\r\n\r\n\t/**\r\n\t * Executes an API call to the URL stored in the `apiUrl` property. By default `httpMethod` is \"auto\", which will determine the best depending on the data to\r\n\t * be sent. Any connection error will be reported to the `failure` callback, and similarly any success to the `success` callback. The `params` object can be\r\n\t * a FormData object or just a regular object.\r\n\t */\r\n\tapiCall: function (params, success, failure, httpMethod=null, retries=null, relativeUrl='')\r\n\t{\r\n\t\tlet url = this.getUrl(relativeUrl);\r\n\r\n\t\tif (this.flags & Api.UNIQUE_STAMP)\r\n\t\t\turl = this.appendParam(url, '_='+Date.now());\r\n\r\n\t\thttpMethod = httpMethod ? httpMethod.toUpperCase() : null;\r\n\t\tif (httpMethod != 'GET' && httpMethod != 'POST')\r\n\t\t\thttpMethod = 'auto';\r\n\r\n\t\tif (retries === null)\r\n\t\t\tretries = this.retries;\r\n\r\n\t\tif (this._requestPackage && (this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t{\r\n\t\t\tif (!(params instanceof FormData))\r\n\t\t\t\tparams = {...params};\r\n\r\n\t\t\tthis._packageData.push([success, failure, params]);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._showProgress();\r\n\r\n\t\tlet data = params;\r\n\r\n\t\tlet options =\r\n\t\t{\r\n\t\t\tmode: 'cors',\r\n\t\t\theaders: {\r\n\t\t\t\t'Accept': 'text/html,application/xhtml+xml,application/xml,application/json;q=0.9',\r\n\t\t\t\t...this.headers\r\n\t\t\t},\r\n\t\t\tmethod: httpMethod,\r\n\t\t\tbody: null,\r\n\t\t\tmultipart: false\r\n\t\t};\r\n\r\n\t\tif (this.flags & Api.INCLUDE_CREDENTIALS)\r\n\t\t\toptions.credentials = 'include';\r\n\r\n\t\tif (typeof(data) !== 'string' && !(data instanceof Blob))\r\n\t\t{\r\n\t\t\tif (!(data instanceof FormData))\r\n\t\t\t{\r\n\t\t\t\tdata = new FormData();\r\n\r\n\t\t\t\tfor (let i in params)\r\n\t\t\t\t{\r\n\t\t\t\t\tif ((params[i] instanceof File) || (params[i] instanceof Blob))\r\n\t\t\t\t\t\tdata.append(i, params[i], params[i].name);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tdata.append(i, params[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i of data.entries())\r\n\t\t\t{\r\n\t\t\t\tif ((i[1] instanceof File) || (i[1] instanceof Blob))\r\n\t\t\t\t{\r\n\t\t\t\t\toptions.method = 'POST';\r\n\t\t\t\t\toptions.multipart = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.useReq64 && (this.flags & Api.REQ64_SUPPORTED) && !options.multipart)\r\n\t\t\t{\r\n\t\t\t\tlet tmp = new FormData();\r\n\t\t\t\ttmp.append('req64', base64.encode(this.encodeParams(data)));\r\n\t\t\t\tdata = tmp;\r\n\t\t\t}\r\n\r\n\t\t\tif (options.method == 'auto')\r\n\t\t\t{\r\n\t\t\t\tlet l = 0;\r\n\r\n\t\t\t\toptions.method = 'GET';\r\n\r\n\t\t\t\tfor (let i of data.entries())\r\n\t\t\t\t{\r\n\t\t\t\t\tl += i[0].length + i[1].length + 2;\r\n\r\n\t\t\t\t\tif (l > 960)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toptions.method = 'POST';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\r\n\t\t\t}\r\n\r\n\t\t\tif (options.method == 'GET')\r\n\t\t\t{\r\n\t\t\t\turl = this.appendParam(url, this.encodeParams(data));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif (!options.multipart)\r\n\t\t\t\t{\r\n\t\t\t\t\toptions.headers['Content-Type'] = 'application/x-www-form-urlencoded';\r\n\t\t\t\t\toptions.body = this.encodeParams(data);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\toptions.body = data;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif (typeof(data) === 'string')\r\n\t\t\t{\r\n\t\t\t\tif (data[0] === '<')\r\n\t\t\t\t{\r\n\t\t\t\t\tif (data.endsWith('</soap:Envelope>'))\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/soap+xml';\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/xml';\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tif (data[0] === '{')\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/json';\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/octet-stream';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\toptions.headers['Content-Type'] = data.type;\r\n\r\n\t\t\toptions.method = 'POST';\r\n\t\t\toptions.body = data;\r\n\t\t}\r\n\r\n\t\tglobal.fetch(url, options)\r\n\t\t.then(result => this.decodeResult(result))\r\n\t\t.then(result =>\r\n\t\t{\r\n\t\t\tthis._hideProgress();\r\n\t\t\tif (!success) return\r\n\r\n\t\t\tif (this.responseFilter(result, params)) {\r\n\t\t\t\ttry { success(result, params); } catch(e) { }\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err =>\r\n\t\t{\r\n\t\t\tthis._hideProgress();\r\n\r\n\t\t\tif (retries == 0) {\r\n\t\t\t\tif (failure) failure(params);\r\n\t\t\t} else {\r\n\t\t\t\tthis.apiCall (data, success, failure, httpMethod, retries-1, relativeUrl);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Decodes a result obtained using fetch into a usable object.\r\n\t */\r\n\tdecodeResult: function (result)\r\n\t{\r\n\t\tlet type = result.headers.get('content-type').split(';')[0].toLowerCase();\r\n\r\n\t\tif ((this.flags & Api.JSON_RESPONSE_SUPPORTED) && type.indexOf('json') !== -1)\r\n\t\t\treturn result.json();\r\n\r\n\t\tif ((this.flags & Api.XML_RESPONSE_SUPPORTED) && type.indexOf('xml') !== -1)\r\n\t\t{\r\n\t\t\treturn new Promise((resolve, reject) =>\r\n\t\t\t{\r\n\t\t\t\tresult.text().then(data =>\r\n\t\t\t\t{\r\n\t\t\t\t\tdata = (new DOMParser).parseFromString(data, 'text/xml');\r\n\t\t\t\t\tresolve(data);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(reject);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result.blob();\r\n\t},\r\n\r\n\t/**\r\n\t * Makes a blob with the specified data and type.\r\n\t */\r\n\tgetBlob: function (data, type)\r\n\t{\r\n\t\treturn new Blob ([data], { type: type });\r\n\t},\r\n\r\n\t/**\r\n\t * Provided access to the base64 module to encode/decode data.\r\n\t */\r\n\tbase64:\r\n\t{\r\n\t\tencode: function (value)\r\n\t\t{\r\n\t\t\treturn base64.encode(value);\r\n\t\t},\r\n\r\n\t\tdecode: function (value)\r\n\t\t{\r\n\t\t\treturn base64.decode(value);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Executes a POST API call.\r\n\t */\r\n\tpost: function (params, success=null, failure=null)\r\n\t{\r\n\t\treturn this.apiCall(params, success, failure, 'POST');\r\n\t},\r\n\r\n\t/**\r\n\t * Executes a GET API call.\r\n\t */\r\n\tget: function (params, success=null, failure=null)\r\n\t{\r\n\t\treturn this.apiCall(params, success, failure, 'GET');\r\n\t},\r\n\r\n\t/**\r\n\t * Executes an automatic API call, returns a promise.\r\n\t */\r\n\tfetch: function (url, params=null)\r\n\t{\r\n\t\tif (params === null)\r\n\t\t{\r\n\t\t\tif (typeof(url) !== 'string')\r\n\t\t\t{\r\n\t\t\t\tparams = url;\r\n\t\t\t\turl = '';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.apiCall(params, resolve, reject, null, null, url);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Builds a URL from the given data.\r\n\t */\r\n\tmakeUrl: function (url, params=null)\r\n\t{\r\n\t\tif (params === null)\r\n\t\t{\r\n\t\t\tif (typeof(url) !== 'string')\r\n\t\t\t{\r\n\t\t\t\tparams = url;\r\n\t\t\t\turl = '';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.appendParam(this.getUrl(url), this.encodeParams(params));\r\n\t}\r\n};\r\n\r\nexport default Api;\r\n","\r\nimport { Model, ModelList, EventDispatcher } from 'rinn';\r\nimport Api from './api.js';\r\n\r\n/*\r\n**\tProvides several methods to quickly interface with a remote data-source as defined by Wind.\r\n*/\r\n\r\nexport default EventDispatcher.extend\r\n({\r\n\tclassName: 'DataSource',\r\n\tdebounceDelay: 250,\r\n\r\n\trequest: null,\r\n\r\n\tincludeCount: false,\r\n\tincludeEnum: false,\r\n\tincludeList: true,\r\n\r\n\teid: null,\r\n\tcount: 0,\r\n\tlist: null,\r\n\tenum: null,\r\n\r\n\t/*\r\n\t**\tConstructs the data source with the specified optional `config` parameters, any of the properties of this object can be specified\r\n\t**\tin the config. Uses the given basePath as prefix for the `f` parameter for subsequent API operations, a basePath of `candies` will\r\n\t**\tresult in calls to `candies.list`, `candies.count`, etc.\r\n\t*/\r\n\t__ctor: function (basePath, config)\r\n\t{\r\n\t\tthis._super.EventDispatcher.__ctor();\r\n\r\n\t\tthis.basePath = basePath;\r\n\r\n\t\tif (config) Object.assign(this, config);\r\n\r\n\t\tthis.request = new Model(this.request);\r\n\r\n\t\tthis.eid = Math.random().toString().substr(2);\r\n\t\tthis.count = 0;\r\n\r\n\t\tthis.list = new ModelList();\r\n\t\tthis.list.dataSource = this;\r\n\r\n\t\tthis.enum = new ModelList();\r\n\t\tthis.enum.dataSource = this;\r\n\r\n\t\tthis.request.addEventListener (this.eid+':propertyChanged', this.forwardRequestEvent, this);\r\n\r\n\t\tthis.list.addEventListener (this.eid+':itemsCleared', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemsChanged', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemRemoved', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemChanged', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemAdded', this.forwardListEvent, this);\r\n\r\n\t\tthis.enum.addEventListener (this.eid+':itemsCleared', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemsChanged', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemRemoved', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemChanged', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemAdded', this.forwardEnumEvent, this);\r\n\t},\r\n\r\n\tforwardRequestEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('request' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\tforwardListEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('list' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\tforwardEnumEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('enum' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\t/*\r\n\t**\tExecutes one or more API functions (depending on `includeCount`, `includeEnum` and `includeList` properties) to retrieve the\r\n\t**\trequired data (uses debounce to prevent too-quick refreshes).\r\n\t**\r\n\t**\tRefresh mode can be: order, filter, range or full. Setting `mode` to `true` will cause a full refresh without debouncing.\r\n\t*/\r\n\trefresh: function (mode='full', callback=null)\r\n\t{\r\n\t\tif (typeof(mode) == 'function')\r\n\t\t{\r\n\t\t\tcallback = mode;\r\n\t\t\tmode = 'full';\r\n\t\t}\r\n\r\n\t\tif (this._timeout)\r\n\t\t{\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t\tthis._timeout = null;\r\n\t\t}\r\n\r\n\t\tconst fn = () =>\r\n\t\t{\r\n\t\t\tthis._timeout = null;\r\n\r\n\t\t\tApi.packageBegin();\r\n\r\n\t\t\tif (this.includeCount && (mode == 'full' || mode == 'filter')) this.fetchCount();\r\n\t\t\tif (this.includeEnum && (mode == 'full')) this.fetchEnum();\r\n\t\t\tif (this.includeList) this.fetchList();\r\n\r\n\t\t\tApi.packageEnd(callback);\r\n\t\t};\r\n\r\n\t\tif (mode === true)\r\n\t\t{\r\n\t\t\tmode = 'full';\r\n\t\t\tfn();\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis._timeout = setTimeout(fn, this.debounceDelay);\r\n\t},\r\n\r\n\t/*\r\n\t**\tSearches for the item in `list` that matches the specified `fields` and sends it to the callback. If no item is found (or if `forced` is true),\r\n\t**\ta call to API function `.get` will be executed with the fields as request parameters. Returns a promise.\r\n\t*/\r\n\tfetch: function (fields, forced=false)\r\n\t{\r\n\t\treturn new Promise((resolve, reject) =>\r\n\t\t{\r\n\t\t\tlet item = forced == true ? null : this.list.find(fields, true);\r\n\t\t\tif (!item)\r\n\t\t\t{\r\n\t\t\t\tthis.fetchOne(fields, (r) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tif (r && r.response == 200)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (r.data.length > 0)\r\n\t\t\t\t\t\t\tresolve(r.data[0]);\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\treject(r);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\treject(r);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tresolve(item.get());\r\n\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t**\tRemoves an item from the remote data source by executing the `.delete` API function, passes the given `fields` as request\r\n\t**\tparameters. Returns a promise.\r\n\t*/\r\n\tdelete: function (params)\r\n\t{\r\n\t\treturn new Promise((resolve, reject) =>\r\n\t\t{\r\n\t\t\tthis.fetchDelete(params, (r) =>\r\n\t\t\t{\r\n\t\t\t\tif (r.response == 200)\r\n\t\t\t\t\tresolve(r);\r\n\t\t\t\telse\r\n\t\t\t\t\treject(r.error);\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\tfetchList: function ()\r\n\t{\r\n\t\tlet data = {...this.request.get()};\r\n\r\n\t\tdata.f = this.basePath + '.list';\r\n\r\n\t\tthis.dispatchEvent('listLoading');\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tthis.list.setData(r.response == 200 ? r.data : null);\r\n\t\t\tthis.dispatchEvent('listLoaded');\r\n\t\t\tthis.dispatchEvent('listChanged');\r\n\t\t});\r\n\t},\r\n\r\n\tfetchEnum: function ()\r\n\t{\r\n\t\tlet data = {...this.request.get()};\r\n\r\n\t\tdata.f = this.basePath + '.enum';\r\n\r\n\t\tthis.dispatchEvent('enumLoading');\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tthis.enum.setData(r.response == 200 ? r.data : null);\r\n\t\t\tthis.dispatchEvent('enumLoaded');\r\n\t\t\tthis.dispatchEvent('enumChanged');\r\n\t\t});\r\n\t},\r\n\r\n\tfetchCount: function ()\r\n\t{\r\n\t\tlet data = {...this.request.get()};\r\n\r\n\t\tdata.f = this.basePath + '.count';\r\n\r\n\t\tthis.dispatchEvent('countLoading');\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tthis.count = r.response == 200 ? r.count : 0;\r\n\t\t\tthis.dispatchEvent('countLoaded');\r\n\t\t\tthis.dispatchEvent('countChanged');\r\n\t\t});\r\n\t},\r\n\r\n\tfetchOne: function (params, callback)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tdata.f = this.basePath + '.get';\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tcallback(r);\r\n\t\t});\r\n\t},\r\n\r\n\tfetchDelete: function (params, callback)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tdata.f = this.basePath + '.delete';\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tcallback(r);\r\n\t\t});\r\n\t},\r\n\r\n\tfetchData: function (params)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tif (data.f[0] == '.')\r\n\t\t\tdata.f = this.basePath + data.f;\r\n\r\n\t\treturn Api.fetch(data);\r\n\t},\r\n\r\n\tmakeUrl: function (params)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tif (data.f[0] == '.')\r\n\t\t\tdata.f = this.basePath + data.f;\r\n\r\n\t\treturn Api.makeUrl(data);\r\n\t}\r\n});\r\n","\r\nimport { Model, ModelList } from 'rinn';\r\nimport Api from './api.js';\r\n\r\n/*\r\n**\tProvides an interface to connect with a listing API function.\r\n*/\r\n\r\nexport default ModelList.extend\r\n({\r\n\tclassName: 'DataList',\r\n\tdebounceDelay: 250,\r\n\r\n\trequest: null,\r\n\r\n\teid: null,\r\n\r\n\t/*\r\n\t**\tConstructs the data list with the specified optional `config` parameters, any of the properties of this object can be specified\r\n\t**\tin the config. The given `f` parameter is passed directly as a request parameter to the API.\r\n\t*/\r\n\t__ctor: function (f, config=null)\r\n\t{\r\n\t\tthis._super.ModelList.__ctor();\r\n\r\n\t\tif (config !==  null)\r\n\t\t\tObject.assign(this, config);\r\n\r\n\t\tif (!this.request)\r\n\t\t\tthis.request = { };\r\n\r\n\t\tthis.request.f = f;\r\n\t\tthis.request = new Model(this.request);\r\n\r\n\t\tthis.eid = Math.random().toString().substr(2);\r\n\t\tthis.dataList = this;\r\n\r\n\t\tthis.request.addEventListener (this.eid+':propertyChanged', this.forwardRequestEvent, this);\r\n\t},\r\n\r\n\tforwardRequestEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('request' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\t/*\r\n\t**\tExecutes a request to retrieve the data for the list (uses debounce to prevent too-quick refreshes).\r\n\t*/\r\n\trefresh: function (callback=null, _callback=null)\r\n\t{\r\n\t\tif (this._timeout)\r\n\t\t{\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t\tthis._timeout = null;\r\n\t\t}\r\n\r\n\t\tif (callback === true)\r\n\t\t{\r\n\t\t\tthis.dispatchEvent('listLoading');\r\n\r\n\t\t\tApi.fetch(this.request.get()).then(r =>\r\n\t\t\t{\r\n\t\t\t\tthis.setData(r.response == 200 ? r.data : null);\r\n\t\t\t\tthis.dispatchEvent('listLoaded');\r\n\t\t\t\tthis.dispatchEvent('listChanged');\r\n\r\n\t\t\t\tif (_callback !== null)\r\n\t\t\t\t\t_callback();\r\n\t\t\t});\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst fn = () => {\r\n\t\t\tthis.refresh(true, callback);\r\n\t\t};\r\n\r\n\t\tthis._timeout = setTimeout(fn, this.debounceDelay);\r\n\t}\r\n});\r\n","\n/**\n**\tCollection of useful easing functions (imported from Cherry source code).\n*/\n\nconst Easing =\n{\n\t/**\n\t**\tInterpolates numeric values between two objects (`src` and `dst`) using the specified `duration` (in seconds) and `easing` function. Note that all four parameters\n\t**\t`src`, `dst`, `duration` and `easing` must be objects having the same number of values.\n\t*/\n\tinterpolate: function (src, dst, duration, easing, callback/* function(data, isFinished) */)\n\t{\n\t\tlet time = { };\n\t\tlet data = { };\n\t\tlet count = 0;\n\n\t\tfor (let x in src)\n\t\t{\n\t\t\ttime[x] = 0.0;\n\t\t\tdata[x] = src[x]\n\t\t\tcount++;\n\t\t}\n\n\t\tlet lastTime = Date.now()/1000;\n\t\tlet dt = 0;\n\n\t\tlet interpolator = function()\n\t\t{\n\t\t\tlet curTime = Date.now()/1000;\n\t\t\tdt = curTime - lastTime;\n\t\t\tlastTime = curTime;\n\n\t\t\tfor (let x in time)\n\t\t\t{\n\t\t\t\tif (time[x] == duration[x])\n\t\t\t\t\tcontinue;\n\n\t\t\t\ttime[x] += dt;\n\t\t\t\tif (time[x] >= duration[x])\n\t\t\t\t{\n\t\t\t\t\ttime[x] = duration[x];\n\t\t\t\t\tcount--;\n\t\t\t\t}\n\n\t\t\t\tlet t = easing[x] (time[x] / duration[x]);\n\t\t\t\tdata[x] = (1-t)*src[x] + t*dst[x];\n\t\t\t}\n\n\t\t\tcallback (data, count == 0);\n\n\t\t\tif (count != 0)\n\t\t\t\trequestAnimationFrame(interpolator);\n\t\t};\n\n\t\tinterpolator();\n\t},\n\n\t/* ******************************************** */\n\tLinear:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn t;\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\treturn t;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tBack:\n\t{\n\t\tk: 1.70158,\n\n\t\tIN: function (t, k)\n\t\t{\n\t\t\tif (k === undefined) k = Easing.Back.k;\n\t\t\treturn t*t*((k+1)*t - k);\n\t\t},\n\n\t\tOUT: function (t, k)\n\t\t{\n\t\t\treturn 1 - Easing.Back.IN(1 - t, k);\n\t\t},\n\n\t\tIN_OUT: function (t, k)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Back.IN(t*2, k)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Back.OUT((t-0.5)*2, k)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tBounce:\n\t{\n\t\tgetConst: function (t)\n\t\t{\n\t\t\tif (t < 1.0/2.75)\n\t\t\t\treturn 7.5625 * t * t;\n\t\t\telse if (t < 2.0/2.75)\n\t\t\t\treturn 7.5625 * (t -= 1.5/2.75)*t + 0.75;\n\t\t\telse if (t < 2.5/2.75)\n\t\t\t\treturn 7.5625 * (t -= 2.250/2.75) * t + 0.9375;\n\n\t\t\treturn 7.5625 * (t -= 2.625/2.75) * t + 0.984375;\n\t\t},\n\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Bounce.getConst(1-t);\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn Easing.Bounce.getConst(t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn (1 - Easing.Bounce.getConst(1-2*t))/2;\n\t\t\telse\n\t\t\t\treturn (Easing.Bounce.getConst((t-0.5)*2)/2)+0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tCirc:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn 1 - Math.sqrt(1 - t*t);\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Circ.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\t\treturn Easing.Circ.IN(t*2)/2;\n\t\t\t\telse\n\t\t\t\t\treturn Easing.Circ.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tCubic:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Cubic.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Cubic.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Cubic.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tExpo:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn Math.pow(2, 12*(t-1));\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn -Math.pow(2, -12*t) + 1;\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif ((t *= 2) < 1)\n\t\t\t\treturn Math.pow (2, 12 * (t - 1)) / 2;\n\t\t\telse\n\t\t\t\treturn (-Math.pow (2, -12 * (t - 1)) + 2) / 2;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tPower:\n\t{\n\t\tp: 12,\n\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn Math.pow(t, Easing.Power.p);\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Power.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Power.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Power.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tQuad:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Quad.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Quad.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Quad.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tQuartic:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t*t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Quartic.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Quartic.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Quartic.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tQuintic:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t*t*t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Quintic.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\t\treturn Easing.Quintic.IN(t*2)/2;\n\t\t\t\telse\n\t\t\t\t\treturn Easing.Quintic.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tSine:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn 1 - Math.sin (1.5708 * (1 - t));\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn Math.sin (1.5708 * t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\treturn (Math.cos (3.1416*t) - 1) / -2;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tStep:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t != 1.0 ? 0 : 1.0;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn t != 1.0 ? 0 : 1.0;\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\treturn t != 1.0 ? 0 : 1.0;\n\t\t}\n\t}\n};\n\nexport default Easing;\n","\nimport { Rinn, Class } from 'rinn';\n\n/**\n**\tClass to animate properties using rules (imported from Cherry source code).\n*/\n\nconst Anim = Class.extend\n({\n\tlist: null,\n\n\tinitialData: null,\n\tdata: null,\n\n\tstack: null,\n\tblock: null,\n\n\ttimeScale: 1, time: 0, blockTime: 0,\n\tindex: 0,\n\n\tpaused: false,\n\tfinished: false,\n\n\tonFinishedCallback: null,\n\tonUpdatedCallback: null,\n\n\t__ctor: function ()\n\t{\n\t\tthis.list = [ ];\n\n\t\tthis.initialData = { };\n\t\tthis.data = { };\n\n\t\tthis.stack = [ ];\n\t\tthis.block = this.list;\n\n\t\tthis.reset();\n\t},\n\n\t__dtor: function ()\n\t{\n\t},\n\n\tclone: function ()\n\t{\n\t\tlet a = new Anim();\n\n\t\ta.list = this.list;\n\t\ta.initialData = this.initialData;\n\n\t\treturn a.reset();\n\t},\n\n\tonFinished: function (callback)\n\t{\n\t\tthis.onFinishedCallback = callback;\n\t\treturn this;\n\t},\n\n\tonUpdated: function (callback)\n\t{\n\t\tthis.onUpdatedCallback = callback;\n\t\treturn this;\n\t},\n\n\t// Resets the animation to its initial state.\n\treset: function ()\n\t{\n\t\tthis.stack.length = 0;\n\t\tthis.blockTime = 0;\n\n\t\tthis.time = 0;\n\t\tthis.index = 0;\n\n\t\tthis.block = this.list;\n\n\t\tthis.paused = true;\n\t\tthis.finished = false;\n\t\tthis.handle = null;\n\n\t\tfor (let i in this.initialData)\n\t\t\tthis.data[i] = this.initialData[i];\n\n\t\treturn this;\n\t},\n\n\t// Sets the initial data.\n\tinitial: function (data)\n\t{\n\t\tthis.initialData = data;\n\t\treturn this.reset();\n\t},\n\n\t// Sets the time scale (animation speed).\n\tspeed: function (value)\n\t{\n\t\tthis.timeScale = value > 0.0 ? value : 1.0;\n\t\treturn this;\n\t},\n\n\t// Sets the output data object.\n\tsetOutput: function (data)\n\t{\n\t\tthis.data = data;\n\t\treturn this;\n\t},\n\n\t// Pauses the animation.\n\tpause: function ()\n\t{\n\t\tif (this.paused) return;\n\n\t\tclearInterval(this.handle);\n\t\tthis.paused = true;\n\t},\n\n\t// Resumes the animation.\n\tresume: function ()\n\t{\n\t\tif (!this.paused) return;\n\n\t\tlet lastTime = Date.now()/1000;\n\n\t\tthis.handle = setInterval(() =>\n\t\t{\n\t\t\tlet curTime = Date.now()/1000;\n\t\t\tlet dt = curTime - lastTime;\n\t\t\tlastTime = curTime;\n\n\t\t\tthis.update(dt);\n\n\t\t\tif (this.onUpdatedCallback)\n\t\t\t\tthis.onUpdatedCallback (this.data, this);\n\t\t},\n\t\t16);\n\n\t\tif (this.onUpdatedCallback)\n\t\t\tthis.onUpdatedCallback (this.data, this);\n\n\t\tthis.paused = false;\n\t},\n\n\t// Updates the animation by the specified delta time (seconds).\n\tupdate: function (dt)\n\t{\n\t\tif (this.paused) return false;\n\n\t\tif (this.index >= this.block.length)\n\t\t\treturn true;\n\n\t\tlet i = 0;\n\n\t\tlet _block;\n\t\tlet _index;\n\t\tlet _blockTime;\n\n\t\tthis.time += dt*this.timeScale;\n\n\t\twhile (this.index < this.block.length)\n\t\t{\n\t\t\tlet cmd = this.block[this.index];\n\t\t\tlet duration;\n\n\t\t\tswitch (cmd.op)\n\t\t\t{\n\t\t\t\tcase \"parallel\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd.blocks.length = 0;\n\t\t\t\t\t\tcmd.started = true;\n\n\t\t\t\t\t\tfor (i = 0; i < cmd.block.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcmd.blocks.push([cmd.block[i]]);\n\t\t\t\t\t\t\tcmd.indices[i] = 0;\n\t\t\t\t\t\t\tcmd.blockTimes[i] = this.blockTime;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t_block = this.block;\n\t\t\t\t\t_index = this.index;\n\t\t\t\t\t_blockTime = this.blockTime;\n\n\t\t\t\t\tlet n = 0;\n\t\t\t\t\tlet blockTime = _blockTime;\n\n\t\t\t\t\tfor (i = 0; i < cmd.blocks.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.block = cmd.blocks[i];\n\t\t\t\t\t\tthis.index = cmd.indices[i];\n\t\t\t\t\t\tthis.blockTime = cmd.blockTimes[i];\n\n\t\t\t\t\t\tif (this.update(0) === true)\n\t\t\t\t\t\t\tn++;\n\n\t\t\t\t\t\tif (this.blockTime > blockTime)\n\t\t\t\t\t\t\tblockTime = this.blockTime;\n\n\t\t\t\t\t\tcmd.blockTimes[i] = this.blockTime;\n\t\t\t\t\t\tcmd.blocks[i] = this.block;\n\t\t\t\t\t\tcmd.indices[i] = this.index;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.block = _block;\n\t\t\t\t\tthis.index = _index;\n\t\t\t\t\tthis.blockTime = _blockTime;\n\n\t\t\t\t\tif (cmd.fn) cmd.fn.call(this);\n\n\t\t\t\t\tif (n != cmd.blocks.length)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime = blockTime;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"serial\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd._block = cmd.block;\n\t\t\t\t\t\tcmd._index = 0;\n\t\t\t\t\t\tcmd._blockTime = this.blockTime;\n\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t_block = this.block;\n\t\t\t\t\t_index = this.index;\n\t\t\t\t\t_blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = cmd._block;\n\t\t\t\t\tthis.index = cmd._index;\n\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\n\t\t\t\t\ti = this.update(0);\n\n\t\t\t\t\tcmd._block = this.block;\n\t\t\t\t\tcmd._index = this.index;\n\t\t\t\t\tcmd._blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = _block;\n\t\t\t\t\tthis.index = _index;\n\t\t\t\t\tthis.blockTime = _blockTime;\n\n\t\t\t\t\tif (cmd.fn) cmd.fn.call(this);\n\n\t\t\t\t\tif (i !== true) return false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"repeat\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd._block = cmd.block;\n\t\t\t\t\t\tcmd._index = 0;\n\t\t\t\t\t\tcmd._blockTime = this.blockTime;\n\t\t\t\t\t\tcmd._count = cmd.count;\n\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t_block = this.block;\n\t\t\t\t\t_index = this.index;\n\t\t\t\t\t_blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = cmd._block;\n\t\t\t\t\tthis.index = cmd._index;\n\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\n\t\t\t\t\ti = this.update(0);\n\n\t\t\t\t\tcmd._block = this.block;\n\t\t\t\t\tcmd._index = this.index;\n\t\t\t\t\tcmd._blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = _block;\n\t\t\t\t\tthis.index = _index;\n\t\t\t\t\tthis.blockTime = _blockTime;\n\n\t\t\t\t\tif (cmd.fn) cmd.fn.call(this);\n\n\t\t\t\t\tif (i !== true) return false;\n\n\t\t\t\t\tif (cmd._count <= 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\t\t\t\t\t\tthis.index++;\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd._index = 0;\n\t\t\t\t\t\tcmd._count--;\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"set\":\n\t\t\t\t\tthis.data[cmd.field] = cmd.value;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"restart\":\n\t\t\t\t\tthis.index = 0;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"wait\":\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"range\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (cmd.startValue === null)\n\t\t\t\t\t\t\tcmd._startValue = this.data[cmd.field];\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tcmd._startValue = cmd.startValue;\n\n\t\t\t\t\t\tcmd._endValue = cmd.endValue;\n\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\tdt = (this.time - this.blockTime) / duration;\n\t\t\t\t\telse\n\t\t\t\t\t\tdt = 1;\n\n\t\t\t\t\tif (cmd.easing && dt != 1.0)\n\t\t\t\t\t\tthis.data[cmd.field] = cmd.easing(dt)*(cmd._endValue - cmd._startValue) + cmd._startValue;\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.data[cmd.field] = dt*(cmd._endValue - cmd._startValue) + cmd._startValue;\n\n\t\t\t\t\tif (dt != 1) return false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"rand\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t\tcmd.last = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\tdt = (this.time - this.blockTime) / duration;\n\t\t\t\t\telse\n\t\t\t\t\t\tdt = 1;\n\n\t\t\t\t\tif (cmd.easing && dt != 1)\n\t\t\t\t\t\tcmd.cur = ~~(cmd.easing(dt)*cmd.count);\n\t\t\t\t\telse\n\t\t\t\t\t\tcmd.cur = ~~(dt*cmd.count);\n\n\t\t\t\t\tif (cmd.cur != cmd.last)\n\t\t\t\t\t{\n\t\t\t\t\t\twhile (true) {\n\t\t\t\t\t\t\ti = ~~(Math.random()*(cmd.endValue - cmd.startValue + 1)) + cmd.startValue;\n\t\t\t\t\t\t\tif (i != this.data[cmd.field]) break;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.data[cmd.field] = i;\n\t\t\t\t\t\tcmd.last = cmd.cur;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (dt != 1) return false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"randt\":\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\tdt = (this.time - this.blockTime) / duration;\n\t\t\t\t\telse\n\t\t\t\t\t\tdt = 1;\n\n\t\t\t\t\tif (cmd.easing && dt != 1)\n\t\t\t\t\t\ti = cmd.easing(dt)*(cmd.count-1);\n\t\t\t\t\telse\n\t\t\t\t\t\ti = dt*(cmd.count-1);\n\n\t\t\t\t\tthis.data[cmd.field] = cmd.table[~~((i + cmd.count) % cmd.count)];\n\n\t\t\t\t\tif (dt != 1) return false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"play\":\n\t\t\t\t\tcmd.snd.play();\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"exec\":\n\t\t\t\t\tcmd.fn.call(this, this);\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this.block == this.list)\n\t\t{\n\t\t\tif (!this.finished && this.onFinishedCallback != null)\n\t\t\t\tthis.onFinishedCallback();\n\n\t\t\tthis.pause();\n\t\t\tthis.finished = true;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t// Runs the subsequent commands in parallel. Should end the parallel block by calling end().\n\tparallel: function ()\n\t{\n\t\tlet block = [ ];\n\n\t\tthis.block.push({ op: \"parallel\", started: false, block: block, blocks: [ ], indices: [ ], blockTimes: [ ] });\n\n\t\tthis.stack.push (this.block);\n\t\tthis.block = block;\n\n\t\treturn this;\n\t},\n\n\t// Runs the subsequent commands in series. Should end the serial block by calling end().\n\tserial: function ()\n\t{\n\t\tlet block = [ ];\n\n\t\tthis.block.push({ op: \"serial\", started: false, block: block });\n\n\t\tthis.stack.push (this.block);\n\t\tthis.block = block;\n\n\t\treturn this;\n\t},\n\n\t// Repeats a block the specified number of times.\n\trepeat: function (count)\n\t{\n\t\tlet block = [ ];\n\n\t\tthis.block.push({ op: \"repeat\", started: false, block: block, count: count });\n\n\t\tthis.stack.push (this.block);\n\t\tthis.block = block;\n\n\t\treturn this;\n\t},\n\n\t// Sets the callback of the current block.\n\tcallback: function (fn)\n\t{\n\t\tlet block = this.stack[this.stack.length-1];\n\t\tblock[block.length-1].fn = fn;\n\n\t\treturn this;\n\t},\n\n\t// Ends a parallel(), serial() or repeat() block.\n\tend: function ()\n\t{\n\t\tthis.block = this.stack.pop();\n\t\treturn this;\n\t},\n\n\t// Sets the value of a variable.\n\tset: function (field, value)\n\t{\n\t\tthis.block.push({ op: \"set\", field: field, value: value });\n\t\treturn this;\n\t},\n\n\t// Restarts the current block.\n\trestart: function (duration)\n\t{\n\t\tthis.block.push({ op: \"restart\" });\n\t\treturn this;\n\t},\n\n\t// Waits for the specified duration.\n\twait: function (duration)\n\t{\n\t\tthis.block.push({ op: \"wait\", duration: duration });\n\t\treturn this;\n\t},\n\n\t// Sets the range of a variable.\n\trange: function (field, duration, startValue, endValue, easing)\n\t{\n\t\tthis.block.push({ op: \"range\", started: false, field: field, duration: duration, startValue: startValue, endValue: endValue, easing: easing ? easing : null });\n\t\treturn this;\n\t},\n\n\t// Generates a certain amount of random numbers in the given range (inclusive).\n\trand: function (field, duration, count, startValue, endValue, easing)\n\t{\n\t\tthis.block.push({ op: \"rand\", started: false, field: field, duration: duration, count: count, startValue: startValue, endValue: endValue, easing: easing ? easing : null });\n\t\treturn this;\n\t},\n\n\t// Generates a certain amount of random numbers in the given range (inclusive). This uses a static random table to determine the next values.\n\trandt: function (field, duration, count, startValue, endValue, easing)\n\t{\n\t\tlet table = [ ];\n\n\t\tfor (let i = 0; i < count; i++)\n\t\t\ttable.push ((i % (endValue - startValue + 1)) + startValue);\n\n\t\tfor (let i = count >> 2; i > 0; i--)\n\t\t{\n\t\t\tlet a = ~~(Math.random() * count);\n\t\t\tlet b = ~~(Math.random() * count);\n\n\t\t\tlet c = table[b];\n\t\t\ttable[b] = table[a];\n\t\t\ttable[a] = c;\n\t\t}\n\n\t\tthis.block.push({ op: \"randt\", field: field, duration: duration, count: count, startValue: startValue, endValue: endValue, table: table, easing: easing ? easing : null });\n\t\treturn this;\n\t},\n\n\t// Plays a sound.\n\tplay: function (snd)\n\t{\n\t\tthis.block.push({ op: \"play\", snd: snd });\n\t\treturn this;\n\t},\n\n\t// Executes a function.\n\texec: function (fn)\n\t{\n\t\tthis.block.push({ op: \"exec\", fn: fn });\n\t\treturn this;\n\t}\n});\n\nexport default Anim;\n","/*\n**\telems/r-tabs\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-tabs data-container=\"div.tab-container\" data-base-route=\"@\" data-initial=\"tab1\">\n\t\t<a data-name=\"tab1\">Tab-1</a>\n\t\t<a data-name=\"tab2\">Tab-2</a>\n\t\t<a data-name=\"tab3\">Tab-3</a>\n\t</r-tabs>\n\n\t<div class=\"tab-container\">\n\t\t<div data-name=\"tab1\">\n\t\t\tThis is tab-1.\n\t\t</div>\n\n\t\t<div data-name=\"tab2\">\n\t\t\tThis is tab-2.\n\t\t</div>\n\n\t\t<div data-name=\"tab3\">\n\t\t\tThis is tab-3.\n\t\t</div>\n\t</div>\n\n\t.x-hidden {\n\t\tdisplay: none;\n\t}\n\n\tr-tabs [data-name].active {\n\t\tfont-weight: bold;\n\t}\n*/\n\nimport Element from '../element.js';\nimport Router from '../router.js';\n\nexport default Element.register ('r-tabs',\n{\n\t/*\n\t**\tContainer element for tab content.\n\t*/\n\tcontainer: null,\n\n\t/**\n\t**\tElement events.\n\t*/\n\t'event click [data-name]': function (evt)\n\t{\n\t\tevt.continuePropagation = true;\n\n\t\tif (this.dataset.baseRoute)\n\t\t{\n\t\t\tlocation = \"#\" + Router.realLocation(this.dataset.baseRoute.replace('@', evt.source.dataset.name));\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selectTab (evt.source.dataset.name);\n\t},\n\n\t/**\n\t**\tInitializes the Tabs element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis._routeHandler = (evt, args) =>\n\t\t{\n\t\t\tif (Router.location != '')\n\t\t\t{\n\t\t\t\tthis.querySelectorAll(\"[href]\").forEach(link =>\n\t\t\t\t{\n\t\t\t\t\tif (!link.href) return;\n\n\t\t\t\t\tif (Router.location.startsWith(link.href.substr(link.href.indexOf('#')+1)))\n\t\t\t\t\t\tlink.classList.add('active');\n\t\t\t\t\telse\n\t\t\t\t\t\tlink.classList.remove('active');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!args.route.changed)\n\t\t\t\treturn;\n\n\t\t\tthis.showTab (args.tabName);\n\t\t};\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tif (\"container\" in this.dataset)\n\t\t{\n\t\t\tif (this.dataset.container == ':previousElement')\n\t\t\t\tthis.container = this.previousElementSibling;\n\t\t\telse if (this.dataset.container == ':nextElement')\n\t\t\t\tthis.container = this.nextElementSibling;\n\t\t\telse if (this.dataset.container == ':none')\n\t\t\t\tthis.container = null;\n\t\t\telse\n\t\t\t\tthis.container = document.querySelector(this.dataset.container);\n\t\t}\n\t\telse\n\t\t\tthis.container = this.nextElementSibling;\n\n\t\tthis._hideTabsExcept(this.dataset.initial);\n\t},\n\n\t/**\n\t**\tAdds a handler to Router if the data-base-route attribute was set.\n\t*/\n\tonConnected: function()\n\t{\n\t\tif (this.dataset.baseRoute)\n\t\t\tRouter.addRoute (this.dataset.baseRoute.replace('@', ':tabName'), this._routeHandler);\n\t},\n\n\t/**\n\t**\tRemoves a handler previously added to Router if the data-base-route attribute was set.\n\t*/\n\tonDisconnected: function()\n\t{\n\t\tif (this.dataset.baseRoute)\n\t\t\tRouter.removeRoute(this.dataset.baseRoute.replace('@', ':tabName'), this._routeHandler);\n\t},\n\n\t/**\n\t**\tHides all tabs except the one with the specified exceptName, if none specified then all tabs will be hidden (adds `.x-hidden` CSS class),\n\t**\tadditionally the respective link item in the tab definition will have class `.active`.\n\t*/\n\t_hideTabsExcept: function (exceptName)\n\t{\n\t\tif (!exceptName) exceptName = '';\n\n\t\tif (this.container != null)\n\t\t{\n\t\t\tthis.container.querySelectorAll(':scope > [data-name]').forEach(i =>\n\t\t\t{\n\t\t\t\tif (i.dataset.name == exceptName)\n\t\t\t\t{\n\t\t\t\t\ti.classList.remove('x-hidden');\n\t\t\t\t\tthis.dispatch('tabShown', { name: i.dataset.name, el: i });\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ti.classList.add('x-hidden');\n\t\t\t\t\tthis.dispatch('tabHidden', { name: i.dataset.name, el: i });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.querySelectorAll(\"[data-name]\").forEach(link =>\n\t\t{\n\t\t\tif (link.dataset.name == exceptName)\n\t\t\t\tlink.classList.add('active');\n\t\t\telse\n\t\t\t\tlink.classList.remove('active');\n\t\t});\n\n\t\tthis.dispatch('tabChanged', { name: exceptName });\n\t},\n\n\t/**\n\t**\tShows the tab with the specified name, ignores `data-base-route` and current route as well.\n\t*/\n\tshowTab: function (name)\n\t{\n\t\treturn this._hideTabsExcept (name);\n\t},\n\n\t/**\n\t**\tShows a tab given its name. The route will be changed automatically if `data-base-route` is enabled.\n\t*/\n\tselectTab: function (name)\n\t{\n\t\tif (this.dataset.baseRoute)\n\t\t{\n\t\t\tconst hash = \"#\" + Router.realLocation(this.dataset.baseRoute.replace('@', name));\n\n\t\t\tif (location.hash != hash)\n\t\t\t{\n\t\t\t\tlocation = hash;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.showTab (name);\n\t}\n});\n","/*\n**\telems/r-form\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n<r-form data-form-action=\"api-function-name\" [data-strict=\"true|false\"] [data-errors-at=\"\"] [data-method=\"post\"]>\n\t<input type=\"text\" data-field=\"username\"/>\n</r-form>\n\nr-form .message.x-hidden {\n    display: none;\n}\n\nr-form span.field-error {\n    display: block;\n    color: red;\n}\n*/\n\nimport { Template } from 'rinn';\nimport Element from '../element.js';\nimport Api from '../api.js';\n\nexport default Element.register ('r-form',\n{\n\t/**\n\t**\tElement events.\n\t*/\n\tevents:\n\t{\n\t\t'change [data-field]': '_fieldChanged',\n\n\t\t'click input[type=reset]': 'reset',\n\t\t'click .reset': 'reset',\n\n\t\t'click input[type=submit]': 'submit',\n\t\t'click button[type=submit]': 'submit',\n\t\t'click .submit': 'submit',\n\t\t'submit form': 'submit'\n\t},\n\n\t/*\n\t**\tInitial form model.\n\t*/\n\tmodel: { },\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tlet formElement = document.createElement('form');\n\t\tformElement.append(...this.childNodes);\n\t\tthis.append(formElement);\n\n\t\tlet def = { };\n\t\tlet names = this.model.get();\n\n\t\tthis.querySelectorAll('[data-field]').forEach((i) =>\n\t\t{\n\t\t\ti.name = i.dataset.field;\n\t\t\tnames[i.name] = i.type;\n\n\t\t\tlet val = i.dataset.default;\n\t\t\tif (val == undefined)\n\t\t\t{\n\t\t\t\tswitch (i.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'radio':\n\t\t\t\t\t\tif (!i.checked) return;\n\t\t\t\t\t\tval = i.value;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\tval = i.checked ? '1' : '0';\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'field':\n\t\t\t\t\t\tval = i.getValue();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'file':\n\t\t\t\t\t\tval = '';\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tval = '';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdef[i.dataset.field] = val;\n\t\t});\n\n\t\tfor (let name in names)\n\t\t{\n\t\t\tif (name in def)\n\t\t\t\tnames[name] = def[name];\n\t\t\telse\n\t\t\t\tnames[name] = '';\n\t\t}\n\n\t\tdef = names;\n\n\t\tthis.model.defaults = def;\n\t\tthis.model.reset();\n\n\t\tthis.clearMarkers();\n\t},\n\n\t/*\n\t**\tTransforms an string returned by the server to a local representation.\n\t*/\n\tfilterString: function (str, r)\n\t{\n\t\tif (!str || !('messages' in global))\n\t\t\treturn str;\n\n\t\tif (str.startsWith('@messages.'))\n\t\t{\n\t\t\tif (str.substr(10) in global.messages)\n\t\t\t\tstr = Template.eval(global.messages[str.substr(10)], r);\n\t\t}\n\n\t\treturn str;\n\t},\n\n\t_change: function(elem)\n\t{\n\t\tif ('createEvent' in document)\n\t\t{\n\t\t\tlet evt = document.createEvent('HTMLEvents');\n\t\t\tevt.initEvent('change', false, true);\n\t\t\telem.dispatchEvent(evt);\n\t\t}\n\t\telse\n\t\t\telem.fireEvent('onchange');\n\t},\n\n\t_setField: function (f, value, silent)\n\t{\n\t\tif (!f) return;\n\n\t\tfor (f of this.querySelectorAll('[data-field=\"'+f+'\"]'))\n\t\t{\n\t\t\tswitch (f.type || f.tagName.toLowerCase())\n\t\t\t{\n\t\t\t\tcase 'select':\n\t\t\t\t\tf.val = f.dataset.value = f.multiple ? (value ? value.split(',') : value) : value;\n\t\t\t\t\tf.value = f.val = f.dataset.value;\n\n\t\t\t\t\tif (silent !== true) this._change(f);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\tf.checked = parseInt(value) ? true : false;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\tf.checked = value == f.value;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'field':\n\t\t\t\t\tf.val = f.dataset.value = value;\n\t\t\t\t\tf.setValue(value);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'file':\n\t\t\t\t\tif ((value instanceof File) || (value instanceof Blob))\n\t\t\t\t\t{\n\t\t\t\t\t\tf.val = value;\n\t\t\t\t\t\tf.dataset.value = value;\n\t\t\t\t\t}\n\t\t\t\t\telse if (value instanceof FileList)\n\t\t\t\t\t{\n\t\t\t\t\t\tf.val = value;\n\t\t\t\t\t\tf.dataset.value = value;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tf.val = f.dataset.value = '';\n\t\t\t\t\t\tf.value = '';\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tf.val = f.dataset.value = value;\n\t\t\t\t\tf.value = value;\n\n\t\t\t\t\tif (silent !== true) this._change(f);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t},\n\n\t_getField: function (f, _value=null, fromFileFields=false)\n\t{\n\t\tif (!f) return null;\n\n\t\tif (typeof(f) != 'string')\n\t\t{\n\t\t\tlet value = f.value == null ? f.val : f.value;\n\t\t\tif (value === null) value = _value;\n\n\t\t\tswitch (f.type || f.tagName.toLowerCase())\n\t\t\t{\n\t\t\t\tcase 'select':\n\t\t\t\t\t_value = f.multiple ? (value ? value.join(',') : value) : value;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\t_value = f.checked ? '1' : '0';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\tif (f.checked) _value = f.value;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'field':\n\t\t\t\t\t_value = f.getValue();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'file':\n\t\t\t\t\t_value = fromFileFields ? (f.files && f.files.length ? (f.multiple ? f.files : f.files[0]) : null) : f.val;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t_value = value;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn _value === null ? '' : _value;\n\t\t}\n\n\t\t_value = null;\n\n\t\tfor (f of this.querySelectorAll('[data-field=\"'+f+'\"]'))\n\t\t\t_value = this._getField(f, _value);\n\n\t\treturn _value === null ? '' : _value;\n\t},\n\n\tgetField: function (name)\n\t{\n\t\treturn this._getField(name);\n\t},\n\n\tclearMarkers: function ()\n\t{\n\t\tthis.classList.remove('busy');\n\n\t\tthis.querySelectorAll('.message').forEach(i => i.classList.add('x-hidden') );\n\t\tthis.querySelectorAll('span.field-error').forEach(i => i.remove());\n\n\t\tthis.querySelectorAll('.field-error').forEach(i => { i.classList.remove('field-error'); i.classList.remove('is-invalid'); });\n\t\tthis.querySelectorAll('.field-passed').forEach(i => i.classList.remove('field-passed'));\n\t},\n\n\t_fieldChanged: function (evt)\n\t{\n\t\tlet f = evt.source;\n\n\t\tif (f.type == 'file')\n\t\t\tthis.model.set (f.dataset.field, this._getField(f, null, true), true);\n\t\telse\n\t\t\tthis.model.set (f.dataset.field, this._getField(f));\n\n\t\tevt.continuePropagation = true;\n\t},\n\n\tonModelPropertyChanged: function (evt, args)\n\t{\n\t\tthis._setField (args.name, args.value);\n\t},\n\n\t_onSuccess: function(r)\n\t{\n\t\tthis.classList.remove('busy');\n\t\tlet tmp;\n\n\t\tthis.dispatch ('formSuccess', r);\n\n\t\tif (r.message && (tmp = this.querySelector('.message.success')) != null)\n\t\t{\n\t\t\ttmp.innerHTML = this.filterString(r.message, r).replace(/\\n/g, '<br/>');\n\t\t\ttmp.classList.remove('x-hidden');\n\t\t\ttmp.onanimationend = () => tmp.classList.add('x-hidden');\n\t\t}\n\t},\n\n\t_onFailure: function(r)\n\t{\n\t\tthis.classList.remove('busy');\n\t\tlet tmp;\n\n\t\tthis.dispatch ('formError', r);\n\n\t\tif (r.fields)\n\t\t{\n\t\t\tfor (let i in r.fields)\n\t\t\t{\n\t\t\t\tlet f = this.querySelector('[data-field-container=\"'+i+'\"]');\n\t\t\t\tif (!f)\n\t\t\t\t{\n\t\t\t\t\tf = this.querySelector('[data-field=\"'+i+'\"]');\n\t\t\t\t\tif (!f) continue;\n\t\t\t\t}\n\n\t\t\t\tlet tmp = document.createElement('span');\n\t\t\t\ttmp.classList.add('field-error');\n\t\t\t\ttmp.innerHTML = this.filterString(r.fields[i], r).replace(/\\n/g, '<br/>');\n\n\t\t\t\tf.classList.add('field-error');\n\t\t\t\tf.classList.add('is-invalid');\n\n\t\t\t\tif (this.dataset.errorsAt == 'bottom')\n\t\t\t\t\tf.parentElement.append(tmp);\n\t\t\t\telse if (this.dataset.errorsAt == 'top')\n\t\t\t\t\tf.parentElement.prepend(tmp);\n\t\t\t\telse\n\t\t\t\t\tf.parentElement.insertBefore(tmp, f.nextElementSibling);\n\n\t\t\t\tsetTimeout((function (tmp) { return function() { tmp.classList.add('active'); } })(tmp), 25);\n\t\t\t}\n\n\t\t\tif (r.error && (tmp = this.querySelector('.message.error')) != null)\n\t\t\t{\n\t\t\t\ttmp.innerHTML = this.filterString(r.error, r).replace(/\\n/g, '<br/>');\n\t\t\t\ttmp.classList.remove('x-hidden');\n\t\t\t\ttmp.onanimationend = () => tmp.classList.add('x-hidden');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif ((tmp = this.querySelector('.message.error')) != null)\n\t\t\t{\n\t\t\t\ttmp.innerHTML = this.filterString(r.error, r).replace(/\\n/g, '<br/>') || ('Error: ' + r.response);\n\t\t\t\ttmp.classList.remove('x-hidden');\n\t\t\t\ttmp.onanimationend = () => tmp.classList.add('x-hidden');\n\t\t\t}\n\t\t}\n\t},\n\n\treset: function (nsilent)\n\t{\n\t\tthis.model.reset (nsilent);\n\t\tthis.clearMarkers();\n\n\t\tif (nsilent === false)\n\t\t{\n\t\t\tfor (var i in this.model.data)\n\t\t\t\tthis._setField (i, this.model.data[i], true);\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tsubmit: function ()\n\t{\n\t\tif (this.classList.contains('busy'))\n\t\t\treturn;\n\n\t\tlet data = { };\n\n\t\tif (this.dataset.strict == 'false')\n\t\t\tObject.assign(data, this.model.get());\n\n\t\tlet list = { };\n\t\tthis.querySelectorAll('[data-field]').forEach(e => list[e.dataset.field] = true);\n\t\tObject.keys(list).forEach(f => data[f] = this._getField(f));\n\n\t\tthis.model.set(data);\n\n\t\tlet f = this.dataset.formAction || this.formAction;\n\t\tif (!f) return;\n\n\t\tthis.clearMarkers();\n\n\t\tthis.classList.add('busy');\n\n\t\tif (typeof(f) != 'function')\n\t\t{\n\t\t\tdata.f = f;\n\t\t\tApi.apiCall(data, (r) => this[r.response == 200 ? '_onSuccess' : '_onFailure'](r), (r) => this._onFailure({ error: 'Unable to execute request.' }), this.dataset.method ?? 'POST');\n\t\t}\n\t\telse\n\t\t\tf(data, (r) => this[r.response == 200 ? '_onSuccess' : '_onFailure'](r));\n\t}\n});\n","/*\n**\telems/r-panel\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-panel data-route=\"name\">\n\t</r-panel>\n\n\tr-panel {\n\t\tdisplay: block;\n\t}\n\n\tr-panel:not(.active) {\n\t\tdisplay: none;\n\t}\n\n*/\n\nimport Element from '../element.js';\nimport Router from '../router.js';\n\nexport default Element.register ('r-panel',\n{\n\t/**\n\t**\tRoute object used by this element.\n\t*/\n\troute: null,\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.style.display = '';\n\n\t\t// Executed then the panel route is activated.\n\t\tthis._onActivate = (evt, args) =>\n\t\t{\n\t\t\tif (!args.route.changed)\n\t\t\t\treturn;\n\n\t\t\tthis.show(true);\n\t\t};\n\n\t\t// Executed then the panel route is deactivated.\n\t\tthis._onDeactivate = (evt, args) =>\n\t\t{\n\t\t\tthis.hide();\n\t\t};\n\n\t\tthis.hide();\n\t},\n\n\t/**\n\t**\tAdds a handler to Router if the data-route attribute was set.\n\t*/\n\tonConnected: function()\n\t{\n\t\tif (this.dataset.route)\n\t\t{\n\t\t\tthis.route = Router.addRoute (this.dataset.route, this._onActivate, this._onDeactivate);\n\t\t\tthis.classList.remove('active');\n\t\t}\n\t\telse\n\t\t\tthis.classList.add('active');\n\t},\n\n\t/**\n\t**\tRemoves a handler previously added to Router if the data-route attribute was set.\n\t*/\n\tonDisconnected: function()\n\t{\n\t\tif (this.dataset.route)\n\t\t\tRouter.removeRoute(this.dataset.route, this._onActivate, this._onDeactivate);\n\t},\n\n\t/**\n\t**\tHides the panel by removing the `active` class from the element. Fires `panelHidden` event.\n\t*/\n\thide: function ()\n\t{\n\t\tthis.classList.remove('active');\n\t\tthis.dispatch('panelHidden', this.route ? this.route.args : { });\n\t},\n\n\t/**\n\t**\tShows the panel visible by adding `active` class to the element. If `silent` is true and `data-route` enabled, the current route\n\t**\twill not be updated. Fires `panelShown` event.\n\t*/\n\tshow: function (silent=false)\n\t{\n\t\tif (this.dataset.route && !silent)\n\t\t{\n\t\t\tlet hash = \"#\" + this.dataset.route;\n\n\t\t\tif (window.location.hash.substr(0, hash.length) != hash)\n\t\t\t{\n\t\t\t\twindow.location = hash;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.classList.add('active');\n\t\tthis.dispatch('panelShown', this.route ? this.route.args : { });\n\t}\n});\n","/*\n**\telems/r-list\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-list data-list=\"window.dataList1\" data-container=\".x-data\" data-wrap=\"true|false\">\n\n\t\t<template data-mode=\"static|dynamic\">\n\t\t</template>\n\n\t\t<div class=\"x-empty\">\n\t\t\tNothing to show.\n\t\t</div>\n\n\t\t<div class=\"x-data\">\n\t\t</div>\n\n\t</r-list>\n\n\tCSS:\n\t\t.x-hidden {\n\t\t\tdisplay: none;\n\t\t}\n\n\tModifiers:\n\t\t.x-empty-null\t\tVisible when the list is in undefined state (before first load).\n\t\t.x-empty\t\t\tVisible when there is no data in the list.\n\t\t.x-not-empty \t\tVisible when there is data in the list.\n\t\t.x-loading \t\t\tVisible when the list is loading.\n*/\n\nimport { Rinn, ModelList, Template } from 'rinn';\nimport Element from '../element.js';\n\n/*\n**\tConnects to a ModelList and renders its contents using a template. When using \"dynamic\" template, the contents can be other custom elements, and\n**\tthe model of each item can be accessed by using data-model=\":list-item\", which will cause the item model to be added to the element.\n**\n**\tAdditionally root attribute data-wrap can be set to 'true' to wrap the template contents inside a div with a data-iid representing the ID of the\n**\titem, this will cause any changes to items to affect only the specific item in question.\n*/\n\nexport default Element.register ('r-list',\n{\n\tlist: null,\n\n\tcontainer: null,\n\ttemplate: null,\n\tisEmpty: false,\n\tisDynamicTemplate: false,\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tthis.container = this.querySelector(this.dataset.container || '.x-data');\n\t\tif (!this.container)\n\t\t{\n\t\t\tthis.container = document.createElement('div');\n\t\t\tthis.container.className = 'x-data';\n\t\t\tthis.appendChild(this.container);\n\t\t}\n\n\t\tlet tmp = this.template_elem = this.querySelector('template');\n\t\tif (tmp)\n\t\t{\n\t\t\tif (tmp.dataset.mode != 'dynamic')\n\t\t\t{\n\t\t\t\tthis.template = Template.compile(tmp.innerHTML);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.template = () => tmp.innerHTML;\n\t\t\t\tthis.isDynamicTemplate = true;\n\t\t\t}\n\n\t\t\ttmp.remove();\n\t\t}\n\t\telse\n\t\t\tthis.template = () => '';\n\n\t\tthis.container.textContent = ' ';\n\n\t\tthis.setEmpty(null);\n\t\tthis.setLoading(null);\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet list = this.getFieldByPath(this.dataset.list);\n\t\tif (!list)\n\t\t{\n\t\t\tconsole.error('List not found: ' + this.dataset.list);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setList (list);\n\t},\n\n\t/*\n\t**\tIndicates if the list is empty. Elements having x-empty, x-not-empty and x-empty-null will be updated.\n\t*/\n\tsetEmpty: function (value)\n\t{\n\t\tif (this.isEmpty === value)\n\t\t\treturn;\n\n\t\tif (value === true)\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-empty-null').forEach(i => i.classList.add('x-hidden'));\n\t\t}\n\t\telse if (value === false)\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-empty-null').forEach(i => i.classList.add('x-hidden'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-empty-null').forEach(i => i.classList.remove('x-hidden'));\n\t\t}\n\n\t\tthis.isEmpty = value;\n\t},\n\n\t/*\n\t**\tIndicates if the list is loading. Elements having x-loading will be updated.\n\t*/\n\tsetLoading: function (value)\n\t{\n\t\tif (value === true)\n\t\t\tthis.querySelectorAll('.x-loading').forEach(i => i.classList.remove('x-hidden'));\n\t\telse\n\t\t\tthis.querySelectorAll('.x-loading').forEach(i => i.classList.add('x-hidden'));\n\t},\n\n\t/**\n\t**\tSets the list model-list of the element.\n\t*/\n\tsetList: function (list)\n\t{\n\t\tif (!list || !Rinn.isInstanceOf(list, ModelList) || this.list === list)\n\t\t\treturn;\n\n\t\tif (this.list != null)\n\t\t{\n\t\t\tif (this.list.dataSource)\n\t\t\t\tthis.list.dataSource.removeEventListener (this.eid+':*');\n\n\t\t\tif (this.list.dataList)\n\t\t\t\tthis.list.dataList.removeEventListener (this.eid+':*');\n\n\t\t\tthis.list.removeEventListener (this.eid+':*');\n\t\t}\n\n\t\tthis.list = list;\n\n\t\tif (this.list.dataSource)\n\t\t{\n\t\t\tthis.list.dataSource.addEventListener (this.eid+':listLoading', this.onLoading, this);\n\t\t\tthis.list.dataSource.addEventListener (this.eid+':listLoaded', this.onLoaded, this);\n\t\t}\n\n\t\tif (this.list.dataList)\n\t\t{\n\t\t\tthis.list.dataList.addEventListener (this.eid+':listLoading', this.onLoading, this);\n\t\t\tthis.list.dataList.addEventListener (this.eid+':listLoaded', this.onLoaded, this);\n\t\t}\n\n\t\tthis.list.addEventListener (this.eid+':itemsCleared', this.onItemsCleared, this);\n\t\tthis.list.addEventListener (this.eid+':itemsChanged', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemRemoved', this.onItemRemoved, this);\n\t\tthis.list.addEventListener (this.eid+':itemChanged', this.onItemChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemAdded', this.onItemAdded, this);\n\t},\n\n\t/*\n\t**\tBuilds an item (inside a div) to be added to the container.\n\t*/\n\tbuildItem: function (iid, data, asHtml=false)\n\t{\n\t\tlet html = this.template(data.get());\n\t\tif (asHtml) return html;\n\n\t\tlet elem = document.createElement('div');\n\t\t\n\t\telem.dataset.iid = iid;\n\t\telem.innerHTML = html;\n\n\t\telem.querySelectorAll('[data-model=\":list-item\"]').forEach(i => {\n\t\t\ti.model = data;\n\t\t\ti.dataset.model = \"this.model\";\n\t\t});\n\n\t\tfor (let attr of this.template_elem.attributes)\n\t\t{\n\t\t\tif (attr.nodeName.startsWith('data-_') || attr.nodeName == 'data-mode')\n\t\t\t\tcontinue;\n\n\t\t\telem.setAttribute(attr.nodeName, attr.nodeValue);\n\t\t}\n\n\t\treturn elem;\n\t},\n\n\t/*\n\t**\tExecuted when the list is loading.\n\t*/\n\tonLoading: function()\n\t{\n\t\tthis.setLoading(true);\n\t},\n\n\t/*\n\t**\tExecuted when the list finished loading.\n\t*/\n\tonLoaded: function()\n\t{\n\t\tthis.setLoading(false);\n\t},\n\n\t/*\n\t**\tExecuted when the list is cleared.\n\t*/\n\tonItemsCleared: function()\n\t{\n\t\tthis.container._timeout = setTimeout(() => {\n\t\t\tthis.setEmpty(true);\n\t\t\tthis.container._timeout = null;\n\t\t\tthis.container.textContent = '';\n\t\t}, 300);\n\t},\n\n\t/*\n\t**\tExecuted when the items of the list changed.\n\t*/\n\tonItemsChanged: function()\n\t{\n\t\tif (this.list.length() == 0)\n\t\t\treturn;\n\n\t\tif (this.container._timeout)\n\t\t\tclearTimeout(this.container._timeout);\n\n\t\tthis.container._timeout = null;\n\t\tthis.container.textContent = '';\n\n\t\tlet i = 0;\n\n\t\tfor (let data of this.list.getData())\n\t\t{\n\t\t\tif (this.dataset.wrap != 'false')\n\t\t\t\tthis.container.append(this.buildItem(this.list.itemId[i++], data));\n\t\t\telse\n\t\t\t\tthis.container.innerHTML += this.buildItem(this.list.itemId[i++], data, true);\n\t\t}\n\n\t\tthis.setEmpty(i == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item is removed from the list.\n\t*/\n\tonItemRemoved: function(evt, args)\n\t{\n\t\tif (this.dataset.wrap == 'false')\n\t\t{\n\t\t\tthis.onItemsChanged();\n\t\t\treturn;\n\t\t}\n\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\telem.remove();\n\t\tthis.setEmpty(this.list.length() == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item changes.\n\t*/\n\tonItemChanged: function(evt, args)\n\t{\n\t\tif (this.isDynamicTemplate) return;\n\n\t\tif (this.dataset.wrap == 'false')\n\t\t{\n\t\t\tthis.onItemsChanged();\n\t\t\treturn;\n\t\t}\n\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\telem.innerHTML = this.template(args.item);\n\t},\n\n\t/*\n\t**\tExecuted when an item is added to the list.\n\t*/\n\tonItemAdded: function(evt, args)\n\t{\n\t\tif (args.position == 'head')\n\t\t{\n\t\t\tif (this.dataset.wrap != 'false')\n\t\t\t\tthis.container.prepend(this.buildItem(args.id, args.item));\n\t\t\telse\n\t\t\t\tthis.container.innerHTML = this.buildItem(args.id, args.item, true) + this.container.innerHTML;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.dataset.wrap != 'false')\n\t\t\t\tthis.container.append(this.buildItem(args.id, args.item));\n\t\t\telse\n\t\t\t\tthis.container.innerHTML += this.buildItem(args.id, args.item, true);\n\t\t}\n\n\t\tthis.setEmpty(false);\n\t},\n\n\t/**\n\t * \tForces re-rendering of the element.\n\t */\n\trefresh: function()\n\t{\n\t\tthis.onItemsChanged();\n\t}\n});\n","/*\n**\telems/r-item\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-item data-model=\"window.model1\">\n\t</r-item>\n*/\n\nimport Element from '../element.js';\n\nexport default Element.register ('r-item',\n{\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t},\n\n\t/**\n\t**\tExecuted when the children and root are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet model = this.getFieldByPath(this.dataset.model);\n\t\tif (!model) model = { };\n\n\t\tthis.setModel (model);\n\t}\n});\n","/*\n**\telems/r-paginator\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-paginator data-source=\"window.dataSource1\" data-page-size=\"25\">\n\t\t<span data-watch=\"count\">Showing [offsetStart] to [offsetEnd] out of [count]</span>\n\n\t\t<button data-action=\"firstPage\">First</button>\n\t\t<button data-action=\"prevPage\">&laquo;</button>\n\t\t<button data-action=\"nextPage\">&raquo;</button>\n\t\t<button data-action=\"lastPage\">Last</button>\n\t\t<button data-action=\"refresh\">Refresh</button>\n\n\t\t<input type=\"text\" data-property=\"pageSize\" />\n\t</r-paginator>\n*/\n\nimport { Rinn } from 'rinn';\nimport Element from '../element.js';\nimport DataSource from '../data-source.js';\n\n/*\n**\tConnects to a data source to provide pagination features.\n*/\n\nexport default Element.register ('r-paginator',\n{\n\tsource: null,\n\ttemplate: null,\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.setModel({\n\t\t\toffsetStart: 0,\n\t\t\toffsetEnd: 0,\n\t\t\tcount: 0, offset: 0,\n\t\t\tcurrentPageSize: this.dataset.pageSize || 25,\n\t\t\tpageSize: this.dataset.pageSize || 25\n\t\t});\n\n\t\tthis.listen('propertyChanged.pageSize', (evt, args) =>\n\t\t{\n\t\t\tif (this.model.get('currentPageSize') == args.value)\n\t\t\t\treturn;\n\n\t\t\tthis.model.set('currentPageSize', args.value);\n\t\t\tthis.updateOffset('range');\n\t\t});\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet source = this.getFieldByPath(this.dataset.source);\n\t\tif (!source)\n\t\t{\n\t\t\tconsole.error('data-source not found: ' + this.dataset.source);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setSource(source);\n\t},\n\n\t/**\n\t**\tSets the source model-list of the paginator.\n\t*/\n\tsetSource: function (source)\n\t{\n\t\tif (!source || !Rinn.isInstanceOf(source, DataSource) || this.source === source)\n\t\t\treturn;\n\n\t\tif (this.source != null)\n\t\t{\n\t\t\tthis.source.removeEventListener (this.eid+':*');\n\t\t\tthis.source.includeCount = false;\n\t\t}\n\n\t\tthis.source = source;\n\n\t\tthis.source.includeCount = true;\n\t\tthis.updateOffset();\n\n\t\tthis.source.addEventListener (this.eid+':requestPropertyChanged', this.onRequestPropertyChanged, this);\n\t\tthis.source.addEventListener (this.eid+':countChanged', this.onCountChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemRemoved', this.onItemRemoved, this);\n\t\tthis.source.addEventListener (this.eid+':listItemAdded', this.onItemAdded, this);\n\n\t\tthis.source.setNamespace(this.eid);\n\t\tthis.source.request.update(true);\n\t\tthis.source.setNamespace(null);\n\t},\n\n\t/*\n\t**\tUpdates several offset related fields in the paginator model. Optionally refreshes the data source with the specified mode.\n\t*/\n\tupdateOffset: function(mode=null)\n\t{\n\t\tthis.model.set('offsetStart', this.model.get('count') != 0 ? this.model.get('offset') + 1 : 0);\n\t\tthis.model.set('offsetEnd', Math.min(this.model.get('count'), this.model.get('offsetStart') + this.model.getInt('pageSize') - 1));\n\t\tthis.model.update('count');\n\n\t\tlet _count = this.source.request.get('count');\n\t\tlet _offset = this.source.request.get('offset');\n\n\t\tthis.source.request.set('count', this.model.getInt('pageSize'));\n\t\tthis.source.request.set('offset', this.model.get('offset'));\n\n\t\tif (mode && (_count != this.source.request.get('count') || _offset != this.source.request.get('offset')))\n\t\t\tthis.source.refresh(mode);\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the source request changes. The property is copied to the local model.\n\t*/\n\tonRequestPropertyChanged: function(evt, args)\n\t{\n\t\tif (args.name == 'count' || args.name == 'offset')\n\t\t\treturn;\n\n\t\tthis.model.set(args.name, args.value);\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the model has changed. The property is copied to the data source request model.\n\t*/\n\tonModelPropertyChanged: function (evt, args)\n\t{\n\t\tlet ignored = [\n\t\t\t'offsetStart',\n\t\t\t'offsetEnd',\n\t\t\t'count',\n\t\t\t'offset',\n\t\t\t'currentPageSize',\n\t\t\t'pageSize'\n\t\t];\n\n\t\tif (ignored.indexOf(args.name) != -1)\n\t\t\treturn;\n\n\t\tif (this.source.request.get(args.name) == args.value)\n\t\t\treturn;\n\n\t\tthis.source.request.set(args.name, args.value);\n\t\tthis.source.refresh('filter');\n\t},\n\n\t/*\n\t**\tExecuted when the remote count changes.\n\t*/\n\tonCountChanged: function(evt, args)\n\t{\n\t\tthis.model.set('count', evt.source.count, false);\n\t\tthis.updateOffset();\n\t},\n\n\t/*\n\t**\tExecuted when an item is removed from the list.\n\t*/\n\tonItemRemoved: function(evt, args)\n\t{\n\t\tthis.model.set('count', this.model.getInt('count') - 1, false);\n\t\tthis.updateOffset();\n\t},\n\n\t/*\n\t**\tExecuted when an item is added to the list.\n\t*/\n\tonItemAdded: function(evt, args)\n\t{\n\t\tthis.model.set('count', this.model.getInt('count') + 1, false);\n\t\tthis.updateOffset();\n\t},\n\n\t/*\n\t**\tMoves to the previous page.\n\t*/\n\tprevPage: function()\n\t{\n\t\tif (this.model.get('offset') <= 0)\n\t\t\treturn;\n\n\t\tlet offs = this.model.get('offset') - this.model.getInt('pageSize');\n\t\tif (offs < 0) offs = 0;\n\n\t\tthis.model.set('offset', offs);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tMoves to the next page.\n\t*/\n\tnextPage: function()\n\t{\n\t\tlet offs = this.model.get('offset') + this.model.getInt('pageSize');\n\t\tif (offs >= this.model.get('count')) return;\n\n\t\tthis.model.set('offset', offs);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tMoves to the first page.\n\t*/\n\tfirstPage: function()\n\t{\n\t\tthis.model.set('offset', 0);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tMoves to the last page.\n\t*/\n\tlastPage: function()\n\t{\n\t\tlet offs = this.model.get('count') - this.model.getInt('pageSize');\n\t\tif (offs < 0) offs = 0;\n\n\t\tthis.model.set('offset', offs);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tRefreshes the data source.\n\t*/\n\trefresh: function()\n\t{\n\t\tthis.source.refresh('full');\n\t},\n\n\t/*\n\t**\tClears (set to empty) the specified fields from the data source's request parameters.\n\t*/\n\tclear: function(args)\n\t{\n\t\tfor (let i = 0; i < args.length; i++)\n\t\t\tthis.model.set(args[i], '');\n\t}\n});\n","/*\n**\telems/r-table\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-table data-source=\"window.dataSource1\">\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>A</th>\n\t\t\t\t\t<th>B</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\n\t\t\t<tbody class=\"x-data\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td>[a]</td>\n\t\t\t\t\t<td>[b]</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</r-table>\n\n\tCSS:\n\t\t.x-hidden {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\tth[data-sort] {\n\t\t\tcursor: pointer; text-decoration: underline;\n\t\t}\n\n\t\tth[data-sort][data-order=\"asc\"]:before {\n\t\t\tcontent: \"\\25B2\";\n\t\t}\n\n\t\tth[data-sort][data-order=\"desc\"]:before {\n\t\t\tcontent: \"\\25BC\";\n\t\t}\n\n\tModifiers:\n\t\t.x-empty\t\t\tAdd to elements that should be shown only when there is no data in the data source.\n\t\t.x-not-empty \t\tAdd to elements that should be shown only when there is data in the data source.\n\t\t[data-sort]\t\t\tAdded to th/td elements in thead, marks the column as sortable.\n*/\n\nimport { Rinn, Template } from 'rinn';\nimport Element from '../element.js';\nimport DataSource from '../data-source.js';\n\n/*\n**\tConnects to a DataSource and renders its contents as a table.\n*/\n\nexport default Element.register ('r-table',\n{\n\tsource: null,\n\ttemplate: null,\n\tcontainer: null,\n\tisEmpty: null,\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.setModel({ });\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tthis.container = this.querySelector(this.dataset.container || 'tbody.x-data');\n\t\tif (!this.container) throw new Error ('r-table requires a container');\n\n\t\tif (this.container.dataset.mode != 'dynamic')\n\t\t\tthis.template = Template.compile(this.container.innerHTML);\n\t\telse\n\t\t\tthis.template = () => this.container.innerHTML;\n\n\t\tthis.temporalBody = document.createElement('tbody');\n\t\tthis.container.textContent = ' ';\n\n\t\tthis.setEmpty(true);\n\t},\n\n\t/**\n\t**\tExecuted when the children and root elements are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet source = this.getFieldByPath(this.dataset.source);\n\t\tif (!source)\n\t\t{\n\t\t\tconsole.error('data-source not found: ' + this.dataset.source);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setSource (source);\n\t},\n\n\t/*\n\t**\tIndicates if the table is empty. Elements having .x-not-empty will be hidden.\n\t*/\n\tsetEmpty: function (value)\n\t{\n\t\tif (this.isEmpty === value)\n\t\t\treturn;\n\n\t\tif (value)\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t}\n\n\t\tthis.isEmpty = value;\n\t},\n\n\t/**\n\t**\tSets the data source of the element.\n\t*/\n\tsetSource: function (source)\n\t{\n\t\tif (!source || !Rinn.isInstanceOf(source, DataSource) || this.source === source)\n\t\t\treturn;\n\n\t\tif (this.source != null)\n\t\t\tthis.source.removeEventListener (this.eid+':*');\n\n\t\tthis.source = source;\n\n\t\tthis.source.addEventListener (this.eid+':requestPropertyChanged', this.onRequestPropertyChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemsCleared', this.onItemsCleared, this);\n\t\tthis.source.addEventListener (this.eid+':listItemsChanged', this.onItemsChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemRemoved', this.onItemRemoved, this);\n\t\tthis.source.addEventListener (this.eid+':listItemChanged', this.onItemChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemAdded', this.onItemAdded, this);\n\n\t\tthis.source.setNamespace(this.eid);\n\t\tthis.source.request.update(true);\n\t\tthis.source.setNamespace(null);\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the source request changes. The property is copied to the local model.\n\t*/\n\tonRequestPropertyChanged: function(evt, args)\n\t{\n\t\tthis.model.set(args.name, args.value);\n\n\t\tif (args.name == 'sort')\n\t\t{\n\t\t\tthis.querySelectorAll('thead [data-sort]').forEach(i => i.dataset.order = '');\n\t\t}\n\t\telse if (args.name == 'order')\n\t\t{\n\t\t\tlet elem = this.querySelector('thead [data-sort=\"'+evt.source.get('sort')+'\"]');\n\t\t\tif (elem) elem.dataset.order = args.value;\n\t\t}\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the model has changed. The property is copied to the data source request model.\n\t*/\n\tonModelPropertyChanged: function (evt, args)\n\t{\n\t\tif (this.source.request.get(args.name) == args.value)\n\t\t\treturn;\n\n\t\tthis.source.request.set(args.name, args.value);\n\n\t\tlet ignored = [\n\t\t\t'count',\n\t\t\t'offset'\n\t\t];\n\n\t\tif (ignored.indexOf(args.name) != -1)\n\t\t\treturn;\n\n\t\tthis.source.refresh('filter');\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the model is removed.\n\t*/\n\tonModelPropertyRemoved: function (evt, args)\n\t{\n\t\tif (typeof(args.fields) == 'string')\n\t\t\tthis.source.request.remove(i);\n\t\telse\n\t\t\targs.fields.forEach(i => this.source.request.remove(i));\n\n\t\tthis.source.refresh('filter');\n\t},\n\n\t/*\n\t**\tBuilds an item to be added to the container.\n\t*/\n\tbuildItem: function (iid, data)\n\t{\n\t\tlet elem = this.temporalBody;\n\n\t\telem.innerHTML = this.template(data.get());\n\n\t\telem.querySelectorAll('[data-model=\":list-item\"]').forEach(i => {\n\t\t\ti.model = data;\n\t\t\ti.dataset.model = \"this.model\";\n\t\t});\n\n\t\telem = elem.firstElementChild;\n\t\telem.dataset.iid = iid;\n\n\t\treturn elem;\n\t},\n\n\t/*\n\t**\tExecuted when the list is cleared.\n\t*/\n\tonItemsCleared: function(evt, args)\n\t{\n\t\tthis.container._timeout = setTimeout(() => {\n\t\t\tthis.setEmpty(true);\n\t\t\tthis.container._timeout = null;\n\t\t\tthis.container.textContent = '';\n\t\t}, 300);\n\t},\n\n\t/*\n\t**\tExecuted when the items of the list changed.\n\t*/\n\tonItemsChanged: function(evt, args)\n\t{\n\t\tif (this.source.list.length() == 0)\n\t\t\treturn;\n\n\t\tif (this.container._timeout)\n\t\t\tclearTimeout(this.container._timeout);\n\n\t\tthis.container._timeout = null;\n\t\tthis.container.textContent = '';\n\n\t\tlet i = 0;\n\n\t\tfor (let data of this.source.list.getData())\n\t\t\tthis.container.append(this.buildItem(this.source.list.itemId[i++], data));\n\n\t\tthis.setEmpty(i == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item is removed from the list.\n\t*/\n\tonItemRemoved: function(evt, args)\n\t{\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\telem.remove();\n\t\tthis.setEmpty(this.source.list.length() == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item changes.\n\t*/\n\tonItemChanged: function(evt, args)\n\t{\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\tlet _elem = this.buildItem(args.id, args.item);\n\t\tthis.container.replaceChild(_elem, elem);\n\t},\n\n\t/*\n\t**\tExecuted when an item is added to the list.\n\t*/\n\tonItemAdded: function(evt, args)\n\t{\n\t\tif (args.position == 'head')\n\t\t\tthis.container.prepend(this.buildItem(args.id, args.item));\n\t\telse\n\t\t\tthis.container.append(this.buildItem(args.id, args.item));\n\n\t\tthis.setEmpty(false);\n\t},\n\n\t/*\n\t**\tHandles clicks to data-sort elements.\n\t*/\n\t\"event click thead [data-sort]\": function(evt, args)\n\t{\n\t\tif (this.source.request.get('sort') == evt.source.dataset.sort)\n\t\t{\n\t\t\tthis.source.request.set('order', this.source.request.get('order') == 'asc' ? 'desc' : 'asc');\n\t\t\tthis.source.refresh('order');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.source.request.set('sort', evt.source.dataset.sort);\n\t\t\tthis.source.request.set('order', 'asc', true);\n\t\t\tthis.source.refresh('order');\n\t\t}\n\t},\n\n\t/*\n\t**\tRefreshes the data source.\n\t*/\n\trefresh: function()\n\t{\n\t\tthis.source.refresh('full');\n\t},\n\n\t/*\n\t**\tClears (set to empty) the specified fields from the data source's request parameters.\n\t*/\n\tclear: function(args)\n\t{\n\t\tfor (let i = 0; i < args.length; i++)\n\t\t\tthis.model.set(args[i], '');\n\t}\n});\n","/*\n**\telems/r-select\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-select data-list=\"window.dataList1\" data-blank=\"\"></r-select>\n*/\n\nimport { Rinn, ModelList } from 'rinn';\nimport Element from '../element.js';\n\n/*\n**\tConnects to a ModelList and renders its contents as a <select> element.\n*/\n\nexport default Element.register ('r-select',\n{\n\tlist: null,\n\tcontainer: null,\n\n\tvalue: '',\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.container = document.createElement('select');\n\t\tthis.parentElement.insertBefore(this.container, this);\n\n\t\tlet list = [];\n\n\t\tfor (let attr of this.attributes)\n\t\t{\n\t\t\tif (attr.nodeName.startsWith('data-_') || attr.nodeName == 'data-list' || attr.nodeName == 'data-blank')\n\t\t\t\tcontinue;\n\n\t\t\tthis.container.setAttribute(attr.nodeName, attr.nodeValue);\n\t\t\tlist.push(attr.nodeName);\n\t\t}\n\n\t\tlist.forEach(i => this.removeAttribute(i));\n\n\t\tthis.textContent = ' ';\n\t\tthis.style.display = 'none';\n\t},\n\n\t/**\n\t**\tExecuted when the children and parent of the element are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet list = this.getFieldByPath(this.dataset.list);\n\t\tif (!list)\n\t\t{\n\t\t\tconsole.error('List not found: ' + this.dataset.list);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setList(list);\n\n\t\tif (this.parentElement.lastElementChild !== this)\n\t\t\tthis.parentElement.append(this);\n\t},\n\n\t/**\n\t**\tSets the list model-list of the element.\n\t*/\n\tsetList: function (list)\n\t{\n\t\tif (!list || !Rinn.isInstanceOf(list, ModelList) || this.list === list)\n\t\t\treturn;\n\n\t\tif (this.list != null)\n\t\t\tthis.list.removeEventListener (this.eid+':*');\n\n\t\tthis.list = list;\n\n\t\tif (this.list.dataSource)\n\t\t\tthis.list.dataSource.includeEnum = true;\n\n\t\tthis.list.addEventListener (this.eid+':itemsCleared', this.onItemsCleared, this);\n\t\tthis.list.addEventListener (this.eid+':itemsChanged', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemRemoved', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemChanged', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemAdded', this.onItemsChanged, this);\n\n\t\tthis.onItemsChanged();\n\t},\n\n\t/*\n\t**\tExecuted when the list is cleared.\n\t*/\n\tonItemsCleared: function(evt, args)\n\t{\n\t\tthis.container.textContent = '';\n\t},\n\n\t/*\n\t**\tExecuted when the items of the list changed.\n\t*/\n\tonItemsChanged: function(evt, args)\n\t{\n\t\tif (this.list.length() == 0)\n\t\t\treturn;\n\n\t\tlet list = this.list.getData();\n\t\tlet value, label, s = '';\n\n\t\tif (list[0].has('value')) value = 'value';\n\t\telse if (list[0].has('id')) value = 'id';\n\n\t\tif (list[0].has('label')) label = 'label';\n\t\telse if (list[0].has('name')) label = 'name';\n\n\t\tif ('blank' in this.dataset)\n\t\t\ts += '<option value=\"\">'+this.dataset.blank+'</option>';\n\n\t\tif (list[0].has('group'))\n\t\t{\n\t\t\tlet groups = { };\n\t\t\tlist.forEach(i => groups[i.get('group')] = null);\n\n\t\t\tfor (let i in groups)\n\t\t\t\tgroups[i] = { name: i, list: [] };\n\n\t\t\tlist.forEach(i => groups[i.get('group')].list.push(i));\n\n\t\t\tgroups = Object.values(groups);\n\t\t\tgroups.forEach(g => {\n\t\t\t\ts += '<optgroup label=\"'+g.name+'\">';\n\t\t\t\tg.list.forEach(i => s += '<option value=\"'+i.get(value)+'\">'+i.get(label)+'</option>');\n\t\t\t\ts += '</optgroup>';\n\t\t\t});\n\t\t}\n\t\telse\n\t\t\tlist.forEach(i => s += '<option value=\"'+i.get(value)+'\">'+i.get(label)+'</option>');\n\n\t\tthis.container.innerHTML = s;\n\t\tthis.container.value = this.container.dataset.value;\n\t},\n\n\t/**\n\t * \tForces re-rendering of the element.\n\t */\n\trefresh: function()\n\t{\n\t\tthis.onItemsChanged();\n\t}\n});\n","\nconst Utils =\n{\n\t/**\n\t**\tForces the browser to show a download dialog.\n\t*/\n\tshowDownload: function (filename, dataUrl)\n\t{\n\t\tvar link = document.createElement(\"a\");\n\t\tlink.href = dataUrl;\n\n\t\tlink.style.display = 'none';\n\t\tlink.download = filename;\n\t\tlink.target = \"_blank\";\n\n\t\tdocument.body.appendChild(link);\n\t\tlink.click();\n\t\tdocument.body.removeChild(link);\n\t},\n\n\t/**\n\t**\tForces the browser to show a file selection dialog.\n\t*/\n\tshowFilePicker: function (allowMultiple, accept, callback)\n\t{\n\t\tvar input = document.createElement(\"input\");\n\n\t\tinput.type = \"file\";\n\t\tinput.accept = accept;\n\t\tinput.style.display = 'none';\n\t\tinput.multiple = allowMultiple;\n\n\t\tdocument.body.appendChild(input);\n\n\t\tinput.onchange = function () {\n\t\t\tcallback(input.files);\n\t\t};\n\n\t\tdocument.body.onfocus = function ()\n\t\t{\n\t\t\tdocument.body.onfocus = null;\n\t\t\tdocument.body.removeChild(input);\n\t\t};\n\n\t\tinput.click();\n\t},\n\n\t/**\n\t**\tLoads a URL using FileReader and returns as a dataURL.\n\t*/\n\tloadAsDataUrl: function (file, callback)\n\t{\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function(e) {\n\t\t\tcallback (e.target.result, null);\n\t\t};\n\n\t\treader.onerror = function(e) {\n\t\t\tcallback (null, e);\n\t\t};\n\n\t\treader.readAsDataURL(file);\n\t},\n\n\t/**\n\t**\tLoads a URL using FileReader and returns as text.\n\t*/\n\tloadAsText: function (file, callback)\n\t{\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function(e) {\n\t\t\tcallback (e.target.result);\n\t\t};\n\n\t\treader.readAsText(file);\n\t},\n\n\t/**\n\t**\tLoads a URL using FileReader and returns as an array buffer.\n\t*/\n\tloadAsArrayBuffer: function (file, callback)\n\t{\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function(e) {\n\t\t\tcallback (e.target.result);\n\t\t};\n\n\t\treader.readAsArrayBuffer(file);\n\t},\n\n\t/**\n\t**\tLoads an array of URLs using FileReader and returns them as data url.\n\t*/\n\tloadAllAsDataUrl: function (fileList, callback)\n\t{\n\t\tvar result = [];\n\n\t\tif (!fileList || !fileList.length)\n\t\t{\n\t\t\tcallback(result);\n\t\t\treturn;\n\t\t}\n\n\t\tvar loadNext = function (i)\n\t\t{\n\t\t\tif (i == fileList.length)\n\t\t\t{\n\t\t\t\tcallback(result);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tUtils.loadAsDataUrl (fileList[i], function(url, err) {\n\t\t\t\tif (!err) {\n\t\t\t\t\tresult.push({ name: fileList[i].name, size: fileList[i].size, url: url });\n\t\t\t\t}\n\t\t\t\tloadNext(i+1);\n\t\t\t});\n\t\t};\n\n\t\tloadNext(0);\n\t},\n\n\t/*\n\t**\tLoads a URL as an image.\n\t*/\n\tloadImageFromUrl: function (url, callback)\n\t{\n\t\tlet image = new Image();\n\t\timage.onload = () => callback(image);\n\t\timage.onerror = () => callback(null);\n\t\timage.src = url;\n\t}\n};\n\nexport default Utils;\n","/*\n**\telems/r-image-cropper\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-image-cropper>\n\t</r-image-cropper>\n*/\n\nimport Element from '../element.js';\nimport Utils from '../utils.js';\n\nexport default Element.register ('r-image-cropper',\n{\n\t/*\n\t**\tDefault aspect ratio.\n\t*/\n\taspectRatio: 1,\n\n\t/*\n\t**\tCurrent image scale.\n\t*/\n\timageScale0: 0, imageScale: 1,\n\n\t/*\n\t**\tImage translation offsets.\n\t*/\n\timageOffsX: 0, imageOffsY: 0,\n\n\t/*\n\t**\tPointer contexts.\n\t*/\n\tpointerA: null, pointerB: null,\n\n\t/*\n\t**\tClient bounding box.\n\t*/\n\tbounds: null,\n\n\t/*\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.canvas = document.createElement('canvas');\n\t\tthis.appendChild(this.canvas);\n\n\t\tthis.g = this.canvas.getContext('2d');\n\n\t\tthis.pointerA = { id: null, active: false, sx: 0, sy: 0, cx: 0, cy: 0, ix: 0, iy: 0 };\n\t\tthis.pointerB = { id: null, active: false, sx: 0, sy: 0, cx: 0, cy: 0, ix: 0, iy: 0 };\n\n\t\tthis.log = document.createElement('div');\n\t\tthis.appendChild(this.log);\n\t},\n\n\t/*\n\t**\tSets the image for the cropper from an image URL.\n\t*/\n\tsetImageUrl: function(url)\n\t{\n\t\tUtils.loadImageFromUrl(url, (image) => {\n\t\t\tthis.setImage(image);\n\t\t});\n\t},\n\n\t/*\n\t**\tSets the image for the cropper from an HTML File object.\n\t*/\n\tsetImageFile: function(file)\n\t{\n\t\tUtils.loadAsDataUrl(file, (url) => {\n\t\t\tUtils.loadImageFromUrl(url, (image) => {\n\t\t\t\tthis.setImage(image);\n\t\t\t});\n\t\t});\n\t},\n\n\t/*\n\t**\tSets the cropper image from an HTML Image element.\n\t*/\n\tsetImage: function(image)\n\t{\n\t\tthis.image = image;\n\n\t\tthis.reset();\n\n\t\tthis.imageScale = Math.max(this.canvas.width / this.image.width, this.canvas.height / this.image.height);\n\n\t\tthis.imageOffsX = (this.canvas.width - this.imageScale*this.image.width)*0.5;\n\t\tthis.imageOffsY = (this.canvas.height - this.imageScale*this.image.height)*0.5;\n\n\t\tthis.render();\n\t},\n\n\t/*\n\t**\tReturns the blob and URL representing the current canvas state.\n\t*/\n\tgetBlobAndUrl: function(callback, type='image/png', quality=0.9)\n\t{\n\t\tthis.canvas.toBlob((blob) => {\n\t\t\tcallback(blob, URL.createObjectURL(blob));\n\t\t},\n\t\ttype, quality);\n\t},\n\n\t/*\n\t**\tAuto-resizes the canvas to ensure the aspect ratio is maintained.\n\t*/\n\treset: function()\n\t{\n\t\tthis.bounds = this.getBoundingClientRect();\n\n\t\tthis.canvas.width = this.bounds.width;\n\t\tthis.canvas.height = this.bounds.width/this.aspectRatio;\n\t},\n\n\t/*\n\t**\tAuto-resizes the canvas to ensure the aspect ratio is maintained and renders the image.\n\t*/\n\trender: function()\n\t{\n\t\tthis.canvas.width = this.canvas.width;\n\n\t\tthis.g.fillStyle = '#000';\n\t\tthis.g.beginPath();\n\t\tthis.g.rect(0, 0, this.canvas.width, this.canvas.height);\n\t\tthis.g.fill();\n\n\t\tthis.g.translate(this.imageOffsX, this.imageOffsY);\n\t\tthis.g.scale(this.imageScale, this.imageScale);\n\t\tthis.g.drawImage(this.image, 0, 0);\n\t},\n\n\t/*\n\t**\tTranslates the image by the given offsets.\n\t*/\n\ttranslateImage: function(offsX, offsY)\n\t{\n\t\tthis.imageOffsX += offsX;\n\t\tthis.imageOffsY += offsY;\n\n\t\tthis.render(true);\n\t},\n\n\t/*\n\t**\tHandle mouse events on the canvas.\n\t*/\n\t\"event mousemove canvas\": function(evt)\n\t{\n\t\tif (this.pointerA.active)\n\t\t{\n\t\t\tthis.pointerA.cx = evt.clientX;\n\t\t\tthis.pointerA.cy = evt.clientY;\n\n\t\t\tthis.translateImage(this.pointerA.cx - this.pointerA.sx, this.pointerA.cy - this.pointerA.sy);\n\n\t\t\tthis.pointerA.sx = this.pointerA.cx;\n\t\t\tthis.pointerA.sy = this.pointerA.cy;\n\t\t}\n\n\t\tthis.pointerA.ix = ((evt.clientX-this.bounds.left) - this.imageOffsX) / this.imageScale;\n\t\tthis.pointerA.iy = ((evt.clientY-this.bounds.top) - this.imageOffsY) / this.imageScale;\n\t},\n\n\t\"event mousedown canvas\": function(evt)\n\t{\n\t\tthis.pointerA.active = true;\n\t\tthis.pointerA.sx = evt.clientX;\n\t\tthis.pointerA.sy = evt.clientY;\n\t},\n\n\t\"event mouseup canvas\": function(evt)\n\t{\n\t\tthis.pointerA.active = false;\n\t},\n\n\t\"event wheel canvas\": function(evt)\n\t{\n\t\tif (evt.deltaY > 0)\n\t\t\tthis.imageScale -= 0.045;\n\t\telse\n\t\t\tthis.imageScale += 0.045;\n\n\t\tif (this.imageScale < 0.1) this.imageScale = 0.1;\n\n\t\tthis.imageOffsX += -this.pointerA.ix*this.imageScale + (evt.clientX-this.bounds.left) - this.imageOffsX;\n\t\tthis.imageOffsY += -this.pointerA.iy*this.imageScale + (evt.clientY-this.bounds.top) - this.imageOffsY;\n\n\t\tthis.render();\n\t},\n\n\t/*\n\t**\tHandle touch events on the canvas.\n\t*/\n\t\"event touchmove canvas\": function(evt)\n\t{\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerA.cx = i.clientX;\n\t\t\t\tthis.pointerA.cy = i.clientY;\n\t\t\t}\n\t\t\telse if (this.pointerB.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerB.cx = i.clientX;\n\t\t\t\tthis.pointerB.cy = i.clientY;\n\t\t\t}\n\t\t}\n\n\t\tif (this.pointerA.active && this.pointerB.active)\n\t\t{\n\t\t\tlet d0 = Math.sqrt(Math.pow(this.pointerA.sx-this.pointerB.sx, 2) + Math.pow(this.pointerA.sy-this.pointerB.sy, 2));\n\t\t\tlet d1 = Math.sqrt(Math.pow(this.pointerA.cx-this.pointerB.cx, 2) + Math.pow(this.pointerA.cy-this.pointerB.cy, 2));\n\n\t\t\tlet d = d1 - d0;\n\t\t\tthis.imageScale += (d/10)*0.025;\n\t\t\tif (this.imageScale < 0.1) this.imageScale = 0.1;\n\n\t\t\tthis.imageOffsX += -this.pointerA.ix*this.imageScale + (this.pointerA.cx-this.bounds.left) - this.imageOffsX;\n\t\t\tthis.imageOffsY += -this.pointerA.iy*this.imageScale + (this.pointerA.cy-this.bounds.top) - this.imageOffsY;\n\n\t\t\tthis.pointerA.sx = this.pointerA.cx;\n\t\t\tthis.pointerA.sy = this.pointerA.cy;\n\n\t\t\tthis.pointerB.sx = this.pointerB.cx;\n\t\t\tthis.pointerB.sy = this.pointerB.cy;\n\n\t\t\tthis.render();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet p = this.pointerA.active ? this.pointerA : (this.pointerB.active ? this.pointerB : null);\n\t\t\tif (!p) return;\n\n\t\t\tthis.translateImage(p.cx - p.sx, p.cy - p.sy);\n\n\t\t\tp.sx = p.cx;\n\t\t\tp.sy = p.cy;\n\t\t}\n\t},\n\n\t\"event touchstart canvas\": function(evt)\n\t{\n\t\tthis.imageScale0 = this.imageScale;\n\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id === null)\n\t\t\t{\n\t\t\t\tthis.pointerA.id = i.identifier;\n\t\t\t\tthis.pointerA.active = true;\n\t\t\t\tthis.pointerA.sx = i.clientX;\n\t\t\t\tthis.pointerA.sy = i.clientY;\n\t\t\t\tthis.pointerA.ix = ((i.clientX-this.bounds.left) - this.imageOffsX) / this.imageScale;\n\t\t\t\tthis.pointerA.iy = ((i.clientY-this.bounds.top) - this.imageOffsY) / this.imageScale;\n\t\t\t}\n\t\t\telse if (this.pointerB.id === null)\n\t\t\t{\n\t\t\t\tthis.pointerB.id = i.identifier;\n\t\t\t\tthis.pointerB.active = true;\n\t\t\t\tthis.pointerB.sx = i.clientX;\n\t\t\t\tthis.pointerB.sy = i.clientY;\n\t\t\t\tthis.pointerB.ix = ((i.clientX-this.bounds.left) - this.imageOffsX) / this.imageScale;\n\t\t\t\tthis.pointerB.iy = ((i.clientY-this.bounds.top) - this.imageOffsY) / this.imageScale;\n\t\t\t}\n\t\t}\n\t},\n\n\t\"event touchend canvas\": function(evt)\n\t{\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerA.id = null;\n\t\t\t\tthis.pointerA.active = false;\n\t\t\t}\n\t\t\telse if (this.pointerB.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerB.id = null;\n\t\t\t\tthis.pointerB.active = false;\n\t\t\t}\n\t\t}\n\t},\n\n\t\"event touchcancel canvas\": function(evt)\n\t{\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerA.id = null;\n\t\t\t\tthis.pointerA.active = false;\n\t\t\t}\n\t\t\telse if (this.pointerB.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerB.id = null;\n\t\t\t\tthis.pointerB.active = false;\n\t\t\t}\n\t\t}\n\t}\n});\n","\nimport _Router from './router.js'; export const Router = _Router;\n//![import \"./router\"]\nimport _Element from './element.js'; export const Element = _Element; export const CElement = _Element;\n//![import \"./element\"]\nimport _Api from './api.js'; export const Api = _Api;\n//![import \"./api\"]\nimport _DataSource from './data-source.js'; export const DataSource = _DataSource;\n//![import \"./data-source\"]\nimport _DataList from './data-list.js'; export const DataList = _DataList;\n//![import \"./data-list\"]\nimport _Easing from './easing.js'; export const Easing = _Easing;\n//![import \"./easing\"]\nimport _Anim from './anim.js'; export const Anim = _Anim;\n//![import \"./anim\"]\nimport _Elements from './elements.js'; export const Elements = _Elements;\n//![import \"./elements\"]\nimport _Utils from './utils.js'; export const Utils = _Utils;\n//![import \"./utils\"]\nimport _db from './db.js'; export const db = _db;\n//![import \"./db\"]\n\nimport * as _Rinn from 'rinn';\nexport const Rinn = _Rinn.Rinn;\nexport const Class = _Rinn.Class;\nexport const Event = _Rinn.Event;\nexport const EventDispatcher = _Rinn.EventDispatcher;\nexport const Model = _Rinn.Model;\nexport const ModelList = _Rinn.ModelList;\nexport const Schema = _Rinn.Schema;\nexport const Flattenable = _Rinn.Flattenable;\nexport const Collection = _Rinn.Collection;\nexport const Template = _Rinn.Template;\n","\r\nimport _Tabs from './elems/r-tabs.js';\r\nimport _Form from './elems/r-form.js';\r\nimport _Panel from './elems/r-panel.js';\r\nimport _List from './elems/r-list.js';\r\nimport _Item from './elems/r-item.js';\r\nimport _Paginator from './elems/r-paginator.js';\r\nimport _Table from './elems/r-table.js';\r\nimport _Select from './elems/r-select.js';\r\nimport _ImageCropper from './elems/r-image-cropper.js';\r\n\r\nexport default {\r\n\tTabs: _Tabs,\r\n\tForm: _Form,\r\n\tPanel: _Panel,\r\n\tList: _List,\r\n\tItem: _Item,\r\n\tPaginator: _Paginator,\r\n\tTable: _Table,\r\n\tSelect: _Select,\r\n\tImageCropper: _ImageCropper\r\n};\r\n","\nimport { Rinn } from 'rinn';\n\n//!class db\n\nexport default\n{\n\t/**\n\t * Database connection.\n\t */\n\tdb: null,\n\n\t/**\n\t * Initializes the database connection.\n\t * @param {string} dbName\n\t * @param {number} version\n\t * @param {(db: IDBDatabase, txn: IDBTransaction, oldVersion: number) => void} upgradeCallback\n\t * @returns {Promise<void>}\n\t * !static init (dbName: string, version: number, upgradeCallback: (db: IDBDatabase, txn: IDBTransaction, oldVersion: number) => void) : Promise<void>;\n\t */\n\tinit: function (dbName, version, upgradeCallback)\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif (!global.indexedDB)\n\t\t\t{\n\t\t\t\treject ('IndexedDB is not available in your system.');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet req = indexedDB.open(dbName, version);\n\t\t\treq.onerror = (evt) =>\n\t\t\t{\n\t\t\t\tlet err = evt.target.error + '';\n\n\t\t\t\tif (err.indexOf('AbortError') !== -1)\n\t\t\t\t\terr = \"\\n\" + req.message;\n\n\t\t\t\treject('Unable to open database: ' + err);\n\t\t\t\treturn;\n\t\t\t};\n\n\t\t\treq.onupgradeneeded = async (evt) =>\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tconst db = evt.target.result;\n\t\t\t\t\tconst txn = evt.target.transaction;\n\n\t\t\t\t\tif (evt.oldVersion < 1)\n\t\t\t\t\t\tdb.createObjectStore('system', { keyPath: ['name'] });\n\n\t\t\t\t\tawait upgradeCallback(db, txn, evt.oldVersion);\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\treq.message = e.message;\n\t\t\t\t\treq.transaction.abort();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treq.onsuccess = async (evt) =>\n\t\t\t{\n\t\t\t\tthis.db = evt.target.result;\n\t\t\t\tresolve();\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Ensures the database is ready to be used, or throws an exception.\n\t */\n\tensureConnected: function()\n\t{\n\t\tif (!this.db)\n\t\t\talert('Error: Database not initialized.');\n\t},\n \n\t/**\n\t * Returns an index object for later use with methods that accept an IDBIndex in the `storeName` parameter.\n\t * @param {string} storeName\n\t * @param {string} indexName\n\t * @returns {IDBIndex}\n\t * !static index (storeName: string, indexName: string) : IDBIndex;\n\t */\n\tindex: function (storeName, indexName)\n\t{\n\t\tthis.ensureConnected();\n\n\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\n\t\tlet index = store.index(indexName);\n\t\tif (!index) throw new Error ('Unable to find index `' + indexName + '` in store ' + storeName);\n\n\t\treturn index;\n\t},\n\n\t/**\n\t * Runs a callback for each record in a data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string} id\n\t * @param { (value:object, cursor:IDBCursor) => Promise<boolean> } callback\n\t * @returns {Promise<void>}\n\t * !static forEach (storeName: string|IDBIndex|IDBObjectStore, id: string, callback: (value:object, cursor:IDBCursor) => Promise<boolean>) : Promise<void>;\n\t */\n\tforEach: function (storeName, id, callback)\n\t{\n\t\tthis.ensureConnected();\n\n\t\tif (typeof(id) === 'function')\n\t\t{\n\t\t\tcallback = id;\n\t\t\tid = null;\n\t\t}\n\n\t\treturn new Promise(async (resolve, reject) =>\n\t\t{\n\t\t\tlet request, store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tif (id === null)\n\t\t\t\trequest = store.openCursor();\n\t\t\telse\n\t\t\t\trequest = store.openCursor(id);\n\n\t\t\trequest.onsuccess = async (event) =>\n\t\t\t{\n\t\t\t\tlet cursor = event.target.result;\n\t\t\t\tif (!cursor)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet result = await callback (cursor.value, cursor);\n\t\t\t\tif (result === false)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcursor.continue();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns the count of all records from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @returns {Promise<number>}\n\t * !static count (storeName: string|IDBIndex|IDBObjectStore) : Promise<number>;\n\t */\n\tcount: function (storeName)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.count();\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns all records from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} filter\n\t * @returns {Promise<Array<object>>}\n\t * !static getAll (storeName: string|IDBIndex|IDBObjectStore, filter?: string|number|Array<string|number>) : Promise<Array<object>>;\n\t */\n\tgetAll: function (storeName, filter=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.getAll(filter);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns all keys from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} filter\n\t * @returns {Promise<Array<string|number|Array<string|number>>>}\n\t * !static getAllKeys (storeName: string|IDBIndex|IDBObjectStore, filter?: string|number|Array<string|number>) : Promise<Array<object>>;\n\t */\n\tgetAllKeys: function (storeName, filter=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.getAllKeys(filter);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Loads a list of records having unique values from the specified data store and returns the entire object or just the specified field.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string} [field]\n\t * @returns {Promise<Array<number|string|object>>}\n\t * !static getAllUnique (storeName: string|IDBIndex|IDBObjectStore) : Promise<Array<number|string|object>>;\n\t */\n\tgetAllUnique: function (storeName, fieldName=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.openCursor(null, 'nextunique');\n\t\t\tlet list = [];\n\n\t\t\trequest.onsuccess = (event) =>\n\t\t\t{\n\t\t\t\tlet cursor = event.target.result;\n\t\t\t\tif (!cursor)\n\t\t\t\t{\n\t\t\t\t\tresolve(list);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlist.push(fieldName ? cursor.value[fieldName] : cursor.value);\n\t\t\t\tcursor.continue();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns a single record from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} id\n\t * @returns {Promise<object>}\n\t * !static get (storeName: string|IDBIndex|IDBObjectStore, id: string|number|Array<string|number>) : Promise<object>;\n\t */\n\tget: function (storeName, id)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.get(id);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result || null);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\n\t/**\n\t * Adds or overwrites a record in the specified data store (data must include the primary key).\n\t * @param {string} storeName\n\t * @param {object} data\n\t * @returns {Promise<void>}\n\t * !static put (storeName: string, data: object) : Promise<void>;\n\t */\n\tput: function (storeName, data)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\t\t\tlet request = store.put(data);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns a variable from the system table.\n\t * @param {string} name - Name of the property to read.\n\t * @param {boolean} full - When `true` the entire object will be returned.\n\t * @returns {any}\n\t * !static sysGet (name: string, full?: boolean) : any;\n\t */\n\tsysGet: async function (name, full=false)\n\t{\n\t\tlet data = await this.get('system', [name]);\n\t\treturn data ? (full ? data : data.value) : null;\n\t},\n\n\t/**\n\t * Writes a variable to the system table.\n\t * @param {string} name - Name of the property to write.\n\t * @param {any} value - Value to write.\n\t * @param {boolean} full - When `true` the entire value will be written as-is.\n\t * @returns {void}\n\t * !static sysPut (name: string, value: any, full?: boolean) : void;\n\t */\n\tsysPut: async function (name, value, full=false)\n\t{\n\t\tif (full)\n\t\t{\n\t\t\tvalue.name = name;\n\t\t\tawait this.put('system', value);\n\t\t}\n\t\telse\n\t\t\tawait this.put('system', { name: name, value: value });\n\t},\n\n\t/**\n\t * Returns a single record from the specified data store that matches the `partial` object and does NOT match the `notPartial` object.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {object} [partial]\n\t * @param {object} [notPartial]\n\t * @returns {Promise<object>}\n\t * !static findOne (storeName: string|IDBIndex|IDBObjectStore, partial?: object, notPartial?: object) : Promise<object>;\n\t */\n\tfindOne: function (storeName, partial=null, notPartial=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.openCursor();\n\n\t\t\trequest.onsuccess = (event) =>\n\t\t\t{\n\t\t\t\tlet cursor = event.target.result;\n\t\t\t\tif (!cursor)\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (partial === null || Rinn.partialCompare(cursor.value, partial))\n\t\t\t\t{\n\t\t\t\t\tif (notPartial !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Rinn.partialCompare(cursor.value, notPartial))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcursor.continue();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(cursor.value);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcursor.continue();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Deletes a record from the specified data store.\n\t * @param {string} storeName\n\t * @param {string|number|Array<string|number>} id\n\t * @returns {Promise<void>}\n\t * !static delete (storeName: string, id: string|number|Array<string|number>) : Promise<void>;\n\t */\n\tdelete: function (storeName, id)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\n\t\t\tlet request = store.delete(id);\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Deletes all items in the specified store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} id\n\t * @returns {Promise<void>}\n\t * !static deleteAll (storeName: string|IDBIndex|IDBObjectStore, id: string|number|Array<string|number>) : Promise<void>;\n\t */\n\tdeleteAll: function (storeName, id=null)\n\t{\n\t\treturn this.forEach(storeName, id, async (value, cursor) => {\n\t\t\tawait cursor.delete();\n\t\t});\n\t},\n\n\t/**\n\t * Inserts a new record in the specified data store.\n\t * @param {string} storeName\n\t * @param {object} data\n\t * @returns {Promise<void>}\n\t * !static insert (storeName: string, data: object) : Promise<void>;\n\t */\n\tinsert: function (storeName, data)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\t\t\tlet request = store.add(data);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t}\n};\n\n//!/class\n"],"names":["$7718a52dfca15325$var$_Router","$k7heJ$EventDispatcher","extend","route","this","_super","EventDispatcher","__ctor","_compileRoute","value","params","replace","m","exec","push","routeRegex","addHandler","handler","unrouted","context","addEventListener","removeHandler","removeEventListener","dispatch","matches","match","s_args","active","dispatchEvent","args","str","i","length","changed","alreadyAttached","globalThis","onhashchange","onLocationChanged","bind","silent","location","realLocation","ignoreHashChangeEvent","hash","onRoute","onUnroute","routes","Route","sortedRoutes","sort","a","b","undefined","cLocation","pLocation","k","state","j","rLocation","$5808f050ebbd5b77$var$elementPrototypes","$5808f050ebbd5b77$var$elementClasses","$5808f050ebbd5b77$var$Element","eid","$k7heJ$Model","evt","continuePropagation","source","_long_press","elem","setTimeout","dx","_pos_fx","_pos_sx","dy","_pos_fy","_pos_sy","Math","sqrt","dispatchOn","clientX","clientY","touches","clearTimeout","opts","dataset","action","split","longPress","enter","_list_watch","_list_visible","_list_property","root","isRoot","style","display","random","toString","substr","model","tmp","setModel","keys","reverse","forEach","init","debug","console","log","tagName","parentElement","events","bindEvents","contents","setInnerHTML","toLowerCase","appendChild","document","createElement","markReady","list","isReady","collectWatchers","ref","getFieldByPath","Object","ready","findCustomParent","checkReady","rootReady","getRoot","onRefAdded","rready","readyLocked","readyReenter","remove","childNodes","result","evaluate","XPathResult","ANY_TYPE","iterateNext","path","$parcel$global","shift","findRoot","update","$k7heJ$Rinn","ensureTypeOf","modelt","onModelPreChanged","onModelPropertyChanging","onModelPropertyPreChanged","onModelPropertyRemoved","setNamespace","classString","trim","classList","add","styleString","indexOf","name","toUpperCase","getBoundingClientRect","width","height","evtstr","hdl","typeOf","selector","listen","keyCode","routeStr","$7718a52dfca15325$export$2e2bcd8739ae039","getRoute","target","HTMLElement","call","detail","elems","querySelectorAll","preventDefault","stopPropagation","eventName","eventCatcher","eventImmediate","callback0","callback1","self","firstCapture","firstCaptureCount","queue","_eventHandler","q","pop","removed","bubbles","MouseEvent","CustomEvent","createEventObject","innerHTML","modified","_list_watch_length","_list_property_length","i3","_template","$k7heJ$Template","compile","_watch","RegExp","watch","removeAttribute","selfWatch","i1","_visible","visible","selfVisible","i2","onchange","onblur","type","checked","getModel","set","getValue","onmouseup","property","selfProperty","filter","element","data","get","fields","test","i4","removeProperty","setProperty","onModelChanged","trigger","val","setValue","onModelPropertyChanged","proto","__prototypePrepared","hasOwnProperty","startsWith","protos","newElement","constructor","super","invokeConstructor","entries","prototype","onCreated","srcElement","connectReference","flags","connectedCallback","elementConnected","xref","disconnectedCallback","onRefRemoved","elementDisconnected","override","fetch","$k7heJ$nodefetch","$d584b999ce7bb535$var$Api","REQUEST_PACKAGE_SUPPORTED","REQ64_SUPPORTED","JSON_RESPONSE_SUPPORTED","XML_RESPONSE_SUPPORTED","INCLUDE_CREDENTIALS","UNIQUE_STAMP","apiUrl","useReq64","retries","res","req","_requestPackage","callback","responseCallback","packageBegin","packageEnd","_packageData","rpkg","$k7heJ$base64","encode","encodeParams","apiCall","_hideProgress","response","responseFilter","e","_requestLevel","documentElement","headers","obj","s","FormData","encodeURIComponent","join","url","param","success","failure","httpMethod","relativeUrl","getUrl","appendParam","Date","now","Accept","method","body","multipart","options","credentials","Blob","endsWith","File","append","l","then","decodeResult","catch","err","json","Promise","resolve","reject","className","debounceDelay","request","includeCount","includeEnum","includeList","count","basePath","config","assign","$k7heJ$ModelList","dataSource","enum","forwardRequestEvent","forwardListEvent","forwardEnumEvent","prepareEvent","setSource","resume","mode","_timeout","fn","$d584b999ce7bb535$export$2e2bcd8739ae039","fetchCount","fetchEnum","fetchList","forced","find","item","fetchOne","r","fetchDelete","error","f","setData","ModelList","dataList","_callback","$0a74aeaee0e1468a$var$Easing","interpolate","src","dst","duration","easing","time","x1","lastTime","dt","interpolator","curTime","x","t","requestAnimationFrame","Linear","IN","OUT","IN_OUT","Back","Bounce","getConst","Circ","Cubic","Expo","pow","Power","p","Quad","Quartic","Quintic","Sine","sin","cos","Step","$0a74aeaee0e1468a$export$2e2bcd8739ae039","$54865aa6b345efd5$var$Anim","$k7heJ$Class","initialData","stack","block","timeScale","blockTime","index","paused","finished","onFinishedCallback","onUpdatedCallback","reset","__dtor","clone","onFinished","onUpdated","handle","initial","speed","setOutput","pause","clearInterval","setInterval","_block","_index","_blockTime","cmd","op","started","blocks","indices","blockTimes","n","_count","field","startValue","_startValue","_endValue","endValue","last","cur","table","snd","play","parallel","serial","repeat","end","restart","wait","range","rand","randt","c","$54865aa6b345efd5$export$2e2bcd8739ae039","$4a9d88aa888e9f4d$export$2e2bcd8739ae039","$5808f050ebbd5b77$export$2e2bcd8739ae039","register","container","baseRoute","selectTab","_routeHandler","link","href","showTab","tabName","previousElementSibling","nextElementSibling","querySelector","_hideTabsExcept","onConnected","addRoute","onDisconnected","removeRoute","exceptName","el","$ec74230761e3bde8$export$2e2bcd8739ae039","formElement","def","names","default","defaults","clearMarkers","filterString","messages","eval","_change","createEvent","initEvent","fireEvent","_setField","multiple","parseInt","FileList","_getField","_value","fromFileFields","files","getField","_fieldChanged","_onSuccess","message","onanimationend","_onFailure","tmp2","tmp1","errorsAt","prepend","insertBefore","nsilent","submit","contains","strict","f1","formAction","$9c0636c07ff6144e$export$2e2bcd8739ae039","_onActivate","show","_onDeactivate","hide","window","$a4fb830b2d507403$export$2e2bcd8739ae039","template","isEmpty","isDynamicTemplate","template_elem","textContent","setEmpty","setLoading","setList","isInstanceOf","onLoading","onLoaded","onItemsCleared","onItemsChanged","onItemRemoved","onItemChanged","onItemAdded","buildItem","iid","asHtml","html","attr","attributes","nodeName","setAttribute","nodeValue","getData","wrap","itemId","id","position","refresh","$7061e6454a23ef4a$export$2e2bcd8739ae039","$8586bcf20c2e54e9$export$2e2bcd8739ae039","offsetStart","offsetEnd","offset","currentPageSize","pageSize","updateOffset","$fe13c50c6c3e66d8$export$2e2bcd8739ae039","onRequestPropertyChanged","onCountChanged","min","getInt","_offset","prevPage","offs","nextPage","firstPage","lastPage","clear","$a1b0099052e4f8e1$export$2e2bcd8739ae039","Error","temporalBody","order","firstElementChild","_elem","replaceChild","$e668322859586774$export$2e2bcd8739ae039","lastElementChild","label","has","blank","groups","values","g","$a86ae7da7dd6c514$var$Utils","showDownload","filename","dataUrl","download","click","removeChild","showFilePicker","allowMultiple","accept","input","onfocus","loadAsDataUrl","file","reader","FileReader","onload","onerror","readAsDataURL","loadAsText","readAsText","loadAsArrayBuffer","readAsArrayBuffer","loadAllAsDataUrl","fileList","loadNext","size","loadImageFromUrl","image","Image","$a86ae7da7dd6c514$export$2e2bcd8739ae039","$183fe4f5f56cd7be$export$2e2bcd8739ae039","aspectRatio","imageScale0","imageScale","imageOffsX","imageOffsY","pointerA","pointerB","bounds","canvas","getContext","sx","sy","cx","cy","ix","iy","setImageUrl","setImage","setImageFile","max","render","getBlobAndUrl","quality","toBlob","blob","URL","createObjectURL","fillStyle","beginPath","rect","fill","translate","scale","drawImage","translateImage","offsX","offsY","left","top","deltaY","changedTouches","identifier","d0","d","$9ffb7151b8b2d038$export$55185c17a0fcbe46","$9ffb7151b8b2d038$export$db77ccec0bb4ccac","$9ffb7151b8b2d038$export$9864de54bd63ed8a","$9ffb7151b8b2d038$export$bf71da7aebe9ddc1","$9ffb7151b8b2d038$export$accd73d198d77d2f","$9ffb7151b8b2d038$export$d3568da47c78d35c","$52a9c945778cbfd0$export$2e2bcd8739ae039","$9ffb7151b8b2d038$export$cea96571ebbff9dd","$9ffb7151b8b2d038$export$deefd61317ad2797","$9ffb7151b8b2d038$export$3abb4be70fa2c84e","Tabs","Form","Panel","List","Item","Paginator","Table","Select","ImageCropper","$9ffb7151b8b2d038$export$d2ca453b913dcdea","$9ffb7151b8b2d038$export$f932f06c7eb6abeb","db","dbName","version","upgradeCallback","indexedDB","open","onupgradeneeded","async","txn","transaction","oldVersion","createObjectStore","keyPath","abort","onsuccess","ensureConnected","alert","storeName","indexName","objectStore","store","openCursor","event","cursor","continue","getAll","getAllKeys","getAllUnique","fieldName","put","sysGet","full","sysPut","findOne","partial","notPartial","partialCompare","delete","deleteAll","insert","$9ffb7151b8b2d038$export$eefcfe56efaaa57d","$9ffb7151b8b2d038$export$4c85e640eb41c31b","$9ffb7151b8b2d038$export$d61e24a684f9e51","$k7heJ$Event","$9ffb7151b8b2d038$export$ec8b666c5fe2c75a","$9ffb7151b8b2d038$export$a1edc412be3e1841","$9ffb7151b8b2d038$export$59eced47f477f85a","$9ffb7151b8b2d038$export$19342e026b58ebb7","$k7heJ$Schema","$9ffb7151b8b2d038$export$3a9581c9ade29768","$k7heJ$Flattenable","$9ffb7151b8b2d038$export$fb8073518f34e6ec","$k7heJ$Collection","$9ffb7151b8b2d038$export$14416b8d99d47caa"],"version":3,"file":"riza.m.js.map"}