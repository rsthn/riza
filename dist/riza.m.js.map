{"mappings":"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","sources":["src/router.js","src/element.js","src/api.js","src/data-source.js","src/data-list.js","src/easing.js","src/anim.js","src/elems/r-tabs.js","src/elems/r-form.js","src/elems/r-panel.js","src/elems/r-list.js","src/elems/r-item.js","src/elems/r-paginator.js","src/elems/r-table.js","src/elems/r-select.js","src/utils.js","src/elements.js","src/elems/r-image-cropper.js","src/db.js","src/runtime-jsx.js","src/main.js"],"sourcesContent":["\r\nimport { EventDispatcher } from 'rinn';\r\n\r\n/*\r\n**\tThe Router is a special module that detects local URL changes (when a hash-change occurs) and\r\n**\tforwards events to the appropriate handlers.\r\n*/\r\n\r\nconst _Router =\r\n{\r\n\tRoute: EventDispatcher.extend\r\n\t({\r\n\t\t/*\r\n\t\t**\tRegular expression for the route. This is generated from a simpler expression provided\r\n\t\t**\tin the constructor.\r\n\t\t*/\r\n\t\trouteRegex: null,\r\n\r\n\t\t/*\r\n\t\t**\tOriginal route string value.\r\n\t\t*/\r\n\t\tvalue: null,\r\n\r\n\t\t/*\r\n\t\t**\tMap with the indices and the names of each paremeter obtained from the route expression.\r\n\t\t*/\r\n\t\tparams: null,\r\n\r\n\t\t/*\r\n\t\t**\tArguments obtained from the current route (uses `params` to determine name of arguments).\r\n\t\t*/\r\n\t\targs: null,\r\n\r\n\t\t/*\r\n\t\t**\tArguments string obtained from the last route dispatch. Used to check if the arguments changed.\r\n\t\t*/\r\n\t\ts_args: null,\r\n\r\n\t\t/*\r\n\t\t**\tIndicates if the route is active because of a past positive dispatch.\r\n\t\t*/\r\n\t\tactive: false,\r\n\r\n\t\t/*\r\n\t\t**\tIndicates if the params have changed since last event. Transition from inactive to active route will always set this value to true.\r\n\t\t*/\r\n\t\tchanged: false,\r\n\r\n\t\t/*\r\n\t\t**\tConstructor of the route, the specified argument is a route expression.\r\n\t\t**\r\n\t\t**\t>> void __ctor (string route);\r\n\t\t*/\r\n\t\t__ctor: function (route)\r\n\t\t{\r\n\t\t\tthis._super.EventDispatcher.__ctor();\r\n\t\t\tthis._compileRoute (this.value = route);\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tTransforms the specified route expression into a regular expression and a set of parameter\r\n\t\t**\tnames and stores them in the 'param' array.\r\n\t\t**\r\n\t\t**\t>> void _compileRoute (string route);\r\n\t\t*/\r\n\t\t_compileRoute: function (route)\r\n\t\t{\r\n\t\t\tthis.params = [];\r\n\r\n\t\t\troute = route.replace(/\\/\\*\\//g, '/.+/');\r\n\r\n\t\t\twhile (true)\r\n\t\t\t{\r\n\t\t\t\tvar m = /:([!@A-Za-z0-9_-]+)/.exec(route);\r\n\t\t\t\tif (!m) break;\r\n\t\r\n\t\t\t\troute = route.replace(m[0], '([^/]+)');\r\n\t\t\t\tthis.params.push (m[1]);\r\n\t\t\t}\r\n\r\n\t\t\tthis.routeRegex = '^' + route.replace(/##/g, '');\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tAdds a handler to the route dispatcher. The handler can be removed later using removeHandler and\r\n\t\t**\tspecifying the same parameters. If unrouted boolean is specified the event to listen to will be\r\n\t\t**\tthe unrouted event (when the route changes and the route is not activated).\r\n\t\t**\r\n\t\t**\tvoid addHandler (handler: function, unrouted: bool, context:object=null);\r\n\t\t*/\r\n\t\taddHandler: function (handler, unrouted=false, context=null)\r\n\t\t{\r\n\t\t\tthis.addEventListener ((unrouted === true ? 'un' : '') + 'routed', handler, context);\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tRemoves a handler from the route dispatcher.\r\n\t\t**\r\n\t\t**\tvoid removeHandler (handler: function, unrouted: bool, context: object=null);\r\n\t\t*/\r\n\t\tremoveHandler: function (handler, unrouted=false, context=null)\r\n\t\t{\r\n\t\t\tthis.removeEventListener ((unrouted === true ? 'un' : '') + 'routed', handler, context);\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tVerifies if the specified route matches the internal route and if so dispatches a (depends on doUnroute parameter) \"routed\" or \"unrouted\" event with the\r\n\t\t**\tparameters obtained from the location to all attached handlers.\r\n\t\t**\r\n\t\t**\tvoid dispatch (route:string, doUnroute:bool);\r\n\t\t*/\r\n\t\tdispatch: function (route)\r\n\t\t{\r\n\t\t\tvar matches = route.match(this.routeRegex);\r\n\t\t\tif (!matches)\r\n\t\t\t{\r\n\t\t\t\tthis.s_args = null;\r\n\r\n\t\t\t\tif (this.active)\r\n\t\t\t\t\tthis.dispatchEvent ('unrouted', { route: this });\r\n\r\n\t\t\t\tthis.active = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar args = { route: this };\r\n\t\t\tvar str = '';\r\n\r\n\t\t\tfor (var i = 0; i < this.params.length; i++)\r\n\t\t\t{\r\n\t\t\t\targs[this.params[i]] = matches[i+1];\r\n\t\t\t\tstr += '_' + matches[i+1];\r\n\t\t\t}\r\n\r\n\t\t\tthis.changed = str != this.s_args;\r\n\t\t\tthis.s_args = str;\r\n\r\n\t\t\tthis.dispatchEvent ('routed', this.args = args);\r\n\t\t\tthis.active = true;\r\n\t\t}\r\n\t}),\r\n\r\n\t/*\r\n\t**\tMap with route objects. The key of the map is the route and the value a handler.\r\n\t*/\r\n\troutes: { },\r\n\r\n\t/*\r\n\t**\tSorted list of routes. Smaller routes are processed first than larger ones. This array stores\r\n\t**\tonly the keys to the Router.routes map.\r\n\t*/\r\n\tsortedRoutes: [ ],\r\n\r\n\t/*\r\n\t**\tIndicates the number of times the onLocationChanged handler should ignore the hash change event.\r\n\t*/\r\n\tignoreHashChangeEvent: 0,\r\n\r\n\t/*\r\n\t**\tCurrent relative location (everything after the location hash symbol).\r\n\t*/\r\n\tlocation: '',\r\n\r\n\t/*\r\n\t**\tCurrent relative location as an array of elements (obtained by splitting the location by slash).\r\n\t*/\r\n\targs: [],\r\n\r\n\t/*\r\n\t**\tInitializes the router module. Ensure to call `refresh` once to force a hashchange when the page loads.\r\n\t*/\r\n\tinit: function ()\r\n\t{\r\n\t\tif (this.alreadyAttached)\r\n\t\t\treturn;\r\n\r\n\t\tthis.alreadyAttached = true;\r\n\r\n\t\tif ('onhashchange' in globalThis)\r\n\t\t\tglobalThis.onhashchange = this.onLocationChanged.bind(this);\r\n\t},\r\n\r\n\t/*\r\n\t**\tRefreshes the current route by forcing a hashchange event.\r\n\t*/\r\n\trefresh: function ()\r\n\t{\r\n\t\tthis.onLocationChanged();\r\n\t},\r\n\r\n\t/*\r\n\t**\tChanges the current location and optionally prevents a trigger of the hashchange event.\r\n\t*/\r\n\tsetRoute: function (route, silent)\r\n\t{\r\n\t\tvar location = this.realLocation (route);\r\n\t\tif (location == this.location) return;\r\n\r\n\t\tif (silent) this.ignoreHashChangeEvent++;\r\n\t\tglobalThis.location.hash = location;\r\n\t},\r\n\r\n\t/*\r\n\t**\tAdds the specified route to the routing map. When the specified route is detected, the `onRoute` handler will be called, and then\r\n\t**\twhen the route exits `onUnroute` will be called.\r\n\t*/\r\n\taddRoute: function (route, onRoute, onUnroute=null)\r\n\t{\r\n\t\tif (!this.routes[route])\r\n\t\t{\r\n\t\t\tthis.routes[route] = new this.Route (route);\r\n\t\t\tthis.sortedRoutes.push (route);\r\n\r\n\t\t\tthis.sortedRoutes.sort ((a, b) => {\r\n\t\t\t\treturn this.routes[a].routeRegex.length - this.routes[b].routeRegex.length;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (onUnroute !== null)\r\n\t\t{\r\n\t\t\tthis.routes[route].addHandler (onRoute, false);\r\n\t\t\tthis.routes[route].addHandler (onUnroute, true);\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis.routes[route].addHandler (onRoute, false);\r\n\r\n\t\treturn this.routes[route];\r\n\t},\r\n\r\n\t/*\r\n\t**\tReturns the Route object for the specified route.\r\n\t*/\r\n\tgetRoute: function (route)\r\n\t{\r\n\t\tif (!this.routes[route])\r\n\t\t{\r\n\t\t\tthis.routes[route] = new this.Route (route);\r\n\t\t\tthis.sortedRoutes.push (route);\r\n\r\n\t\t\tthis.sortedRoutes.sort ((a, b) => {\r\n\t\t\t\treturn this.routes[a].routeRegex.length - this.routes[b].routeRegex.length;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this.routes[route];\r\n\t},\r\n\r\n\t/*\r\n\t**\tAdds the specified routes to the routing map. The routes map should contain the route expression\r\n\t**\tin the key of the map and a handler function in the value.\r\n\t*/\r\n\taddRoutes: function (routes)\r\n\t{\r\n\t\tfor (var i in routes)\r\n\t\t{\r\n\t\t\tif (!this.routes[i])\r\n\t\t\t{\r\n\t\t\t\tthis.routes[i] = new this.Route (i);\r\n\t\t\t\tthis.sortedRoutes.push (i);\r\n\t\t\t}\r\n\r\n\t\t\tthis.routes[i].addHandler (routes[i], false);\r\n\t\t}\r\n\r\n\t\tthis.sortedRoutes.sort ((a, b) => {\r\n\t\t\treturn this.routes[a].routeRegex.length - this.routes[b].routeRegex.length;\r\n\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t**\tRemoves the specified route from the routing map.\r\n\t*/\r\n\tremoveRoute: function (route, onRoute, onUnroute)\r\n\t{\r\n\t\tif (!this.routes[route]) return;\r\n\r\n\t\tif (onUnroute !== undefined)\r\n\t\t{\r\n\t\t\tthis.routes[route].removeHandler (onRoute, false);\r\n\t\t\tthis.routes[route].removeHandler (onUnroute, true);\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis.routes[route].removeHandler (onRoute);\r\n\t},\r\n\r\n\t/*\r\n\t**\tRemoves the specified routes from the routing map. The routes map should contain the route\r\n\t**\texpression in the key of the map and a handler function in the value.\r\n\t*/\r\n\tremoveRoutes: function (routes)\r\n\t{\r\n\t\tfor (var i in routes)\r\n\t\t{\r\n\t\t\tif (!this.routes[i]) continue;\r\n\r\n\t\t\tthis.routes[i].removeHandler (routes[i]);\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t**\tGiven a formatted location and a previous one it will return the correct real location.\r\n\t*/\r\n\trealLocation: function (cLocation, pLocation)\r\n\t{\r\n\t\tif (!pLocation) pLocation = this.location;\r\n\t\tif (!pLocation) pLocation = ' ';\r\n\r\n\t\tvar state = 0, i = 0, j = 0, k;\r\n\t\tvar rLocation = '';\r\n\r\n\t\twhile (state != -1 && i < cLocation.length && j < pLocation.length)\r\n\t\t{\r\n\t\t\tswitch (state)\r\n\t\t\t{\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tif (cLocation.substr(i++, 1) == '*')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstate = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (cLocation.substr(i-1, 1) != pLocation.substr(j++, 1))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trLocation += cLocation.substr(i-1);\r\n\t\t\t\t\t\tstate = -1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trLocation += pLocation.substr(j-1, 1);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tif (cLocation.substr(i, 1) == '*')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstate = 3;\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate = 2;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tk = pLocation.indexOf(cLocation.substr(i, 1), j);\r\n\t\t\t\t\tif (k == -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trLocation += pLocation.substr(j) + cLocation.substr(i);\r\n\t\t\t\t\t\tstate = -1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trLocation += pLocation.substr(j, k-j);\r\n\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t\tj = k;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tk = pLocation.lastIndexOf(cLocation.substr(i, 1));\r\n\t\t\t\t\tif (k == -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trLocation += cLocation.substr(i);\r\n\t\t\t\t\t\tstate = -1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trLocation += pLocation.substr(j, k-j);\r\n\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t\tj = k;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (state != -1)\r\n\t\t\trLocation += cLocation.substr(i);\r\n\r\n\t\treturn rLocation.trim();\r\n\t},\r\n\r\n\t/*\r\n\t**\tEvent handler called when the location hash changes.\r\n\t*/\r\n\tonLocationChanged: function ()\r\n\t{\r\n\t\tvar cLocation = location.hash.substr(1);\r\n\t\tvar rLocation = this.realLocation (cLocation);\r\n\r\n\t\tif (cLocation != rLocation)\r\n\t\t{\r\n\t\t\tglobalThis.location.replace('#' + rLocation);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.location = cLocation;\r\n\t\tthis.args = this.location.split ('/');\r\n\r\n\t\tif (this.ignoreHashChangeEvent > 0)\r\n\t\t{\r\n\t\t\tthis.ignoreHashChangeEvent--;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < this.sortedRoutes.length; i++)\r\n\t\t\tthis.routes[this.sortedRoutes[i]].dispatch (this.location);\r\n\t},\r\n\r\n\t/*\r\n\t**\tNavigates to the given hash-based URL.\r\n\t*/\r\n\tnavigate: function (location, replace=false)\r\n\t{\r\n\t\tlocation = this.realLocation(location);\r\n\r\n\t\tif (globalThis.location.hash == '#'+location)\r\n\t\t{\r\n\t\t\tthis.refresh();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (replace)\r\n\t\t\tglobalThis.location.replace('#'+location);\r\n\t\telse\r\n\t\t\tglobalThis.location.hash = location;\r\n\t}\r\n};\r\n\r\n_Router.init();\r\n\r\nexport default _Router;\r\n","\nimport { Rinn, Model, Template } from 'rinn';\nimport Router from './router.js';\n\n/**\n * Map containing the original prototypes for all registered elements.\n */\nconst elementPrototypes = { };\n\n/**\n * Map containing the final classes for all registered elements.\n */\nconst elementClasses = { };\n\n/**\n * Base class for custom elements. Provides support for model-triggered events, easy definition of handlers for events originated in\n * self or child-elements, and several utility methods.\n */\n\nconst Element = \n{\n\t/**\n\t * Internal element ID. Added as namespace to model events. Ensures that certain model events are run locally only, not affecting other event handlers.\n\t */\n\teid: null,\n\n\t/**\n\t * Indicates if the element is a root element, that is, the target element to attach child elements having `data-ref` attribute.\n\t */\n\tisRoot: true,\n\n\t/**\n\t * Root element to which this element is attached (when applicable).\n\t */\n\troot: null,\n\n\t/**\n\t * Indicates ready-state of the element. Possible values are: 0: \"Not ready\", 1: \"Children Initialized\", and 2: \"Parent Ready\".\n\t */\n\tisReady: 0,\n\treadyReenter: 0,\n\treadyLocked: 0,\n\n\t/**\n\t * Model type (class) for the element's model.\n\t */\n\tmodelt: Model,\n\n\t/**\n\t * Data model related to the element.\n\t */\n\tmodel: null,\n\n\t/**\n\t * Contents of the element. When set, the innerHTML will be set to this value.\n\t */\n\tcontents: null,\n\n\t/**\n\t * \tEvents map.\n\t */\n\tevents:\n\t{\n\t\t'mousedown [data-long-press]': function (evt)\n\t\t{\n\t\t\tevt.continuePropagation = true;\n\t\t\tif (evt.source._long_press) return;\n\n\t\t\tlet elem = evt.source;\n\n\t\t\telem._long_press = setTimeout(() =>\n\t\t\t{\n\t\t\t\tlet dx = elem._pos_fx - elem._pos_sx;\n\t\t\t\tlet dy = elem._pos_fy - elem._pos_sy;\n\n\t\t\t\telem._long_press = null;\n\n\t\t\t\tlet d = Math.sqrt(dx*dx + dy*dy);\n\t\t\t\tif (d < 5) {\n\t\t\t\t\telem._long_press = false;\n\t\t\t\t\tthis.dispatchOn (elem, 'long-press');\n\t\t\t\t}\n\t\t\t},\n\t\t\t500);\n\n\t\t\telem._pos_sx = evt.clientX;\n\t\t\telem._pos_sy = evt.clientY;\n\n\t\t\telem._pos_fx = evt.clientX;\n\t\t\telem._pos_fy = evt.clientY;\n\t\t},\n\n\t\t'mousemove [data-long-press]': function (evt)\n\t\t{\n\t\t\tevt.continuePropagation = true;\n\t\t\tif (!evt.source._long_press) return;\n\n\t\t\tevt.source._pos_fx = evt.clientX;\n\t\t\tevt.source._pos_fy = evt.clientY;\n\t\t},\n\n\t\t'touchstart [data-long-press]': function (evt)\n\t\t{\n\t\t\tevt.continuePropagation = true;\n\t\t\tif (evt.source._long_press) return;\n\n\t\t\tlet elem = evt.source;\n\n\t\t\telem._long_press = setTimeout(() => {\n\t\t\t\tlet dx = elem._pos_fx - elem._pos_sx;\n\t\t\t\tlet dy = elem._pos_fy - elem._pos_sy;\n\n\t\t\t\telem._long_press = null;\n\n\t\t\t\tlet d = Math.sqrt(dx*dx + dy*dy);\n\t\t\t\tif (d < 5) {\n\t\t\t\t\telem._long_press = false;\n\t\t\t\t\tthis.dispatchOn (elem, 'long-press');\n\t\t\t\t}\n\t\t\t}, 500);\n\n\t\t\telem._pos_sx = evt.touches[0].clientX;\n\t\t\telem._pos_sy = evt.touches[0].clientY;\n\n\t\t\telem._pos_fx = evt.touches[0].clientX;\n\t\t\telem._pos_fy = evt.touches[0].clientY;\n\t\t},\n\n\t\t'touchmove [data-long-press]': function (evt)\n\t\t{\n\t\t\tevt.continuePropagation = true;\n\t\t\tif (!evt.source._long_press) return;\n\n\t\t\tevt.source._pos_fx = evt.touches[0].clientX;\n\t\t\tevt.source._pos_fy = evt.touches[0].clientY;\n\t\t},\n\n\t\t'mouseup [data-long-press]': function (evt)\n\t\t{\n\t\t\tif (evt.source._long_press === false)\n\t\t\t\treturn;\n\n\t\t\tif (evt.source._long_press) {\n\t\t\t\tclearTimeout(evt.source._long_press);\n\t\t\t\tevt.source._long_press = null;\n\t\t\t}\n\t\n\t\t\tevt.continuePropagation = true;\n\t\t},\n\t\n\t\t'touchend [data-long-press]': function (evt)\n\t\t{\n\t\t\tif (evt.source._long_press === false)\n\t\t\t\treturn;\n\t\n\t\t\tif (evt.source._long_press) {\n\t\t\t\tclearTimeout(evt.source._long_press);\n\t\t\t\tevt.source._long_press = null;\n\t\t\t}\n\t\n\t\t\tevt.continuePropagation = true;\n\t\t},\n\n\t\t'click [data-action]': function(evt)\n\t\t{\n\t\t\tif (evt.source._long_press === false)\n\t\t\t\treturn;\n\n\t\t\tlet opts = evt.source.dataset.action.split(' ');\n\n\t\t\tif (opts[0] in this)\n\t\t\t\tthis[opts[0]] ({ ...evt.params, ...evt.source.dataset, ...opts, length: opts.length }, evt);\n\t\t\telse\n\t\t\t\tevt.continuePropagation = true;\n\t\t},\n\n\t\t'long-press [data-long-press]': function(evt)\n\t\t{\n\t\t\tlet opts = evt.source.dataset.longPress.split(' ');\n\n\t\t\tif (opts[0] in this)\n\t\t\t\tthis[opts[0]] ({ ...evt.params, ...evt.source.dataset, ...opts, length: opts.length }, evt);\n\t\t\telse\n\t\t\t\tevt.continuePropagation = true;\n\t\t},\n\n\t\t'keyup(13) input[data-enter]': function(evt)\n\t\t{\n\t\t\tlet opts = evt.source.dataset.enter.split(' ');\n\n\t\t\tif (opts[0] in this)\n\t\t\t\tthis[opts[0]] ({ ...evt.params, ...evt.source.dataset, ...opts, length: opts.length }, evt);\n\t\t\telse\n\t\t\t\tevt.continuePropagation = true;\n\t\t}\n\t},\n\n\t/**\n\t * Internal routes map, set by `bindRoutes`.\n\t */\n\troutes: null,\n\n\t/**\n\t * \tElement constructor.\n\t */\n\t__ctor: function()\n\t{\n\t\tthis._list_watch = [];\n\t\tthis._list_visible = [];\n\t\tthis._list_attr = [];\n\t\tthis._list_property = [];\n\n\t\tif ('root' in this.dataset)\n\t\t{\n\t\t\tif (this.dataset.root == 'false')\n\t\t\t\tthis.isRoot = false;\n\t\t}\n\n\t\tthis.style.display = 'block';\n\n\t\tthis.eid = Math.random().toString().substr(2);\n\n\t\tif (this.model != null)\n\t\t{\n\t\t\tlet tmp = this.model;\n\t\t\tthis.model = null;\n\t\t\tthis.setModel (tmp, false);\n\t\t}\n\n\t\tObject.keys(this._super).reverse().forEach(i =>\n\t\t{\n\t\t\tif ('init' in this._super[i])\n\t\t\t\tthis._super[i].init();\n\t\t});\n\n\t\tif (Element.debug)\n\t\t\tconsole.log('>> ' + this.tagName + ' INIT ON ' + this.parentElement.tagName);\n\n\t\tthis.init();\n\n\t\tif (this.events)\n\t\t\tthis.bindEvents (this.events);\n\n\t\tif (this.contents)\n\t\t\tthis.setInnerHTML(this.contents);\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.tagName.toLowerCase() !== 'r-dom-probe')\n\t\t\t\tthis.appendChild(document.createElement('r-dom-probe'));\n\t\t\telse\n\t\t\t\tthis.markReady();\n\t\t}, 0);\n\t},\n\n\t/**\n\t * \tInitializes the element. Called after construction of the instance.\n\t */\n\tinit: function()\n\t{\n\t},\n\n\t/**\n\t * \tExecuted when the children of the element are ready.\n\t */\n\tready: function()\n\t{\n\t},\n\n\t/**\n\t * \tExecuted after ready and after the root is also ready.\n\t */\n\trready: function()\n\t{\n\t},\n\n\t/**\n\t * \tMarks the element as ready.\n\t */\n\tmarkReady: function (list=null)\n\t{\n\t\tthis.readyLocked++;\n\n\t\tif (!this.isReady)\n\t\t{\n\t\t\tthis.isReady = 1;\n\n\t\t\t// Set model is `model` property was set in the element.\n\t\t\tif ('model' in this.dataset)\n\t\t\t{\n\t\t\t\tlet ref = this.getFieldByPath(this.dataset.model);\n\t\t\t\tif (ref) this.setModel(ref);\n\t\t\t}\n\n\t\t\t// Run ready methods in class hierarchy.\n\t\t\tObject.keys(this._super).reverse().forEach(i =>\n\t\t\t{\n\t\t\t\tif ('ready' in this._super[i])\n\t\t\t\t\tthis._super[i].ready();\n\t\t\t});\n\n\t\t\tif (Element.debug)\n\t\t\t\tconsole.log('>> ' + this.tagName + ' READY');\n\n\t\t\tthis.ready();\n\t\t\tif (this.onready) this.onready(this);\n\n\t\t\tthis.collectWatchers();\n\t\t}\n\t\telse\n\t\t\tthis.collectWatchers();\n\n\t\tlet root = this.findCustomParent(this);\n\n\t\tif (Element.debug)\n\t\t\tconsole.log(this.tagName + ' ROOT IS ' + (root ? root.tagName : 'NULL'));\n\n\t\tif (root && root.isReady === 0 && this.isReady != 0)\n\t\t\troot.checkReady();\n\n\t\tlet rootReady = false;\n\n\t\tif (root && root.isReady === 2 && this.isReady !== 2)\n\t\t{\n\t\t\tthis.getRoot();\n\n\t\t\tif (this.root && this.dataset.ref)\n\t\t\t{\n\t\t\t\tif (Element.debug)\n\t\t\t\t\tconsole.log(this.tagName + ' REF AS `' + this.dataset.ref + '` ON ' + this.root.tagName);\n\n\t\t\t\tthis.root[this.dataset.ref] = this;\n\t\t\t\tthis.root.onRefAdded (this.dataset.ref, this);\n\t\t\t}\n\n\t\t\trootReady = true;\n\t\t}\n\n\t\tif (!root && this.isReady !== 2)\n\t\t{\n\t\t\trootReady = true;\n\t\t}\n\n\t\tif (rootReady)\n\t\t{\n\t\t\tthis.isReady = 2;\n\n\t\t\tif (list !== null) {\n\t\t\t\tfor (let elem of list)\n\t\t\t\t\telem.checkReady();\n\t\t\t}\n\n\t\t\tif (Element.debug)\n\t\t\t\tconsole.log('>> ' + this.tagName + ' RREADY');\n\n\t\t\tObject.keys(this._super).reverse().forEach(i =>\n\t\t\t{\n\t\t\t\tif ('rready' in this._super[i])\n\t\t\t\t\tthis._super[i].rready();\n\t\t\t});\n\n\t\t\tthis.rready();\n\t\t\tif (this.onrootready) this.onrootready(this);\n\t\t}\n\n\t\tthis.readyLocked--;\n\n\t\tif (this.readyReenter && !this.readyLocked)\n\t\t{\n\t\t\tthis.readyReenter = false;\n\t\t\tthis.checkReady();\n\t\t}\n\n\t\tif (this.tagName.toLowerCase() === 'r-dom-probe')\n\t\t\tthis.remove();\n\t},\n\n\t/**\n\t *\tChecks if all children are ready and fires the appropriate function (`ready` and/or `rready`).\n\t */\n\tcheckReady: function()\n\t{\n\t\tif (this.childNodes.length == 0)\n\t\t\treturn;\n\n\t\tif (this.readyLocked)\n\t\t{\n\t\t\tthis.readyReenter = true;\n\t\t\treturn;\n\t\t}\n\n\t\tlet isReady = true;\n\t\tlet list = [];\n\n\t\tlet result = document.evaluate(\".//*[contains(name(),'-')]\", this, null, XPathResult.ANY_TYPE, null);\n\n\t\tif (Element.debug)\n\t\t\tconsole.log('# CHECKING ' + this.tagName);\n\n\t\twhile (true)\n\t\t{\n\t\t\tlet elem = result.iterateNext();\n\t\t\tif (!elem) break;\n\n\t\t\tif (elem === this)\n\t\t\t\tcontinue;\n\n\t\t\tlet root = this.findCustomParent(elem);\n\t\t\tif (root !== this) continue;\n\n\t\t\tif (Element.debug)\n\t\t\t\tconsole.log('   ' + elem.tagName + ' = ' + elem.isReady);\n\n\t\t\tif (!elem.isReady)\n\t\t\t\tisReady = false;\n\n\t\t\tlist.push(elem);\n\t\t}\n\n\t\tif (!isReady) return;\n\n\t\tthis.markReady(list);\n\t},\n\n\t/**\n\t * \tReturns the value of a field given its path. Starts from `global`, unless the first item in the path is `this`, in which case it will start from the element.\n\t */\n\tgetFieldByPath: function(path)\n\t{\n\t\tif (!path) return null;\n\n\t\tif (typeof(path) !== 'string')\n\t\t\treturn path;\n\n\t\tlet tmp = path.split('.');\n\t\tlet ref = global;\n\n\t\tif (tmp.length && tmp[0] == 'this')\n\t\t{\n\t\t\tref = this;\n\t\t\ttmp.shift();\n\t\t}\n\n\t\tif (tmp.length && tmp[0] == 'root')\n\t\t{\n\t\t\tref = this.getRoot();\n\t\t\ttmp.shift();\n\t\t}\n\n\t\twhile (ref != null && tmp.length != 0)\n\t\t\tref = ref[tmp.shift()];\n\n\t\treturn ref;\n\t},\n\n\t/**\n\t * \tReturns the root of the element (that is, the `root` property). If not set it will attempt to find the root first.\n\t */\n\tgetRoot: function()\n\t{\n\t\treturn this.root ? this.root : (this.root = this.findRoot());\n\t},\n\n\t/**\n\t * \tSets the model of the element and executes the `modelChanged` event handler (unless `update` is set to false).\n\t */\n\tsetModel: function (model, update=true)\n\t{\n\t\tif (!model) return this;\n\n\t\tmodel = Rinn.ensureTypeOf(this.modelt, model);\n\n\t\tif (this.model !== model)\n\t\t{\n\t\t\tif (this.model != null)\n\t\t\t{\n\t\t\t\tthis.model.removeEventListener (this.eid+':modelChanged', this.onModelPreChanged, this);\n\t\t\t\tthis.model.removeEventListener (this.eid+':propertyChanging', this.onModelPropertyChanging, this);\n\t\t\t\tthis.model.removeEventListener (this.eid+':propertyChanged', this.onModelPropertyPreChanged, this);\n\t\t\t\tthis.model.removeEventListener (this.eid+':propertyRemoved', this.onModelPropertyRemoved, this);\n\t\t\t}\n\n\t\t\tthis.model = model;\n\n\t\t\tthis.model.addEventListener (this.eid+':modelChanged', this.onModelPreChanged, this);\n\t\t\tthis.model.addEventListener (this.eid+':propertyChanging', this.onModelPropertyChanging, this);\n\t\t\tthis.model.addEventListener (this.eid+':propertyChanged', this.onModelPropertyPreChanged, this);\n\t\t\tthis.model.addEventListener (this.eid+':propertyRemoved', this.onModelPropertyRemoved, this);\n\t\t}\n\n\t\tif (update !== false)\n\t\t\tthis.model.setNamespace(this.eid).update(true).setNamespace(null);\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * \tReturns the model of the element. Added for symmetry only, exactly the same as accesing public property `model` of this class.\n\t */\n\tgetModel: function ()\n\t{\n\t\treturn this.model;\n\t},\n\n\t/**\n\t * \tAdds one or more CSS classes (separated by space) to the element.\n\t */\n\taddClass: function (classString)\n\t{\n\t\tif (!classString) return this;\n\n\t\tclassString.split(' ').forEach(i =>\n\t\t{\n\t\t\ti = i.trim();\n\t\t\tif (!i) return;\n\n\t\t\tif (i[0] == '-' || i[0] == '+')\n\t\t\t\tthis.classList[i[0] == '-' ? 'remove' : 'add'](i.substr(1));\n\t\t\telse\n\t\t\t\tthis.classList.add(i);\n\t\t});\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * \tRemoves one or more CSS classes (separated by space) from the element.\n\t */\n\tremoveClass: function (classString)\n\t{\n\t\tif (!classString) return this;\n\n\t\tclassString.split(' ').forEach(i =>\n\t\t{\n\t\t\ti = i.trim();\n\t\t\tif (!i) return;\n\n\t\t\tif (i[0] == '-' || i[0] == '+')\n\t\t\t\tthis.classList[i[0] == '-' ? 'remove' : 'add'](i.substr(1));\n\t\t\telse\n\t\t\t\tthis.classList.remove(i);\n\t\t});\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * \tSets one or more style properties to the element (separated by semi-colon).\n\t */\n\tsetStyle: function (styleString)\n\t{\n\t\tif (!styleString) return this;\n\n\t\tstyleString.split(';').forEach(i => {\n\t\t\tlet j = (i = i.trim()).indexOf(':');\n\t\t\tif (j == -1) return;\n\n\t\t\tlet name = i.substr(0, j).trim();\n\t\t\tfor (let k = name.indexOf('-'); k != -1; k = name.indexOf('-')) {\n\t\t\t\tname = name.substr(0, k) + name.substr(k+1, 1).toUpperCase() + name.substr(k+2);\n\t\t\t}\n\n\t\t\tthis.style[name] = i.substr(j+1).trim();\n\t\t});\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * \tReturns the width of the specified element (or of itself it none provided), uses `getBoundingClientRect`.\n\t */\n\tgetWidth: function (elem=null)\n\t{\n\t\treturn (elem || this).getBoundingClientRect().width;\n\t},\n\n\t/**\n\t * \tReturns the height of the specified element (or of itself it none provided), uses `getBoundingClientRect`.\n\t */\n\tgetHeight: function (elem=null)\n\t{\n\t\treturn (elem || this).getBoundingClientRect().height;\n\t},\n\n\t/**\n\t**\tBinds all events in the specified map to the element, the events map can have one of the following forms:\n\t**\n\t**\t\t\"click .button\": \"doSomething\",\t\t(Delegated Event)\n\t**\t\t\"click .button\": function() { },\t(Delegated Event)\n\t**\t\t\"myevt &this\": \"...\",\t\t\t\t(Self Event)\n\t**\t\t\"myevt\": \"...\",\t\t\t\t\t\t(Element Event)\n\t**\t\t\"myevt @objName\": \"...\",\t\t\t(EventDispatcher Event)\n\t**\t\t\"#propname\": \"...\",\t\t\t\t\t(Property Changed Event)\n\t**\t\t\"keyup(10) .input\": \"...\"\t\t\t(Delegated Event with Parameters)\n\t**\n\t**\t>> Element bindEvents (object events);\n\t*/\n\tbindEvents: function (events)\n\t{\n\t\tfor (let evtstr in events)\n\t\t{\n\t\t\tlet hdl = events[evtstr];\n\n\t\t\tif (Rinn.typeOf(hdl) == 'string')\n\t\t\t\thdl = this[hdl];\n\n\t\t\thdl = hdl.bind(this);\n\n\t\t\tvar i = evtstr.indexOf(' ');\n\n\t\t\tvar name = i == -1 ? evtstr : evtstr.substr(0, i);\n\t\t\tvar selector = i == -1 ? '' : evtstr.substr(i + 1);\n\n\t\t\tlet args = null;\n\n\t\t\tvar j = name.indexOf('(');\n\t\t\tif (j != -1)\n\t\t\t{\n\t\t\t\targs = name.substr(j+1, name.length-j-2).split(',');\n\t\t\t\tname = name.substr(0, j);\n\t\t\t}\n\n\t\t\tif (selector[0] == '@')\n\t\t\t{\n\t\t\t\tif (selector != '@this')\n\t\t\t\t{\n\t\t\t\t\tthis[selector.substr(1)].addEventListener(name, hdl);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tselector = this;\n\t\t\t}\n\t\t\telse if (selector[0] == '&')\n\t\t\t{\n\t\t\t\tif (selector != '&this')\n\t\t\t\t\tselector = \"[data-ref='\"+selector.substr(1)+\"']\";\n\t\t\t\telse\n\t\t\t\t\tselector = this;\n\t\t\t}\n\n\t\t\tif (name.substr(0, 1) == '#')\n\t\t\t{\n\t\t\t\tthis.listen('propertyChanged.'+name.substr(1), this, hdl);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (args != null)\n\t\t\t{\n\t\t\t\tswitch (name)\n\t\t\t\t{\n\t\t\t\t\tcase 'keyup': case 'keydown':\n\t\t\t\t\t\tthis.listen (name, selector, function (evt)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (Rinn.indexOf(args, evt.keyCode.toString()) != -1)\n\t\t\t\t\t\t\t\treturn hdl (evt, args);\n\n\t\t\t\t\t\t\tevt.continuePropagation = true;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.listen (name, selector, hdl);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t/**\n\t**\tBinds all routes in the specified map to the Router object.\n\t**\n\t**\t\t\"route-path\": \"doSomething\"\t\t\t\t\t\tOn-Route\n\t**\t\t\"route-path\": function (evt, args) { }\t\t\tOn-Route\n\t**\t\t\"!route-path\": \"doSomething\"\t\t\t\t\tOn-UnRoute\n\t**\t\t\"!route-path\": function (evt, args) { }\t\t\tOn-UnRoute\n\t**\n\t**\t>> Element bindRoutes ();\n\t*/\n\tbindRoutes: function ()\n\t{\n\t\tif (!this.routes)\n\t\t\treturn;\n\n\t\tfor (let routeStr in this.routes)\n\t\t{\n\t\t\tlet route = routeStr[0] === '!' ? Router.getRoute(routeStr.substr(1)) : Router.getRoute(routeStr);\n\t\t\tlet handler = this.routes[routeStr];\n\n\t\t\tif (Rinn.typeOf(handler) === 'string')\n\t\t\t\thandler = this[handler];\n\n\t\t\tif (routeStr[0] === '!')\n\t\t\t\troute.addHandler(handler, true, this);\n\t\t\telse\n\t\t\t\troute.addHandler(handler, false, this);\n\t\t}\n\t},\n\n\t/**\n\t * Unbinds all routes added by bindRoutes.\n\t */\n\tunbindRoutes: function ()\n\t{\n\t\tif (!this.routes)\n\t\t\treturn;\n\n\t\tfor (let routeStr in this.routes)\n\t\t{\n\t\t\tlet route = routeStr[0] === '!' ? Router.getRoute(routeStr.substr(1)) : Router.getRoute(routeStr);\n\t\t\tlet handler = this.routes[routeStr];\n\n\t\t\tif (Rinn.typeOf(handler) === 'string')\n\t\t\t\thandler = this[handler];\n\n\t\t\tif (routeStr[0] === '!')\n\t\t\t\troute.removeHandler(handler, true, this);\n\t\t\telse\n\t\t\t\troute.removeHandler(handler, false, this);\n\t\t}\n\t},\n\n\t/**\n\t**\tExecutes the underlying event handler given an event and a selector. Called internally by listen().\n\t**\n\t**\t>> void _eventHandler (event evt, string selector, function handler);\n\t*/\n\t_eventHandler: function (evt, selector, handler)\n\t{\n\t\tif (evt.continuePropagation === false)\n\t\t\treturn;\n\n\t\tevt.continuePropagation = true;\n\t\tevt.source = evt.target;\n\n\t\tif (selector && selector instanceof HTMLElement)\n\t\t{\n\t\t\tif (evt.source === selector)\n\t\t\t{\n\t\t\t\tevt.continuePropagation = false;\n\n\t\t\t\tif (handler.call (this, evt, evt.detail) === true)\n\t\t\t\t\tevt.continuePropagation = true;\n\t\t\t}\n\t\t}\n\t\telse if (selector && selector != '*')\n\t\t{\n\t\t\tlet elems = this.querySelectorAll(selector);\n\n\t\t\twhile (evt.source !== this)\n\t\t\t{\n\t\t\t\tlet i = Rinn.indexOf (elems, evt.source, true);\n\t\t\t\tif (i !== -1)\n\t\t\t\t{\n\t\t\t\t\tevt.continuePropagation = false;\n\n\t\t\t\t\tif (handler.call (this, evt, evt.detail) === true)\n\t\t\t\t\t\tevt.continuePropagation = true;\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tevt.source = evt.source.parentElement;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tevt.continuePropagation = false;\n\n\t\t\tif (handler.call (this, evt, evt.detail) === true)\n\t\t\t\tevt.continuePropagation = true;\n\t\t}\n\n\t\tif (evt.continuePropagation === false)\n\t\t{\n\t\t\tevt.preventDefault();\n\t\t\tevt.stopPropagation();\n\t\t}\n\t},\n\n\t/**\n\t**\tListens for an event on elements matching the specified selector, returns an object with a single method `remove` used\n\t**\tto remove the listener when it is no longer needed.\n\t**\n\t**\t>> object listen (string eventName, string selector, function handler);\n\t**\t>> object listen (string eventName, function handler);\n\t*/\n\tlisten: function (eventName, selector, handler)\n\t{\n\t\tlet eventCatcher = false;\n\t\tlet eventImmediate = false;\n\n\t\tif (Rinn.typeOf(selector) == 'function')\n\t\t{\n\t\t\thandler = selector;\n\t\t\tselector = null;\n\t\t}\n\n\t\tif (eventName[eventName.length-1] == '!')\n\t\t{\n\t\t\teventName = eventName.substr(0, eventName.length-1);\n\t\t\teventCatcher = true;\n\t\t}\n\n\t\tif (eventName[0] == '!')\n\t\t{\n\t\t\teventName = eventName.substr(1);\n\t\t\teventImmediate = true;\n\t\t}\n\n\t\tlet callback0 = null;\n\t\tlet callback1 = null;\n\t\tlet self = this;\n\n\t\tthis.addEventListener (eventName, callback0 = (evt) =>\n\t\t{\n\t\t\tif (evt.continuePropagation === false)\n\t\t\t\treturn;\n\n\t\t\tif (!evt.firstCapture)\n\t\t\t{\n\t\t\t\tevt.firstCapture = this;\n\t\t\t\tevt.firstCaptureCount = 0;\n\t\t\t\tevt.queue = [];\n\t\t\t}\n\n\t\t\tif (evt.firstCapture === this)\n\t\t\t\tevt.firstCaptureCount++;\n\n\t\t\tif (eventCatcher == true)\n\t\t\t\tevt.queue.push([this, selector, handler]);\n\n\t\t\tif (eventImmediate == true)\n\t\t\t\tthis._eventHandler(evt, selector, handler);\n\t\t},\n\t\ttrue);\n\n\t\tthis.addEventListener (eventName, callback1 = (evt) =>\n\t\t{\n\t\t\tif (evt.continuePropagation === false)\n\t\t\t\treturn;\n\n\t\t\tif (eventCatcher != true && eventImmediate != true)\n\t\t\t\tthis._eventHandler(evt, selector, handler);\n\n\t\t\tif (evt.firstCapture === this && evt.continuePropagation !== false)\n\t\t\t{\n\t\t\t\tif (--evt.firstCaptureCount == 0)\n\t\t\t\t{\n\t\t\t\t\twhile (evt.queue.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet q = evt.queue.pop();\n\t\t\t\t\t\tq[0]._eventHandler(evt, q[1], q[2]);\n\t\t\t\t\t}\n\n\t\t\t\t\tevt.continuePropagation = false;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tfalse);\n\n\t\treturn {\n\t\t\tremoved: false,\n\t\t\tremove: function() {\n\t\t\t\tif (this.removed) return;\n\t\t\t\tthis.removed = true;\n\t\t\t\tself.removeEventListener(eventName, callback0, true);\n\t\t\t\tself.removeEventListener(eventName, callback1, false);\n\t\t\t}\n\t\t};\n\t},\n\n\t/**\n\t**\tCreates an event object for later dispatch.\n\t*/\n\tcreateEventObject: function(eventName, args, bubbles)\n\t{\n\t\tlet evt;\n\n\t\tif (eventName == 'click')\n\t\t\tevt = new MouseEvent(eventName, { bubbles: bubbles, detail: args });\n\t\telse\n\t\t\tevt = new CustomEvent (eventName, { bubbles: bubbles, detail: args });\n\n\t\treturn evt;\n\t},\n\n\t/**\n\t**\tDispatches a new event with the specified name and the given arguments.\n\t*/\n\tdispatch: function (eventName, args=null, bubbles=true)\n\t{\n\t\tlet propName = 'on' + eventName.toLowerCase();\n\t\tif (propName in this) {\n\t\t\tthis[propName] (args);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.dispatchEvent (this.createEventObject(eventName, args, bubbles));\n\t},\n\n\t/**\n\t**\tDispatches a new event on the specified element with the given name and arguments (uses `CustomEvent`).\n\t*/\n\tdispatchOn: function (elem, eventName, args=null, bubbles=true)\n\t{\n\t\telem.dispatchEvent (this.createEventObject(eventName, args, bubbles));\n\t},\n\n\t/**\n\t**\tSets the innerHTML property of the element and runs some post set-content tasks.\n\t**\n\t**\t>> void setInnerHTML (value);\n\t*/\n\tsetInnerHTML: function (value)\n\t{\n\t\tthis.readyLocked++;\n\t\tthis.innerHTML = value;\n\t\tthis.readyLocked--;\n\t},\n\n\t/**\n\t**\tCollects all watchers (data-watch, data-visible, data-attr, data-property), that depend on the model, should be invoked when the\n    **  structure of the element changed (added/removed children). This is automatically called when the setInnerHTML method is called.\n\t**\n\t**\tNote that for 3rd party libs that add children to this element (which could probably have a watcher) will possibly result in\n\t**\tduplication of the added elements when compiling the innerHTML template. To prevent this add the 'pseudo' CSS class to any\n\t**\telement that should not be added to the HTML template.\n\t**\n\t**\t>> void collectWatchers ();\n\t*/\n\tcollectWatchers: function ()\n\t{\n\t\tlet self = this;\n\t\tlet modified = false;\n\t\tlet list;\n\n\t\tif (!this.isRoot) return;\n\n\t\tlet _list_watch_length = this._list_watch.length;\n\t\tlet _list_visible_length = this._list_visible.length;\n\t\tlet _list_attr_length = this._list_attr.length;\n\t\tlet _list_property_length = this._list_property.length;\n\n\t\t/* *** */\n\t\tlist = this.querySelectorAll('[data-watch]');\n\t\tfor (let i = 0; i < list.length; i++)\n\t\t{\n\t\t\tfor (let j of list[i].querySelectorAll('.pseudo'))\n\t\t\t\tj.remove();\n\n\t\t\tlist[i]._template = Template.compile(list[i].innerHTML);\n\t\t\tlist[i]._watch = new RegExp('^(' + list[i].dataset.watch + ')$');\n\t\t\tlist[i].innerHTML = '';\n\n\t\t\tlist[i].removeAttribute('data-watch');\n\t\t\tthis._list_watch.push(list[i]);\n\t\t}\n\n\t\tif ('selfWatch' in this.dataset)\n\t\t{\n\t\t\tfor (let j of this.querySelectorAll('.pseudo'))\n\t\t\t\tj.remove();\n\n\t\t\tthis._template = Template.compile(this.innerHTML);\n\t\t\tthis._watch = new RegExp('^(' + this.dataset.selfWatch + ')$');\n\t\t\tthis.innerHTML = '';\n\n\t\t\tthis.removeAttribute('data-self-watch');\n\t\t\tthis._list_watch.push(this);\n\t\t}\n\n\t\t/* *** */\n\t\tlist = this.querySelectorAll('[data-visible]');\n\t\tfor (let i = 0; i < list.length; i++)\n\t\t{\n\t\t\tlist[i]._visible = Template.compile(list[i].dataset.visible);\n\n\t\t\tlist[i].removeAttribute('data-visible');\n\t\t\tthis._list_visible.push(list[i]);\n\t\t}\n\n\t\tif ('selfVisible' in this.dataset)\n\t\t{\n\t\t\tthis._visible = Template.compile(this.dataset.selfVisible);\n\n\t\t\tthis.removeAttribute('data-self-visible');\n\t\t\tthis._list_visible.push(this);\n\t\t}\n\n\t\t/* *** */\n\t\tlist = this.querySelectorAll('[data-attr]');\n\t\tfor (let i = 0; i < list.length; i++)\n\t\t{\n            list[i]._attr = [];\n\n            for (let j of list[i].dataset.attr.split(';'))\n            {\n                j = j.split(':');\n                if (j.length != 2) continue;\n\n                list[i]._attr.push({\n                    name: j[0].trim(),\n                    value: Template.compile(j[1].trim())\n                });\n            }\n\n\t\t\tlist[i].removeAttribute('data-attr');\n\t\t\tthis._list_attr.push(list[i]);\n\t\t}\n\n\t\tif ('selfAttr' in this.dataset)\n\t\t{\n            this._attr = [];\n\n            for (let j of this.dataset.selfAttr.split(';'))\n            {\n                j = j.split(':');\n                if (j.length != 2) continue;\n\n                this._attr.push({\n                    name: j[0].trim(),\n                    value: Template.compile(j[1].trim())\n                });\n            }\n\n\t\t\tthis.removeAttribute('data-self-attr');\n\t\t\tthis._list_attr.push(this);\n\t\t}\n\n\t\t/* *** */\n\t\tlist = this.querySelectorAll('[data-property]');\n\t\tfor (let i = 0; i < list.length; i++)\n\t\t{\n\t\t\tlist[i].onchange = list[i].onblur = function()\n\t\t\t{\n\t\t\t\tswitch (this.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'radio':\n\t\t\t\t\t\tif (this.checked) self.getModel().set(this.name, this.value);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\tself.getModel().set(this.name, this.checked ? '1' : '0');\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'field':\n\t\t\t\t\t\tself.getModel().set(this.name, this.getValue());\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tself.getModel().set(this.name, this.value);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (list[i].tagName == 'SELECT')\n\t\t\t{\n\t\t\t\tlist[i].onmouseup = function()\n\t\t\t\t{\n\t\t\t\t\tself.getModel().set(this.name, this.value);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tlist[i].name = list[i].dataset.property;\n\n\t\t\tlist[i].removeAttribute('data-property');\n\t\t\tthis._list_property.push(list[i]);\n\t\t}\n\n\t\tif ('selfProperty' in this.dataset)\n\t\t{\n\t\t\tthis.onchange = this.onblur = function()\n\t\t\t{\n\t\t\t\tswitch (this.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'radio':\n\t\t\t\t\t\tif (this.checked) self.getModel().set(this.name, this.value);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\tself.getModel().set(this.name, this.checked ? '1' : '0');\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'field':\n\t\t\t\t\t\tself.getModel().set(this.name, this.getValue());\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tself.getModel().set(this.name, this.value);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (this.tagName == 'SELECT')\n\t\t\t{\n\t\t\t\tthis.onmouseup = function()\n\t\t\t\t{\n\t\t\t\t\tself.getModel().set(this.name, this.value);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tthis.name = this.dataset.selfProperty;\n\n\t\t\tthis.removeAttribute('data-self-property');\n\t\t\tthis._list_property.push(this);\n\t\t}\n\n\t\t/* *** */\n\t\tthis._list_watch = this._list_watch.filter(i => i.parentElement != null);\n\t\tif (_list_watch_length != this._list_watch.length) modified = true;\n\n\t\tthis._list_visible = this._list_visible.filter(i => i.parentElement != null);\n\t\tif (_list_visible_length != this._list_visible.length) modified = true;\n\n        this._list_attr = this._list_attr.filter(i => i.parentElement != null);\n\t\tif (_list_attr_length != this._list_attr.length) modified = true;\n\n\t\tthis._list_property = this._list_property.filter(i => i.parentElement != null);\n\t\tif (_list_property_length != this._list_property.length) modified = true;\n\n\t\tif (this.model != null && modified)\n\t\t\tthis.model.setNamespace(this.eid).update(true).setNamespace(null);\n\t},\n\n\t/**\n\t**\tExecuted when the element is created and yet not attached to the DOM tree.\n\t*/\n\tonCreated: function()\n\t{\n\t},\n\n\t/**\n\t * Executed when the element is attached to the DOM tree.\n\t */\n\telementConnected: function()\n\t{\n\t\tthis.bindRoutes();\n\t\tthis.onConnected();\n\t},\n\n\t/**\n\t * Executed when the element is no longer a part of the DOM tree.\n\t */\n\telementDisconnected: function()\n\t{\n\t\tthis.unbindRoutes();\n\t},\n\n\t/**\n\t**\tExecuted when the element is attached to the DOM tree.\n\t*/\n\tonConnected: function()\n\t{\n        if (this.onconnected) this.onconnected(this);\n\t},\n\n\t/**\n\t**\tExecuted when the element is no longer a part of the DOM tree.\n\t*/\n\tonDisconnected: function()\n\t{\n        if (this.ondisconnected) this.ondisconnected(this);\n\t},\n\n\t/**\n\t**\tExecuted on the root element when a child element has `data-ref` attribute and it was added to it.\n\t*/\n\tonRefAdded: function (name, element)\n\t{\n\t},\n\n\t/**\n\t**\tExecuted on the root element when a child element has `data-ref` attribute and it was removed from it.\n\t*/\n\tonRefRemoved: function (name, element)\n\t{\n\t},\n\n\t/**\n\t**\tEvent handler invoked when the model has changed, executed before onModelChanged() to update internal dependencies,\n\t**\tshould not be overriden or elements watching the model will not be updated.\n\t**\n\t**\t>> void onModelPreChanged (evt, args);\n\t*/\n\tonModelPreChanged: function (evt, args)\n\t{\n\t\tlet data = this.getModel().get();\n\n\t\tfor (let i = 0; i < this._list_watch.length; i++)\n\t\t{\n\t\t\tfor (let j of args.fields)\n\t\t\t{\n\t\t\t\tif (!this._list_watch[i]._watch.test(j))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tthis._list_watch[i].innerHTML = this._list_watch[i]._template(data);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < this._list_visible.length; i++)\n\t\t{\n\t\t\tif (!!this._list_visible[i]._visible(data, 'arg'))\n\t\t\t\tthis._list_visible[i].style.removeProperty('display');\n\t\t\telse\n\t\t\t\tthis._list_visible[i].style.setProperty('display', 'none', 'important');\n\t\t}\n\n\t\tfor (let i = 0; i < this._list_attr.length; i++)\n\t\t{\n            for (let j of this._list_attr[i]._attr)\n                this._list_attr[i][j.name] = j.value(data, 'arg');\n\t\t}\n\n\t\tthis.onModelChanged(evt, args);\n\t},\n\n\t/**\n\t**\tEvent handler invoked when the model has changed.\n\t*/\n\tonModelChanged: function (evt, args) // @override\n\t{\n\t},\n\n\t/**\n\t**\tEvent handler invoked when a property of the model is changing. Fields `name` and `value` can be found in the `args` object.\n\t*/\n\tonModelPropertyChanging: function (evt, args) // @override\n\t{\n\t},\n\n\t/**\n\t**\tEvent handler invoked when a property of the model has changed, executed before onModelPropertyChanged() to update internal\n\t**\tdependencies. Automatically triggers internal events named `propertyChanged.<propertyName>` and `propertyChanged`.\n\t**\tShould not be overriden or elements depending on the property will not be updated.\n\t*/\n\tonModelPropertyPreChanged: function (evt, args)\n\t{\n\t\tfor (let i = 0; i < this._list_property.length; i++)\n\t\t{\n\t\t\tif (this._list_property[i].name == args.name)\n\t\t\t{\n\t\t\t\tlet trigger = true;\n\n\t\t\t\tswitch (this._list_property[i].type)\n\t\t\t\t{\n\t\t\t\t\tcase 'radio':\n\t\t\t\t\t\tif (this._list_property[i].value != args.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis._list_property[i].parentElement.classList.remove('active');\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._list_property[i].checked = true;\n\t\t\t\t\t\tthis._list_property[i].parentElement.classList.add('active');\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\tif (~~args.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis._list_property[i].checked = true;\n\t\t\t\t\t\t\tthis._list_property[i].parentElement.classList.add('active');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis._list_property[i].checked = false;\n\t\t\t\t\t\t\tthis._list_property[i].parentElement.classList.remove('active');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'field':\n\t\t\t\t\t\tthis._list_property[i].val = this._list_property[i].dataset.value = args.value;\t\n\t\t\t\t\t\tthis._list_property[i].setValue (args.value);\n\t\t\t\t\t\ttrigger = false;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis._list_property[i].value = args.value;\n\t\t\t\t\t\tthis._list_property[i].val = this._list_property[i].dataset.value = args.value;\t\n\n\t\t\t\t\t\tif (this._list_property[i].value != args.value)\n\t\t\t\t\t\t\ttrigger = false;\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (trigger && this._list_property[i].onchange)\n\t\t\t\t\tthis._list_property[i].onchange();\n\t\t\t}\n\t\t}\n\n\t\tthis.dispatch ('propertyChanged.' + args.name, args, false);\n\t\tthis.dispatch ('propertyChanged', args, false);\n\n\t\tthis.onModelPropertyChanged(evt, args);\n\t},\n\n\t/**\n\t**\tEvent handler invoked when a property of the model has changed.\n\t*/\n\tonModelPropertyChanged: function (evt, args) // @override\n\t{\n\t},\n\n\t/**\n\t**\tEvent handler invoked when a property of the model is removed. Field `name` can be found in the `args` object.\n\t*/\n\tonModelPropertyRemoved: function (evt, args) // @override\n\t{\n\t},\n\n\t/*\n\t**\tRuns the following preparation procedures on the specified prototype:\n\t**\t\t- All functions named 'event <event-name> [event-selector]' will be moved to the 'events' map.\n\t**\t\t- All functions named 'route <route-path>' will be moved to the 'routes' map.\n\t**\n\t**\t>> void preparePrototype (object proto);\n\t*/\n\tpreparePrototype: function (proto)\n\t{\n\t\tif (proto.__prototypePrepared === true)\n\t\t\treturn;\n\n\t\tproto.__prototypePrepared = true;\n\n\t\tif (!proto.hasOwnProperty('events') || !proto.events)\n\t\t\tproto.events = { };\n\n\t\tif (!proto.hasOwnProperty('routes') || !proto.routes)\n\t\t\tproto.routes = { };\n\n\t\tfor (let i in proto)\n\t\t{\n\t\t\tif (i.startsWith('event '))\n\t\t\t{\n\t\t\t\tproto.events[i.substr(6)] = proto[i];\n\t\t\t\tdelete proto[i];\n\t\t\t}\n\t\t\telse if (i.startsWith('route '))\n\t\t\t{\n\t\t\t\tproto.routes[i.substr(6)] = proto[i];\n\t\t\t\tdelete proto[i];\n\t\t\t}\n\t\t}\n\t},\n\n\t/*\n\t**\tRegisters a new custom element with the specified name. Extra functionality can be added with one or more prototypes, by default\n\t**\tall elements also get the `Element` prototype. Note that the final prototypes of all registered elements are stored, and if you want\n\t**\tto inherit another element's prototype just provide its name (string) in the protos argument list.\n\t**\n\t**\t>> class register (string name, ...(object|string) protos);\n\t*/\n\tregister: function (name, ...protos)\n\t{\n\t\tconst newElement = class extends HTMLElement\n\t\t{\n\t\t\tconstructor()\n\t\t\t{\n\t\t\t\tsuper();\n\t\t\t\tthis.invokeConstructor = true;\n\n\t\t\t\tif (Element.debug)\n\t\t\t\t\tconsole.log('CREATED ' + this.tagName);\n\n\t\t\t\tthis._super = { };\n\n\t\t\t\tfor (let i of Object.entries(this.constructor.prototype._super))\n\t\t\t\t{\n\t\t\t\t\tthis._super[i[0]] = { };\n\n\t\t\t\t\tfor (let j of Object.entries(i[1])) {\n\t\t\t\t\t\tthis._super[i[0]][j[0]] = j[1].bind(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.onCreated();\n\t\t\t}\n\n\t\t\tfindRoot (srcElement)\n\t\t\t{\n\t\t\t\tlet elem = srcElement ? srcElement : this.parentElement;\n\n\t\t\t\twhile (elem != null)\n\t\t\t\t{\n\t\t\t\t\tif ('isRoot' in elem && elem.isRoot === true)\n\t\t\t\t\t\treturn elem;\n\n\t\t\t\t\telem = elem.parentElement;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfindCustomParent (srcElement)\n\t\t\t{\n\t\t\t\tlet elem = srcElement ? srcElement.parentElement : this.parentElement;\n\n\t\t\t\twhile (elem != null)\n\t\t\t\t{\n\t\t\t\t\tif (elem.tagName.indexOf('-') !== -1)\n\t\t\t\t\t\treturn elem;\n\n\t\t\t\t\telem = elem.parentElement;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconnectReference (root=null, flags=255)\n\t\t\t{\n\t\t\t\tif (!this.root && (flags & 1) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (root == null) root = this.findRoot();\n\t\t\t\t\tif (root != null)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.dataset.ref)\n\t\t\t\t\t\t\troot[this.dataset.ref] = this;\n\n\t\t\t\t\t\tthis.root = root;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconnectedCallback ()\n\t\t\t{\n\t\t\t\tthis.connectReference(null, 1);\n\n\t\t\t\tif (this.invokeConstructor)\n\t\t\t\t{\n\t\t\t\t\tthis.invokeConstructor = false;\n\t\t\t\t\tthis.__ctor();\n\t\t\t\t}\n\n\t\t\t\tthis.connectReference(null, 2);\n\t\t\t\tthis.elementConnected();\n\n\t\t\t\tif (this.dataset.xref)\n\t\t\t\t\tglobalThis[this.dataset.xref] = this;\n\t\t\t}\n\n\t\t\tdisconnectedCallback()\n\t\t\t{\n\t\t\t\tif (this.root)\n\t\t\t\t{\n\t\t\t\t\tif (this.dataset.ref)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.root.onRefRemoved (this.dataset.ref, this);\n\n\t\t\t\t\t\tdelete this.root[this.dataset.ref];\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.root = null;\n\t\t\t\t}\n\n\t\t\t\tthis.elementDisconnected();\n\n\t\t\t\tif (this.dataset.xref)\n\t\t\t\t\tdelete globalThis[this.dataset.xref];\n\t\t\t}\n\t\t};\n\n\t\tRinn.override (newElement.prototype, Element);\n\n\t\tconst proto = { };\n\t\tconst _super = { };\n\t\tconst events = Rinn.clone(Element.events);\n\n\t\tlet __init = true;\n\t\tlet __ready = true;\n\t\tlet __rready = true;\n\t\tlet __check;\n\n\t\tfor (let i = 0; i < protos.length; i++)\n\t\t{\n\t\t\tif (!protos[i]) continue;\n\n\t\t\tif (Rinn.typeOf(protos[i]) == 'string')\n\t\t\t{\n\t\t\t\tconst name = protos[i];\n\n\t\t\t\tprotos[i] = elementPrototypes[name];\n\t\t\t\tif (!protos[i]) continue;\n\n\t\t\t\t_super[name] = { };\n\n\t\t\t\tfor (let f in protos[i])\n\t\t\t\t{\n\t\t\t\t\tif (Rinn.typeOf(protos[i][f]) != 'function')\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t_super[name][f] = protos[i][f];\n\t\t\t\t}\n\n\t\t\t\t__init = false;\n\t\t\t\t__ready = false;\n\t\t\t\t__rready = false;\n\t\t\t\t__check = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tElement.preparePrototype(protos[i]);\n\t\t\t\t__check = true;\n\t\t\t}\n\n\t\t\tif ('_super' in protos[i])\n\t\t\t\tRinn.override (_super, protos[i]._super);\n\n\t\t\tif ('events' in protos[i])\n\t\t\t\tRinn.override (events, protos[i].events);\n\n\t\t\tRinn.override (newElement.prototype, protos[i]);\n\t\t\tRinn.override (proto, protos[i]);\n\n\t\t\tif (__check)\n\t\t\t{\n\t\t\t\tif (!__init && 'init' in protos[i]) __init = true;\n\t\t\t\tif (!__ready && 'ready' in protos[i]) __ready = true;\n\t\t\t\tif (!__rready && 'rready' in protos[i]) __rready = true;\n\t\t\t}\n\t\t}\n\n\t\tlet dummy = function(){};\n\n\t\tif (!__init)\n\t\t{\n\t\t\tnewElement.prototype.init = dummy;\n\t\t\tproto.init = dummy;\n\t\t}\n\n\t\tif (!__ready)\n\t\t{\n\t\t\tnewElement.prototype.ready = dummy;\n\t\t\tproto.ready = dummy;\n\t\t}\n\n\t\tif (!__rready)\n\t\t{\n\t\t\tnewElement.prototype.rready = dummy;\n\t\t\tproto.rready = dummy;\n\t\t}\n\n\t\tnewElement.prototype._super = _super;\n\t\tnewElement.prototype.events = events;\n\n\t\tproto._super = _super;\n\t\tproto.events = events;\n\n\t\tcustomElements.define (name, newElement);\n\n\t\telementPrototypes[name] = proto;\n\t\telementClasses[name] = newElement;\n\n\t\treturn newElement;\n\t},\n\n\t/*\n\t**\tExpands an already created custom element with the specified prototype(s).\n\t**\n\t**\t>> void expand (string elementName, ...object protos);\n\t*/\n\texpand: function (name, ...protos)\n\t{\n\t\tif (!(name in elementPrototypes))\n\t\t\treturn;\n\n\t\tconst self = elementPrototypes[name];\n\t\tconst elem = elementClasses[name];\n\n\t\tconst _super = self._super;\n\t\tconst events = self.events;\n\n\t\tfor (let proto of protos)\n\t\t{\n\t\t\tElement.preparePrototype(proto);\n\n\t\t\tif ('_super' in proto)\n\t\t\t\tRinn.override (_super, proto._super);\n\n\t\t\tif ('events' in proto)\n\t\t\t\tRinn.override (events, proto.events);\n\n\t\t\tRinn.override (elem.prototype, proto);\n\t\t\tRinn.override (self, proto);\n\t\t}\n\n\t\telem.prototype._super = _super;\n\t\telem.prototype.events = events;\n\n\t\tself._super = _super;\n\t\tself.events = events;\n\t},\n\n\t/*\n\t**\tAppends a hook to a function of a custom element.\n\t*/\n\thookAppend: function (name, functionName, newFunction)\n\t{\n\t\tif (!(name in elementPrototypes))\n\t\t\treturn;\n\n\t\tlet hook1 = Rinn.hookAppend(elementPrototypes[name], functionName, newFunction);\n\t\tlet hook2 = Rinn.hookAppend(elementClasses[name].prototype, functionName, newFunction);\n\n\t\treturn { \n\t\t\tunhook: function() {\n\t\t\t\thook1.unhook();\n\t\t\t\thook2.unhook();\n\t\t\t}\n\t\t};\n\t},\n\n\t/*\n\t**\tPrepends a hook to a function of a custom element.\n\t*/\n\thookPrepend: function (name, functionName, newFunction)\n\t{\n\t\tif (!(name in elementPrototypes))\n\t\t\treturn;\n\n\t\tlet hook1 = Rinn.hookPrepend(elementPrototypes[name], functionName, newFunction);\n\t\tlet hook2 = Rinn.hookPrepend(elementClasses[name].prototype, functionName, newFunction);\n\n\t\treturn { \n\t\t\tunhook: function() {\n\t\t\t\thook1.unhook();\n\t\t\t\thook2.unhook();\n\t\t\t}\n\t\t};\n\t},\n\n\t/**\n\t**\tBuilt-in action handlers.\n\t*/\n\n\t/**\n\t**\t:toggleClass <className> [<selector>]\n\t**\n\t**\tToggles a CSS class on the element.\n\t*/\n\t':toggleClass': function (args, evt)\n\t{\n\t\tlet elem = evt.source;\n\n\t\tif ('2' in args)\n\t\t\telem = document.querySelector(args[2]);\n\n\t\tif (!elem) return;\n\n\t\tif (elem.classList.contains(args[1]))\n\t\t\telem.classList.remove(args[1]);\n\t\telse\n\t\t\telem.classList.add(args[1]);\n\t},\n\n\t/**\n\t**\t:setClass <className> [<selector>]\n\t**\n\t**\tSets a CSS class on the element.\n\t*/\n\t':setClass': function (args, evt)\n\t{\n\t\tlet elem = evt.source;\n\n\t\tif ('2' in args)\n\t\t\telem = document.querySelector(args[2]);\n\n\t\tif (!elem) return;\n\n\t\telem.classList.add(args[1]);\n\t},\n\n\t/**\n\t**\t:volatileClass <className> [<selector>]\n\t**\n\t**\tAdds the CSS class to the element and any click outside will cause it to be removed.\n\t*/\n\t':volatileClass': function (args, evt)\n\t{\n\t\tlet elem = evt.source;\n\n\t\tif ('2' in args)\n\t\t\telem = document.querySelector(args[2]);\n\n\t\tif (!elem) return;\n\n\t\telem.classList.add(args[1]);\n\n\t\tlet fn = () => {\n\t\t\twindow.removeEventListener('click', fn, true);\n\t\t\telem.classList.remove(args[1]);\n\t\t};\n\n\t\twindow.addEventListener('click', fn, true);\n\t},\n\n\t/**\n\t**\t:toggleClassUnique <className> <parentSelector> <childSelector>\n\t**\n\t**\tToggles a CSS class on the element and only one element in the selected parent can have the class.\n\t*/\n\t':toggleClassUnique': function (args, evt)\n\t{\n\t\tlet elem = evt.source;\n\t\tif (!elem) return;\n\n\t\tif (elem.classList.contains(args[1]))\n\t\t{\n\t\t\telem.classList.remove(args[1]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\telem.querySelectorParent(args[2]).querySelectorAll(args[3]).forEach(elem => elem.classList.remove(args[1]));\n\t\t\telem.classList.add(args[1]);\n\t\t}\n\t},\n\n\t/**\n\t**\t:setClassUnique <className> <parentSelector> <childSelector>\n\t**\n\t**\tSets a CSS class on the element and only that element in the selected parent can have the class.\n\t*/\n\t':setClassUnique': function (args, evt)\n\t{\n\t\tlet elem = evt.source;\n\t\tif (!elem) return;\n\n\t\telem.querySelectorParent(args[2]).querySelectorAll(args[3]).forEach(elem => elem.classList.remove(args[1]));\n\t\telem.classList.add(args[1]);\n\t}\n};\n\nElement.debug = false;\n\nElement.register('r-elem', {\n});\n\nElement.register ('r-dom-probe', {\n});\n\n/* ****************************************** */\n\n/**\n * Finds the parent element given a selector.\n */\nHTMLElement.prototype.querySelectorParent = function (selector)\n{\n\tlet elem = this;\n\n\twhile (elem != null)\n\t{\n\t\tif (elem.matches(selector))\n\t\t\tbreak;\n\n\t\telem = elem.parentElement;\n\t}\n\n\treturn elem;\n};\n\nexport default Element;\n","\r\nimport base64 from 'base-64';\r\n\r\n/**\r\n * API interface utility functions.\r\n */\r\n\r\nconst Api =\r\n{\r\n\t/**\r\n\t * Flags constants.\r\n\t */\r\n\tREQUEST_PACKAGE_SUPPORTED:\t0x01,\r\n\tREQ64_SUPPORTED: \t\t\t0x02,\r\n\tJSON_RESPONSE_SUPPORTED: \t0x04,\r\n\tXML_RESPONSE_SUPPORTED: \t0x08,\r\n\tINCLUDE_CREDENTIALS:\t\t0x10,\r\n\tUNIQUE_STAMP:\t\t\t\t0x20,\r\n\tDISABLE_CORS:\t\t\t\t0x40,\r\n\r\n\t/**\r\n\t * Target URL for all the API requests. Set by calling `setEndPoint`.\r\n\t */\r\n\tapiUrl: \"/api\",\r\n\r\n\t/**\r\n\t * Capabilities flag.\r\n\t */\r\n\tflags: 0x01 | 0x02 | 0x04 | 0x08 | 0x10 | 0x20,\r\n\r\n\t/**\r\n\t * Indicates if all request data will be packed into a req64 parameter instead of individual fields.\r\n\t */\r\n\tuseReq64: false,\r\n\r\n\t/**\r\n\t * Number of retries to execute each API call before giving up and invoking error handlers.\r\n\t */\r\n\tretries: 0,\r\n\r\n\t/**\r\n\t * Headers for the request.\r\n\t */\r\n\theaders: { },\r\n\r\n\t/**\r\n\t * Level of the current request. Used to detect nested requests.\r\n\t */\r\n\t_requestLevel: 0,\r\n\r\n\t/**\r\n\t * Indicates if all API calls should be bundled in a request package. Activated by calling the packageBegin() function and finished with packageEnd().\r\n\t */\r\n\t_requestPackage: 0,\r\n\r\n\t/**\r\n\t * When in package-mode, this contains the package data to be sent upon a call to packageEnd().\r\n\t */\r\n\t_packageData: [],\r\n\r\n\t/**\r\n\t * Sets the API end-point URL address.\r\n\t */\r\n\tsetEndPoint: function (apiUrl, flags=null)\r\n\t{\r\n\t\tthis.apiUrl = apiUrl;\r\n\t\tthis.flags = flags ?? this.flags;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * Overridable filter that processes the response from the server and returns true if it was successful. The `res` parameter indicates the response data, and `req` the request data.\r\n\t */\r\n\tresponseFilter: function (res, req)\r\n\t{\r\n\t\treturn true;\r\n\t},\r\n\r\n\t/**\r\n\t * Starts \"package-mode\" (using the `rpkg` field). Any API calls after this will be bundled together.\r\n\t */\r\n\tpackageBegin: function ()\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t\treturn;\r\n\r\n\t\tthis._requestPackage++;\r\n\t},\r\n\r\n\t/**\r\n\t * Finishes \"package-mode\" and a single API request with the currently constructed package will be sent.\r\n\t */\r\n\tpackageEnd: function (callback)\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t\treturn;\r\n\r\n\t\tif (!this._requestPackage)\r\n\t\t\treturn;\r\n\r\n\t\tif (--this._requestPackage)\r\n\t\t\treturn;\r\n\r\n\t\tthis.packageSend(callback);\r\n\t},\r\n\r\n\t/**\r\n\t * Starts package-mode, executes the callback and finishes package-mode. Therefore any requests made by the callback will be packed together.\r\n\t */\r\n\tbatch: function (callback, responseCallback=null)\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t{\r\n\t\t\tcallback();\r\n\t\t\tif (responseCallback) responseCallback();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.packageBegin();\r\n\t\tcallback();\r\n\t\tthis.packageEnd(responseCallback);\r\n\t},\r\n\r\n\t/**\r\n\t * Sends a single API request with the currently constructed package and maintains package-mode.\r\n\t */\r\n\tpackageSend: function (callback)\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t\treturn;\r\n\r\n\t\tif (!this._packageData.length)\r\n\t\t\treturn;\r\n\r\n\t\tlet _packageData = this._packageData;\r\n\t\tthis._packageData = [];\r\n\r\n\t\tvar rpkg = \"\";\r\n\r\n\t\tfor (var i = 0; i < _packageData.length; i++)\r\n\t\t\trpkg += \"r\"+i+\",\"+base64.encode(this.encodeParams(_packageData[i][2]))+\";\";\r\n\r\n\t\tthis._showProgress();\r\n\r\n\t\tthis.apiCall (\r\n\t\t\t{ rpkg: rpkg },\r\n\r\n\t\t\t(res, req) =>\r\n\t\t\t{\r\n\t\t\t\tthis._hideProgress();\r\n\r\n\t\t\t\tfor (let i = 0; i < _packageData.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar response = res[\"r\"+i];\r\n\t\t\t\t\t\tif (!response)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (_packageData[i][1] != null) _packageData[i][1] (_packageData[i][2]);\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (_packageData[i][0] != null)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (this.responseFilter (response, _packageData[i][2]))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t_packageData[i][0] (response, _packageData[i][2]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (e) {\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (callback) callback();\r\n\t\t\t},\r\n\r\n\t\t\t(req) =>\r\n\t\t\t{\r\n\t\t\t\tthis._hideProgress();\r\n\r\n\t\t\t\tfor (let i = 0; i < _packageData.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (_packageData[i][1] != null) _packageData[i][1] (_packageData[i][2]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t},\r\n\r\n\t/**\r\n\t * Adds CSS class 'busy' to the HTML root element, works only if running inside a browser.\r\n\t */\r\n\t_showProgress: function ()\r\n\t{\r\n\t\tif ('document' in global) {\r\n\t\t\tthis._requestLevel++;\r\n\t\t\tif (this._requestLevel > 0) global.document.documentElement.classList.add('busy');\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Removes the 'busy' CSS class from the HTML element.\r\n\t */\r\n\t_hideProgress: function ()\r\n\t{\r\n\t\tif ('document' in global)\r\n\t\t{\r\n\t\t\tthis._requestLevel--;\r\n\t\t\tif (this._requestLevel) return;\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (this._requestLevel === 0)\r\n\t\t\t\t\tglobal.document.documentElement.classList.remove('busy');\r\n\t\t\t}, 250);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Sets an HTTP header.\r\n\t */\r\n\theader: function (name, value)\r\n\t{\r\n\t\tif (value === null)\r\n\t\t\tdelete this.headers[name];\r\n\t\telse\r\n\t\t\tthis.headers[name] = value;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * Returns a parameter string for a GET request given an object with fields.\r\n\t */\r\n\tencodeParams: function (obj)\r\n\t{\r\n\t\tlet s = [];\r\n\r\n\t\tif (obj instanceof FormData)\r\n\t\t{\r\n\t\t\tfor (let i of obj.entries())\r\n\t\t\t\ts.push(encodeURIComponent(i[0]) + '=' + encodeURIComponent(i[1]));\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tfor (let i in obj)\r\n\t\t\t\ts.push(encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]));\r\n\t\t}\r\n\r\n\t\treturn s.join('&');\r\n\t},\r\n\r\n\t/**\r\n\t * Returns a URL given a relative or absolute URL.\r\n\t */\r\n\tgetUrl: function (url)\r\n\t{\r\n\t\tif (url.indexOf('//') !== -1)\r\n\t\t\treturn url;\r\n\r\n\t\treturn this.apiUrl + url;\r\n\t},\r\n\r\n\t/**\r\n\t * Appends a parameter to the URL.\r\n\t */\r\n\tappendParam: function (url, param)\r\n\t{\r\n\t\treturn url + (url.indexOf('?') == -1 ? '?' : '&') + param;\r\n\t},\r\n\r\n\t/**\r\n\t * Executes an API call to the URL stored in the `apiUrl` property. By default `httpMethod` is \"auto\", which will determine the best depending on the data to\r\n\t * be sent. Any connection error will be reported to the `failure` callback, and similarly any success to the `success` callback. The `params` object can be\r\n\t * a FormData object or just a regular object.\r\n\t */\r\n\tapiCall: function (params, success, failure, httpMethod=null, retries=null, relativeUrl='')\r\n\t{\r\n\t\tlet url = this.getUrl(relativeUrl);\r\n\r\n\t\tif (this.flags & Api.UNIQUE_STAMP)\r\n\t\t\turl = this.appendParam(url, '_='+Date.now());\r\n\r\n\t\thttpMethod = httpMethod ? httpMethod.toUpperCase() : null;\r\n\t\tif (httpMethod != 'GET' && httpMethod != 'POST')\r\n\t\t\thttpMethod = 'auto';\r\n\r\n\t\tif (retries === null)\r\n\t\t\tretries = this.retries;\r\n\r\n\t\tif (this._requestPackage && (this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t{\r\n\t\t\tif (!(params instanceof FormData))\r\n\t\t\t\tparams = {...params};\r\n\r\n\t\t\tthis._packageData.push([success, failure, params]);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._showProgress();\r\n\r\n\t\tlet data = params;\r\n\r\n\t\tlet options =\r\n\t\t{\r\n\t\t\tmode: this.flags & Api.DISABLE_CORS ? 'no-cors' : 'cors',\r\n\t\t\theaders: {\r\n\t\t\t\t'Accept': 'text/html,application/xhtml+xml,application/xml,application/json;q=0.9',\r\n\t\t\t\t...this.headers\r\n\t\t\t},\r\n\t\t\tmethod: httpMethod,\r\n\t\t\tbody: null,\r\n\t\t\tmultipart: false\r\n\t\t};\r\n\r\n\t\tif (this.flags & Api.INCLUDE_CREDENTIALS)\r\n\t\t\toptions.credentials = 'include';\r\n\r\n\t\tif (typeof(data) !== 'string' && !(data instanceof Blob))\r\n\t\t{\r\n\t\t\tif (!(data instanceof FormData))\r\n\t\t\t{\r\n\t\t\t\tdata = new FormData();\r\n\r\n\t\t\t\tfor (let i in params)\r\n\t\t\t\t{\r\n\t\t\t\t\tif ((params[i] instanceof File) || (params[i] instanceof Blob))\r\n\t\t\t\t\t\tdata.append(i, params[i], params[i].name);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tdata.append(i, params[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i of data.entries())\r\n\t\t\t{\r\n\t\t\t\tif ((i[1] instanceof File) || (i[1] instanceof Blob))\r\n\t\t\t\t{\r\n\t\t\t\t\toptions.method = 'POST';\r\n\t\t\t\t\toptions.multipart = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.useReq64 && (this.flags & Api.REQ64_SUPPORTED) && !options.multipart)\r\n\t\t\t{\r\n\t\t\t\tlet tmp = new FormData();\r\n\t\t\t\ttmp.append('req64', base64.encode(this.encodeParams(data)));\r\n\t\t\t\tdata = tmp;\r\n\t\t\t}\r\n\r\n\t\t\tif (options.method == 'auto')\r\n\t\t\t{\r\n\t\t\t\tlet l = 0;\r\n\r\n\t\t\t\toptions.method = 'GET';\r\n\r\n\t\t\t\tfor (let i of data.entries())\r\n\t\t\t\t{\r\n\t\t\t\t\tl += i[0].length + i[1].length + 2;\r\n\r\n\t\t\t\t\tif (l > 960)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toptions.method = 'POST';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\r\n\t\t\t}\r\n\r\n\t\t\tif (options.method == 'GET')\r\n\t\t\t{\r\n\t\t\t\turl = this.appendParam(url, this.encodeParams(data));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif (!options.multipart)\r\n\t\t\t\t{\r\n\t\t\t\t\toptions.headers['Content-Type'] = 'application/x-www-form-urlencoded';\r\n\t\t\t\t\toptions.body = this.encodeParams(data);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\toptions.body = data;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif (typeof(data) === 'string')\r\n\t\t\t{\r\n\t\t\t\tif (data[0] === '<')\r\n\t\t\t\t{\r\n\t\t\t\t\tif (data.endsWith('</soap:Envelope>'))\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/soap+xml';\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/xml';\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tif (data[0] === '{' || data[0] === '[')\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/json';\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/octet-stream';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\toptions.headers['Content-Type'] = data.type;\r\n\r\n\t\t\toptions.method = 'POST';\r\n\t\t\toptions.body = data;\r\n\t\t}\r\n\r\n\t\tglobal.fetch(url, options)\r\n\t\t.then(result => this.decodeResult(result))\r\n\t\t.then(result =>\r\n\t\t{\r\n\t\t\tthis._hideProgress();\r\n\t\t\tif (!success) return\r\n\r\n\t\t\tif (this.responseFilter(result, params)) {\r\n\t\t\t\ttry { success(result, params); } catch(e) { }\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err =>\r\n\t\t{\r\n\t\t\tthis._hideProgress();\r\n\r\n\t\t\tif (retries == 0) {\r\n\t\t\t\tif (failure) failure(err, params);\r\n\t\t\t} else {\r\n\t\t\t\tthis.apiCall (data, success, failure, httpMethod, retries-1, relativeUrl);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Decodes a result obtained using fetch into a usable object.\r\n\t */\r\n\tdecodeResult: function (result)\r\n\t{\r\n\t\tlet type = result.headers.get('content-type').split(';')[0].toLowerCase();\r\n\r\n\t\tif ((this.flags & Api.JSON_RESPONSE_SUPPORTED) && type.indexOf('json') !== -1)\r\n\t\t\treturn result.json();\r\n\r\n\t\tif ((this.flags & Api.XML_RESPONSE_SUPPORTED) && type.indexOf('xml') !== -1)\r\n\t\t{\r\n\t\t\treturn new Promise((resolve, reject) =>\r\n\t\t\t{\r\n\t\t\t\tresult.text().then(data =>\r\n\t\t\t\t{\r\n\t\t\t\t\tdata = (new DOMParser).parseFromString(data, 'text/xml');\r\n\t\t\t\t\tresolve(data);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(reject);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result.blob();\r\n\t},\r\n\r\n\t/**\r\n\t * Makes a blob with the specified data and type.\r\n\t */\r\n\tgetBlob: function (data, type)\r\n\t{\r\n\t\treturn new Blob ([data], { type: type });\r\n\t},\r\n\r\n\t/**\r\n\t * Provided access to the base64 module to encode/decode data.\r\n\t */\r\n\tbase64:\r\n\t{\r\n\t\tencode: function (value)\r\n\t\t{\r\n\t\t\treturn base64.encode(value);\r\n\t\t},\r\n\r\n\t\tdecode: function (value)\r\n\t\t{\r\n\t\t\treturn base64.decode(value);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Executes an API request, returns a promise.\r\n\t */\r\n\trequest: function (method, url, params=null)\r\n\t{\r\n\t\tif (params === null)\r\n\t\t{\r\n\t\t\tif (typeof(url) !== 'string')\r\n\t\t\t{\r\n\t\t\t\tparams = url;\r\n\t\t\t\turl = '';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.apiCall(params, resolve, reject, null, method, url);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Executes a POST API call.\r\n\t */\r\n\tpost: function (params, success=null, failure=null)\r\n\t{\r\n\t\treturn this.apiCall(params, success, failure, 'POST');\r\n\t},\r\n\r\n\t/**\r\n\t * Executes a GET API call.\r\n\t */\r\n\tget: function (params, success=null, failure=null)\r\n\t{\r\n\t\treturn this.apiCall(params, success, failure, 'GET');\r\n\t},\r\n\r\n\t/**\r\n\t * Executes an automatic API call, returns a promise.\r\n\t */\r\n\tfetch: function (url, params=null)\r\n\t{\r\n\t\tif (params === null) {\r\n\t\t\tif (typeof(url) !== 'string') {\r\n\t\t\t\tparams = url;\r\n\t\t\t\turl = '';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.apiCall(params, resolve, reject, null, null, url);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Builds a URL from the given data.\r\n\t */\r\n\tmakeUrl: function (url, params=null)\r\n\t{\r\n\t\tif (params === null)\r\n\t\t{\r\n\t\t\tif (typeof(url) !== 'string')\r\n\t\t\t{\r\n\t\t\t\tparams = url;\r\n\t\t\t\turl = '';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.appendParam(this.getUrl(url), this.encodeParams(params));\r\n\t}\r\n};\r\n\r\nexport default Api;\r\n","\r\nimport { Model, ModelList, EventDispatcher } from 'rinn';\r\nimport Api from './api.js';\r\n\r\n/*\r\n**\tProvides several methods to quickly interface with a remote data-source as defined by Wind.\r\n*/\r\n\r\nexport default EventDispatcher.extend\r\n({\r\n\tclassName: 'DataSource',\r\n\tdebounceDelay: 250,\r\n\r\n\trequest: null,\r\n\r\n\tincludeCount: false,\r\n\tincludeEnum: false,\r\n\tincludeList: true,\r\n\r\n\teid: null,\r\n\tcount: 0,\r\n\tlist: null,\r\n\tenum: null,\r\n\r\n\t/*\r\n\t**\tConstructs the data source with the specified optional `config` parameters, any of the properties of this object can be specified\r\n\t**\tin the config. Uses the given basePath as prefix for the `f` parameter for subsequent API operations, a basePath of `candies` will\r\n\t**\tresult in calls to `candies.list`, `candies.count`, etc.\r\n\t*/\r\n\t__ctor: function (basePath, config)\r\n\t{\r\n\t\tthis._super.EventDispatcher.__ctor();\r\n\r\n\t\tthis.basePath = basePath;\r\n\r\n\t\tif (config) Object.assign(this, config);\r\n\r\n\t\tthis.request = new Model(this.request);\r\n\r\n\t\tthis.eid = Math.random().toString().substr(2);\r\n\t\tthis.count = 0;\r\n\r\n\t\tthis.list = new ModelList();\r\n\t\tthis.list.dataSource = this;\r\n\r\n\t\tthis.enum = new ModelList();\r\n\t\tthis.enum.dataSource = this;\r\n\r\n\t\tthis.request.addEventListener (this.eid+':propertyChanged', this.forwardRequestEvent, this);\r\n\r\n\t\tthis.list.addEventListener (this.eid+':itemsCleared', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemsChanged', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemRemoved', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemChanged', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemAdded', this.forwardListEvent, this);\r\n\r\n\t\tthis.enum.addEventListener (this.eid+':itemsCleared', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemsChanged', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemRemoved', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemChanged', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemAdded', this.forwardEnumEvent, this);\r\n\t},\r\n\r\n\tforwardRequestEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('request' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\tforwardListEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('list' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\tforwardEnumEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('enum' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\t/*\r\n\t**\tExecutes one or more API functions (depending on `includeCount`, `includeEnum` and `includeList` properties) to retrieve the\r\n\t**\trequired data (uses debounce to prevent too-quick refreshes).\r\n\t**\r\n\t**\tRefresh mode can be: order, filter, range, enum or full. Setting `mode` to `true` will cause a full refresh without debouncing.\r\n\t*/\r\n\trefresh: function (mode='full', callback=null)\r\n\t{\r\n\t\tif (typeof(mode) == 'function') {\r\n\t\t\tcallback = mode;\r\n\t\t\tmode = 'full';\r\n\t\t}\r\n\r\n\t\tif (this._timeout) {\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t\tthis._timeout = null;\r\n\t\t}\r\n\r\n\t\tconst fn = () =>\r\n\t\t{\r\n\t\t\tthis._timeout = null;\r\n\r\n\t\t\tApi.packageBegin();\r\n\r\n\t\t\tif (this.includeCount && (mode === 'full' || mode === 'filter')) this.fetchCount();\r\n\t\t\tif (this.includeEnum && (mode === 'full' || mode === 'enum')) this.fetchEnum();\r\n\t\t\tif (this.includeList && mode !== 'enum') this.fetchList();\r\n\r\n\t\t\tApi.packageEnd(callback);\r\n\t\t};\r\n\r\n\t\tif (mode === true) {\r\n\t\t\tmode = 'full';\r\n\t\t\tfn();\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis._timeout = setTimeout(fn, this.debounceDelay);\r\n\t},\r\n\r\n\t/*\r\n\t**\tSearches for the item in `list` that matches the specified `fields` and sends it to the callback. If no item is found (or if `forced` is true),\r\n\t**\ta call to API function `.get` will be executed with the fields as request parameters. Returns a promise.\r\n\t*/\r\n\tfetch: function (fields, forced=false)\r\n\t{\r\n\t\treturn new Promise((resolve, reject) =>\r\n\t\t{\r\n\t\t\tlet item = forced == true ? null : this.list.find(fields, true);\r\n\t\t\tif (!item)\r\n\t\t\t{\r\n\t\t\t\tthis.fetchOne(fields, (r) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tif (r && r.response == 200)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (r.data.length > 0)\r\n\t\t\t\t\t\t\tresolve(r.data[0]);\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\treject(r);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\treject(r);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tresolve(item.get());\r\n\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t**\tRemoves an item from the remote data source by executing the `.delete` API function, passes the given `fields` as request\r\n\t**\tparameters. Returns a promise.\r\n\t*/\r\n\tdelete: function (params)\r\n\t{\r\n\t\treturn new Promise((resolve, reject) =>\r\n\t\t{\r\n\t\t\tthis.fetchDelete(params, (r) =>\r\n\t\t\t{\r\n\t\t\t\tif (r.response == 200)\r\n\t\t\t\t\tresolve(r);\r\n\t\t\t\telse\r\n\t\t\t\t\treject(r.error);\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\tfetchList: function ()\r\n\t{\r\n\t\tlet data = {...this.request.get()};\r\n\r\n\t\tdata.f = this.basePath + '.list';\r\n\r\n\t\tthis.dispatchEvent('listLoading');\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tthis.list.setData(r.response == 200 ? r.data : null);\r\n\t\t\tthis.dispatchEvent('listLoaded');\r\n\t\t\tthis.dispatchEvent('listChanged');\r\n\t\t});\r\n\t},\r\n\r\n\tfetchEnum: function ()\r\n\t{\r\n\t\tlet data = {...this.request.get()};\r\n\r\n\t\tdata.f = this.basePath + '.enum';\r\n\r\n\t\tthis.dispatchEvent('enumLoading');\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tthis.enum.setData(r.response == 200 ? r.data : null);\r\n\t\t\tthis.dispatchEvent('enumLoaded');\r\n\t\t\tthis.dispatchEvent('enumChanged');\r\n\t\t});\r\n\t},\r\n\r\n\tfetchCount: function ()\r\n\t{\r\n\t\tlet data = {...this.request.get()};\r\n\r\n\t\tdata.f = this.basePath + '.count';\r\n\r\n\t\tthis.dispatchEvent('countLoading');\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tthis.count = r.response == 200 ? r.count : 0;\r\n\t\t\tthis.dispatchEvent('countLoaded');\r\n\t\t\tthis.dispatchEvent('countChanged');\r\n\t\t});\r\n\t},\r\n\r\n\tfetchOne: function (params, callback)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tdata.f = this.basePath + '.get';\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tcallback(r);\r\n\t\t});\r\n\t},\r\n\r\n\tfetchDelete: function (params, callback)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tdata.f = this.basePath + '.delete';\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tcallback(r);\r\n\t\t});\r\n\t},\r\n\r\n\tfetchData: function (params)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tif (data.f[0] == '.')\r\n\t\t\tdata.f = this.basePath + data.f;\r\n\r\n\t\treturn Api.fetch(data);\r\n\t},\r\n\r\n\tmakeUrl: function (params)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tif (data.f[0] == '.')\r\n\t\t\tdata.f = this.basePath + data.f;\r\n\r\n\t\treturn Api.makeUrl(data);\r\n\t}\r\n});\r\n","\r\nimport { Model, ModelList } from 'rinn';\r\nimport Api from './api.js';\r\n\r\n/*\r\n**\tProvides an interface to connect with a listing API function.\r\n*/\r\n\r\nexport default ModelList.extend\r\n({\r\n\tclassName: 'DataList',\r\n\tdebounceDelay: 250,\r\n\r\n\trequest: null,\r\n\r\n\teid: null,\r\n\r\n\t/*\r\n\t**\tConstructs the data list with the specified optional `config` parameters, any of the properties of this object can be specified\r\n\t**\tin the config. The given `f` parameter is passed directly as a request parameter to the API.\r\n\t*/\r\n\t__ctor: function (f, config=null)\r\n\t{\r\n\t\tthis._super.ModelList.__ctor();\r\n\r\n\t\tif (config !==  null)\r\n\t\t\tObject.assign(this, config);\r\n\r\n\t\tif (!this.request)\r\n\t\t\tthis.request = { };\r\n\r\n\t\tthis.request.f = f;\r\n\t\tthis.request = new Model(this.request);\r\n\r\n\t\tthis.eid = Math.random().toString().substr(2);\r\n\t\tthis.dataList = this;\r\n\r\n\t\tthis.request.addEventListener (this.eid+':propertyChanged', this.forwardRequestEvent, this);\r\n\t},\r\n\r\n\tforwardRequestEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('request' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\t/*\r\n\t**\tExecutes a request to retrieve the data for the list (uses debounce to prevent too-quick refreshes).\r\n\t*/\r\n\trefresh: function (callback=null, _callback=null)\r\n\t{\r\n\t\tif (this._timeout)\r\n\t\t{\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t\tthis._timeout = null;\r\n\t\t}\r\n\r\n\t\tif (callback === true)\r\n\t\t{\r\n\t\t\tthis.dispatchEvent('listLoading');\r\n\r\n\t\t\tApi.fetch(this.request.get()).then(r =>\r\n\t\t\t{\r\n\t\t\t\tthis.setData(r.response == 200 ? r.data : null);\r\n\t\t\t\tthis.dispatchEvent('listLoaded');\r\n\t\t\t\tthis.dispatchEvent('listChanged');\r\n\r\n\t\t\t\tif (_callback !== null)\r\n\t\t\t\t\t_callback();\r\n\t\t\t});\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst fn = () => {\r\n\t\t\tthis.refresh(true, callback);\r\n\t\t};\r\n\r\n\t\tthis._timeout = setTimeout(fn, this.debounceDelay);\r\n\t}\r\n});\r\n","\n/**\n**\tCollection of useful easing functions (imported from Cherry source code).\n*/\n\nconst Easing =\n{\n\t/**\n\t**\tInterpolates numeric values between two objects (`src` and `dst`) using the specified `duration` (in seconds) and `easing` function. Note\n\t**\tthat all four parameters `src`, `dst`, `duration` and `easing` must be objects having the same number of values.\n\t*/\n\tinterpolate: function (src, dst, duration, easing, callback/* function(data, isFinished) */)\n\t{\n\t\tlet time = { };\n\t\tlet data = { };\n\t\tlet count = 0;\n\n\t\tfor (let x in src)\n\t\t{\n\t\t\ttime[x] = 0.0;\n\t\t\tdata[x] = src[x]\n\t\t\tcount++;\n\t\t}\n\n\t\tlet lastTime = Date.now()/1000;\n\t\tlet dt = 0;\n\n\t\tlet interpolator = function()\n\t\t{\n\t\t\tlet curTime = Date.now()/1000;\n\t\t\tdt = curTime - lastTime;\n\t\t\tlastTime = curTime;\n\n\t\t\tfor (let x in time)\n\t\t\t{\n\t\t\t\tif (time[x] == duration[x])\n\t\t\t\t\tcontinue;\n\n\t\t\t\ttime[x] += dt;\n\t\t\t\tif (time[x] >= duration[x])\n\t\t\t\t{\n\t\t\t\t\ttime[x] = duration[x];\n\t\t\t\t\tcount--;\n\t\t\t\t}\n\n\t\t\t\tlet t = easing[x] (time[x] / duration[x]);\n\t\t\t\tdata[x] = (1-t)*src[x] + t*dst[x];\n\t\t\t}\n\n\t\t\tcallback (data, count == 0);\n\n\t\t\tif (count != 0)\n\t\t\t\trequestAnimationFrame(interpolator);\n\t\t};\n\n\t\tinterpolator();\n\t},\n\n\t/* ******************************************** */\n\tLinear:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn t;\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\treturn t;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tBack:\n\t{\n\t\tk: 1.70158,\n\n\t\tIN: function (t, k)\n\t\t{\n\t\t\tif (k === undefined) k = Easing.Back.k;\n\t\t\treturn t*t*((k+1)*t - k);\n\t\t},\n\n\t\tOUT: function (t, k)\n\t\t{\n\t\t\treturn 1 - Easing.Back.IN(1 - t, k);\n\t\t},\n\n\t\tIN_OUT: function (t, k)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Back.IN(t*2, k)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Back.OUT((t-0.5)*2, k)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tBounce:\n\t{\n\t\tgetConst: function (t)\n\t\t{\n\t\t\tif (t < 1.0/2.75)\n\t\t\t\treturn 7.5625 * t * t;\n\t\t\telse if (t < 2.0/2.75)\n\t\t\t\treturn 7.5625 * (t -= 1.5/2.75)*t + 0.75;\n\t\t\telse if (t < 2.5/2.75)\n\t\t\t\treturn 7.5625 * (t -= 2.250/2.75) * t + 0.9375;\n\n\t\t\treturn 7.5625 * (t -= 2.625/2.75) * t + 0.984375;\n\t\t},\n\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Bounce.getConst(1-t);\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn Easing.Bounce.getConst(t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn (1 - Easing.Bounce.getConst(1-2*t))/2;\n\t\t\telse\n\t\t\t\treturn (Easing.Bounce.getConst((t-0.5)*2)/2)+0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tCirc:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn 1 - Math.sqrt(1 - t*t);\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Circ.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\t\treturn Easing.Circ.IN(t*2)/2;\n\t\t\t\telse\n\t\t\t\t\treturn Easing.Circ.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tCubic:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Cubic.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Cubic.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Cubic.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tExpo:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn Math.pow(2, 12*(t-1));\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn -Math.pow(2, -12*t) + 1;\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif ((t *= 2) < 1)\n\t\t\t\treturn Math.pow (2, 12 * (t - 1)) / 2;\n\t\t\telse\n\t\t\t\treturn (-Math.pow (2, -12 * (t - 1)) + 2) / 2;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tPower:\n\t{\n\t\tp: 12,\n\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn Math.pow(t, Easing.Power.p);\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Power.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Power.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Power.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tQuad:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Quad.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Quad.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Quad.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tQuartic:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t*t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Quartic.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Quartic.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Quartic.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tQuintic:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t*t*t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Quintic.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\t\treturn Easing.Quintic.IN(t*2)/2;\n\t\t\t\telse\n\t\t\t\t\treturn Easing.Quintic.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tSine:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn 1 - Math.sin (1.5708 * (1 - t));\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn Math.sin (1.5708 * t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\treturn (Math.cos (3.1416*t) - 1) / -2;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tStep:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t != 1.0 ? 0 : 1.0;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn t != 1.0 ? 0 : 1.0;\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\treturn t != 1.0 ? 0 : 1.0;\n\t\t}\n\t}\n};\n\nexport default Easing;\n","\nimport { Rinn, Class } from 'rinn';\n\n/**\n**\tClass to animate properties using rules (imported from Cherry source code).\n*/\n\nconst Anim = Class.extend\n({\n\tlist: null,\n\n\tinitialData: null,\n\tdata: null,\n\n\tstack: null,\n\tblock: null,\n\n\ttimeScale: 1, time: 0, blockTime: 0,\n\tindex: 0,\n\n\tpaused: false,\n\tfinished: false,\n\n\tonFinishedCallback: null,\n\tonUpdatedCallback: null,\n\n\t__ctor: function ()\n\t{\n\t\tthis.list = [ ];\n\n\t\tthis.initialData = { };\n\t\tthis.data = { };\n\n\t\tthis.stack = [ ];\n\t\tthis.block = this.list;\n\n\t\tthis.reset();\n\t},\n\n\t__dtor: function ()\n\t{\n\t},\n\n\tclone: function ()\n\t{\n\t\tlet a = new Anim();\n\n\t\ta.list = this.list;\n\t\ta.initialData = this.initialData;\n\n\t\treturn a.reset();\n\t},\n\n\tonFinished: function (callback)\n\t{\n\t\tthis.onFinishedCallback = callback;\n\t\treturn this;\n\t},\n\n\tonUpdated: function (callback)\n\t{\n\t\tthis.onUpdatedCallback = callback;\n\t\treturn this;\n\t},\n\n\t// Resets the animation to its initial state.\n\treset: function ()\n\t{\n\t\tthis.stack.length = 0;\n\t\tthis.blockTime = 0;\n\n\t\tthis.time = 0;\n\t\tthis.index = 0;\n\n\t\tthis.block = this.list;\n\n\t\tthis.paused = true;\n\t\tthis.finished = false;\n\t\tthis.handle = null;\n\n\t\tfor (let i in this.initialData)\n\t\t\tthis.data[i] = this.initialData[i];\n\n\t\treturn this;\n\t},\n\n\t// Sets the initial data.\n\tinitial: function (data)\n\t{\n\t\tthis.initialData = data;\n\t\treturn this.reset();\n\t},\n\n\t// Sets the time scale (animation speed).\n\tspeed: function (value)\n\t{\n\t\tthis.timeScale = value > 0.0 ? value : 1.0;\n\t\treturn this;\n\t},\n\n\t// Sets the output data object.\n\tsetOutput: function (data)\n\t{\n\t\tthis.data = data;\n\t\treturn this;\n\t},\n\n\t// Pauses the animation.\n\tpause: function ()\n\t{\n\t\tif (this.paused) return;\n\n\t\tclearInterval(this.handle);\n\t\tthis.paused = true;\n\t},\n\n\t// Resumes the animation.\n\tresume: function ()\n\t{\n\t\tif (!this.paused) return;\n\n\t\tlet lastTime = Date.now()/1000;\n\n\t\tthis.handle = setInterval(() =>\n\t\t{\n\t\t\tlet curTime = Date.now()/1000;\n\t\t\tlet dt = curTime - lastTime;\n\t\t\tlastTime = curTime;\n\n\t\t\tthis.update(dt);\n\n\t\t\tif (this.onUpdatedCallback)\n\t\t\t\tthis.onUpdatedCallback (this.data, this);\n\t\t},\n\t\t16);\n\n\t\tif (this.onUpdatedCallback)\n\t\t\tthis.onUpdatedCallback (this.data, this);\n\n\t\tthis.paused = false;\n\t},\n\n\t// Updates the animation by the specified delta time (seconds).\n\tupdate: function (dt)\n\t{\n\t\tif (this.paused) return false;\n\n\t\tif (this.index >= this.block.length)\n\t\t\treturn true;\n\n\t\tlet i = 0;\n\n\t\tlet _block;\n\t\tlet _index;\n\t\tlet _blockTime;\n\n\t\tthis.time += dt*this.timeScale;\n\n\t\twhile (this.index < this.block.length)\n\t\t{\n\t\t\tlet cmd = this.block[this.index];\n\t\t\tlet duration;\n\n\t\t\tswitch (cmd.op)\n\t\t\t{\n\t\t\t\tcase \"parallel\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd.blocks.length = 0;\n\t\t\t\t\t\tcmd.started = true;\n\n\t\t\t\t\t\tfor (i = 0; i < cmd.block.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcmd.blocks.push([cmd.block[i]]);\n\t\t\t\t\t\t\tcmd.indices[i] = 0;\n\t\t\t\t\t\t\tcmd.blockTimes[i] = this.blockTime;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t_block = this.block;\n\t\t\t\t\t_index = this.index;\n\t\t\t\t\t_blockTime = this.blockTime;\n\n\t\t\t\t\tlet n = 0;\n\t\t\t\t\tlet blockTime = _blockTime;\n\n\t\t\t\t\tfor (i = 0; i < cmd.blocks.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.block = cmd.blocks[i];\n\t\t\t\t\t\tthis.index = cmd.indices[i];\n\t\t\t\t\t\tthis.blockTime = cmd.blockTimes[i];\n\n\t\t\t\t\t\tif (this.update(0) === true)\n\t\t\t\t\t\t\tn++;\n\n\t\t\t\t\t\tif (this.blockTime > blockTime)\n\t\t\t\t\t\t\tblockTime = this.blockTime;\n\n\t\t\t\t\t\tcmd.blockTimes[i] = this.blockTime;\n\t\t\t\t\t\tcmd.blocks[i] = this.block;\n\t\t\t\t\t\tcmd.indices[i] = this.index;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.block = _block;\n\t\t\t\t\tthis.index = _index;\n\t\t\t\t\tthis.blockTime = _blockTime;\n\n\t\t\t\t\tif (cmd.fn) cmd.fn.call(this);\n\n\t\t\t\t\tif (n != cmd.blocks.length)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime = blockTime;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"serial\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd._block = cmd.block;\n\t\t\t\t\t\tcmd._index = 0;\n\t\t\t\t\t\tcmd._blockTime = this.blockTime;\n\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t_block = this.block;\n\t\t\t\t\t_index = this.index;\n\t\t\t\t\t_blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = cmd._block;\n\t\t\t\t\tthis.index = cmd._index;\n\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\n\t\t\t\t\ti = this.update(0);\n\n\t\t\t\t\tcmd._block = this.block;\n\t\t\t\t\tcmd._index = this.index;\n\t\t\t\t\tcmd._blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = _block;\n\t\t\t\t\tthis.index = _index;\n\t\t\t\t\tthis.blockTime = _blockTime;\n\n\t\t\t\t\tif (cmd.fn) cmd.fn.call(this);\n\n\t\t\t\t\tif (i !== true) return false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"repeat\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd._block = cmd.block;\n\t\t\t\t\t\tcmd._index = 0;\n\t\t\t\t\t\tcmd._blockTime = this.blockTime;\n\t\t\t\t\t\tcmd._count = cmd.count;\n\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t_block = this.block;\n\t\t\t\t\t_index = this.index;\n\t\t\t\t\t_blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = cmd._block;\n\t\t\t\t\tthis.index = cmd._index;\n\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\n\t\t\t\t\ti = this.update(0);\n\n\t\t\t\t\tcmd._block = this.block;\n\t\t\t\t\tcmd._index = this.index;\n\t\t\t\t\tcmd._blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = _block;\n\t\t\t\t\tthis.index = _index;\n\t\t\t\t\tthis.blockTime = _blockTime;\n\n\t\t\t\t\tif (cmd.fn) cmd.fn.call(this);\n\n\t\t\t\t\tif (i !== true) return false;\n\n\t\t\t\t\tif (cmd._count <= 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\t\t\t\t\t\tthis.index++;\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd._index = 0;\n\t\t\t\t\t\tcmd._count--;\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"set\":\n\t\t\t\t\tthis.data[cmd.field] = cmd.value;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"restart\":\n\t\t\t\t\tthis.index = 0;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"wait\":\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"range\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (cmd.startValue === null)\n\t\t\t\t\t\t\tcmd._startValue = this.data[cmd.field];\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tcmd._startValue = cmd.startValue;\n\n\t\t\t\t\t\tcmd._endValue = cmd.endValue;\n\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\tdt = (this.time - this.blockTime) / duration;\n\t\t\t\t\telse\n\t\t\t\t\t\tdt = 1;\n\n\t\t\t\t\tif (cmd.easing && dt != 1.0)\n\t\t\t\t\t\tthis.data[cmd.field] = cmd.easing(dt)*(cmd._endValue - cmd._startValue) + cmd._startValue;\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.data[cmd.field] = dt*(cmd._endValue - cmd._startValue) + cmd._startValue;\n\n\t\t\t\t\tif (dt != 1) return false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"rand\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t\tcmd.last = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\tdt = (this.time - this.blockTime) / duration;\n\t\t\t\t\telse\n\t\t\t\t\t\tdt = 1;\n\n\t\t\t\t\tif (cmd.easing && dt != 1)\n\t\t\t\t\t\tcmd.cur = ~~(cmd.easing(dt)*cmd.count);\n\t\t\t\t\telse\n\t\t\t\t\t\tcmd.cur = ~~(dt*cmd.count);\n\n\t\t\t\t\tif (cmd.cur != cmd.last)\n\t\t\t\t\t{\n\t\t\t\t\t\twhile (true) {\n\t\t\t\t\t\t\ti = ~~(Math.random()*(cmd.endValue - cmd.startValue + 1)) + cmd.startValue;\n\t\t\t\t\t\t\tif (i != this.data[cmd.field]) break;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.data[cmd.field] = i;\n\t\t\t\t\t\tcmd.last = cmd.cur;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (dt != 1) return false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"randt\":\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\tdt = (this.time - this.blockTime) / duration;\n\t\t\t\t\telse\n\t\t\t\t\t\tdt = 1;\n\n\t\t\t\t\tif (cmd.easing && dt != 1)\n\t\t\t\t\t\ti = cmd.easing(dt)*(cmd.count-1);\n\t\t\t\t\telse\n\t\t\t\t\t\ti = dt*(cmd.count-1);\n\n\t\t\t\t\tthis.data[cmd.field] = cmd.table[~~((i + cmd.count) % cmd.count)];\n\n\t\t\t\t\tif (dt != 1) return false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"play\":\n\t\t\t\t\tcmd.snd.play();\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"exec\":\n\t\t\t\t\tcmd.fn.call(this, this);\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this.block == this.list)\n\t\t{\n\t\t\tif (!this.finished && this.onFinishedCallback != null)\n\t\t\t\tthis.onFinishedCallback();\n\n\t\t\tthis.pause();\n\t\t\tthis.finished = true;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t// Runs the subsequent commands in parallel. Should end the parallel block by calling end().\n\tparallel: function ()\n\t{\n\t\tlet block = [ ];\n\n\t\tthis.block.push({ op: \"parallel\", started: false, block: block, blocks: [ ], indices: [ ], blockTimes: [ ] });\n\n\t\tthis.stack.push (this.block);\n\t\tthis.block = block;\n\n\t\treturn this;\n\t},\n\n\t// Runs the subsequent commands in series. Should end the serial block by calling end().\n\tserial: function ()\n\t{\n\t\tlet block = [ ];\n\n\t\tthis.block.push({ op: \"serial\", started: false, block: block });\n\n\t\tthis.stack.push (this.block);\n\t\tthis.block = block;\n\n\t\treturn this;\n\t},\n\n\t// Repeats a block the specified number of times.\n\trepeat: function (count)\n\t{\n\t\tlet block = [ ];\n\n\t\tthis.block.push({ op: \"repeat\", started: false, block: block, count: count });\n\n\t\tthis.stack.push (this.block);\n\t\tthis.block = block;\n\n\t\treturn this;\n\t},\n\n\t// Sets the callback of the current block.\n\tcallback: function (fn)\n\t{\n\t\tlet block = this.stack[this.stack.length-1];\n\t\tblock[block.length-1].fn = fn;\n\n\t\treturn this;\n\t},\n\n\t// Ends a parallel(), serial() or repeat() block.\n\tend: function ()\n\t{\n\t\tthis.block = this.stack.pop();\n\t\treturn this;\n\t},\n\n\t// Sets the value of a variable.\n\tset: function (field, value)\n\t{\n\t\tthis.block.push({ op: \"set\", field: field, value: value });\n\t\treturn this;\n\t},\n\n\t// Restarts the current block.\n\trestart: function (duration)\n\t{\n\t\tthis.block.push({ op: \"restart\" });\n\t\treturn this;\n\t},\n\n\t// Waits for the specified duration.\n\twait: function (duration)\n\t{\n\t\tthis.block.push({ op: \"wait\", duration: duration });\n\t\treturn this;\n\t},\n\n\t// Sets the range of a variable.\n\trange: function (field, duration, startValue, endValue, easing)\n\t{\n\t\tthis.block.push({ op: \"range\", started: false, field: field, duration: duration, startValue: startValue, endValue: endValue, easing: easing ? easing : null });\n\t\treturn this;\n\t},\n\n\t// Generates a certain amount of random numbers in the given range (inclusive).\n\trand: function (field, duration, count, startValue, endValue, easing)\n\t{\n\t\tthis.block.push({ op: \"rand\", started: false, field: field, duration: duration, count: count, startValue: startValue, endValue: endValue, easing: easing ? easing : null });\n\t\treturn this;\n\t},\n\n\t// Generates a certain amount of random numbers in the given range (inclusive). This uses a static random table to determine the next values.\n\trandt: function (field, duration, count, startValue, endValue, easing)\n\t{\n\t\tlet table = [ ];\n\n\t\tfor (let i = 0; i < count; i++)\n\t\t\ttable.push ((i % (endValue - startValue + 1)) + startValue);\n\n\t\tfor (let i = count >> 2; i > 0; i--)\n\t\t{\n\t\t\tlet a = ~~(Math.random() * count);\n\t\t\tlet b = ~~(Math.random() * count);\n\n\t\t\tlet c = table[b];\n\t\t\ttable[b] = table[a];\n\t\t\ttable[a] = c;\n\t\t}\n\n\t\tthis.block.push({ op: \"randt\", field: field, duration: duration, count: count, startValue: startValue, endValue: endValue, table: table, easing: easing ? easing : null });\n\t\treturn this;\n\t},\n\n\t// Plays a sound.\n\tplay: function (snd)\n\t{\n\t\tthis.block.push({ op: \"play\", snd: snd });\n\t\treturn this;\n\t},\n\n\t// Executes a function.\n\texec: function (fn)\n\t{\n\t\tthis.block.push({ op: \"exec\", fn: fn });\n\t\treturn this;\n\t}\n});\n\nexport default Anim;\n","/*\n\t<r-tabs data-container=\"div.tab-container\" data-base-route=\"@\" data-initial=\"tab1\">\n\t\t<a data-name=\"tab1\">Tab-1</a>\n\t\t<a data-name=\"tab2\">Tab-2</a>\n\t\t<a data-name=\"tab3\">Tab-3</a>\n\t</r-tabs>\n\n\t<div class=\"tab-container\">\n\t\t<div data-name=\"tab1\">\n\t\t\tThis is tab-1.\n\t\t</div>\n\n\t\t<div data-name=\"tab2\">\n\t\t\tThis is tab-2.\n\t\t</div>\n\n\t\t<div data-name=\"tab3\">\n\t\t\tThis is tab-3.\n\t\t</div>\n\t</div>\n\n\t.x-hidden {\n\t\tdisplay: none;\n\t}\n\n\tr-tabs [data-name].active {\n\t\tfont-weight: bold;\n\t}\n*/\n\nimport Element from '../element.js';\nimport Router from '../router.js';\n\nexport default Element.register ('r-tabs',\n{\n\t/**\n\t * Container element for tab content.\n\t */\n\tcontainer: null,\n\n\t/**\n\t * Active tab name.\n\t */\n\tactiveTab: null,\n\n\t/**\n\t**\tElement events.\n\t*/\n\t'event click [data-name]': function (evt)\n\t{\n\t\tevt.continuePropagation = true;\n\n\t\tif (this.dataset.baseRoute)\n\t\t{\n\t\t\tlocation = \"#\" + Router.realLocation(this.dataset.baseRoute.replace('@', evt.source.dataset.name));\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selectTab (evt.source.dataset.name);\n\t},\n\n\t/**\n\t**\tInitializes the Tabs element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis._routeHandler = (evt, args) =>\n\t\t{\n\t\t\tif (Router.location != '')\n\t\t\t{\n\t\t\t\tthis.querySelectorAll(\"[href]\").forEach(link =>\n\t\t\t\t{\n\t\t\t\t\tif (!link.href) return;\n\n\t\t\t\t\tif (Router.location.startsWith(link.href.substr(link.href.indexOf('#')+1))) {\n\t\t\t\t\t\tlink.classList.add('active');\n\t\t\t\t\t\tlink.classList.add('is-active');\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tlink.classList.remove('active');\n\t\t\t\t\t\tlink.classList.remove('is-active');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!args.route.changed)\n\t\t\t\treturn;\n\n\t\t\tthis.showTab (args.tabName);\n\t\t};\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tif (\"container\" in this.dataset)\n\t\t{\n\t\t\tif (this.dataset.container == ':previousElement')\n\t\t\t\tthis.container = this.previousElementSibling;\n\t\t\telse if (this.dataset.container == ':nextElement')\n\t\t\t\tthis.container = this.nextElementSibling;\n\t\t\telse if (this.dataset.container == ':none')\n\t\t\t\tthis.container = null;\n\t\t\telse\n\t\t\t\tthis.container = document.querySelector(this.dataset.container);\n\t\t}\n\t\telse\n\t\t\tthis.container = this.nextElementSibling;\n\n\t\tthis._hideTabsExcept(this.dataset.initial);\n\t},\n\n\t/**\n\t**\tAdds a handler to Router if the data-base-route attribute was set.\n\t*/\n\tonConnected: function()\n\t{\n\t\tif (this.dataset.baseRoute)\n\t\t\tRouter.addRoute (this.dataset.baseRoute.replace('@', ':tabName'), this._routeHandler);\n\t},\n\n\t/**\n\t**\tRemoves a handler previously added to Router if the data-base-route attribute was set.\n\t*/\n\tonDisconnected: function()\n\t{\n\t\tif (this.dataset.baseRoute)\n\t\t\tRouter.removeRoute(this.dataset.baseRoute.replace('@', ':tabName'), this._routeHandler);\n\t},\n\n\t/**\n\t**\tHides all tabs except the one with the specified exceptName, if none specified then all tabs will be hidden (adds `.x-hidden` CSS class),\n\t**\tadditionally the respective link item in the tab definition will have class `.active` and `.is-active`.\n\t*/\n\t_hideTabsExcept: function (exceptName)\n\t{\n\t\tif (!exceptName) exceptName = '';\n\n\t\tif (this.container != null)\n\t\t{\n\t\t\tthis.container.querySelectorAll(':scope > [data-name]').forEach(i =>\n\t\t\t{\n\t\t\t\tif (i.dataset.name == exceptName)\n\t\t\t\t{\n\t\t\t\t\ti.classList.remove('x-hidden');\n\t\t\t\t\tthis.dispatch('tabShown', { name: i.dataset.name, el: i });\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ti.classList.add('x-hidden');\n\t\t\t\t\tthis.dispatch('tabHidden', { name: i.dataset.name, el: i });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.querySelectorAll(\"[data-name]\").forEach(link =>\n\t\t{\n\t\t\tif (link.dataset.name == exceptName) {\n\t\t\t\tlink.classList.add('active');\n\t\t\t\tlink.classList.add('is-active');\n\t\t\t} else {\n\t\t\t\tlink.classList.remove('active');\n\t\t\t\tlink.classList.remove('is-active');\n\t\t\t}\n\t\t});\n\n\t\tthis.activeTab = exceptName;\n\t\tthis.dispatch('tabChanged', { name: exceptName, el: this });\n\t},\n\n\t/**\n\t**\tShows the tab with the specified name, ignores `data-base-route` and current route as well.\n\t*/\n\tshowTab: function (name)\n\t{\n\t\treturn this._hideTabsExcept (name);\n\t},\n\n\t/**\n\t**\tShows a tab given its name. The route will be changed automatically if `data-base-route` is enabled.\n\t*/\n\tselectTab: function (name)\n\t{\n\t\tif (this.dataset.baseRoute)\n\t\t{\n\t\t\tconst hash = \"#\" + Router.realLocation(this.dataset.baseRoute.replace('@', name));\n\n\t\t\tif (location.hash != hash)\n\t\t\t{\n\t\t\t\tlocation = hash;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.showTab (name);\n\t}\n});\n","/*\n<r-form data-form-action=\"api-function-name\" [data-strict=\"true|false\"] [data-errors-at=\"\"] [data-method=\"post\"]>\n\t<input type=\"text\" data-field=\"username\"/>\n</r-form>\n\nr-form .message.x-hidden {\n    display: none;\n}\n\nr-form span.field-error {\n    display: block;\n    color: red;\n}\n*/\n\nimport { Template } from 'rinn';\nimport Element from '../element.js';\nimport Api from '../api.js';\n\nexport default Element.register ('r-form',\n{\n\t/**\n\t**\tElement events.\n\t*/\n\tevents:\n\t{\n\t\t'change [data-field]': '_fieldChanged',\n\n\t\t'click input[type=reset]': 'reset',\n\t\t'click .reset': 'reset',\n\n\t\t'click input[type=submit]': 'submit',\n\t\t'click button[type=submit]': 'submit',\n\t\t'click .submit': 'submit',\n\t\t'submit form': 'submit'\n\t},\n\n\t/*\n\t**\tInitial form model.\n\t*/\n\tmodel: { },\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tlet formElement = document.createElement('form');\n\t\tformElement.append(...this.childNodes);\n\t\tthis.append(formElement);\n\n\t\tlet def = { };\n\t\tlet names = this.model.get();\n\n\t\tthis.querySelectorAll('[data-field]').forEach((i) =>\n\t\t{\n\t\t\ti.name = i.dataset.field;\n\t\t\tnames[i.name] = i.type;\n\n\t\t\tlet val = i.dataset.default;\n\t\t\tif (val == undefined)\n\t\t\t{\n\t\t\t\tswitch (i.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'radio':\n\t\t\t\t\t\tif (!i.checked) return;\n\t\t\t\t\t\tval = i.value;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\tval = i.checked ? '1' : '0';\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'field':\n\t\t\t\t\t\tval = i.getValue();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'file':\n\t\t\t\t\t\tval = '';\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tval = '';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdef[i.dataset.field] = val;\n\t\t});\n\n\t\tfor (let name in names)\n\t\t{\n\t\t\tif (name in def)\n\t\t\t\tnames[name] = def[name];\n\t\t\telse\n\t\t\t\tnames[name] = '';\n\t\t}\n\n\t\tdef = names;\n\n\t\tthis.model.defaults = def;\n\t\tthis.model.reset();\n\n\t\tthis.clearMarkers();\n\t},\n\n\t/*\n\t**\tTransforms an string returned by the server to a local representation.\n\t*/\n\tfilterString: function (str, r)\n\t{\n\t\tif (!str || !('messages' in global))\n\t\t\treturn str;\n\n\t\tif (str.startsWith('@messages.'))\n\t\t{\n\t\t\tif (str.substr(10) in global.messages)\n\t\t\t\tstr = Template.eval(global.messages[str.substr(10)], r);\n\t\t}\n\n\t\treturn str;\n\t},\n\n\t_change: function(elem)\n\t{\n\t\tif ('createEvent' in document)\n\t\t{\n\t\t\tlet evt = document.createEvent('HTMLEvents');\n\t\t\tevt.initEvent('change', false, true);\n\t\t\telem.dispatchEvent(evt);\n\t\t}\n\t\telse\n\t\t\telem.fireEvent('onchange');\n\t},\n\n\t_setField: function (f, value, silent)\n\t{\n\t\tif (!f) return;\n\n\t\tfor (f of this.querySelectorAll('[data-field=\"'+f+'\"]'))\n\t\t{\n\t\t\tswitch (f.type || f.tagName.toLowerCase())\n\t\t\t{\n\t\t\t\tcase 'select':\n\t\t\t\t\tf.val = f.dataset.value = f.multiple ? (value ? value.split(',') : value) : value;\n\t\t\t\t\tf.value = f.val = f.dataset.value;\n\n\t\t\t\t\tif (silent !== true) this._change(f);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\tf.checked = parseInt(value) ? true : false;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\tf.checked = value == f.value;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'field':\n\t\t\t\t\tf.val = f.dataset.value = value;\n\t\t\t\t\tf.setValue(value);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'file':\n\t\t\t\t\tif ((value instanceof File) || (value instanceof Blob))\n\t\t\t\t\t{\n\t\t\t\t\t\tf.val = value;\n\t\t\t\t\t\tf.dataset.value = value;\n\t\t\t\t\t}\n\t\t\t\t\telse if (value instanceof FileList)\n\t\t\t\t\t{\n\t\t\t\t\t\tf.val = value;\n\t\t\t\t\t\tf.dataset.value = value;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tf.val = f.dataset.value = '';\n\t\t\t\t\t\tf.value = '';\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tf.val = f.dataset.value = value;\n\t\t\t\t\tf.value = value;\n\n\t\t\t\t\tif (silent !== true) this._change(f);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t},\n\n\t_getField: function (f, _value=null, fromFileFields=false)\n\t{\n\t\tif (!f) return null;\n\n\t\tif (typeof(f) != 'string')\n\t\t{\n\t\t\tlet value = f.value == null ? f.val : f.value;\n\t\t\tif (value === null) value = _value;\n\n\t\t\tswitch (f.type || f.tagName.toLowerCase())\n\t\t\t{\n\t\t\t\tcase 'select':\n\t\t\t\t\t_value = f.multiple ? (value ? value.join(',') : value) : value;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\t_value = f.checked ? '1' : '0';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\tif (f.checked) _value = f.value;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'field':\n\t\t\t\t\t_value = f.getValue();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'file':\n\t\t\t\t\t_value = fromFileFields ? (f.files && f.files.length ? (f.multiple ? f.files : f.files[0]) : null) : f.val;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t_value = value;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn _value === null ? '' : _value;\n\t\t}\n\n\t\t_value = null;\n\n\t\tfor (f of this.querySelectorAll('[data-field=\"'+f+'\"]'))\n\t\t\t_value = this._getField(f, _value);\n\n\t\treturn _value === null ? '' : _value;\n\t},\n\n\tgetField: function (name)\n\t{\n\t\treturn this._getField(name);\n\t},\n\n\tclearMarkers: function ()\n\t{\n\t\tthis.classList.remove('busy');\n\n\t\tthis.querySelectorAll('.message').forEach(i => i.classList.add('x-hidden') );\n\t\tthis.querySelectorAll('span.field-error').forEach(i => i.remove());\n\n\t\tthis.querySelectorAll('.field-error').forEach(i => { i.classList.remove('field-error'); i.classList.remove('is-invalid'); });\n\t\tthis.querySelectorAll('.field-passed').forEach(i => i.classList.remove('field-passed'));\n\t},\n\n\t_fieldChanged: function (evt)\n\t{\n\t\tlet f = evt.source;\n\n\t\tif (f.type == 'file')\n\t\t\tthis.model.set (f.dataset.field, this._getField(f, null, true), true);\n\t\telse\n\t\t\tthis.model.set (f.dataset.field, this._getField(f));\n\n\t\tevt.continuePropagation = true;\n\t},\n\n\tonModelPropertyChanged: function (evt, args)\n\t{\n\t\tthis._setField (args.name, args.value);\n\t},\n\n\t_onSuccess: function(r)\n\t{\n\t\tthis.classList.remove('busy');\n\t\tlet tmp;\n\n\t\tthis.dispatch ('formSuccess', r);\n\n\t\tif (r.message && (tmp = this.querySelector('.message.success')) != null)\n\t\t{\n\t\t\ttmp.innerHTML = this.filterString(r.message, r).replace(/\\n/g, '<br/>');\n\t\t\ttmp.classList.remove('x-hidden');\n\t\t\ttmp.onanimationend = () => tmp.classList.add('x-hidden');\n\t\t}\n\t},\n\n\t_onFailure: function(r)\n\t{\n\t\tthis.classList.remove('busy');\n\t\tlet tmp;\n\n\t\tthis.dispatch ('formError', r);\n\n\t\tif (r.fields)\n\t\t{\n\t\t\tfor (let i in r.fields)\n\t\t\t{\n\t\t\t\tlet f = this.querySelector('[data-field-container=\"'+i+'\"]');\n\t\t\t\tif (!f)\n\t\t\t\t{\n\t\t\t\t\tf = this.querySelector('[data-field=\"'+i+'\"]');\n\t\t\t\t\tif (!f) continue;\n\t\t\t\t}\n\n\t\t\t\tlet tmp = document.createElement('span');\n\t\t\t\ttmp.classList.add('field-error');\n\t\t\t\ttmp.innerHTML = this.filterString(r.fields[i], r).replace(/\\n/g, '<br/>');\n\n\t\t\t\tf.classList.add('field-error');\n\t\t\t\tf.classList.add('is-invalid');\n\n\t\t\t\tif (this.dataset.errorsAt == 'bottom')\n\t\t\t\t\tf.parentElement.append(tmp);\n\t\t\t\telse if (this.dataset.errorsAt == 'top')\n\t\t\t\t\tf.parentElement.prepend(tmp);\n\t\t\t\telse\n\t\t\t\t\tf.parentElement.insertBefore(tmp, f.nextElementSibling);\n\n\t\t\t\tsetTimeout((function (tmp) { return function() { tmp.classList.add('active'); } })(tmp), 25);\n\t\t\t}\n\n\t\t\tif (r.error && (tmp = this.querySelector('.message.error')) != null)\n\t\t\t{\n\t\t\t\ttmp.innerHTML = this.filterString(r.error, r).replace(/\\n/g, '<br/>');\n\t\t\t\ttmp.classList.remove('x-hidden');\n\t\t\t\ttmp.onanimationend = () => tmp.classList.add('x-hidden');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif ((tmp = this.querySelector('.message.error')) != null)\n\t\t\t{\n\t\t\t\ttmp.innerHTML = this.filterString(r.error, r).replace(/\\n/g, '<br/>') || ('Error: ' + r.response);\n\t\t\t\ttmp.classList.remove('x-hidden');\n\t\t\t\ttmp.onanimationend = () => tmp.classList.add('x-hidden');\n\t\t\t}\n\t\t}\n\t},\n\n\treset: function (nsilent)\n\t{\n\t\tthis.model.reset (nsilent);\n\t\tthis.clearMarkers();\n\n\t\tif (nsilent === false)\n\t\t{\n\t\t\tfor (var i in this.model.data)\n\t\t\t\tthis._setField (i, this.model.data[i], true);\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tsubmit: function ()\n\t{\n\t\tif (this.classList.contains('busy'))\n\t\t\treturn;\n\n\t\tlet data = { };\n\n\t\tif (this.dataset.strict == 'false')\n\t\t\tObject.assign(data, this.model.get());\n\n\t\tlet list = { };\n\t\tthis.querySelectorAll('[data-field]').forEach(e => list[e.dataset.field] = true);\n\t\tObject.keys(list).forEach(f => data[f] = this._getField(f));\n\n        if (this.onbeforesubmit)\n            this.onbeforesubmit(data);\n\n\t\tthis.model.set(data);\n\n\t\tlet f = this.dataset.formAction || this.formAction;\n\t\tif (!f) return;\n\n\t\tthis.clearMarkers();\n\n\t\tthis.classList.add('busy');\n\n\t\tif (typeof(f) != 'function')\n\t\t{\n\t\t\tdata.f = f;\n\t\t\tApi.apiCall(data, (r) => this[r.response == 200 ? '_onSuccess' : '_onFailure'](r), (r) => this._onFailure({ error: 'Unable to execute request.' }), this.dataset.method ?? 'POST');\n\t\t}\n\t\telse\n\t\t\tf(data, (r) => this[r.response == 200 ? '_onSuccess' : '_onFailure'](r));\n\t}\n});\n","/*\n    <r-panel data-route=\"name\">\n    </r-panel>\n\n    r-panel {\n        display: block;\n    }\n\n    r-panel:not(.active) {\n        display: none;\n    }\n\n    r-panel.inactive {\n    }\n\n    r-panel.active {\n    }\n*/\n\nimport Element from '../element.js';\nimport Router from '../router.js';\n\nexport default Element.register ('r-panel',\n{\n\t/**\n\t * Route object used by this element.\n\t */\n\troute: null,\n\n\t/**\n\t * Initializes the element.\n\t */\n\tinit: function()\n\t{\n\t\tthis.style.display = '';\n\n\t\t// Executed then the panel route is activated.\n\t\tthis._onActivate = (evt, args) =>\n\t\t{\n\t\t\tif (!args.route.changed)\n\t\t\t\treturn;\n\n\t\t\tthis.show(true);\n\t\t};\n\n\t\t// Executed then the panel route is deactivated.\n\t\tthis._onDeactivate = (evt, args) =>\n\t\t{\n\t\t\tthis.hide();\n\t\t};\n\n\t\tthis.hide();\n\t},\n\n\t/**\n\t * Adds a handler to Router if the data-route attribute was set.\n\t */\n\tonConnected: function()\n\t{\n\t\tif (this.dataset.route)\n\t\t{\n\t\t\tthis.route = Router.addRoute (this.dataset.route, this._onActivate, this._onDeactivate);\n\t\t\tthis.classList.remove('active');\n\t\t}\n\t\telse\n\t\t\tthis.classList.add('active');\n\t},\n\n\t/**\n\t * Removes a handler previously added to Router if the data-route attribute was set.\n\t */\n\tonDisconnected: function()\n\t{\n\t\tif (this.dataset.route)\n\t\t\tRouter.removeRoute(this.dataset.route, this._onActivate, this._onDeactivate);\n\t},\n\n\t/**\n\t * Hides the panel by removing the `active` and adding `inactive` class to the element. Fires `panelHidden` event.\n\t */\n\thide: function ()\n\t{\n\t\tthis.classList.remove('active');\n\t\tthis.classList.add('inactive');\n\t\tthis.dispatch('panelHidden', this.route ? this.route.args : { });\n\t},\n\n\t/**\n\t * Shows the panel visible by adding `active` and removing `inactive` class from the element. If `silent` is true and `data-route` enabled,\n\t * the current route will not be updated. Fires `panelShown` event.\n\t * @param {boolean} silent \n\t */\n\tshow: function (silent=false)\n\t{\n\t\tif (this.dataset.route && !silent)\n\t\t{\n\t\t\tlet hash = \"#\" + this.dataset.route;\n\n\t\t\tif (window.location.hash.substr(0, hash.length) != hash)\n\t\t\t{\n\t\t\t\twindow.location = hash;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.classList.remove('inactive');\n\t\tthis.classList.add('active');\n\t\tthis.dispatch('panelShown', this.route ? this.route.args : { });\n\t}\n});\n","/*\n\t<r-list data-list=\"window.dataList1\" data-container=\".x-data\" data-wrap=\"true|false\">\n\n\t\t<template data-mode=\"static|dynamic\">\n\t\t</template>\n\n\t\t<div class=\"x-empty\">\n\t\t\tNothing to show.\n\t\t</div>\n\n\t\t<div class=\"x-data\">\n\t\t</div>\n\n\t</r-list>\n\n\tCSS:\n\t\t.x-hidden {\n\t\t\tdisplay: none;\n\t\t}\n\n\tModifiers:\n\t\t.x-empty-null\t\tVisible when the list is in undefined state (before first load).\n\t\t.x-empty\t\t\tVisible when there is no data in the list.\n\t\t.x-not-empty \t\tVisible when there is data in the list.\n\t\t.x-loading \t\t\tVisible when the list is loading.\n*/\n\nimport { Rinn, ModelList, Template } from 'rinn';\nimport Element from '../element.js';\n\n/*\n**\tConnects to a ModelList and renders its contents using a template. When using \"dynamic\" template, the contents can be other custom elements, and\n**\tthe model of each item can be accessed by using data-model=\":list-item\", which will cause the item model to be added to the element.\n**\n**\tAdditionally root attribute data-wrap can be set to 'true' to wrap the template contents inside a div with a data-iid representing the ID of the\n**\titem, this will cause any changes to items to affect only the specific item in question.\n*/\n\nexport default Element.register ('r-list',\n{\n\tlist: null,\n\n\tcontainer: null,\n\ttemplate: null,\n\tisEmpty: false,\n\tisDynamicTemplate: false,\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tthis.container = this.querySelector(this.dataset.container || '.x-data');\n\t\tif (!this.container)\n\t\t{\n\t\t\tthis.container = document.createElement('div');\n\t\t\tthis.container.className = 'x-data';\n\t\t\tthis.appendChild(this.container);\n\t\t}\n\n\t\tlet tmp = this.template_elem = this.querySelector('template');\n\t\tif (tmp) {\n\t\t\tif (tmp.dataset.mode != 'dynamic') {\n\t\t\t\tthis.template = Template.compile(tmp.innerHTML);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.template = () => tmp.innerHTML;\n\t\t\t\tthis.isDynamicTemplate = true;\n\t\t\t}\n\n\t\t\ttmp.remove();\n\t\t}\n\t\telse\n\t\t\tthis.template = () => '';\n\n\t\tthis.container.textContent = ' ';\n\n\t\tthis.setEmpty(null);\n\t\tthis.setLoading(null);\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet list = this.dataList ?? this.getFieldByPath(this.dataset.list);\n\t\tif (!list) {\n\t\t\tif (this.dataset.list) console.error('data-list not found: ' + this.dataset.list);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setList(list);\n\t},\n\n\t/*\n\t**\tIndicates if the list is empty. Elements having x-empty, x-not-empty and x-empty-null will be updated.\n\t*/\n\tsetEmpty: function (value)\n\t{\n\t\tif (this.isEmpty === value)\n\t\t\treturn;\n\n\t\tif (value === true)\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-empty-null').forEach(i => i.classList.add('x-hidden'));\n\t\t}\n\t\telse if (value === false)\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-empty-null').forEach(i => i.classList.add('x-hidden'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-empty-null').forEach(i => i.classList.remove('x-hidden'));\n\t\t}\n\n\t\tthis.isEmpty = value;\n\t},\n\n\t/*\n\t**\tIndicates if the list is loading. Elements having x-loading will be updated.\n\t*/\n\tsetLoading: function (value)\n\t{\n\t\tif (value === true)\n\t\t\tthis.querySelectorAll('.x-loading').forEach(i => i.classList.remove('x-hidden'));\n\t\telse\n\t\t\tthis.querySelectorAll('.x-loading').forEach(i => i.classList.add('x-hidden'));\n\t},\n\n\t/**\n\t**\tSets the list model-list of the element.\n\t*/\n\tsetList: function (list)\n\t{\n\t\tif (!list || !Rinn.isInstanceOf(list, ModelList) || this.list === list)\n\t\t\treturn;\n\n\t\tif (this.list != null)\n\t\t{\n\t\t\tif (this.list.dataSource)\n\t\t\t\tthis.list.dataSource.removeEventListener (this.eid+':*');\n\n\t\t\tif (this.list.dataList)\n\t\t\t\tthis.list.dataList.removeEventListener (this.eid+':*');\n\n\t\t\tthis.list.removeEventListener (this.eid+':*');\n\t\t}\n\n\t\tthis.list = list;\n\n\t\tif (this.list.dataSource)\n\t\t{\n\t\t\tthis.list.dataSource.addEventListener (this.eid+':listLoading', this.onLoading, this);\n\t\t\tthis.list.dataSource.addEventListener (this.eid+':listLoaded', this.onLoaded, this);\n\t\t}\n\n\t\tif (this.list.dataList)\n\t\t{\n\t\t\tthis.list.dataList.addEventListener (this.eid+':listLoading', this.onLoading, this);\n\t\t\tthis.list.dataList.addEventListener (this.eid+':listLoaded', this.onLoaded, this);\n\t\t}\n\n\t\tthis.list.addEventListener (this.eid+':itemsCleared', this.onItemsCleared, this);\n\t\tthis.list.addEventListener (this.eid+':itemsChanged', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemRemoved', this.onItemRemoved, this);\n\t\tthis.list.addEventListener (this.eid+':itemChanged', this.onItemChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemAdded', this.onItemAdded, this);\n\t},\n\n\t/*\n\t**\tBuilds an item (inside a div) to be added to the container.\n\t*/\n\tbuildItem: function (iid, data, asHtml=false)\n\t{\n\t\tif (this.content) {\n\t\t\tlet elem = this.content(data.get());\n\t\t\telem.dataset.iid = iid;\n\t\t\treturn elem;\n\t\t}\n\n\t\tif (this.container.content) {\n\t\t\tlet elem = this.container.content(data.get());\n\t\t\telem.dataset.iid = iid;\n\t\t\treturn elem;\n\t\t}\n\n\t\tlet html = this.template(data.get());\n\t\tif (asHtml) return html;\n\n\t\tlet elem = document.createElement('div');\n\t\t\n\t\telem.dataset.iid = iid;\n\t\telem.innerHTML = html;\n\n\t\telem.querySelectorAll('[data-model=\":list-item\"]').forEach(i => {\n\t\t\ti.model = data;\n\t\t\ti.dataset.model = \"this.model\";\n\t\t});\n\n\t\tfor (let attr of this.template_elem.attributes)\n\t\t{\n\t\t\tif (attr.nodeName.startsWith('data-_') || attr.nodeName == 'data-mode')\n\t\t\t\tcontinue;\n\n\t\t\telem.setAttribute(attr.nodeName, attr.nodeValue);\n\t\t}\n\n\t\treturn elem;\n\t},\n\n\t/*\n\t**\tExecuted when the list is loading.\n\t*/\n\tonLoading: function()\n\t{\n\t\tthis.setLoading(true);\n\t},\n\n\t/*\n\t**\tExecuted when the list finished loading.\n\t*/\n\tonLoaded: function()\n\t{\n\t\tthis.setLoading(false);\n\t},\n\n\t/*\n\t**\tExecuted when the list is cleared.\n\t*/\n\tonItemsCleared: function()\n\t{\n\t\tthis.container._timeout = setTimeout(() => {\n\t\t\tthis.setEmpty(true);\n\t\t\tthis.container._timeout = null;\n\t\t\tthis.container.textContent = '';\n\t\t}, 300);\n\t},\n\n\t/*\n\t**\tExecuted when the items of the list changed.\n\t*/\n\tonItemsChanged: function()\n\t{\n\t\tif (this.list.length() == 0)\n\t\t\treturn;\n\n\t\tif (this.container._timeout)\n\t\t\tclearTimeout(this.container._timeout);\n\n\t\tthis.container._timeout = null;\n\t\tthis.container.textContent = '';\n\n\t\tlet i = 0;\n\n\t\tfor (let data of this.list.getData())\n\t\t{\n\t\t\tif (this.dataset.wrap != 'false')\n\t\t\t\tthis.container.append(this.buildItem(this.list.itemId[i++], data));\n\t\t\telse\n\t\t\t\tthis.container.innerHTML += this.buildItem(this.list.itemId[i++], data, true);\n\t\t}\n\n\t\tthis.setEmpty(i == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item is removed from the list.\n\t*/\n\tonItemRemoved: function(evt, args)\n\t{\n\t\tif (this.dataset.wrap == 'false')\n\t\t{\n\t\t\tthis.onItemsChanged();\n\t\t\treturn;\n\t\t}\n\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\telem.remove();\n\t\tthis.setEmpty(this.list.length() == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item changes.\n\t*/\n\tonItemChanged: function(evt, args)\n\t{\n\t\tif (this.isDynamicTemplate) return;\n\n\t\tif (this.dataset.wrap == 'false')\n\t\t{\n\t\t\tthis.onItemsChanged();\n\t\t\treturn;\n\t\t}\n\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\telem.innerHTML = this.template(args.item);\n\t},\n\n\t/*\n\t**\tExecuted when an item is added to the list.\n\t*/\n\tonItemAdded: function(evt, args)\n\t{\n\t\tif (args.position == 'head')\n\t\t{\n\t\t\tif (this.dataset.wrap != 'false')\n\t\t\t\tthis.container.prepend(this.buildItem(args.id, args.item));\n\t\t\telse\n\t\t\t\tthis.container.innerHTML = this.buildItem(args.id, args.item, true) + this.container.innerHTML;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.dataset.wrap != 'false')\n\t\t\t\tthis.container.append(this.buildItem(args.id, args.item));\n\t\t\telse\n\t\t\t\tthis.container.innerHTML += this.buildItem(args.id, args.item, true);\n\t\t}\n\n\t\tthis.setEmpty(false);\n\t},\n\n\t/**\n\t * \tForces re-rendering of the element.\n\t */\n\trefresh: function()\n\t{\n\t\tthis.onItemsChanged();\n\t}\n});\n","/*\n\t<r-item data-model=\"window.model1\">\n\t</r-item>\n*/\n\nimport Element from '../element.js';\n\nexport default Element.register ('r-item',\n{\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t},\n\n\t/**\n\t**\tExecuted when the children and root are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet model = this.getFieldByPath(this.dataset.model);\n\t\tif (!model) model = { };\n\n\t\tthis.setModel (model);\n\t}\n});\n","/*\n\t<r-paginator data-source=\"window.dataSource1\" data-page-size=\"25\">\n\t\t<span data-watch=\"count\">Showing [offsetStart] to [offsetEnd] out of [count]</span>\n\n\t\t<button data-action=\"firstPage\">First</button>\n\t\t<button data-action=\"prevPage\">&laquo;</button>\n\t\t<button data-action=\"nextPage\">&raquo;</button>\n\t\t<button data-action=\"lastPage\">Last</button>\n\t\t<button data-action=\"refresh\">Refresh</button>\n\n\t\t<input type=\"text\" data-property=\"pageSize\" />\n\t</r-paginator>\n*/\n\nimport { Rinn } from 'rinn';\nimport Element from '../element.js';\nimport DataSource from '../data-source.js';\n\n/*\n**\tConnects to a data source to provide pagination features.\n*/\n\nexport default Element.register ('r-paginator',\n{\n\tsource: null,\n\ttemplate: null,\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.setModel({\n\t\t\toffsetStart: 0,\n\t\t\toffsetEnd: 0,\n\t\t\tcount: 0, offset: 0,\n\t\t\tcurrentPageSize: this.dataset.pageSize || 25,\n\t\t\tpageSize: this.dataset.pageSize || 25\n\t\t});\n\n\t\tthis.listen('propertyChanged.pageSize', (evt, args) =>\n\t\t{\n\t\t\tif (this.model.get('currentPageSize') == args.value)\n\t\t\t\treturn;\n\n\t\t\tthis.model.set('currentPageSize', args.value);\n\t\t\tthis.updateOffset('range');\n\t\t});\n\t},\n\n\trready: function()\n\t{\n\t\tlet source = this.dataSource ?? this.getFieldByPath(this.dataset.source);\n\t\tif (!source) {\n\t\t\tif (this.dataset.source) console.error('data-source not found: ' + this.dataset.source);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setSource(source);\n\t},\n\n\t/**\n\t**\tSets the source model-list of the paginator.\n\t*/\n\tsetSource: function (source)\n\t{\n\t\tif (!source || !Rinn.isInstanceOf(source, DataSource) || this.source === source)\n\t\t\treturn;\n\n\t\tif (this.source != null)\n\t\t{\n\t\t\tthis.source.removeEventListener (this.eid+':*');\n\t\t\tthis.source.includeCount = false;\n\t\t}\n\n\t\tthis.source = source;\n\n\t\tthis.source.includeCount = true;\n\t\tthis.updateOffset();\n\n\t\tthis.source.addEventListener (this.eid+':requestPropertyChanged', this.onRequestPropertyChanged, this);\n\t\tthis.source.addEventListener (this.eid+':countChanged', this.onCountChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemRemoved', this.onItemRemoved, this);\n\t\tthis.source.addEventListener (this.eid+':listItemAdded', this.onItemAdded, this);\n\n\t\tthis.source.setNamespace(this.eid);\n\t\tthis.source.request.update(true);\n\t\tthis.source.setNamespace(null);\n\t},\n\n\t/*\n\t**\tUpdates several offset related fields in the paginator model. Optionally refreshes the data source with the specified mode.\n\t*/\n\tupdateOffset: function(mode=null)\n\t{\n\t\tthis.model.set('offsetStart', this.model.get('count') != 0 ? this.model.get('offset') + 1 : 0);\n\t\tthis.model.set('offsetEnd', Math.min(this.model.get('count'), this.model.get('offsetStart') + this.model.getInt('pageSize') - 1));\n\t\tthis.model.update('count');\n\n\t\tlet _count = this.source.request.get('count');\n\t\tlet _offset = this.source.request.get('offset');\n\n\t\tthis.source.request.set('count', this.model.getInt('pageSize'));\n\t\tthis.source.request.set('offset', this.model.get('offset'));\n\n\t\tif (mode && (_count != this.source.request.get('count') || _offset != this.source.request.get('offset')))\n\t\t\tthis.source.refresh(mode);\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the source request changes. The property is copied to the local model.\n\t*/\n\tonRequestPropertyChanged: function(evt, args)\n\t{\n\t\tif (args.name == 'count' || args.name == 'offset')\n\t\t\treturn;\n\n\t\tthis.model.set(args.name, args.value);\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the model has changed. The property is copied to the data source request model.\n\t*/\n\tonModelPropertyChanged: function (evt, args)\n\t{\n\t\tlet ignored = [\n\t\t\t'offsetStart',\n\t\t\t'offsetEnd',\n\t\t\t'count',\n\t\t\t'offset',\n\t\t\t'currentPageSize',\n\t\t\t'pageSize'\n\t\t];\n\n\t\tif (ignored.indexOf(args.name) != -1)\n\t\t\treturn;\n\n\t\tif (this.source.request.get(args.name) == args.value)\n\t\t\treturn;\n\n\t\tthis.source.request.set(args.name, args.value);\n\t\tthis.source.refresh('filter');\n\t},\n\n\t/*\n\t**\tExecuted when the remote count changes.\n\t*/\n\tonCountChanged: function(evt, args)\n\t{\n\t\tthis.model.set('count', evt.source.count, false);\n\t\tthis.updateOffset();\n\t},\n\n\t/*\n\t**\tExecuted when an item is removed from the list.\n\t*/\n\tonItemRemoved: function(evt, args)\n\t{\n\t\tthis.model.set('count', this.model.getInt('count') - 1, false);\n\t\tthis.updateOffset();\n\t},\n\n\t/*\n\t**\tExecuted when an item is added to the list.\n\t*/\n\tonItemAdded: function(evt, args)\n\t{\n\t\tthis.model.set('count', this.model.getInt('count') + 1, false);\n\t\tthis.updateOffset();\n\t},\n\n\t/*\n\t**\tMoves to the previous page.\n\t*/\n\tprevPage: function()\n\t{\n\t\tif (this.model.get('offset') <= 0)\n\t\t\treturn;\n\n\t\tlet offs = this.model.get('offset') - this.model.getInt('pageSize');\n\t\tif (offs < 0) offs = 0;\n\n\t\tthis.model.set('offset', offs);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tMoves to the next page.\n\t*/\n\tnextPage: function()\n\t{\n\t\tlet offs = this.model.get('offset') + this.model.getInt('pageSize');\n\t\tif (offs >= this.model.get('count')) return;\n\n\t\tthis.model.set('offset', offs);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tMoves to the first page.\n\t*/\n\tfirstPage: function()\n\t{\n\t\tthis.model.set('offset', 0);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tMoves to the last page.\n\t*/\n\tlastPage: function()\n\t{\n\t\tlet offs = this.model.get('count') - this.model.getInt('pageSize');\n\t\tif (offs < 0) offs = 0;\n\n\t\tthis.model.set('offset', offs);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tRefreshes the data source.\n\t*/\n\trefresh: function()\n\t{\n\t\tthis.source.refresh('full');\n\t},\n\n\t/*\n\t**\tClears (set to empty) the specified fields from the data source's request parameters.\n\t*/\n\tclear: function(args)\n\t{\n\t\tfor (let i = 0; i < args.length; i++)\n\t\t\tthis.model.set(args[i], '');\n\t}\n});\n","/*\n\t<r-table data-source=\"window.dataSource1\">\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>A</th>\n\t\t\t\t\t<th>B</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\n\t\t\t<tbody class=\"x-data\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td>[a]</td>\n\t\t\t\t\t<td>[b]</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</r-table>\n\n\tCSS:\n\t\t.x-hidden {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\tth[data-sort] {\n\t\t\tcursor: pointer; text-decoration: underline;\n\t\t}\n\n\t\tth[data-sort][data-order=\"asc\"]:before {\n\t\t\tcontent: \"\\25B2\";\n\t\t}\n\n\t\tth[data-sort][data-order=\"desc\"]:before {\n\t\t\tcontent: \"\\25BC\";\n\t\t}\n\n\tModifiers:\n\t\t.x-empty\t\t\tAdd to elements that should be shown only when there is no data in the data source.\n\t\t.x-not-empty \t\tAdd to elements that should be shown only when there is data in the data source.\n\t\t[data-sort]\t\t\tAdded to th/td elements in thead, marks the column as sortable.\n*/\n\nimport { Rinn, Template } from 'rinn';\nimport Element from '../element.js';\nimport DataSource from '../data-source.js';\n\n/*\n**\tConnects to a DataSource and renders its contents as a table.\n*/\n\nexport default Element.register ('r-table',\n{\n\tsource: null,\n\ttemplate: null,\n\tcontainer: null,\n\tisEmpty: null,\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.setModel({ });\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tthis.container = this.querySelector(this.dataset.container || 'tbody.x-data');\n\t\tif (!this.container) throw new Error ('r-table requires a container');\n\n\t\tif (this.container.dataset.mode != 'dynamic')\n\t\t\tthis.template = Template.compile(this.container.innerHTML);\n\t\telse\n\t\t\tthis.template = () => this.container.innerHTML;\n\n\t\tthis.temporalBody = document.createElement('tbody');\n\t\tthis.container.textContent = ' ';\n\n\t\tthis.setEmpty(true);\n\t},\n\n\t/**\n\t**\tExecuted when the children and root elements are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet source = this.dataSource ?? this.getFieldByPath(this.dataset.source);\n\t\tif (!source) {\n\t\t\tif (this.dataset.source) console.error('data-source not found: ' + this.dataset.source);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setSource(source);\n\t},\n\n\t/*\n\t**\tIndicates if the table is empty. Elements having .x-not-empty will be hidden.\n\t*/\n\tsetEmpty: function (value)\n\t{\n\t\tif (this.isEmpty === value)\n\t\t\treturn;\n\n\t\tif (value)\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t}\n\n\t\tthis.isEmpty = value;\n\t},\n\n\t/**\n\t**\tSets the data source of the element.\n\t*/\n\tsetSource: function (source)\n\t{\n\t\tif (!source || !Rinn.isInstanceOf(source, DataSource) || this.source === source)\n\t\t\treturn;\n\n\t\tif (this.source != null)\n\t\t\tthis.source.removeEventListener (this.eid+':*');\n\n\t\tthis.source = source;\n\n\t\tthis.source.addEventListener (this.eid+':requestPropertyChanged', this.onRequestPropertyChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemsCleared', this.onItemsCleared, this);\n\t\tthis.source.addEventListener (this.eid+':listItemsChanged', this.onItemsChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemRemoved', this.onItemRemoved, this);\n\t\tthis.source.addEventListener (this.eid+':listItemChanged', this.onItemChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemAdded', this.onItemAdded, this);\n\n\t\tthis.source.setNamespace(this.eid);\n\t\tthis.source.request.update(true);\n\t\tthis.source.setNamespace(null);\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the source request changes. The property is copied to the local model.\n\t*/\n\tonRequestPropertyChanged: function(evt, args)\n\t{\n\t\tthis.model.set(args.name, args.value);\n\n\t\tif (args.name == 'sort')\n\t\t{\n\t\t\tthis.querySelectorAll('thead [data-sort]').forEach(i => i.dataset.order = '');\n\t\t}\n\t\telse if (args.name == 'order')\n\t\t{\n\t\t\tlet elem = this.querySelector('thead [data-sort=\"'+evt.source.get('sort')+'\"]');\n\t\t\tif (elem) elem.dataset.order = args.value;\n\t\t}\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the model has changed. The property is copied to the data source request model.\n\t*/\n\tonModelPropertyChanged: function (evt, args)\n\t{\n\t\tif (this.source.request.get(args.name) == args.value)\n\t\t\treturn;\n\n\t\tthis.source.request.set(args.name, args.value);\n\n\t\tlet ignored = [\n\t\t\t'count',\n\t\t\t'offset'\n\t\t];\n\n\t\tif (ignored.indexOf(args.name) != -1)\n\t\t\treturn;\n\n\t\tthis.source.refresh('filter');\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the model is removed.\n\t*/\n\tonModelPropertyRemoved: function (evt, args)\n\t{\n\t\tif (typeof(args.fields) == 'string')\n\t\t\tthis.source.request.remove(i);\n\t\telse\n\t\t\targs.fields.forEach(i => this.source.request.remove(i));\n\n\t\tthis.source.refresh('filter');\n\t},\n\n\t/*\n\t**\tBuilds an item to be added to the container.\n\t*/\n\tbuildItem: function (iid, data)\n\t{\n\t\tif (this.container.content) {\n\t\t\tlet elem = this.container.content(data.get());\n\t\t\telem.dataset.iid = iid;\n\t\t\treturn elem;\n\t\t}\n\n\t\tlet elem = this.temporalBody;\n\n\t\telem.innerHTML = this.template(data.get());\n\n\t\telem.querySelectorAll('[data-model=\":list-item\"]').forEach(i => {\n\t\t\ti.model = data;\n\t\t\ti.dataset.model = \"this.model\";\n\t\t});\n\n\t\telem = elem.firstElementChild;\n\t\telem.dataset.iid = iid;\n\n\t\treturn elem;\n\t},\n\n\t/*\n\t**\tExecuted when the list is cleared.\n\t*/\n\tonItemsCleared: function(evt, args)\n\t{\n\t\tthis.container._timeout = setTimeout(() => {\n\t\t\tthis.setEmpty(true);\n\t\t\tthis.container._timeout = null;\n\t\t\tthis.container.textContent = '';\n\t\t}, 300);\n\t},\n\n\t/*\n\t**\tExecuted when the items of the list changed.\n\t*/\n\tonItemsChanged: function(evt, args)\n\t{\n\t\tif (this.source.list.length() == 0)\n\t\t\treturn;\n\n\t\tif (this.container._timeout)\n\t\t\tclearTimeout(this.container._timeout);\n\n\t\tthis.container._timeout = null;\n\t\tthis.container.textContent = '';\n\n\t\tlet i = 0;\n\n\t\tfor (let data of this.source.list.getData())\n\t\t\tthis.container.append(this.buildItem(this.source.list.itemId[i++], data));\n\n\t\tthis.setEmpty(i == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item is removed from the list.\n\t*/\n\tonItemRemoved: function(evt, args)\n\t{\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\telem.remove();\n\t\tthis.setEmpty(this.source.list.length() == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item changes.\n\t*/\n\tonItemChanged: function(evt, args)\n\t{\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\tlet _elem = this.buildItem(args.id, args.item);\n\t\tthis.container.replaceChild(_elem, elem);\n\t},\n\n\t/*\n\t**\tExecuted when an item is added to the list.\n\t*/\n\tonItemAdded: function(evt, args)\n\t{\n\t\tif (args.position == 'head')\n\t\t\tthis.container.prepend(this.buildItem(args.id, args.item));\n\t\telse\n\t\t\tthis.container.append(this.buildItem(args.id, args.item));\n\n\t\tthis.setEmpty(false);\n\t},\n\n\t/*\n\t**\tHandles clicks to data-sort elements.\n\t*/\n\t\"event click thead [data-sort]\": function(evt, args)\n\t{\n\t\tif (this.source.request.get('sort') == evt.source.dataset.sort)\n\t\t{\n\t\t\tthis.source.request.set('order', this.source.request.get('order') == 'asc' ? 'desc' : 'asc');\n\t\t\tthis.source.refresh('order');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.source.request.set('sort', evt.source.dataset.sort);\n\t\t\tthis.source.request.set('order', 'asc', true);\n\t\t\tthis.source.refresh('order');\n\t\t}\n\t},\n\n\t/*\n\t**\tRefreshes the data source.\n\t*/\n\trefresh: function()\n\t{\n\t\tthis.source.refresh('full');\n\t},\n\n\t/*\n\t**\tClears (set to empty) the specified fields from the data source's request parameters.\n\t*/\n\tclear: function(args)\n\t{\n\t\tfor (let i = 0; i < args.length; i++)\n\t\t\tthis.model.set(args[i], '');\n\t}\n});\n","/*\n\t<r-select data-list=\"window.dataList1\" data-blank=\"\"></r-select>\n*/\n\nimport { Rinn, ModelList } from 'rinn';\nimport Element from '../element.js';\n\n/*\n**\tConnects to a ModelList and renders its contents as a <select> element.\n*/\n\nexport default Element.register ('r-select',\n{\n\tlist: null,\n\tcontainer: null,\n\n\tvalue: '',\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.container = document.createElement('select');\n\t\tthis.parentElement.insertBefore(this.container, this);\n\n\t\tlet list = [];\n\n\t\tfor (let attr of this.attributes)\n\t\t{\n\t\t\tif (attr.nodeName.startsWith('data-_') || attr.nodeName == 'data-list' || attr.nodeName == 'data-blank')\n\t\t\t\tcontinue;\n\n\t\t\tthis.container.setAttribute(attr.nodeName, attr.nodeValue);\n\t\t\tlist.push(attr.nodeName);\n\t\t}\n\n\t\tlist.forEach(i => this.removeAttribute(i));\n\n\t\tthis.textContent = ' ';\n\t\tthis.style.display = 'none';\n\t},\n\n\t/**\n\t**\tExecuted when the children and parent of the element are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet list = this.dataList ?? this.getFieldByPath(this.dataset.list);\n\t\tif (!list) {\n\t\t\tif (this.dataset.list) console.error('data-list not found: ' + this.dataset.list);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setList(list);\n\n\t\tif (this.parentElement.lastElementChild !== this)\n\t\t\tthis.parentElement.append(this);\n\t},\n\n\t/**\n\t**\tSets the list model-list of the element.\n\t*/\n\tsetList: function (list)\n\t{\n\t\tif (!list || !Rinn.isInstanceOf(list, ModelList) || this.list === list)\n\t\t\treturn;\n\n\t\tif (this.list != null)\n\t\t\tthis.list.removeEventListener (this.eid+':*');\n\n\t\tthis.list = list;\n\n\t\tif (this.list.dataSource)\n\t\t\tthis.list.dataSource.includeEnum = true;\n\n\t\tthis.list.addEventListener (this.eid+':itemsCleared', this.onItemsCleared, this);\n\t\tthis.list.addEventListener (this.eid+':itemsChanged', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemRemoved', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemChanged', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemAdded', this.onItemsChanged, this);\n\n\t\tthis.onItemsChanged();\n\t},\n\n\t/*\n\t**\tExecuted when the list is cleared.\n\t*/\n\tonItemsCleared: function(evt, args)\n\t{\n\t\tthis.container.textContent = '';\n\t},\n\n\t/*\n\t**\tExecuted when the items of the list changed.\n\t*/\n\tonItemsChanged: function(evt, args)\n\t{\n\t\tif (this.list.length() == 0)\n\t\t\treturn;\n\n\t\tlet list = this.list.getData();\n\t\tlet value, label, s = '';\n\n\t\tif (list[0].has('value')) value = 'value';\n\t\telse if (list[0].has('id')) value = 'id';\n\n\t\tif (list[0].has('label')) label = 'label';\n\t\telse if (list[0].has('name')) label = 'name';\n\n\t\tif ('blank' in this.dataset)\n\t\t\ts += '<option value=\"\">'+this.dataset.blank+'</option>';\n\n\t\tif (list[0].has('group'))\n\t\t{\n\t\t\tlet groups = { };\n\t\t\tlist.forEach(i => groups[i.get('group')] = null);\n\n\t\t\tfor (let i in groups)\n\t\t\t\tgroups[i] = { name: i, list: [] };\n\n\t\t\tlist.forEach(i => groups[i.get('group')].list.push(i));\n\n\t\t\tgroups = Object.values(groups);\n\t\t\tgroups.forEach(g => {\n\t\t\t\ts += '<optgroup label=\"'+g.name+'\">';\n\t\t\t\tg.list.forEach(i => s += '<option value=\"'+i.get(value)+'\">'+i.get(label)+'</option>');\n\t\t\t\ts += '</optgroup>';\n\t\t\t});\n\t\t}\n\t\telse\n\t\t\tlist.forEach(i => s += '<option value=\"'+i.get(value)+'\">'+i.get(label)+'</option>');\n\n\t\tthis.container.innerHTML = s;\n\t\tthis.container.value = this.container.dataset.value;\n\t},\n\n\t/**\n\t * \tForces re-rendering of the element.\n\t */\n\trefresh: function()\n\t{\n\t\tthis.onItemsChanged();\n\t}\n});\n","\nconst Utils =\n{\n\t/**\n\t**\tForces the browser to show a download dialog.\n\t*/\n\tshowDownload: function (filename, url)\n\t{\n\t\tvar link = document.createElement(\"a\");\n\t\tlink.href = url;\n\n\t\tlink.style.display = 'none';\n\t\tlink.download = filename;\n\t\tlink.target = \"_blank\";\n\n\t\tdocument.body.appendChild(link);\n\t\tlink.click();\n\t\tdocument.body.removeChild(link);\n\t},\n\n\t/**\n\t**\tForces the browser to show a file selection dialog.\n\t*/\n\tshowFilePicker: function (allowMultiple, accept, callback)\n\t{\n\t\tvar input = document.createElement(\"input\");\n\n\t\tinput.type = \"file\";\n\t\tinput.accept = accept;\n\t\tinput.style.display = 'none';\n\t\tinput.multiple = allowMultiple;\n\n\t\tdocument.body.appendChild(input);\n\n\t\tinput.onchange = function () {\n\t\t\tcallback(input.files);\n\t\t};\n\n\t\tdocument.body.onfocus = function ()\n\t\t{\n\t\t\tdocument.body.onfocus = null;\n\t\t\tdocument.body.removeChild(input);\n\t\t};\n\n\t\tinput.click();\n\t},\n\n\t/**\n\t**\tLoads a URL using FileReader and returns as a dataURL.\n\t*/\n\tloadAsDataUrl: function (file, callback)\n\t{\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function(e) {\n\t\t\tcallback (e.target.result, null);\n\t\t};\n\n\t\treader.onerror = function(e) {\n\t\t\tcallback (null, e);\n\t\t};\n\n\t\treader.readAsDataURL(file);\n\t},\n\n\t/**\n\t**\tLoads a URL using FileReader and returns as text.\n\t*/\n\tloadAsText: function (file, callback)\n\t{\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function(e) {\n\t\t\tcallback (e.target.result);\n\t\t};\n\n\t\treader.readAsText(file);\n\t},\n\n\t/**\n\t**\tLoads a URL using FileReader and returns as an array buffer.\n\t*/\n\tloadAsArrayBuffer: function (file, callback)\n\t{\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function(e) {\n\t\t\tcallback (e.target.result);\n\t\t};\n\n\t\treader.readAsArrayBuffer(file);\n\t},\n\n\t/**\n\t**\tLoads an array of URLs using FileReader and returns them as data url.\n\t*/\n\tloadAllAsDataUrl: function (fileList, callback)\n\t{\n\t\tvar result = [];\n\n\t\tif (!fileList || !fileList.length)\n\t\t{\n\t\t\tcallback(result);\n\t\t\treturn;\n\t\t}\n\n\t\tvar loadNext = function (i)\n\t\t{\n\t\t\tif (i == fileList.length)\n\t\t\t{\n\t\t\t\tcallback(result);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tUtils.loadAsDataUrl (fileList[i], function(url, err) {\n\t\t\t\tif (!err) {\n\t\t\t\t\tresult.push({ name: fileList[i].name, size: fileList[i].size, url: url });\n\t\t\t\t}\n\t\t\t\tloadNext(i+1);\n\t\t\t});\n\t\t};\n\n\t\tloadNext(0);\n\t},\n\n\t/*\n\t**\tLoads a URL as an image.\n\t*/\n\tloadImageFromUrl: function (url, callback)\n\t{\n\t\tlet image = new Image();\n\t\timage.onload = () => callback(image);\n\t\timage.onerror = () => callback(null);\n\t\timage.src = url;\n\t}\n};\n\nexport default Utils;\n","\nimport _Tabs from './elems/r-tabs.js';\nimport _Form from './elems/r-form.js';\nimport _Panel from './elems/r-panel.js';\nimport _List from './elems/r-list.js';\nimport _Item from './elems/r-item.js';\nimport _Paginator from './elems/r-paginator.js';\nimport _Table from './elems/r-table.js';\nimport _Select from './elems/r-select.js';\nimport _ImageCropper from './elems/r-image-cropper.js';\n\nexport default {\n\tTabs: _Tabs,\n\tForm: _Form,\n\tPanel: _Panel,\n\tList: _List,\n\tItem: _Item,\n\tPaginator: _Paginator,\n\tTable: _Table,\n\tSelect: _Select,\n\tImageCropper: _ImageCropper\n};\n","/*\n\t<r-image-cropper>\n\t</r-image-cropper>\n*/\n\nimport Element from '../element.js';\nimport Utils from '../utils.js';\n\nexport default Element.register ('r-image-cropper',\n{\n\t/*\n\t**\tDefault aspect ratio.\n\t*/\n\taspectRatio: 1,\n\n\t/*\n\t**\tCurrent image scale.\n\t*/\n\timageScale0: 0, imageScale: 1,\n\n\t/*\n\t**\tImage translation offsets.\n\t*/\n\timageOffsX: 0, imageOffsY: 0,\n\n\t/*\n\t**\tPointer contexts.\n\t*/\n\tpointerA: null, pointerB: null,\n\n\t/*\n\t**\tClient bounding box.\n\t*/\n\tbounds: null,\n\n\t/*\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.canvas = document.createElement('canvas');\n\t\tthis.appendChild(this.canvas);\n\n\t\tthis.g = this.canvas.getContext('2d');\n\n\t\tthis.pointerA = { id: null, active: false, sx: 0, sy: 0, cx: 0, cy: 0, ix: 0, iy: 0 };\n\t\tthis.pointerB = { id: null, active: false, sx: 0, sy: 0, cx: 0, cy: 0, ix: 0, iy: 0 };\n\n\t\tthis.log = document.createElement('div');\n\t\tthis.appendChild(this.log);\n\t},\n\n\t/*\n\t**\tSets the image for the cropper from an image URL.\n\t*/\n\tsetImageUrl: function(url)\n\t{\n\t\tUtils.loadImageFromUrl(url, (image) => {\n\t\t\tthis.setImage(image);\n\t\t});\n\t},\n\n\t/*\n\t**\tSets the image for the cropper from an HTML File object.\n\t*/\n\tsetImageFile: function(file)\n\t{\n\t\tUtils.loadAsDataUrl(file, (url) => {\n\t\t\tUtils.loadImageFromUrl(url, (image) => {\n\t\t\t\tthis.setImage(image);\n\t\t\t});\n\t\t});\n\t},\n\n\t/*\n\t**\tSets the cropper image from an HTML Image element.\n\t*/\n\tsetImage: function(image)\n\t{\n\t\tthis.image = image;\n\n\t\tthis.reset();\n\n\t\tthis.imageScale = Math.max(this.canvas.width / this.image.width, this.canvas.height / this.image.height);\n\n\t\tthis.imageOffsX = (this.canvas.width - this.imageScale*this.image.width)*0.5;\n\t\tthis.imageOffsY = (this.canvas.height - this.imageScale*this.image.height)*0.5;\n\n\t\tthis.render();\n\t},\n\n\t/*\n\t**\tReturns the blob and URL representing the current canvas state.\n\t*/\n\tgetBlobAndUrl: function(callback, type='image/png', quality=0.9)\n\t{\n\t\tthis.canvas.toBlob((blob) => {\n\t\t\tcallback(blob, URL.createObjectURL(blob));\n\t\t},\n\t\ttype, quality);\n\t},\n\n\t/*\n\t**\tAuto-resizes the canvas to ensure the aspect ratio is maintained.\n\t*/\n\treset: function()\n\t{\n\t\tthis.bounds = this.getBoundingClientRect();\n\n\t\tthis.canvas.width = this.bounds.width;\n\t\tthis.canvas.height = this.bounds.width/this.aspectRatio;\n\t},\n\n\t/*\n\t**\tAuto-resizes the canvas to ensure the aspect ratio is maintained and renders the image.\n\t*/\n\trender: function()\n\t{\n\t\tthis.canvas.width = this.canvas.width;\n\n\t\tthis.g.fillStyle = '#000';\n\t\tthis.g.beginPath();\n\t\tthis.g.rect(0, 0, this.canvas.width, this.canvas.height);\n\t\tthis.g.fill();\n\n\t\tthis.g.translate(this.imageOffsX, this.imageOffsY);\n\t\tthis.g.scale(this.imageScale, this.imageScale);\n\t\tthis.g.drawImage(this.image, 0, 0);\n\t},\n\n\t/*\n\t**\tTranslates the image by the given offsets.\n\t*/\n\ttranslateImage: function(offsX, offsY)\n\t{\n\t\tthis.imageOffsX += offsX;\n\t\tthis.imageOffsY += offsY;\n\n\t\tthis.render(true);\n\t},\n\n\t/*\n\t**\tHandle mouse events on the canvas.\n\t*/\n\t\"event mousemove canvas\": function(evt)\n\t{\n\t\tif (this.pointerA.active)\n\t\t{\n\t\t\tthis.pointerA.cx = evt.clientX;\n\t\t\tthis.pointerA.cy = evt.clientY;\n\n\t\t\tthis.translateImage(this.pointerA.cx - this.pointerA.sx, this.pointerA.cy - this.pointerA.sy);\n\n\t\t\tthis.pointerA.sx = this.pointerA.cx;\n\t\t\tthis.pointerA.sy = this.pointerA.cy;\n\t\t}\n\n\t\tthis.pointerA.ix = ((evt.clientX-this.bounds.left) - this.imageOffsX) / this.imageScale;\n\t\tthis.pointerA.iy = ((evt.clientY-this.bounds.top) - this.imageOffsY) / this.imageScale;\n\t},\n\n\t\"event mousedown canvas\": function(evt)\n\t{\n\t\tthis.pointerA.active = true;\n\t\tthis.pointerA.sx = evt.clientX;\n\t\tthis.pointerA.sy = evt.clientY;\n\t},\n\n\t\"event mouseup canvas\": function(evt)\n\t{\n\t\tthis.pointerA.active = false;\n\t},\n\n\t\"event wheel canvas\": function(evt)\n\t{\n\t\tif (evt.deltaY > 0)\n\t\t\tthis.imageScale -= 0.045;\n\t\telse\n\t\t\tthis.imageScale += 0.045;\n\n\t\tif (this.imageScale < 0.1) this.imageScale = 0.1;\n\n\t\tthis.imageOffsX += -this.pointerA.ix*this.imageScale + (evt.clientX-this.bounds.left) - this.imageOffsX;\n\t\tthis.imageOffsY += -this.pointerA.iy*this.imageScale + (evt.clientY-this.bounds.top) - this.imageOffsY;\n\n\t\tthis.render();\n\t},\n\n\t/*\n\t**\tHandle touch events on the canvas.\n\t*/\n\t\"event touchmove canvas\": function(evt)\n\t{\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerA.cx = i.clientX;\n\t\t\t\tthis.pointerA.cy = i.clientY;\n\t\t\t}\n\t\t\telse if (this.pointerB.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerB.cx = i.clientX;\n\t\t\t\tthis.pointerB.cy = i.clientY;\n\t\t\t}\n\t\t}\n\n\t\tif (this.pointerA.active && this.pointerB.active)\n\t\t{\n\t\t\tlet d0 = Math.sqrt(Math.pow(this.pointerA.sx-this.pointerB.sx, 2) + Math.pow(this.pointerA.sy-this.pointerB.sy, 2));\n\t\t\tlet d1 = Math.sqrt(Math.pow(this.pointerA.cx-this.pointerB.cx, 2) + Math.pow(this.pointerA.cy-this.pointerB.cy, 2));\n\n\t\t\tlet d = d1 - d0;\n\t\t\tthis.imageScale += (d/10)*0.025;\n\t\t\tif (this.imageScale < 0.1) this.imageScale = 0.1;\n\n\t\t\tthis.imageOffsX += -this.pointerA.ix*this.imageScale + (this.pointerA.cx-this.bounds.left) - this.imageOffsX;\n\t\t\tthis.imageOffsY += -this.pointerA.iy*this.imageScale + (this.pointerA.cy-this.bounds.top) - this.imageOffsY;\n\n\t\t\tthis.pointerA.sx = this.pointerA.cx;\n\t\t\tthis.pointerA.sy = this.pointerA.cy;\n\n\t\t\tthis.pointerB.sx = this.pointerB.cx;\n\t\t\tthis.pointerB.sy = this.pointerB.cy;\n\n\t\t\tthis.render();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet p = this.pointerA.active ? this.pointerA : (this.pointerB.active ? this.pointerB : null);\n\t\t\tif (!p) return;\n\n\t\t\tthis.translateImage(p.cx - p.sx, p.cy - p.sy);\n\n\t\t\tp.sx = p.cx;\n\t\t\tp.sy = p.cy;\n\t\t}\n\t},\n\n\t\"event touchstart canvas\": function(evt)\n\t{\n\t\tthis.imageScale0 = this.imageScale;\n\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id === null)\n\t\t\t{\n\t\t\t\tthis.pointerA.id = i.identifier;\n\t\t\t\tthis.pointerA.active = true;\n\t\t\t\tthis.pointerA.sx = i.clientX;\n\t\t\t\tthis.pointerA.sy = i.clientY;\n\t\t\t\tthis.pointerA.ix = ((i.clientX-this.bounds.left) - this.imageOffsX) / this.imageScale;\n\t\t\t\tthis.pointerA.iy = ((i.clientY-this.bounds.top) - this.imageOffsY) / this.imageScale;\n\t\t\t}\n\t\t\telse if (this.pointerB.id === null)\n\t\t\t{\n\t\t\t\tthis.pointerB.id = i.identifier;\n\t\t\t\tthis.pointerB.active = true;\n\t\t\t\tthis.pointerB.sx = i.clientX;\n\t\t\t\tthis.pointerB.sy = i.clientY;\n\t\t\t\tthis.pointerB.ix = ((i.clientX-this.bounds.left) - this.imageOffsX) / this.imageScale;\n\t\t\t\tthis.pointerB.iy = ((i.clientY-this.bounds.top) - this.imageOffsY) / this.imageScale;\n\t\t\t}\n\t\t}\n\t},\n\n\t\"event touchend canvas\": function(evt)\n\t{\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerA.id = null;\n\t\t\t\tthis.pointerA.active = false;\n\t\t\t}\n\t\t\telse if (this.pointerB.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerB.id = null;\n\t\t\t\tthis.pointerB.active = false;\n\t\t\t}\n\t\t}\n\t},\n\n\t\"event touchcancel canvas\": function(evt)\n\t{\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerA.id = null;\n\t\t\t\tthis.pointerA.active = false;\n\t\t\t}\n\t\t\telse if (this.pointerB.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerB.id = null;\n\t\t\t\tthis.pointerB.active = false;\n\t\t\t}\n\t\t}\n\t}\n});\n","\nimport { Rinn } from 'rinn';\n\n//!class db\n\nexport default\n{\n\t/**\n\t * Database connection.\n\t */\n\tdb: null,\n\n\t/**\n\t * Initializes the database connection.\n\t * @param {string} dbName\n\t * @param {number} version\n\t * @param {(db: IDBDatabase, txn: IDBTransaction, oldVersion: number) => void} upgradeCallback\n\t * @returns {Promise<void>}\n\t * !static init (dbName: string, version: number, upgradeCallback: (db: IDBDatabase, txn: IDBTransaction, oldVersion: number) => void) : Promise<void>;\n\t */\n\tinit: function (dbName, version, upgradeCallback)\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif (!global.indexedDB)\n\t\t\t{\n\t\t\t\treject ('IndexedDB is not available in your system.');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet req = indexedDB.open(dbName, version);\n\t\t\treq.onerror = (evt) =>\n\t\t\t{\n\t\t\t\tlet err = evt.target.error + '';\n\n\t\t\t\tif (err.indexOf('AbortError') !== -1)\n\t\t\t\t\terr = \"\\n\" + req.message;\n\n\t\t\t\treject('Unable to open database: ' + err);\n\t\t\t\treturn;\n\t\t\t};\n\n\t\t\treq.onupgradeneeded = async (evt) =>\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tconst db = evt.target.result;\n\t\t\t\t\tconst txn = evt.target.transaction;\n\n\t\t\t\t\tif (evt.oldVersion < 1)\n\t\t\t\t\t\tdb.createObjectStore('system', { keyPath: ['name'] });\n\n\t\t\t\t\tawait upgradeCallback(db, txn, evt.oldVersion);\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\treq.message = e.message;\n\t\t\t\t\treq.transaction.abort();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treq.onsuccess = async (evt) =>\n\t\t\t{\n\t\t\t\tthis.db = evt.target.result;\n\t\t\t\tresolve();\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Ensures the database is ready to be used, or throws an exception.\n\t */\n\tensureConnected: function()\n\t{\n\t\tif (!this.db)\n\t\t\talert('Error: Database not initialized.');\n\t},\n \n\t/**\n\t * Returns an index object for later use with methods that accept an IDBIndex in the `storeName` parameter.\n\t * @param {string} storeName\n\t * @param {string} indexName\n\t * @returns {IDBIndex}\n\t * !static index (storeName: string, indexName: string) : IDBIndex;\n\t */\n\tindex: function (storeName, indexName)\n\t{\n\t\tthis.ensureConnected();\n\n\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\n\t\tlet index = store.index(indexName);\n\t\tif (!index) throw new Error ('Unable to find index `' + indexName + '` in store ' + storeName);\n\n\t\treturn index;\n\t},\n\n\t/**\n\t * Runs a callback for each record in a data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string} id\n\t * @param { (value:object, cursor:IDBCursor) => Promise<boolean> } callback\n\t * @returns {Promise<void>}\n\t * !static forEach (storeName: string|IDBIndex|IDBObjectStore, id: string, callback: (value:object, cursor:IDBCursor) => Promise<boolean>) : Promise<void>;\n\t */\n\tforEach: function (storeName, id, callback)\n\t{\n\t\tthis.ensureConnected();\n\n\t\tif (typeof(id) === 'function')\n\t\t{\n\t\t\tcallback = id;\n\t\t\tid = null;\n\t\t}\n\n\t\treturn new Promise(async (resolve, reject) =>\n\t\t{\n\t\t\tlet request, store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tif (id === null)\n\t\t\t\trequest = store.openCursor();\n\t\t\telse\n\t\t\t\trequest = store.openCursor(id);\n\n\t\t\trequest.onsuccess = async (event) =>\n\t\t\t{\n\t\t\t\tlet cursor = event.target.result;\n\t\t\t\tif (!cursor)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet result = await callback (cursor.value, cursor);\n\t\t\t\tif (result === false)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcursor.continue();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns the count of all records from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @returns {Promise<number>}\n\t * !static count (storeName: string|IDBIndex|IDBObjectStore) : Promise<number>;\n\t */\n\tcount: function (storeName)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.count();\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns all records from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} filter\n\t * @returns {Promise<Array<object>>}\n\t * !static getAll (storeName: string|IDBIndex|IDBObjectStore, filter?: string|number|Array<string|number>) : Promise<Array<object>>;\n\t */\n\tgetAll: function (storeName, filter=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.getAll(filter);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns all keys from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} filter\n\t * @returns {Promise<Array<string|number|Array<string|number>>>}\n\t * !static getAllKeys (storeName: string|IDBIndex|IDBObjectStore, filter?: string|number|Array<string|number>) : Promise<Array<object>>;\n\t */\n\tgetAllKeys: function (storeName, filter=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.getAllKeys(filter);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Loads a list of records having unique values from the specified data store and returns the entire object or just the specified field.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string} [field]\n\t * @returns {Promise<Array<number|string|object>>}\n\t * !static getAllUnique (storeName: string|IDBIndex|IDBObjectStore) : Promise<Array<number|string|object>>;\n\t */\n\tgetAllUnique: function (storeName, fieldName=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.openCursor(null, 'nextunique');\n\t\t\tlet list = [];\n\n\t\t\trequest.onsuccess = (event) =>\n\t\t\t{\n\t\t\t\tlet cursor = event.target.result;\n\t\t\t\tif (!cursor)\n\t\t\t\t{\n\t\t\t\t\tresolve(list);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlist.push(fieldName ? cursor.value[fieldName] : cursor.value);\n\t\t\t\tcursor.continue();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns a single record from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} id\n\t * @returns {Promise<object>}\n\t * !static get (storeName: string|IDBIndex|IDBObjectStore, id: string|number|Array<string|number>) : Promise<object>;\n\t */\n\tget: function (storeName, id)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.get(id);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result || null);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\n\t/**\n\t * Adds or overwrites a record in the specified data store (data must include the primary key).\n\t * @param {string} storeName\n\t * @param {object} data\n\t * @returns {Promise<void>}\n\t * !static put (storeName: string, data: object) : Promise<void>;\n\t */\n\tput: function (storeName, data)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\t\t\tlet request = store.put(data);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns a variable from the system table.\n\t * @param {string} name - Name of the property to read.\n\t * @param {boolean} full - When `true` the entire object will be returned.\n\t * @returns {any}\n\t * !static sysGet (name: string, full?: boolean) : any;\n\t */\n\tsysGet: async function (name, full=false)\n\t{\n\t\tlet data = await this.get('system', [name]);\n\t\treturn data ? (full ? data : data.value) : null;\n\t},\n\n\t/**\n\t * Writes a variable to the system table.\n\t * @param {string} name - Name of the property to write.\n\t * @param {any} value - Value to write.\n\t * @param {boolean} full - When `true` the entire value will be written as-is.\n\t * @returns {void}\n\t * !static sysPut (name: string, value: any, full?: boolean) : void;\n\t */\n\tsysPut: async function (name, value, full=false)\n\t{\n\t\tif (full)\n\t\t{\n\t\t\tvalue.name = name;\n\t\t\tawait this.put('system', value);\n\t\t}\n\t\telse\n\t\t\tawait this.put('system', { name: name, value: value });\n\t},\n\n\t/**\n\t * Returns a single record from the specified data store that matches the `partial` object and does NOT match the `notPartial` object.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {object} [partial]\n\t * @param {object} [notPartial]\n\t * @returns {Promise<object>}\n\t * !static findOne (storeName: string|IDBIndex|IDBObjectStore, partial?: object, notPartial?: object) : Promise<object>;\n\t */\n\tfindOne: function (storeName, partial=null, notPartial=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.openCursor();\n\n\t\t\trequest.onsuccess = (event) =>\n\t\t\t{\n\t\t\t\tlet cursor = event.target.result;\n\t\t\t\tif (!cursor)\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (partial === null || Rinn.partialCompare(cursor.value, partial))\n\t\t\t\t{\n\t\t\t\t\tif (notPartial !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Rinn.partialCompare(cursor.value, notPartial))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcursor.continue();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(cursor.value);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcursor.continue();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Deletes a record from the specified data store.\n\t * @param {string} storeName\n\t * @param {string|number|Array<string|number>} id\n\t * @returns {Promise<void>}\n\t * !static delete (storeName: string, id: string|number|Array<string|number>) : Promise<void>;\n\t */\n\tdelete: function (storeName, id)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\n\t\t\tlet request = store.delete(id);\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Deletes all items in the specified store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} id\n\t * @returns {Promise<void>}\n\t * !static deleteAll (storeName: string|IDBIndex|IDBObjectStore, id: string|number|Array<string|number>) : Promise<void>;\n\t */\n\tdeleteAll: function (storeName, id=null)\n\t{\n\t\treturn this.forEach(storeName, id, async (value, cursor) => {\n\t\t\tawait cursor.delete();\n\t\t});\n\t},\n\n\t/**\n\t * Inserts a new record in the specified data store.\n\t * @param {string} storeName\n\t * @param {object} data\n\t * @returns {Promise<void>}\n\t * !static insert (storeName: string, data: object) : Promise<void>;\n\t */\n\tinsert: function (storeName, data)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\t\t\tlet request = store.add(data);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t}\n};\n\n//!/class\n","\n/**\n * Indicates if signal debugging is enabled. When so, every signal change will be logged to the console.\n */\nexport let debugSignals = false;\n\n/**\n * Signal class.\n */\nexport class Signal\n{\n    #value;\n    #defvalue;\n    #listeners;\n    #label;\n\n    constructor (value, defvalue)\n    {\n        this.#value = value;\n        this.#label = null;\n\n        this.#defvalue = defvalue;\n        this.#listeners = [];\n    }\n\n    get value() {\n        return this.#value;\n    }\n\n    set value(val) {\n        if (this.#value === val) return;\n        this.#value = val;\n        this.notify();\n    }\n\n    get() {\n        return this.value;\n    }\n\n    set(value) {\n        this.value = value;\n        return this;\n    }\n\n    label (value=null)\n    {\n        if (value === null)\n            return this.#label;\n        this.#label = value;\n        return this;\n    }\n\n    reset() {\n        this.value = this.#defvalue;\n        return this;\n    }\n\n    connect (callback) {\n        this.#listeners.push(callback);\n        return this;\n    }\n\n    notify()\n    {\n        if (debugSignals)\n            console.log('CHANGED', this.#label, this.#listeners.length);\n\n        for (let callback of this.#listeners)\n            callback();\n    }\n};\n\n/**\n * Creates a new signal object.\n * @param {*} value?\n * @param {*} defaultValue?\n * @returns {Signal}\n */\nexport function signal (value=null, defaultValue=null)\n{\n    return new Signal (value, defaultValue);\n}\n\n/**\n * Creates a new signal as an expression of the specified signals evaluated by the given function.\n * @param {Array<Signal|*>} signals \n * @param {Function} evaluator \n * @returns {Signal}\n */\nexport function expr (signals, evaluator)\n{\n    let active = [];\n    let notified = false;\n\n    for (let i = 0; i < signals.length; i++)\n    {\n        if (signals[i] instanceof Signal)\n            active.push([i, signals[i]]);\n    }\n\n    if (!active.length)\n        return evaluator(...signals);\n\n    const sgn = signal();\n\n    const update = function() {\n        for (let i of active)\n            signals[i[0]] = i[1].value;\n        sgn.value = evaluator(...signals);\n        notified = false;\n    };\n\n    const debouncer = function() {\n        if (notified) return;\n        notified = true;\n        queueMicrotask(update);\n    };\n\n    for (let i of active)\n        i[1].connect(debouncer);\n\n    update();\n    return sgn;\n}\n\n/**\n * Creates a new watcher, such that if any signal changes the evaluator will be run.\n * @param {Array<Signal|*>} signals \n * @param {Function} evaluator \n * @param {boolean} initialRun? Set to `false` to disable the initial run of the evaluator.\n */\nexport function watch (signals, evaluator, initialRun=true)\n{\n    let active = [];\n    let notified = false;\n\n    for (let i = 0; i < signals.length; i++)\n    {\n        if (signals[i] instanceof Signal)\n            active.push([i, signals[i]]);\n    }\n\n    if (!active.length) {\n        if (initialRun) evaluator(...signals);\n        return;\n    }\n\n    const update = function() {\n        for (let i of active)\n            signals[i[0]] = i[1].value;\n        evaluator(...signals);\n        notified = false;\n    };\n\n    const debouncer = function() {\n        if (notified) return;\n        notified = true;\n        queueMicrotask(update);\n    };\n\n    for (let i of active)\n        i[1].connect(debouncer);\n\n    if (initialRun) update();\n}\n\n/**\n * Helper functions used by the JSX transformer.\n */\nexport const helpers =\n{\n    /**\n     * Special object to tag dynamic attributes.\n     */\n    DYNAMIC: { },\n\n    /**\n     * Sets the value of a property inside an object.\n     * @param {Element|Text} root\n     * @param {string[]} path\n     * @param {number} lastIndex\n     * @param {object} value\n     */\n    setValue: function (root, path, lastIndex, value)\n    {\n        // Rename properties `class`, `classList` to `className`.\n        if (path[0] === 'class' || path[0] === 'classList')\n            path[0] = 'className';\n\n        if (path.length > 1 && path[0] === 'trait')\n        {\n            switch (path[1])\n            {\n                case 'valueSignal':\n                    root.onchange = (e) => value.set(e.currentTarget.value);\n                    watch([value], (value) => root.value = value);\n                    break;\n\n                case 'inputSignal':\n                    root.oninput = (e) => value.set(e.currentTarget.value);\n                    watch([value], (value) => root.value = value);\n                    break;\n\n                default:\n                    console.error('Unknown trait: ' + path[1]);\n                    break;\n            }\n\n            return;\n        }\n\n        // Object used to set `style` or `class` attribute.\n        if (path.length === 1 && typeof(value) === 'object')\n        {\n            switch (path[0])\n            {\n                case 'style':\n                    for (let i in value)\n                        watch([i, value[i]], (i, value) => root.style[i] = value);\n                    return;\n\n                case 'className':\n                    if (value instanceof Array)\n                    {\n                        watch([value], (value) => {\n                            root.className = '';\n                            for (let i in value)\n                                root.classList.add(value[i]);\n                        });\n                    }\n                    else {\n                        for (let i in value)\n                            watch([i, value[i]], (i, value) => root.classList[value == true ? 'add' : 'remove'](i));\n                    }\n                    return;\n            }\n        }\n\n        // Specific CSS class such as `class:hidden`.\n        if (path.length === 2 && path[0] === 'className')\n        {\n            watch([path[1], value], (i, value) => root.classList[value == true ? 'add' : 'remove'](i));\n            return;\n        }\n\n        // Any other attribute/property.\n        for (let i = 0; i < lastIndex && root; i++)\n            root = root[path[i]];\n\n        if (root)\n            watch([path[lastIndex], value], (name, value) => root[name] = value);\n    },\n\n    /**\n     * Creates a setter for a specified path inside an object.\n     * @param {string[]} path \n     * @returns {(root: Element|Text, value: object) => void}\n     */\n    createSetter: function (path)\n    {\n        const n = path.length-1;\n\n        return function (root, value) {\n            helpers.setValue(root, path, n, value);\n        };\n    },\n\n    /**\n     * Copies the event listeners and custom properties from `node` to `newNode`.\n     * @param {Element} node\n     * @param {Element} newNode\n     * @returns {Element}\n     */\n    copyProps: function (node, newNode)\n    {\n        // Copy property event listeners.\n        for (let propName in node)\n        {\n            if (!propName.startsWith('on') || propName.startsWith('onmoz') || !node[propName])\n                continue;\n\n            newNode[propName] = node[propName];\n        }\n\n        // Copy custom properties.\n        for (let propName of Object.getOwnPropertyNames(node))\n        {\n            if (~~propName == propName) // Skip numeric properties.\n                continue;\n\n            newNode[propName] = node[propName];\n        }\n\n        return newNode;\n    },\n\n    /**\n     * Clones an element node and ensures certain properties are copied over.\n     * @param {Element} node\n     * @param {boolean} [deep=false]\n     */\n    cloneNode: function (node, deep=false)\n    {\n        if (!deep && node.isCustom === true)\n            throw new Error ('cloneNode only available as deep clone for custom elements.');\n\n        if (deep && node.isCustom === true)\n            return node.cloneNodeCustom();\n\n        let newNode = node.cloneNode();\n\n        if (deep) {\n            for (let childNode of node.childNodes)\n                newNode.appendChild(helpers.cloneNode(childNode, true));\n        }\n\n        // Copy handlers and properties.\n        helpers.copyProps(node, newNode);\n\n        // Execute `oncreated` handler.\n        if ('oncreated' in newNode)\n            newNode.oncreated(newNode);\n\n        return newNode;\n    },\n\n    /**\n     * Ensures the provided value is a node or a node-compatible (such as an array of nodes).\n     * @param {Node|Array<Node|string>|string} value\n     * @param {boolean} [cloneNode=false]\n     * @returns {Node|Array<Node>}\n     */\n    ensureNode: function (value, cloneNode=false)\n    {\n        if (value instanceof Array) {\n            for (let i = 0; i < value.length; i++)\n                value[i] = helpers.ensureNode(value[i], cloneNode);\n            return value;\n        }\n\n        if (!(value instanceof Node))\n            return document.createTextNode(value);\n\n        return cloneNode ? helpers.cloneNode(value, true) : value;\n    },\n\n    /**\n     * Replaces the specified refNode by a newNode and returns the new reference node.\n     * @param {Node} parent\n     * @param {Node|Array<Node>} refNode\n     * @param {Node|Array<Node>} newNode\n     * @returns {Node|Array<Node>}\n     */\n    replaceNode: function (parent, refNode, newNode, appendChild=false)\n    {\n        // When refNode is an array, remove all those nodes but leave just one for reference.\n        if (refNode instanceof Array)\n        {\n            while (refNode.length > 1) {\n                let tmp = refNode.shift();\n                if (tmp.parentElement === parent)\n                    tmp.remove();\n            }\n            refNode = refNode.shift();\n        }\n\n        let newRefNode = newNode;\n        let firstNode = newNode;\n\n        // When newNode is an array, create a document fragment for faster append of all children.\n        if (newNode instanceof Array)\n        {\n            let frag = document.createDocumentFragment();\n            newRefNode = [];\n\n            if (newNode.length == 0)\n                newNode = [document.createTextNode('')];\n\n            for (let i = 0; i < newNode.length; i++) {\n                newRefNode.push(newNode[i]);\n                frag.appendChild(newNode[i]);\n            }\n\n            firstNode = newNode[0];\n            newNode = frag;\n        }\n\n        if (appendChild === false)\n        {\n            refNode.replaceWith(newNode);\n\n            let tmpNode = document.createComment('');\n            firstNode.parentElement.insertBefore(tmpNode, firstNode);\n\n            if (!(newRefNode instanceof Array))\n                newRefNode = [ newRefNode ];\n\n            newRefNode.push(tmpNode);\n        }\n        else\n            refNode.appendChild(newNode);\n\n        return newRefNode;\n    },\n\n    /**\n     * Creates a DOM node replacer.\n     * @param {Element|Text|Array<Element|Text>} refNode\n     * @returns {(root: Element|Text, newNode: any) => void}\n     */\n    createReplacer: function (refNode)\n    {\n        return function (root, newNode) {\n            refNode = helpers.replaceNode(root, refNode, helpers.ensureNode(newNode));\n        };\n    },\n\n    /**\n     * Creates a function that builds an element.\n     * @param {string} tagName - Tag of the element to create.\n     * @param {array} attributes - Array of name-value pairs. When dynamic attributes are present use the helpers.DYNAMIC as value placeholder.\n     * @param {Array<Element|Text|string|null>} children - When dynamic children are present use the placeholder `null`.\n     * @returns { (runtimeAttributeValues: Array<string>, runtimeChildren: Array<Element|Text|Array<Element|Text>>) => HTMLElement }\n     */\n    create: function (tagName, attributes, children)\n    {\n        // Attach static attributes.\n        let baseElement = document.createElement(tagName);\n        let dynamicAttributes = [];\n\n        for (let i = 0; i < attributes.length; i += 2)\n        {\n            let path = null;\n\n            if (attributes[i].indexOf(':') !== -1)\n                path = attributes[i].split(':');\n            else\n                path = [attributes[i]];\n\n            if (attributes[i+1] !== helpers.DYNAMIC) {\n                helpers.setValue(baseElement, path, path.length-1, attributes[i+1]);\n                continue;\n            }\n\n            dynamicAttributes.push(helpers.createSetter(path));\n        }\n\n        // Attach static children.\n        let dynamicChildrenIndices = [];\n        let dynamicBuild = false;\n        let firstBuild = true;\n\n        // Get indices of dynamic children and detect if any child is a custom element.\n        for (let i in children)\n        {\n            if (children[i].isCustom === true)\n                dynamicBuild = true;\n\n            if (children[i] === helpers.DYNAMIC)\n                dynamicChildrenIndices.push(i);\n        }\n\n        // Create and return the element builder fuction.\n        const N = dynamicAttributes.length;\n        const M = dynamicChildrenIndices.length;\n\n        return function (runtimeDynamicAttributes, runtimeChildren, spreadAttributes=null)\n        {\n            const getElement = (runtimeChildren, originalElement=null) =>\n            {\n                let elem = null;\n\n                if (firstBuild || dynamicBuild)\n                {\n                    let target = dynamicBuild ? helpers.cloneNode(baseElement) : baseElement;\n\n                    for (let i in children)\n                    {\n                        if (children[i] instanceof Array)\n                            throw new Error('Document fragments not fully supported!');\n\n                        helpers.replaceNode(target, target, helpers.ensureNode(children[i], true), true);\n                    }\n\n                    if (dynamicBuild) elem = target;\n                    firstBuild = false;\n                }\n\n                if (elem === null)\n                    elem = helpers.cloneNode(baseElement, true);\n\n                const hadOnCreated = 'oncreated' in elem;\n                const dynamicChildren = dynamicChildrenIndices.map(idx => helpers.createReplacer(elem.childNodes[idx]));\n\n                for (let i = 0; i < N; i++)\n                    dynamicAttributes[i](elem, runtimeDynamicAttributes[i]);\n\n                for (let i = 0; i < M; i++)\n                    watch([runtimeChildren[i], i], (val, i) => dynamicChildren[i](elem, val));\n\n                if (spreadAttributes !== null)\n                {\n                    for (let attributes of spreadAttributes)\n                    {\n                        for (let i in attributes)\n                        {\n                            let path = null;\n                            if (i.indexOf(':') !== -1)\n                                path = i.split(':');\n                            else\n                                path = [ i ];\n\n                            helpers.setValue(elem, path, path.length-1, attributes[i]);\n                        }\n                    }\n                }\n\n                if (originalElement !== null) {\n                    helpers.copyProps(originalElement, elem);\n                }\n\n                if (!hadOnCreated && 'oncreated' in elem)\n                    elem.oncreated(elem);\n\n                elem.isCustom = true;\n\n                elem.cloneNode = () => {\n                    throw new Error ('Use of cloneNode is forbidden in custom elements, use cloneNodeCustom instead.');\n                };\n\n                elem.cloneNodeCustom = () => {\n                    return getElement(runtimeChildren.map(e => e instanceof Node && e.isCustom === true ? e.cloneNodeCustom() : e), elem);\n                };\n\n                return elem;\n            };\n\n            return getElement(runtimeChildren);\n        };\n    }\n};\n","\nimport _Router from './router.js'; export const Router = _Router;\n//![import \"./router\"]\nimport _Element from './element.js'; export const Element = _Element; export const CElement = _Element;\n//![import \"./element\"]\nimport _Api from './api.js'; export const Api = _Api;\n//![import \"./api\"]\nimport _DataSource from './data-source.js'; export const DataSource = _DataSource;\n//![import \"./data-source\"]\nimport _DataList from './data-list.js'; export const DataList = _DataList;\n//![import \"./data-list\"]\nimport _Easing from './easing.js'; export const Easing = _Easing;\n//![import \"./easing\"]\nimport _Anim from './anim.js'; export const Anim = _Anim;\n//![import \"./anim\"]\nimport _Elements from './elements.js'; export const Elements = _Elements;\n//![import \"./elements\"]\nimport _Utils from './utils.js'; export const Utils = _Utils;\n//![import \"./utils\"]\nimport _db from './db.js'; export const db = _db;\n//![import \"./db\"]\n\nimport * as _Rinn from 'rinn';\nexport const Rinn = _Rinn.Rinn;\nexport const Class = _Rinn.Class;\nexport const Event = _Rinn.Event;\nexport const EventDispatcher = _Rinn.EventDispatcher;\nexport const Model = _Rinn.Model;\nexport const ModelList = _Rinn.ModelList;\nexport const Schema = _Rinn.Schema;\nexport const Flattenable = _Rinn.Flattenable;\nexport const Collection = _Rinn.Collection;\nexport const Template = _Rinn.Template;\n\nexport { debugSignals, signal, expr, watch, helpers } from './runtime-jsx';\n"],"names":["$7718a52dfca15325$var$_Router","Route","$k7heJ$EventDispatcher","extend","routeRegex","value","params","args","s_args","active","changed","__ctor","route","this","_super","EventDispatcher","_compileRoute","replace","m","exec","push","addHandler","handler","unrouted","context","addEventListener","removeHandler","removeEventListener","dispatch","matches","match","dispatchEvent","str","i","length","routes","sortedRoutes","ignoreHashChangeEvent","location","init","alreadyAttached","globalThis","onhashchange","onLocationChanged","bind","refresh","setRoute","silent","location1","realLocation","hash","addRoute","onRoute","onUnroute","sort","a","b","getRoute","addRoutes","removeRoute","undefined","removeRoutes","cLocation","pLocation","k","state","j","rLocation","substr","indexOf","lastIndexOf","trim","split","navigate","$7718a52dfca15325$export$2e2bcd8739ae039","$5808f050ebbd5b77$var$elementPrototypes","$5808f050ebbd5b77$var$elementClasses","$5808f050ebbd5b77$var$Element","eid","isRoot","root","isReady","readyReenter","readyLocked","modelt","$k7heJ$Model","model","contents","events","evt","continuePropagation","source","_long_press","elem","setTimeout","dx","_pos_fx","_pos_sx","dy","_pos_fy","_pos_sy","Math","sqrt","dispatchOn","clientX","clientY","touches","clearTimeout","opts","dataset","action","longPress","enter","_list_watch","_list_visible","_list_attr","_list_property","style","display","random","toString","tmp","setModel","Object","keys","reverse","forEach","debug","console","log","tagName","parentElement","bindEvents","setInnerHTML","toLowerCase","appendChild","document","createElement","markReady","ready","rready","list","collectWatchers","ref","getFieldByPath","onready","findCustomParent","checkReady","rootReady","getRoot","onRefAdded","onrootready","remove","childNodes","result","evaluate","XPathResult","ANY_TYPE","iterateNext","path","$parcel$global","shift","findRoot","update","$k7heJ$Rinn","ensureTypeOf","onModelPreChanged","onModelPropertyChanging","onModelPropertyPreChanged","onModelPropertyRemoved","setNamespace","getModel","addClass","classString","classList","add","removeClass","setStyle","styleString","name","toUpperCase","getWidth","getBoundingClientRect","width","getHeight","height","evtstr","hdl","typeOf","selector","listen","keyCode","bindRoutes","routeStr","unbindRoutes","_eventHandler","target","HTMLElement","call","detail","elems","querySelectorAll","preventDefault","stopPropagation","eventName","eventCatcher","eventImmediate","callback0","callback1","self","firstCapture","firstCaptureCount","queue","q","pop","removed","createEventObject","bubbles","MouseEvent","CustomEvent","propName","innerHTML","modified","_list_watch_length","_list_visible_length","_list_attr_length","_list_property_length","_template","$k7heJ$Template","compile","_watch","RegExp","watch","removeAttribute","selfWatch","_visible","visible","selfVisible","_attr","attr","selfAttr","onchange","onblur","type","checked","set","getValue","onmouseup","property","selfProperty","filter","onCreated","elementConnected","onConnected","elementDisconnected","onconnected","onDisconnected","ondisconnected","element","onRefRemoved","data","get","fields","test","removeProperty","setProperty","onModelChanged","trigger","val","setValue","onModelPropertyChanged","preparePrototype","proto","__prototypePrepared","hasOwnProperty","startsWith","register","protos","newElement","constructor","super","invokeConstructor","entries","prototype","srcElement","connectReference","flags","connectedCallback","xref","disconnectedCallback","override","clone","__check","__init","__ready","__rready","f","dummy","customElements","define","expand","hookAppend","functionName","newFunction","hook1","hook2","unhook","hookPrepend","querySelector","contains","fn","window","querySelectorParent","$5808f050ebbd5b77$export$2e2bcd8739ae039","$d584b999ce7bb535$var$Api","REQUEST_PACKAGE_SUPPORTED","REQ64_SUPPORTED","JSON_RESPONSE_SUPPORTED","XML_RESPONSE_SUPPORTED","INCLUDE_CREDENTIALS","UNIQUE_STAMP","DISABLE_CORS","apiUrl","useReq64","retries","headers","_requestLevel","_requestPackage","_packageData","setEndPoint","responseFilter","res","req","packageBegin","packageEnd","callback","packageSend","batch","responseCallback","rpkg","$k7heJ$base64","encode","encodeParams","_showProgress","apiCall","_hideProgress","response","e","documentElement","header","obj","s","FormData","encodeURIComponent","join","getUrl","url","appendParam","param","success","failure","httpMethod","relativeUrl","Date","now","options","mode","Accept","method","body","multipart","credentials","Blob","endsWith","File","append","l","fetch","then","decodeResult","catch","err","json","Promise","resolve","reject","text","DOMParser","parseFromString","blob","getBlob","base64","decode","request","post","makeUrl","$d584b999ce7bb535$export$2e2bcd8739ae039","$fe13c50c6c3e66d8$export$2e2bcd8739ae039","className","debounceDelay","includeCount","includeEnum","includeList","count","enum","basePath","config","assign","$k7heJ$ModelList","dataSource","forwardRequestEvent","forwardListEvent","forwardEnumEvent","prepareEvent","setSource","resume","_timeout","fetchCount","fetchEnum","fetchList","forced","item","find","fetchOne","r","delete","fetchDelete","error","setData","fetchData","$52a9c945778cbfd0$export$2e2bcd8739ae039","ModelList","dataList","_callback","$0a74aeaee0e1468a$var$Easing","interpolate","src","dst","duration","easing","time","x","lastTime","dt","interpolator","curTime","t","requestAnimationFrame","Linear","IN","OUT","IN_OUT","Back","Bounce","getConst","Circ","Cubic","Expo","pow","Power","p","Quad","Quartic","Quintic","Sine","sin","cos","Step","$0a74aeaee0e1468a$export$2e2bcd8739ae039","$54865aa6b345efd5$var$Anim","$k7heJ$Class","initialData","stack","block","timeScale","blockTime","index","paused","finished","onFinishedCallback","onUpdatedCallback","reset","__dtor","onFinished","onUpdated","handle","initial","speed","setOutput","pause","clearInterval","setInterval","_block","_index","_blockTime","cmd","op","started","blocks","indices","blockTimes","n","_count","field","startValue","_startValue","_endValue","endValue","last","cur","table","snd","play","parallel","serial","repeat","end","restart","wait","range","rand","randt","c","$54865aa6b345efd5$export$2e2bcd8739ae039","$4a9d88aa888e9f4d$export$2e2bcd8739ae039","container","activeTab","baseRoute","selectTab","_routeHandler","link","href","showTab","tabName","previousElementSibling","nextElementSibling","_hideTabsExcept","exceptName","el","$ec74230761e3bde8$export$2e2bcd8739ae039","formElement","def","names","default","defaults","clearMarkers","filterString","messages","eval","_change","createEvent","initEvent","fireEvent","_setField","multiple","parseInt","FileList","_getField","_value","fromFileFields","files","getField","_fieldChanged","_onSuccess","message","onanimationend","_onFailure","errorsAt","prepend","insertBefore","nsilent","submit","strict","onbeforesubmit","formAction","$9c0636c07ff6144e$export$2e2bcd8739ae039","_onActivate","show","_onDeactivate","hide","$a4fb830b2d507403$export$2e2bcd8739ae039","template","isEmpty","isDynamicTemplate","template_elem","textContent","setEmpty","setLoading","setList","isInstanceOf","onLoading","onLoaded","onItemsCleared","onItemsChanged","onItemRemoved","onItemChanged","onItemAdded","buildItem","iid","asHtml","content","html","attributes","nodeName","setAttribute","nodeValue","getData","wrap","itemId","id","position","$7061e6454a23ef4a$export$2e2bcd8739ae039","$8586bcf20c2e54e9$export$2e2bcd8739ae039","offsetStart","offsetEnd","offset","currentPageSize","pageSize","updateOffset","onRequestPropertyChanged","onCountChanged","min","getInt","_offset","prevPage","offs","nextPage","firstPage","lastPage","clear","$a1b0099052e4f8e1$export$2e2bcd8739ae039","Error","temporalBody","i1","order","firstElementChild","_elem","replaceChild","$e668322859586774$export$2e2bcd8739ae039","lastElementChild","label","has","blank","groups","values","g","$a86ae7da7dd6c514$var$Utils","showDownload","filename","download","click","removeChild","showFilePicker","allowMultiple","accept","input","onfocus","loadAsDataUrl","file","reader","FileReader","onload","onerror","readAsDataURL","loadAsText","readAsText","loadAsArrayBuffer","readAsArrayBuffer","loadAllAsDataUrl","fileList","loadNext","size","loadImageFromUrl","image","Image","$a86ae7da7dd6c514$export$2e2bcd8739ae039","$5c1b3a60e2432554$export$2e2bcd8739ae039","Tabs","Form","Panel","List","Item","Paginator","Table","Select","ImageCropper","aspectRatio","imageScale0","imageScale","imageOffsX","imageOffsY","pointerA","pointerB","bounds","canvas","getContext","sx","sy","cx","cy","ix","iy","setImageUrl","setImage","setImageFile","max","render","getBlobAndUrl","quality","toBlob","URL","createObjectURL","fillStyle","beginPath","rect","fill","translate","scale","drawImage","translateImage","offsX","offsY","left","top","deltaY","changedTouches","identifier","d0","d","$5c284bd1d2bc0d7d$export$2e2bcd8739ae039","db","dbName","version","upgradeCallback","indexedDB","open","onupgradeneeded","async","txn","transaction","oldVersion","createObjectStore","keyPath","abort","onsuccess","ensureConnected","alert","storeName","indexName","objectStore","store","openCursor","event","cursor","continue","getAll","getAllKeys","getAllUnique","fieldName","put","sysGet","full","sysPut","findOne","partial","notPartial","partialCompare","deleteAll","insert","$09e89c15f3c11137$export$60c00dae65e1852f","$09e89c15f3c11137$export$8210dfe1863c478","defvalue","listeners","notify","connect","$09e89c15f3c11137$export$e2ef10f86a8d60e8","defaultValue","$09e89c15f3c11137$export$dce8637ca0d755f","signals","evaluator","notified","sgn","debouncer","queueMicrotask","$09e89c15f3c11137$export$3db5d71bdb2d5499","initialRun","$09e89c15f3c11137$export$cbfd4c4104bf5a27","DYNAMIC","lastIndex","currentTarget","oninput","Array","createSetter","copyProps","node","newNode","getOwnPropertyNames","cloneNode","deep","isCustom","cloneNodeCustom","childNode","oncreated","ensureNode","Node","createTextNode","replaceNode","parent","refNode","newRefNode","firstNode","frag","createDocumentFragment","replaceWith","tmpNode","createComment","createReplacer","create","children","baseElement","dynamicAttributes","dynamicChildrenIndices","dynamicBuild","firstBuild","N","M","runtimeDynamicAttributes","runtimeChildren","spreadAttributes","getElement","originalElement","hadOnCreated","dynamicChildren","map","idx","$9ffb7151b8b2d038$export$55185c17a0fcbe46","$9ffb7151b8b2d038$export$db77ccec0bb4ccac","$9ffb7151b8b2d038$export$9864de54bd63ed8a","$9ffb7151b8b2d038$export$bf71da7aebe9ddc1","$9ffb7151b8b2d038$export$accd73d198d77d2f","$9ffb7151b8b2d038$export$d3568da47c78d35c","$9ffb7151b8b2d038$export$cea96571ebbff9dd","$9ffb7151b8b2d038$export$deefd61317ad2797","$9ffb7151b8b2d038$export$3abb4be70fa2c84e","$9ffb7151b8b2d038$export$d2ca453b913dcdea","$9ffb7151b8b2d038$export$f932f06c7eb6abeb","$9ffb7151b8b2d038$export$eefcfe56efaaa57d","$9ffb7151b8b2d038$export$4c85e640eb41c31b","$9ffb7151b8b2d038$export$d61e24a684f9e51","$k7heJ$Event","$9ffb7151b8b2d038$export$ec8b666c5fe2c75a","$9ffb7151b8b2d038$export$a1edc412be3e1841","$9ffb7151b8b2d038$export$59eced47f477f85a","$9ffb7151b8b2d038$export$19342e026b58ebb7","$k7heJ$Schema","$9ffb7151b8b2d038$export$3a9581c9ade29768","$k7heJ$Flattenable","$9ffb7151b8b2d038$export$fb8073518f34e6ec","$k7heJ$Collection","$9ffb7151b8b2d038$export$14416b8d99d47caa"],"version":3,"file":"riza.m.js.map"}