{"mappings":"8UAkBEA,EAAA,C,MAKAC,EAAAC,OAAA,C,WAoBA,K,MAaC,K,OAWA,K,8BAcA,E,SAYA,E,OAoBA,SAAIC,GACJC,KAAKC,OAAOC,gBACZC,S,KACCC,cAAcJ,KAAKK,MAAAN,E,gBASZ,SAAGA,GACX,I,KADaO,OAAO,G,EAAOP,EAAAQ,QAAA,oBACjB,CAEL,IAAIC,EAAI,sBAAmBC,KAAQV,GAEvC,IAAKS,EAAA,MACLT,EAAOA,EAAMQ,QAASC,EAAA,GAAI,WAC1BR,KAAAM,OAAAI,KAAAF,EAAA,GAED,CACAR,KAAKW,WAAa,IAAAZ,EAAAQ,QAAA,S,EAuBpBK,WAAA,SAAAC,EAAAC,GAAA,EAAAC,EAAA,MAKAf,KAAAgB,mBAAA,IAAAF,EAAA,kBAAAD,EAAAE,EAKA,EAcAE,cAAA,SAAAJ,EAAAC,GAAA,EAAAC,EAAA,MAKKf,KAACkB,sBAAoB,IAAAJ,EAAA,kBAAAD,EAAAE,EACzB,EAYAI,SAAA,SAAApB,GAED,IAAAqB,EAAArB,EAAAsB,MAAArB,KAAAW,YAMK,IAAKS,EAQR,OANIpB,KAACsB,OAAa,KACbtB,KAAAuB,QAAavB,KAAMwB,cAAO,YAE1BzB,MAAAC,YAEFA,KAAAuB,QAAA,GAYJ,IAPC,IAAIE,EAAO,CACP1B,MAAOC,MAKL0B,EAAK,GACZC,EAAA,EAAAA,EAAA3B,KAAAM,OAAAsB,OAAAD,IAEDF,EAAAzB,KAAAM,OAAAqB,IAAAP,EAAAO,EAAA,GAKMD,GAAK,IAAON,EACjBO,EAAA,GAEC3B,KAAK6B,QAAAH,GAAiB1B,KAAEsB,OAExBtB,KAAKsB,OAAAI,E,KACJF,cAAY,SAAUxB,KAAAyB,KAAWA,G,KAC/BF,QAAA,C,WAYC,G,aAMH,G,sBAKgB,E,SAGlB,G,KASA,G,KAIC,WAGDvB,KAAA8B,kBAED9B,KAAA8B,iBAAA,EAMM,iBACLC,wBAAAC,aAAAhC,KAAAiC,kBAAAC,KAAAlC,O,UAKA,WAEDA,KAAAiC,mB,WASK,SAASlC,EAAMoC,GAEnB,IAAAC,EAAgBpC,KAAMqC,aAAatC,GAIjCqC,GAAMpC,KAAAsC,W,GACDtC,KAAAuC,wB,oBAEKC,KAAEJ,E,oBAOVrC,EAAU0C,EAACC,EAAA,M,mBACX3C,K,KACA4C,OAAA5C,GAAA,IAAAC,KAAA4C,MAAA7C,G,KAED8C,aAAanC,KAAAX,G,KACb8C,aAAMC,MAAA,CAAAC,EAAAC,IAEDhD,KAAA2C,OAAAI,GAAApC,WAAAiB,OAAA5B,KAAA2C,OAAAK,GAAArC,WAAAiB,UAIA,O,eACJ7B,GAAMa,WAAA6B,GAAA,G,KACNE,OAAA5C,GAAAa,WAAA8B,GAAA,I,KAEDC,OAAU5C,GAAAa,WAAA6B,GAAA,G,KACVE,OAAM5C,E,oBAMLA,G,mBACKA,K,YACLA,GAAM,IAAAC,KAAA4C,MAAA7C,G,KACN8C,aAAAnC,KAAAX,G,KAED8C,aAAaC,MAAA,CAAAC,EAAUC,IAElBhD,KAAK2C,OAAAI,GAAApC,WAAAiB,OAAA5B,KAAA2C,OAAAK,GAAArC,WAAAiB,UAIX5B,KAAM2C,OAAA5C,E,qBAMJ4C,G,aACAA,EAED3C,KAAA2C,OAAahB,KAEb3B,KAAK2C,OAAKhB,GAAA,IAAA3B,KAAA4C,MAAAjB,GACV3B,KAAK6C,aAACnC,KAAAiB,IAEP3B,KAAA2C,OAAAhB,GAAAf,WAAA+B,EAAAhB,IAAA,GAMF3B,KAAA6C,aAAiBC,MAAM,CAACC,EAAAC,IACxBhD,KAAA2C,OAAAI,GAAApC,WAAAiB,OAAA5B,KAAA2C,OAAAK,GAAArC,WAAAiB,Q,cAYC,SAAW7B,EAAS0C,EAAQC,GAC5B1C,KAAA2C,OAAO5C,UACPkD,IAAAP,GAEG1C,KAAC2C,OAAW5C,GAAAkB,cAAUwB,GAAA,GACtBzC,KAAK2C,OAAO5C,GAACkB,cAAqByB,GAAA,IAElC1C,KAAK2C,OAAA5C,GAAAkB,cACTwB,G,eAOA,SAAAE,GAED,QAAAhB,KAAAgB,EAKS3C,KAAG2C,OAAKhB,IAEZ3B,KAAA2C,OAAWhB,GAAAV,cAAiB0B,EAAIhB,G,eASnC,SAAWuB,EAAaC,GACzBA,MAAAnD,KAAAsC,UACAa,MAAA,K,IAEF,IAAeC,EAAfC,EAAA,EAAA1B,EAAA,EAAQ2B,EAAI,EAEZC,EAAA,I,o/BCtaA,MAAMC,EAAoB,GAKpBC,EAAiB,GAOjBC,EACN,CAICC,IAAK,KAKLC,QAAQ,EAKRC,KAAM,KAKNC,QAAS,EACTC,aAAc,EACdC,YAAa,EAKbC,OAAQC,EAKRC,MAAO,KAKPC,SAAU,KAKVC,OACA,CACC,8BAA+B,SAAUC,GAGxC,GADAA,EAAIC,qBAAsB,EACtBD,EAAIE,OAAOC,YAAa,OAE5B,IAAIC,EAAOJ,EAAIE,OAEfE,EAAKD,YAAcE,YAAW,KAE7B,IAAIC,EAAKF,EAAKG,QAAUH,EAAKI,QACzBC,EAAKL,EAAKM,QAAUN,EAAKO,QAE7BP,EAAKD,YAAc,KAEXS,KAAKC,KAAKP,EAAGA,EAAKG,EAAGA,GACrB,IACPL,EAAKD,aAAc,EACnBzE,KAAKoF,WAAYV,EAAM,c,GAGzB,KAEAA,EAAKI,QAAUR,EAAIe,QACnBX,EAAKO,QAAUX,EAAIgB,QAEnBZ,EAAKG,QAAUP,EAAIe,QACnBX,EAAKM,QAAUV,EAAIgB,O,EAGpB,8BAA+B,SAAUhB,GAExCA,EAAIC,qBAAsB,EACrBD,EAAIE,OAAOC,cAEhBH,EAAIE,OAAOK,QAAUP,EAAIe,QACzBf,EAAIE,OAAOQ,QAAUV,EAAIgB,Q,EAG1B,+BAAgC,SAAUhB,GAGzC,GADAA,EAAIC,qBAAsB,EACtBD,EAAIE,OAAOC,YAAa,OAE5B,IAAIC,EAAOJ,EAAIE,OAEfE,EAAKD,YAAcE,YAAW,KAC7B,IAAIC,EAAKF,EAAKG,QAAUH,EAAKI,QACzBC,EAAKL,EAAKM,QAAUN,EAAKO,QAE7BP,EAAKD,YAAc,KAEXS,KAAKC,KAAKP,EAAGA,EAAKG,EAAGA,GACrB,IACPL,EAAKD,aAAc,EACnBzE,KAAKoF,WAAYV,EAAM,c,GAEtB,KAEHA,EAAKI,QAAUR,EAAIiB,QAAQ,GAAGF,QAC9BX,EAAKO,QAAUX,EAAIiB,QAAQ,GAAGD,QAE9BZ,EAAKG,QAAUP,EAAIiB,QAAQ,GAAGF,QAC9BX,EAAKM,QAAUV,EAAIiB,QAAQ,GAAGD,O,EAG/B,8BAA+B,SAAUhB,GAExCA,EAAIC,qBAAsB,EACrBD,EAAIE,OAAOC,cAEhBH,EAAIE,OAAOK,QAAUP,EAAIiB,QAAQ,GAAGF,QACpCf,EAAIE,OAAOQ,QAAUV,EAAIiB,QAAQ,GAAGD,Q,EAGrC,4BAA6B,SAAUhB,IAEP,IAA3BA,EAAIE,OAAOC,cAGXH,EAAIE,OAAOC,cACde,aAAalB,EAAIE,OAAOC,aACxBH,EAAIE,OAAOC,YAAc,MAG1BH,EAAIC,qBAAsB,E,EAG3B,6BAA8B,SAAUD,IAER,IAA3BA,EAAIE,OAAOC,cAGXH,EAAIE,OAAOC,cACde,aAAalB,EAAIE,OAAOC,aACxBH,EAAIE,OAAOC,YAAc,MAG1BH,EAAIC,qBAAsB,E,EAG3B,sBAAuB,SAASD,GAE/B,IAA+B,IAA3BA,EAAIE,OAAOC,YACd,OAED,IAAIgB,EAAOnB,EAAIE,OAAOkB,QAAQC,OAAOC,MAAM,KAEvCH,EAAK,KAAMzF,KACdA,KAAKyF,EAAK,IAAK,IAAKnB,EAAIhE,UAAWgE,EAAIE,OAAOkB,WAAYD,EAAM7D,OAAQ6D,EAAK7D,QAAU0C,GAEvFA,EAAIC,qBAAsB,C,EAG5B,+BAAgC,SAASD,GAExC,IAAImB,EAAOnB,EAAIE,OAAOkB,QAAQG,UAAUD,MAAM,KAE1CH,EAAK,KAAMzF,KACdA,KAAKyF,EAAK,IAAK,IAAKnB,EAAIhE,UAAWgE,EAAIE,OAAOkB,WAAYD,EAAM7D,OAAQ6D,EAAK7D,QAAU0C,GAEvFA,EAAIC,qBAAsB,C,EAG5B,8BAA+B,SAASD,GAEvC,IAAImB,EAAOnB,EAAIE,OAAOkB,QAAQI,MAAMF,MAAM,KAEtCH,EAAK,KAAMzF,KACdA,KAAKyF,EAAK,IAAK,IAAKnB,EAAIhE,UAAWgE,EAAIE,OAAOkB,WAAYD,EAAM7D,OAAQ6D,EAAK7D,QAAU0C,GAEvFA,EAAIC,qBAAsB,C,GAO7B5B,OAAQ,KAKRxC,OAAQ,WAgBP,GAdAH,KAAK+F,YAAc,GACnB/F,KAAKgG,cAAgB,GACrBhG,KAAKiG,eAAiB,GAElB,SAAUjG,KAAK0F,SAEO,SAArB1F,KAAK0F,QAAQ7B,OAChB7D,KAAK4D,QAAS,GAGhB5D,KAAKkG,MAAMC,QAAU,QAErBnG,KAAK2D,IAAMuB,KAAKkB,SAASC,WAAWC,OAAO,GAEzB,MAAdtG,KAAKmE,MACT,CACC,IAAIoC,EAAMvG,KAAKmE,MACfnE,KAAKmE,MAAQ,KACbnE,KAAKwG,SAAUD,GAAK,E,CAGrBE,OAAOC,KAAK1G,KAAKC,QAAQ0G,UAAUC,SAAQjF,IAEtC,SAAU3B,KAAKC,OAAO0B,IACzB3B,KAAKC,OAAO0B,GAAGkF,MAAM,IAGnBnD,EAAQoD,OACXC,QAAQC,IAAI,MAAQhH,KAAKiH,QAAU,YAAcjH,KAAKkH,cAAcD,SAErEjH,KAAK6G,OAED7G,KAAKqE,QACRrE,KAAKmH,WAAYnH,KAAKqE,QAEnBrE,KAAKoE,UACRpE,KAAKoH,aAAapH,KAAKoE,UAExBO,YAAW,KACyB,gBAA/B3E,KAAKiH,QAAQI,cAChBrH,KAAKsH,YAAYC,SAASC,cAAc,gBAExCxH,KAAKyH,WAAW,GACf,E,EAMJZ,KAAM,WACN,EAMAa,MAAO,WACP,EAMAC,OAAQ,WACR,EAMAF,UAAW,SAAUG,EAAK,MAIzB,GAFA5H,KAAKgE,cAEAhE,KAAK8D,QAyBT9D,KAAK6H,sBAxBN,CAIC,GAHA7H,KAAK8D,QAAU,EAGX,UAAW9D,KAAK0F,QACpB,CACC,IAAIoC,EAAM9H,KAAK+H,eAAe/H,KAAK0F,QAAQvB,OACvC2D,GAAK9H,KAAKwG,SAASsB,E,CAIxBrB,OAAOC,KAAK1G,KAAKC,QAAQ0G,UAAUC,SAAQjF,IAEtC,UAAW3B,KAAKC,OAAO0B,IAC1B3B,KAAKC,OAAO0B,GAAG+F,OAAO,IAGpBhE,EAAQoD,OACXC,QAAQC,IAAI,MAAQhH,KAAKiH,QAAU,UAEpCjH,KAAK0H,QACL1H,KAAK6H,iB,CAKN,IAAIhE,EAAO7D,KAAKgI,iBAAiBhI,MAE7B0D,EAAQoD,OACXC,QAAQC,IAAIhH,KAAKiH,QAAU,aAAepD,EAAOA,EAAKoD,QAAU,SAE7DpD,GAAyB,IAAjBA,EAAKC,SAAiC,GAAhB9D,KAAK8D,SACtCD,EAAKoE,aAEN,IAAIC,GAAY,EAuBhB,GArBIrE,GAAyB,IAAjBA,EAAKC,SAAkC,IAAjB9D,KAAK8D,UAEtC9D,KAAKmI,UAEDnI,KAAK6D,MAAQ7D,KAAK0F,QAAQoC,MAEzBpE,EAAQoD,OACXC,QAAQC,IAAIhH,KAAKiH,QAAU,YAAcjH,KAAK0F,QAAQoC,IAAM,QAAU9H,KAAK6D,KAAKoD,SAEjFjH,KAAK6D,KAAK7D,KAAK0F,QAAQoC,KAAO9H,KAC9BA,KAAK6D,KAAKuE,WAAYpI,KAAK0F,QAAQoC,IAAK9H,OAGzCkI,GAAY,GAGRrE,GAAyB,IAAjB7D,KAAK8D,UAEjBoE,GAAY,GAGTA,EACJ,CAGC,GAFAlI,KAAK8D,QAAU,EAEF,OAAT8D,EACH,IAAK,IAAIlD,KAAQkD,EAChBlD,EAAKuD,aAGHvE,EAAQoD,OACXC,QAAQC,IAAI,MAAQhH,KAAKiH,QAAU,WAEpCR,OAAOC,KAAK1G,KAAKC,QAAQ0G,UAAUC,SAAQjF,IAEtC,WAAY3B,KAAKC,OAAO0B,IAC3B3B,KAAKC,OAAO0B,GAAGgG,QAAQ,IAGzB3H,KAAK2H,Q,CAGN3H,KAAKgE,cAEDhE,KAAK+D,eAAiB/D,KAAKgE,cAE9BhE,KAAK+D,cAAe,EACpB/D,KAAKiI,cAG6B,gBAA/BjI,KAAKiH,QAAQI,eAChBrH,KAAKqI,Q,EAMPJ,WAAY,WAEX,GAA8B,GAA1BjI,KAAKsI,WAAW1G,OACnB,OAED,GAAI5B,KAAKgE,YAGR,YADAhE,KAAK+D,cAAe,GAIrB,IAAID,GAAU,EACV8D,EAAO,GAEPW,EAAShB,SAASiB,SAAS,6BAA8BxI,KAAM,KAAMyI,YAAYC,SAAU,MAK/F,IAHIhF,EAAQoD,OACXC,QAAQC,IAAI,cAAgBhH,KAAKiH,WAGlC,CACC,IAAIvC,EAAO6D,EAAOI,cAClB,IAAKjE,EAAM,MAEPA,IAAS1E,OAGFA,KAAKgI,iBAAiBtD,KACpB1E,OAET0D,EAAQoD,OACXC,QAAQC,IAAI,MAAQtC,EAAKuC,QAAU,MAAQvC,EAAKZ,SAE5CY,EAAKZ,UACTA,GAAU,GAEX8D,EAAKlH,KAAKgE,I,CAGNZ,GAEL9D,KAAKyH,UAAUG,E,EAMhBG,eAAgB,SAASa,GAExB,IAAKA,EAAM,OAAO,KAElB,IAAIrC,EAAMqC,EAAKhD,MAAM,KACjBkC,EAAMe,EAcV,IAZItC,EAAI3E,QAAoB,QAAV2E,EAAI,KAErBuB,EAAM9H,KACNuG,EAAIuC,SAGDvC,EAAI3E,QAAoB,QAAV2E,EAAI,KAErBuB,EAAM9H,KAAKmI,UACX5B,EAAIuC,SAGS,MAAPhB,GAA6B,GAAdvB,EAAI3E,QACzBkG,EAAMA,EAAIvB,EAAIuC,SAEf,OAAOhB,C,EAMRK,QAAS,WAER,OAAOnI,KAAK6D,KAAO7D,KAAK6D,KAAQ7D,KAAK6D,KAAO7D,KAAK+I,U,EAMlDvC,SAAU,SAAUrC,EAAO6E,GAAO,GAEjC,OAAK7E,GAELA,EAAQ8E,EAAKC,aAAalJ,KAAKiE,OAAQE,GAEnCnE,KAAKmE,QAAUA,IAEA,MAAdnE,KAAKmE,QAERnE,KAAKmE,MAAMjD,oBAAqBlB,KAAK2D,IAAI,gBAAiB3D,KAAKmJ,kBAAmBnJ,MAClFA,KAAKmE,MAAMjD,oBAAqBlB,KAAK2D,IAAI,oBAAqB3D,KAAKoJ,wBAAyBpJ,MAC5FA,KAAKmE,MAAMjD,oBAAqBlB,KAAK2D,IAAI,mBAAoB3D,KAAKqJ,0BAA2BrJ,MAC7FA,KAAKmE,MAAMjD,oBAAqBlB,KAAK2D,IAAI,mBAAoB3D,KAAKsJ,uBAAwBtJ,OAG3FA,KAAKmE,MAAQA,EAEbnE,KAAKmE,MAAMnD,iBAAkBhB,KAAK2D,IAAI,gBAAiB3D,KAAKmJ,kBAAmBnJ,MAC/EA,KAAKmE,MAAMnD,iBAAkBhB,KAAK2D,IAAI,oBAAqB3D,KAAKoJ,wBAAyBpJ,MACzFA,KAAKmE,MAAMnD,iBAAkBhB,KAAK2D,IAAI,mBAAoB3D,KAAKqJ,0BAA2BrJ,MAC1FA,KAAKmE,MAAMnD,iBAAkBhB,KAAK2D,IAAI,mBAAoB3D,KAAKsJ,uBAAwBtJ,QAGzE,IAAXgJ,GACHhJ,KAAKmE,MAAMoF,aAAavJ,KAAK2D,KAAKqF,QAAO,GAAMO,aAAa,MAEtDvJ,MAzBYA,I,EA+BpBwJ,SAAU,WAET,OAAOxJ,KAAKmE,K,EAMbsF,SAAU,SAAUC,GAEnB,OAAKA,GAELA,EAAY9D,MAAM,KAAKgB,SAAQjF,KAE9BA,EAAIA,EAAEgI,UAGM,KAARhI,EAAE,IAAqB,KAARA,EAAE,GACpB3B,KAAK4J,UAAkB,KAARjI,EAAE,GAAY,SAAW,OAAOA,EAAE2E,OAAO,IAExDtG,KAAK4J,UAAUC,IAAIlI,GAAE,IAGhB3B,MAbkBA,I,EAmB1B8J,YAAa,SAAUJ,GAEtB,OAAKA,GAELA,EAAY9D,MAAM,KAAKgB,SAAQjF,KAE9BA,EAAIA,EAAEgI,UAGM,KAARhI,EAAE,IAAqB,KAARA,EAAE,GACpB3B,KAAK4J,UAAkB,KAARjI,EAAE,GAAY,SAAW,OAAOA,EAAE2E,OAAO,IAExDtG,KAAK4J,UAAUvB,OAAO1G,GAAE,IAGnB3B,MAbkBA,I,EAmB1B+J,SAAU,SAAUC,GAEnB,OAAKA,GAELA,EAAYpE,MAAM,KAAKgB,SAAQjF,IAC9B,IAAI2B,GAAK3B,EAAIA,EAAEgI,QAAQM,QAAQ,KAC/B,IAAS,GAAL3G,EAAS,OAEb,IAAI4G,EAAOvI,EAAE2E,OAAO,EAAGhD,GAAGqG,OAC1B,IAAK,IAAIvG,EAAI8G,EAAKD,QAAQ,MAAW,GAAL7G,EAASA,EAAI8G,EAAKD,QAAQ,KACzDC,EAAOA,EAAK5D,OAAO,EAAGlD,GAAK8G,EAAK5D,OAAOlD,EAAE,EAAG,GAAG+G,cAAgBD,EAAK5D,OAAOlD,EAAE,GAG9EpD,KAAKkG,MAAMgE,GAAQvI,EAAE2E,OAAOhD,EAAE,GAAGqG,MAAM,IAGjC3J,MAdkBA,I,EAoB1BoK,SAAU,SAAU1F,EAAK,MAExB,OAAQA,GAAQ1E,MAAMqK,wBAAwBC,K,EAM/CC,UAAW,SAAU7F,EAAK,MAEzB,OAAQA,GAAQ1E,MAAMqK,wBAAwBG,M,EAgB/CrD,WAAY,SAAU9C,GAErB,IAAK,IAAIoG,KAAUpG,EACnB,CACC,IAAIqG,EAAMrG,EAAOoG,GAEO,UAApBxB,EAAK0B,OAAOD,KACfA,EAAM1K,KAAK0K,IAEZA,EAAMA,EAAIxI,KAAKlC,MAEf,IAAI2B,EAAI8I,EAAOR,QAAQ,KAEnBC,GAAY,GAALvI,EAAU8I,EAASA,EAAOnE,OAAO,EAAG3E,GAC3CiJ,GAAgB,GAALjJ,EAAU,GAAK8I,EAAOnE,OAAO3E,EAAI,GAEhD,IAAIF,EAAO,KAEX,IAAI6B,EAAI4G,EAAKD,QAAQ,KAOrB,IANS,GAAL3G,IAEH7B,EAAOyI,EAAK5D,OAAOhD,EAAE,EAAG4G,EAAKtI,OAAO0B,EAAE,GAAGsC,MAAM,KAC/CsE,EAAOA,EAAK5D,OAAO,EAAGhD,IAGJ,KAAfsH,EAAS,GACb,CACC,GAAgB,SAAZA,EACJ,CACC5K,KAAK4K,EAAStE,OAAO,IAAItF,iBAAiBkJ,EAAMQ,GAChD,Q,CAGDE,EAAW5K,I,KAEY,KAAf4K,EAAS,KAGhBA,EADe,SAAZA,EACQ,cAAcA,EAAStE,OAAO,GAAG,KAEjCtG,MAGb,GAAyB,KAArBkK,EAAK5D,OAAO,EAAG,GAAnB,CAMA,GAAY,MAAR7E,EAEH,OAAQyI,GAEP,IAAK,QAAS,IAAK,UAClBlK,KAAK6K,OAAQX,EAAMU,GAAU,SAAUtG,GAEtC,IAAkD,GAA9C2E,EAAKgB,QAAQxI,EAAM6C,EAAIwG,QAAQzE,YAClC,OAAOqE,EAAKpG,EAAK7C,GAElB6C,EAAIC,qBAAsB,C,IAG3B,SAIHvE,KAAK6K,OAAQX,EAAMU,EAAUF,E,MArB5B1K,KAAK6K,OAAO,mBAAmBX,EAAK5D,OAAO,GAAItG,KAAM0K,E,CAwBvD,OAAO1K,I,EAaR+K,WAAY,WAEX,GAAK/K,KAAK2C,OAGV,IAAK,IAAIqI,KAAYhL,KAAK2C,OAC1B,CACC,IAAI5C,EAAwB,MAAhBiL,EAAS,GAAaC,EAAOC,SAASF,EAAS1E,OAAO,IAAM2E,EAAOC,SAASF,GACpFnK,EAAUb,KAAK2C,OAAOqI,GAEG,WAAzB/B,EAAK0B,OAAO9J,KACfA,EAAUb,KAAKa,IAEI,MAAhBmK,EAAS,GACZjL,EAAMa,WAAWC,GAAS,EAAMb,MAEhCD,EAAMa,WAAWC,GAAS,EAAOb,K,GAOpCmL,aAAc,WAEb,GAAKnL,KAAK2C,OAGV,IAAK,IAAIqI,KAAYhL,KAAK2C,OAC1B,CACC,IAAI5C,EAAwB,MAAhBiL,EAAS,GAAaC,EAAOC,SAASF,EAAS1E,OAAO,IAAM2E,EAAOC,SAASF,GACpFnK,EAAUb,KAAK2C,OAAOqI,GAEG,WAAzB/B,EAAK0B,OAAO9J,KACfA,EAAUb,KAAKa,IAEI,MAAhBmK,EAAS,GACZjL,EAAMkB,cAAcJ,GAAS,EAAMb,MAEnCD,EAAMkB,cAAcJ,GAAS,EAAOb,K,GASvCoL,cAAe,SAAU9G,EAAKsG,EAAU/J,GAEvC,IAAgC,IAA5ByD,EAAIC,oBAAR,CAMA,GAHAD,EAAIC,qBAAsB,EAC1BD,EAAIE,OAASF,EAAI+G,OAEbT,GAAYA,aAAoBU,YAE/BhH,EAAIE,SAAWoG,IAElBtG,EAAIC,qBAAsB,GAEmB,IAAzC1D,EAAQ0K,KAAMvL,KAAMsE,EAAKA,EAAIkH,UAChClH,EAAIC,qBAAsB,SAGxB,GAAIqG,GAAwB,KAAZA,EACrB,CACC,IAAIa,EAAQzL,KAAK0L,iBAAiBd,GAElC,KAAOtG,EAAIE,SAAWxE,MACtB,CAEC,IAAU,IADFiJ,EAAKgB,QAASwB,EAAOnH,EAAIE,QAAQ,GAEzC,CACCF,EAAIC,qBAAsB,GAEmB,IAAzC1D,EAAQ0K,KAAMvL,KAAMsE,EAAKA,EAAIkH,UAChClH,EAAIC,qBAAsB,GAE3B,K,CAIAD,EAAIE,OAASF,EAAIE,OAAO0C,a,OAM1B5C,EAAIC,qBAAsB,GAEmB,IAAzC1D,EAAQ0K,KAAMvL,KAAMsE,EAAKA,EAAIkH,UAChClH,EAAIC,qBAAsB,IAGI,IAA5BD,EAAIC,sBAEPD,EAAIqH,iBACJrH,EAAIsH,kBAhDJ,C,EA2DFf,OAAQ,SAAUgB,EAAWjB,EAAU/J,GAEtC,IAAIiL,GAAe,EACfC,GAAiB,EAEQ,YAAzB9C,EAAK0B,OAAOC,KAEf/J,EAAU+J,EACVA,EAAW,MAGyB,KAAjCiB,EAAUA,EAAUjK,OAAO,KAE9BiK,EAAYA,EAAUvF,OAAO,EAAGuF,EAAUjK,OAAO,GACjDkK,GAAe,GAGI,KAAhBD,EAAU,KAEbA,EAAYA,EAAUvF,OAAO,GAC7ByF,GAAiB,GAGlB,IAAIC,EAAY,KACZC,EAAY,KACZC,EAAOlM,KAiDX,OA/CAA,KAAKgB,iBAAkB6K,EAAWG,EAAa1H,KAEd,IAA5BA,EAAIC,sBAGHD,EAAI6H,eAER7H,EAAI6H,aAAenM,KACnBsE,EAAI8H,kBAAoB,EACxB9H,EAAI+H,MAAQ,IAGT/H,EAAI6H,eAAiBnM,MACxBsE,EAAI8H,oBAEe,GAAhBN,GACHxH,EAAI+H,MAAM3L,KAAK,CAACV,KAAM4K,EAAU/J,IAEX,GAAlBkL,GACH/L,KAAKoL,cAAc9G,EAAKsG,EAAU/J,GAAQ,GAE5C,GAEAb,KAAKgB,iBAAkB6K,EAAWI,EAAa3H,IAE9C,IAAgC,IAA5BA,EAAIC,sBAGY,GAAhBuH,GAA0C,GAAlBC,GAC3B/L,KAAKoL,cAAc9G,EAAKsG,EAAU/J,GAE/ByD,EAAI6H,eAAiBnM,OAAoC,IAA5BsE,EAAIC,qBAEL,KAAzBD,EAAI8H,mBACV,CACC,KAAO9H,EAAI+H,MAAMzK,QACjB,CACC,IAAI0K,EAAIhI,EAAI+H,MAAME,MAClBD,EAAE,GAAGlB,cAAc9G,EAAKgI,EAAE,GAAIA,EAAE,G,CAGjChI,EAAIC,qBAAsB,C,IAI7B,GAEO,CACNiI,SAAS,EACTnE,OAAQ,WACHrI,KAAKwM,UACTxM,KAAKwM,SAAU,EACfN,EAAKhL,oBAAoB2K,EAAWG,GAAW,GAC/CE,EAAKhL,oBAAoB2K,EAAWI,GAAW,G,IAQlDQ,kBAAmB,SAASZ,EAAWpK,EAAMiL,GAE5C,IAAIpI,EAOJ,OAJCA,EADgB,SAAbuH,EACG,IAAIc,WAAWd,EAAW,CAAEa,QAASA,EAASlB,OAAQ/J,IAEtD,IAAImL,YAAaf,EAAW,CAAEa,QAASA,EAASlB,OAAQ/J,IAExD6C,C,EAMRnD,SAAU,SAAU0K,EAAWpK,EAAK,KAAMiL,GAAQ,GAEjD1M,KAAKwB,cAAexB,KAAKyM,kBAAkBZ,EAAWpK,EAAMiL,G,EAM7DtH,WAAY,SAAUV,EAAMmH,EAAWpK,EAAK,KAAMiL,GAAQ,GAEzDhI,EAAKlD,cAAexB,KAAKyM,kBAAkBZ,EAAWpK,EAAMiL,G,EAQ7DtF,aAAc,SAAU/G,GAEvBL,KAAKgE,cACLhE,KAAK6M,UAAYxM,EACjBL,KAAKgE,a,EAaN6D,gBAAiB,WAEhB,IAEID,EAFAsE,EAAOlM,KACP8M,GAAW,EAGf,IAAK9M,KAAK4D,OAAQ,OAElB,IAAImJ,EAAqB/M,KAAK+F,YAAYnE,OACtCoL,EAAuBhN,KAAKgG,cAAcpE,OAC1CqL,EAAwBjN,KAAKiG,eAAerE,OAGhDgG,EAAO5H,KAAK0L,iBAAiB,gBAC7B,IAAK,IAAI/J,EAAI,EAAGA,EAAIiG,EAAKhG,OAAQD,IACjC,CACC,IAAK,IAAI2B,KAAKsE,EAAKjG,GAAG+J,iBAAiB,WACtCpI,EAAE+E,SAEHT,EAAKjG,GAAGuL,UAAYC,EAASC,QAAQxF,EAAKjG,GAAGkL,WAC7CjF,EAAKjG,GAAG0L,OAAS,IAAIC,OAAO,KAAO1F,EAAKjG,GAAG+D,QAAQ6H,MAAQ,MAC3D3F,EAAKjG,GAAGkL,UAAY,GAEpBjF,EAAKjG,GAAG6L,gBAAgB,cACxBxN,KAAK+F,YAAYrF,KAAKkH,EAAKjG,G,CAG5B,GAAI,cAAe3B,KAAK0F,QACxB,CACC,IAAK,IAAI+H,KAAKzN,KAAK0L,iBAAiB,WACnC+B,EAAEpF,SAEHrI,KAAKkN,UAAYC,EAASC,QAAQpN,KAAK6M,WACvC7M,KAAKqN,OAAS,IAAIC,OAAO,KAAOtN,KAAK0F,QAAQgI,UAAY,MACzD1N,KAAK6M,UAAY,GAEjB7M,KAAKwN,gBAAgB,mBACrBxN,KAAK+F,YAAYrF,KAAKV,K,CAIvB4H,EAAO5H,KAAK0L,iBAAiB,kBAC7B,IAAK,IAAIiC,EAAI,EAAGA,EAAI/F,EAAKhG,OAAQ+L,IAEhC/F,EAAK+F,GAAGC,SAAWT,EAASC,QAAQxF,EAAK+F,GAAGjI,QAAQmI,SAEpDjG,EAAK+F,GAAGH,gBAAgB,gBACxBxN,KAAKgG,cAActF,KAAKkH,EAAK+F,IAG1B,gBAAiB3N,KAAK0F,UAEzB1F,KAAK4N,SAAWT,EAASC,QAAQpN,KAAK0F,QAAQoI,aAE9C9N,KAAKwN,gBAAgB,qBACrBxN,KAAKgG,cAActF,KAAKV,OAIzB4H,EAAO5H,KAAK0L,iBAAiB,mBAC7B,IAAK,IAAIqC,EAAI,EAAGA,EAAInG,EAAKhG,OAAQmM,IAEhCnG,EAAKmG,GAAGC,SAAWpG,EAAKmG,GAAGE,OAAS,WAEnC,OAAQjO,KAAKkO,MAEZ,IAAK,QACAlO,KAAKmO,SAASjC,EAAK1C,WAAW4E,IAAIpO,KAAKkK,KAAMlK,KAAKK,OACtD,MAED,IAAK,WACJ6L,EAAK1C,WAAW4E,IAAIpO,KAAKkK,KAAMlK,KAAKmO,QAAU,IAAM,KACpD,MAED,IAAK,QACJjC,EAAK1C,WAAW4E,IAAIpO,KAAKkK,KAAMlK,KAAKqO,YACpC,MAED,QACCnC,EAAK1C,WAAW4E,IAAIpO,KAAKkK,KAAMlK,KAAKK,O,EAKhB,UAAnBuH,EAAKmG,GAAG9G,UAEXW,EAAKmG,GAAGO,UAAY,WAEnBpC,EAAK1C,WAAW4E,IAAIpO,KAAKkK,KAAMlK,KAAKK,M,GAItCuH,EAAKmG,GAAG7D,KAAOtC,EAAKmG,GAAGrI,QAAQ6I,SAE/B3G,EAAKmG,GAAGP,gBAAgB,iBACxBxN,KAAKiG,eAAevF,KAAKkH,EAAKmG,IAG3B,iBAAkB/N,KAAK0F,UAE1B1F,KAAKgO,SAAWhO,KAAKiO,OAAS,WAE7B,OAAQjO,KAAKkO,MAEZ,IAAK,QACAlO,KAAKmO,SAASjC,EAAK1C,WAAW4E,IAAIpO,KAAKkK,KAAMlK,KAAKK,OACtD,MAED,IAAK,WACJ6L,EAAK1C,WAAW4E,IAAIpO,KAAKkK,KAAMlK,KAAKmO,QAAU,IAAM,KACpD,MAED,IAAK,QACJjC,EAAK1C,WAAW4E,IAAIpO,KAAKkK,KAAMlK,KAAKqO,YACpC,MAED,QACCnC,EAAK1C,WAAW4E,IAAIpO,KAAKkK,KAAMlK,KAAKK,O,EAKnB,UAAhBL,KAAKiH,UAERjH,KAAKsO,UAAY,WAEhBpC,EAAK1C,WAAW4E,IAAIpO,KAAKkK,KAAMlK,KAAKK,M,GAItCL,KAAKkK,KAAOlK,KAAK0F,QAAQ8I,aAEzBxO,KAAKwN,gBAAgB,sBACrBxN,KAAKiG,eAAevF,KAAKV,OAI1BA,KAAK+F,YAAc/F,KAAK+F,YAAY0I,QAAO9M,GAAwB,MAAnBA,EAAEuF,gBAC9C6F,GAAsB/M,KAAK+F,YAAYnE,SAAQkL,GAAW,GAE9D9M,KAAKgG,cAAgBhG,KAAKgG,cAAcyI,QAAO9M,GAAwB,MAAnBA,EAAEuF,gBAClD8F,GAAwBhN,KAAKgG,cAAcpE,SAAQkL,GAAW,GAElE9M,KAAKiG,eAAiBjG,KAAKiG,eAAewI,QAAO9M,GAAwB,MAAnBA,EAAEuF,gBACpD+F,GAAyBjN,KAAKiG,eAAerE,SAAQkL,GAAW,GAElD,MAAd9M,KAAKmE,OAAiB2I,GACzB9M,KAAKmE,MAAMoF,aAAavJ,KAAK2D,KAAKqF,QAAO,GAAMO,aAAa,K,EAM9DmF,UAAW,WACX,EAMAC,iBAAkB,WAEjB3O,KAAK+K,aACL/K,KAAK4O,a,EAMNC,oBAAqB,WAEpB7O,KAAKmL,c,EAMNyD,YAAa,WACb,EAMAE,eAAgB,WAChB,EAMA1G,WAAY,SAAU8B,EAAM6E,GAC5B,EAMAC,aAAc,SAAU9E,EAAM6E,GAC9B,EASA5F,kBAAmB,SAAU7E,EAAK7C,GAEjC,IAAIwN,EAAOjP,KAAKwJ,WAAW0F,MAE3B,IAAK,IAAIvN,EAAI,EAAGA,EAAI3B,KAAK+F,YAAYnE,OAAQD,IAE5C,IAAK,IAAI2B,KAAK7B,EAAK0N,OAElB,GAAKnP,KAAK+F,YAAYpE,GAAG0L,OAAO+B,KAAK9L,GAArC,CAGAtD,KAAK+F,YAAYpE,GAAGkL,UAAY7M,KAAK+F,YAAYpE,GAAGuL,UAAU+B,GAC9D,KAHC,CAOH,IAAK,IAAItB,EAAI,EAAGA,EAAI3N,KAAKgG,cAAcpE,OAAQ+L,IAExC3N,KAAKgG,cAAc2H,GAAGC,SAASqB,EAAM,OAC1CjP,KAAKgG,cAAc2H,GAAGzH,MAAMmJ,eAAe,WAE3CrP,KAAKgG,cAAc2H,GAAGzH,MAAMoJ,YAAY,UAAW,OAAQ,aAG7DtP,KAAKuP,eAAejL,EAAK7C,E,EAM1B8N,eAAgB,SAAUjL,EAAK7C,GAC/B,EAMA2H,wBAAyB,SAAU9E,EAAK7C,GACxC,EAQA4H,0BAA2B,SAAU/E,EAAK7C,GAEzC,IAAK,IAAIE,EAAI,EAAGA,EAAI3B,KAAKiG,eAAerE,OAAQD,IAE/C,GAAI3B,KAAKiG,eAAetE,GAAGuI,MAAQzI,EAAKyI,KACxC,CACC,IAAIsF,GAAU,EAEd,OAAQxP,KAAKiG,eAAetE,GAAGuM,MAE9B,IAAK,QACJ,GAAIlO,KAAKiG,eAAetE,GAAGtB,OAASoB,EAAKpB,MACzC,CACCL,KAAKiG,eAAetE,GAAGuF,cAAc0C,UAAUvB,OAAO,UACtD,Q,CAGDrI,KAAKiG,eAAetE,GAAGwM,SAAU,EACjCnO,KAAKiG,eAAetE,GAAGuF,cAAc0C,UAAUC,IAAI,UACnD,MAED,IAAK,aACEpI,EAAKpB,OAEVL,KAAKiG,eAAetE,GAAGwM,SAAU,EACjCnO,KAAKiG,eAAetE,GAAGuF,cAAc0C,UAAUC,IAAI,YAInD7J,KAAKiG,eAAetE,GAAGwM,SAAU,EACjCnO,KAAKiG,eAAetE,GAAGuF,cAAc0C,UAAUvB,OAAO,WAGvD,MAED,IAAK,QACJrI,KAAKiG,eAAetE,GAAG8N,IAAMzP,KAAKiG,eAAetE,GAAG+D,QAAQrF,MAAQoB,EAAKpB,MACzEL,KAAKiG,eAAetE,GAAG+N,SAAUjO,EAAKpB,OACtCmP,GAAU,EACV,MAED,QACCxP,KAAKiG,eAAetE,GAAGtB,MAAQoB,EAAKpB,MACpCL,KAAKiG,eAAetE,GAAG8N,IAAMzP,KAAKiG,eAAetE,GAAG+D,QAAQrF,MAAQoB,EAAKpB,MAErEL,KAAKiG,eAAetE,GAAGtB,OAASoB,EAAKpB,QACxCmP,GAAU,GAKTA,GAAWxP,KAAKiG,eAAetE,GAAGqM,UACrChO,KAAKiG,eAAetE,GAAGqM,U,CAI1BhO,KAAKmB,SAAU,mBAAqBM,EAAKyI,KAAMzI,GAAM,GACrDzB,KAAKmB,SAAU,kBAAmBM,GAAM,GAExCzB,KAAK2P,uBAAuBrL,EAAK7C,E,EAMlCkO,uBAAwB,SAAUrL,EAAK7C,GACvC,EAMA6H,uBAAwB,SAAUhF,EAAK7C,GACvC,EAUAmO,iBAAkB,SAAUC,GAE3B,IAAkC,IAA9BA,EAAMC,oBAAV,CAGAD,EAAMC,qBAAsB,EAEvBD,EAAME,eAAe,WAAcF,EAAMxL,SAC7CwL,EAAMxL,OAAS,IAEXwL,EAAME,eAAe,WAAcF,EAAMlN,SAC7CkN,EAAMlN,OAAS,IAEhB,IAAK,IAAIhB,KAAKkO,EAETlO,EAAEqO,WAAW,WAEhBH,EAAMxL,OAAO1C,EAAE2E,OAAO,IAAMuJ,EAAMlO,UAC3BkO,EAAMlO,IAELA,EAAEqO,WAAW,YAErBH,EAAMlN,OAAOhB,EAAE2E,OAAO,IAAMuJ,EAAMlO,UAC3BkO,EAAMlO,GApBd,C,EAgCFsO,SAAU,SAAU/F,KAASgG,GAE5B,MAAMC,EAAa,cAAc7E,YAEhC8E,cAECC,QACArQ,KAAKsQ,mBAAoB,EAErB5M,EAAQoD,OACXC,QAAQC,IAAI,WAAahH,KAAKiH,SAE/BjH,KAAKC,OAAS,GAEd,IAAK,IAAI0B,KAAK8E,OAAO8J,QAAQvQ,KAAKoQ,YAAYI,UAAUvQ,QACxD,CACCD,KAAKC,OAAO0B,EAAE,IAAM,GAEpB,IAAK,IAAI2B,KAAKmD,OAAO8J,QAAQ5O,EAAE,IAC9B3B,KAAKC,OAAO0B,EAAE,IAAI2B,EAAE,IAAMA,EAAE,GAAGpB,KAAKlC,K,CAItCA,KAAK0O,W,CAGN3F,SAAU0H,GAET,IAAI/L,EAAO+L,GAA0BzQ,KAAKkH,cAE1C,KAAe,MAARxC,GACP,CACC,GAAI,WAAYA,IAAwB,IAAhBA,EAAKd,OAC5B,OAAOc,EAERA,EAAOA,EAAKwC,a,CAGb,OAAO,I,CAGRc,iBAAkByI,GAEjB,IAAI/L,EAAO+L,EAAaA,EAAWvJ,cAAgBlH,KAAKkH,cAExD,KAAe,MAARxC,GACP,CACC,IAAkC,IAA9BA,EAAKuC,QAAQgD,QAAQ,KACxB,OAAOvF,EAERA,EAAOA,EAAKwC,a,CAGb,OAAO,I,CAGRwJ,iBAAkB7M,EAAK,KAAM8M,EAAM,KAE7B3Q,KAAK6D,MAAuB,IAAN,EAAR8M,KAEN,MAAR9M,IAAcA,EAAO7D,KAAK+I,YAClB,MAARlF,IAEC7D,KAAK0F,QAAQoC,MAChBjE,EAAK7D,KAAK0F,QAAQoC,KAAO9H,MAE1BA,KAAK6D,KAAOA,G,CAKf+M,oBAEC5Q,KAAK0Q,iBAAiB,KAAM,GAExB1Q,KAAKsQ,oBAERtQ,KAAKsQ,mBAAoB,EACzBtQ,KAAKG,UAGNH,KAAK0Q,iBAAiB,KAAM,GAC5B1Q,KAAK2O,mBAED3O,KAAK0F,QAAQmL,OAChB9O,WAAW/B,KAAK0F,QAAQmL,MAAQ7Q,K,CAGlC8Q,uBAEK9Q,KAAK6D,OAEJ7D,KAAK0F,QAAQoC,MAEhB9H,KAAK6D,KAAKmL,aAAchP,KAAK0F,QAAQoC,IAAK9H,aAEnCA,KAAK6D,KAAK7D,KAAK0F,QAAQoC,MAG/B9H,KAAK6D,KAAO,MAGb7D,KAAK6O,sBAED7O,KAAK0F,QAAQmL,aACT9O,WAAW/B,KAAK0F,QAAQmL,K,GAIlC5H,EAAK8H,SAAUZ,EAAWK,UAAW9M,GAErC,MAAMmM,EAAQ,GACR5P,EAAS,GACToE,EAAS4E,EAAK+H,MAAMtN,EAAQW,QAElC,IAGI4M,EAHAC,GAAS,EACTC,GAAU,EACVC,GAAW,EAGf,IAAK,IAAIzP,EAAI,EAAGA,EAAIuO,EAAOtO,OAAQD,IAElC,GAAKuO,EAAOvO,GAAZ,CAEA,GAA8B,UAA1BsH,EAAK0B,OAAOuF,EAAOvO,IACvB,CACC,MAAM0P,EAAOnB,EAAOvO,GAGpB,GADAuO,EAAOvO,GAAK6B,EAAkB6N,IACzBnB,EAAOvO,GAAI,SAEhB1B,EAAOoR,GAAQ,GAEf,IAAK,IAAIC,KAAKpB,EAAOvO,GAEa,YAA7BsH,EAAK0B,OAAOuF,EAAOvO,GAAG2P,MAG1BrR,EAAOoR,GAAMC,GAAKpB,EAAOvO,GAAG2P,IAG7BJ,GAAS,EACTC,GAAU,EACVC,GAAW,EACXH,GAAU,C,MAIVvN,EAAQkM,iBAAiBM,EAAOvO,IAChCsP,GAAU,EAGP,WAAYf,EAAOvO,IACtBsH,EAAK8H,SAAU9Q,EAAQiQ,EAAOvO,GAAG1B,QAE9B,WAAYiQ,EAAOvO,IACtBsH,EAAK8H,SAAU1M,EAAQ6L,EAAOvO,GAAG0C,QAElC4E,EAAK8H,SAAUZ,EAAWK,UAAWN,EAAOvO,IAC5CsH,EAAK8H,SAAUlB,EAAOK,EAAOvO,IAEzBsP,KAEEC,GAAU,SAAUhB,EAAOvO,KAAIuP,GAAS,IACxCC,GAAW,UAAWjB,EAAOvO,KAAIwP,GAAU,IAC3CC,GAAY,WAAYlB,EAAOvO,KAAIyP,GAAW,GA3CpC,CA+CjB,IAAIG,EAAQ,WAAU,EA+BtB,OA7BKL,IAEJf,EAAWK,UAAU3J,KAAO0K,EAC5B1B,EAAMhJ,KAAO0K,GAGTJ,IAEJhB,EAAWK,UAAU9I,MAAQ6J,EAC7B1B,EAAMnI,MAAQ6J,GAGVH,IAEJjB,EAAWK,UAAU7I,OAAS4J,EAC9B1B,EAAMlI,OAAS4J,GAGhBpB,EAAWK,UAAUvQ,OAASA,EAC9BkQ,EAAWK,UAAUnM,OAASA,EAE9BwL,EAAM5P,OAASA,EACf4P,EAAMxL,OAASA,EAEfmN,eAAeC,OAAQvH,EAAMiG,GAE7B3M,EAAkB0G,GAAQ2F,EAC1BpM,EAAeyG,GAAQiG,EAEhBA,C,EAQRuB,OAAQ,SAAUxH,KAASgG,GAE1B,KAAMhG,KAAQ1G,GACb,OAED,MAAM0I,EAAO1I,EAAkB0G,GACzBxF,EAAOjB,EAAeyG,GAEtBjK,EAASiM,EAAKjM,OACdoE,EAAS6H,EAAK7H,OAEpB,IAAK,IAAIwL,KAASK,EAEjBxM,EAAQkM,iBAAiBC,GAErB,WAAYA,GACf5G,EAAK8H,SAAU9Q,EAAQ4P,EAAM5P,QAE1B,WAAY4P,GACf5G,EAAK8H,SAAU1M,EAAQwL,EAAMxL,QAE9B4E,EAAK8H,SAAUrM,EAAK8L,UAAWX,GAC/B5G,EAAK8H,SAAU7E,EAAM2D,GAGtBnL,EAAK8L,UAAUvQ,OAASA,EACxByE,EAAK8L,UAAUnM,OAASA,EAExB6H,EAAKjM,OAASA,EACdiM,EAAK7H,OAASA,C,EAMfsN,WAAY,SAAUzH,EAAM0H,EAAcC,GAEzC,KAAM3H,KAAQ1G,GACb,OAED,IAAIsO,EAAQ7I,EAAK0I,WAAWnO,EAAkB0G,GAAO0H,EAAcC,GAC/DE,EAAQ9I,EAAK0I,WAAWlO,EAAeyG,GAAMsG,UAAWoB,EAAcC,GAE1E,MAAO,CACNG,OAAQ,WACPF,EAAME,SACND,EAAMC,Q,IAQTC,YAAa,SAAU/H,EAAM0H,EAAcC,GAE1C,KAAM3H,KAAQ1G,GACb,OAED,IAAIsO,EAAQ7I,EAAKgJ,YAAYzO,EAAkB0G,GAAO0H,EAAcC,GAChEE,EAAQ9I,EAAKgJ,YAAYxO,EAAeyG,GAAMsG,UAAWoB,EAAcC,GAE3E,MAAO,CACNG,OAAQ,WACPF,EAAME,SACND,EAAMC,Q,IAcT,eAAgB,SAAUvQ,EAAM6C,GAE/B,IAAII,EAAOJ,EAAIE,OAEX,MAAO/C,IACViD,EAAO6C,SAAS2K,cAAczQ,EAAK,KAE/BiD,IAEDA,EAAKkF,UAAUuI,SAAS1Q,EAAK,IAChCiD,EAAKkF,UAAUvB,OAAO5G,EAAK,IAE3BiD,EAAKkF,UAAUC,IAAIpI,EAAK,I,EAQ1B,YAAa,SAAUA,EAAM6C,GAE5B,IAAII,EAAOJ,EAAIE,OAEX,MAAO/C,IACViD,EAAO6C,SAAS2K,cAAczQ,EAAK,KAE/BiD,GAELA,EAAKkF,UAAUC,IAAIpI,EAAK,G,EAQzB,iBAAkB,SAAUA,EAAM6C,GAEjC,IAAII,EAAOJ,EAAIE,OAKf,GAHI,MAAO/C,IACViD,EAAO6C,SAAS2K,cAAczQ,EAAK,MAE/BiD,EAAM,OAEXA,EAAKkF,UAAUC,IAAIpI,EAAK,IAExB,IAAI2Q,EAAK,KACRC,OAAOnR,oBAAoB,QAASkR,GAAI,GACxC1N,EAAKkF,UAAUvB,OAAO5G,EAAK,GAAG,EAG/B4Q,OAAOrR,iBAAiB,QAASoR,GAAI,E,EAQtC,qBAAsB,SAAU3Q,EAAM6C,GAErC,IAAII,EAAOJ,EAAIE,OACVE,IAEDA,EAAKkF,UAAUuI,SAAS1Q,EAAK,IAEhCiD,EAAKkF,UAAUvB,OAAO5G,EAAK,KAI3BiD,EAAK4N,oBAAoB7Q,EAAK,IAAIiK,iBAAiBjK,EAAK,IAAImF,SAAQlC,GAAQA,EAAKkF,UAAUvB,OAAO5G,EAAK,MACvGiD,EAAKkF,UAAUC,IAAIpI,EAAK,K,EAS1B,kBAAmB,SAAUA,EAAM6C,GAElC,IAAII,EAAOJ,EAAIE,OACVE,IAELA,EAAK4N,oBAAoB7Q,EAAK,IAAIiK,iBAAiBjK,EAAK,IAAImF,SAAQlC,GAAQA,EAAKkF,UAAUvB,OAAO5G,EAAK,MACvGiD,EAAKkF,UAAUC,IAAIpI,EAAK,I,EAI1BiC,OAAgB,GAEhBA,EAAQuM,SAAS,SAAU,IAG3BvM,EAAQuM,SAAU,cAAe,IAQjC3E,YAAYkF,UAAU8B,oBAAsB,SAAU1H,GAErD,IAAIlG,EAAO1E,KAEX,KAAe,MAAR0E,IAEFA,EAAKtD,QAAQwJ,IAGjBlG,EAAOA,EAAKwC,cAGb,OAAOxC,C,MAGR6N,EAAe7O,ECrpDd,MAAA8O,EAAwB,CAGxBC,0BAA0B,EAC1BC,gBAAiB,EAEjBC,wBAAA,EAKAC,uBAAA,EAKAC,oBAAA,GAKAC,aAAA,GAeAC,OAAA,O,MAeK,GAIJC,UAAA,EAQAC,QAAA,E,QAUK,G,cAQM,E,gBASN,E,aAQM,G,YAON,SAAWF,EAAApC,EAAkB,MAQlC,OAPA3Q,KAAA+S,SAED/S,KAAA2Q,SAAA3Q,KAAA2Q,MAKO3Q,I,iBASO,SAACkT,EAAAC,GAEd,OAAK,C,eAQE,WAELnT,KAAK2Q,MAAA6B,EAAgBC,2B,KAErBW,iB,sBAQGC,G,KACA1C,MAAA6B,EAAAC,2B,KAEDW,oB,uCAMCC,G,eAWE,SAAAA,EAAgBC,EAAA,MAErBtT,KAAK2Q,MAAW6B,EAA0BC,4B,KAK1Cc,eACFF,IAEDrT,KAAAwT,WAAAF,G,cAQE,SAAAD,GACD,KAAArT,KAAA2Q,MAAA6B,EAAAC,2BAAA,OAED,IAAAzS,KAAAyT,aAAA7R,OAAA,OAKC,IAAI6R,EAAczT,KAAAyT,a,KAEjBA,aAAK,G,QACLC,EAAI,GAEJ/R,EAAA,EAAWA,EAAM8R,EAAA7R,OAAAD,IAAA+R,GAAA,IAAA/R,EAAA,IAAAgS,EAAAC,OAAA5T,KAAA6T,aAAAJ,EAAA9R,GAAA,S,0BAGhBmS,QAAO,CACRJ,SACD,CAAAR,EAAAC,KAEDnT,KAAA+T,gBAKK,QAAKpS,EAAK,EAAIA,EACjB8R,EAAY7R,OAAYD,IAAE,IAE1B,IAAKqS,EAAad,EAAG,IAAMvR,GAErB,IAAKqS,EAAA,CACZ,MAAAP,EAAA9R,GAAA,IAAA8R,EAAA9R,GAAA,GAAA8R,EAAA9R,GAAA,IAED,QAKS,CAIF,MAFC8R,EAAY9R,GAAQ,IAOhB3B,KAAIiU,eACND,EAAAP,EAA2B9R,GAAG,KAAA8R,EAAmB9R,GAAG,GAAEqS,EAAIP,EAAA9R,GAAA,GAInE,OAAAuS,GAAA,CAEDb,MAAA,IAKKF,IAGJnT,KAAO+T,gBACP,QAAApS,EAAA,EAAAA,EAAA8R,EAAA7R,OAAAD,IAAA,MAAA8R,EAAA9R,GAAA,IAAA8R,EAAA9R,GAAA,GAAA8R,EAAA9R,GAAA,M,gBAiBU,WAEN,aAAakH,IAGjB7I,KAAAmU,gBACInU,KAAAmU,cAAuB,GAAAtL,EAAoBtB,SAC9C6M,gBAAoBxK,UAAAC,IAAA,Q,gBAQE,W,GAEtB,aAAKhB,EAAkB,C,QAACsL,gBAASnU,KAAAmU,cAAO,O,YAAQ,KAAG,IAAAnU,KAAAmU,eAAAtL,EAAAtB,SAAA6M,gBAAAxK,UAAAvB,OAAA,UACnD,I,UASA,SAAM6B,EAAM7J,G,OACH,OAATA,SAASL,KAAAqU,QAAAnK,G,KACRmK,QAAUnK,GAAA7J,E,mBAKX,SAAgBiU,G,IACfC,EAAA,GAEF,GAAID,aAAaE,SAAA,QAAA7S,KAAI2S,EAAA/D,UAAAgE,EAAA7T,KACpB+T,mBAAmB9S,EAAA,IAAG,IAAU8S,mBAAA9S,EAAA,UAE7B,QAAOgM,KAAK2G,EAAKC,EAAA7T,KAAQ+T,mBAAU9G,GAAgB,IACvD8G,mBAAAH,EAAA3G,K,OACC4G,EAAMG,KAAI,I,SAWT,SAAAC,G,OAEkB,IAAnBA,EAAA1K,QAAU,MAET0K,E,KAEC5B,OAAQ4B,C,cAMN,SAAKA,EAAQC,G,WAES,GAArBD,EAAM1K,QAAI,KAAW,SAAA2K,C,mBASlBtU,EAAOuU,EAASC,EAAAC,EAAA,KAAA9B,EAAA,KAAA+B,EAAA,I,MAEvBhV,KAAKiV,OAAKD,G,cAEJxC,EAAmBM,eAAW6B,EAAA3U,KAAAkV,YAAAP,EAAA,KAAAQ,KAAAC,QAIlC,Q,EAFDL,EACAA,EAAA5K,cAAA,OACyB,QAAhB4K,IAAgBA,EAAA,QACxB,O,IAAM9B,EAAAjT,KAAAiT,S,sBACNjT,KAAA2Q,MAAA6B,EAAAC,0BAqBH,OApBEnS,aAAAkU,WAAAlU,EAAA,IACDA,S,KAQAmT,aAAa/S,KAAA,CAEZmU,EACAC,EACAxU,I,oDAyBD,CAED+U,OAAc,4EACPrV,KAAKqU,SAGbiB,OAAAP,EAICQ,KAAK,KACLC,WAAK,G,QAGE7E,MAAQ6B,EAAgBK,sBAAA4C,EAAAC,YAAA,WAAe,iBAAZzG,GAAYA,aAAA0G,KA+D/C,iBAAA1G,EAED,MAAAA,EAAA,GAKaA,EAAQ2G,SAAQ,oBAAkBH,EAAQpB,QAAA,uCACtDoB,EAAApB,QAAA,kCAED,MAAApF,EAAA,GAGAwG,EAAKpB,QAAU,gBAAgB,mBAElBoB,EAAQpB,QAAQ,gBAAkB,2BAC9CoB,EAAApB,QAAA,gBAAApF,EAAAf,KAEDuH,EAAAH,OAAA,OAKKG,EAAMF,KAAStG,MAtF4B,CAG9C,KAAMA,aACPuF,UAAA,CACKvF,EAAC,IAAAuF,SAED,QAAO7S,KAAKrB,EACfA,EAAAqB,aAAAkU,MAAAvV,EAAAqB,aAAAgU,KAAA1G,EAAA6G,OAAAnU,EAAArB,EAAAqB,GAAArB,EAAAqB,GAAAuI,MAAI+E,EAAA6G,OAASnU,EAAOrB,EAAOqB,G,CAI1B,QAAAgM,KAAAsB,EAAAsB,UAAA,GAAA5C,EAAA,aAAAkI,MAAAlI,EAAA,aAAAgI,KAAA,CACHF,EAAAH,OAAA,OAEDG,EAAAD,WAAA,EAKS,KAEJ,CAGA,GAAKxV,KAACgT,UAAQhT,KAAA2Q,MAAA6B,EAAIE,kBAAwC+C,EAAMD,UAEnE,CAEC,IAAOjP,EAAO,IAAIiO,SAEjBjO,EAAIuP,OAAI,QAAenC,EAAAC,OAAA5T,KAAA6T,aAAA5E,KACvBA,EAAO1I,C,CAGN,WAAAkP,EAAAH,OAAA,CAGG,IAAAS,EAAO,EACdN,EAAAH,OAAA,MAED,QAAAvH,KAAAkB,EAAAsB,UAKuB,GAAXwF,GAAMhI,EAAA,GAAAnM,OAAAmM,EAAA,GAAAnM,OAAA,EAAKmU,EAAA,KAAGN,EAAAH,OAAA,OAAY,KAAI,CAG1C,CAMC,OADQG,EAAAH,OACRX,EAAA3U,KAAAkV,YAAAP,EAAA3U,KAAA6T,aAAA5E,IACQwG,EAAAD,UAKAC,EAAAF,KAAAtG,GAJPwG,EAAApB,QAAA,oDAEOoB,EAAAF,KAAevV,KACvB6T,aAAA5E,G,GA8BQ+G,MAAOrB,EAAAc,GAAAQ,MAAA1N,GAAAvI,KAAAkW,aAAA3N,KAAA0N,MAAA1N,I,QACbwL,gBACAc,GACD7U,KAAAiU,eAAA1L,EAAAjI,GAAA,IAEMuU,EAAItM,EAASjI,EACN,CAAb,MAAK4T,GAAQ,KACXiC,OAAAC,IACHpW,KAAA+T,gBAED,GAAAd,EAKW6B,GAETA,EAAAxU,GAAIN,KAAO8T,QAAS7E,EAAA4F,EACpBC,EAAAC,EAAA9B,EAAA,EAAA+B,EAAA,G,eAMU,SAACzM,GACZ,IAAA2F,EAAA3F,EAAA8L,QAAAnF,IAAA,gBAAAtJ,MAAA,QAAAyB,cACA,OAAArH,KAAA2Q,MAAA6B,EAAAG,0BAAA,IAAAzE,EAAAjE,QAAA,QAAA1B,EAAA8N,OAEFrW,KAAA2Q,MAAA6B,EAAeI,yBAAG,IAAA1E,EAAAjE,QAAA,WAAAqM,SAAA,CAAAC,EAAAC,K,8nBCzgBC3W,EAAAC,OAAA,CAElB2W,UAAS,aAETC,cAAc,IACdC,QAAA,KACAC,cAAa,EAEbC,aAAS,EACTC,aAAQ,EACRnT,IAAI,KACJoT,MAAM,EAENnP,KAAA,K,KAOC,K,OASI,SAASoP,EAAEC,GAEfjX,KAAKC,OAAOC,gBAAIC,SAChBH,KAAKgX,SAAKA,EAENC,GAAQxQ,OAAIyQ,OAAAlX,KAAAiX,GAChBjX,KAAK2W,QAAK,IAAazS,EAAKlE,KAAA2W,SAE5B3W,KAAK2D,IAAAuB,KAAQkB,SAAAC,WAAuBC,OAAI,GAExCtG,KAAK+W,MAAK,EACV/W,KAAK4H,KAAK,IAAAuP,EACVnX,KAAK4H,KAAKwP,WAAApX,KACVA,KAAKqX,KAAK,IAAAF,EACVnX,KAAKqX,KAAKD,WAAApX,KAEVA,KAAK2W,QAAK3V,iBAAkBhB,KAAQ2D,IAAC,mBAAsB3D,KAAAsX,oBAAwBtX,MACnFA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,gBAAiB3D,KAAKuX,iBAAkBvX,MAC7EA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,gBAAgB3D,KAAKuX,iBAAkBvX,MAC5EA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,eAAgB3D,KAAKuX,iBAAkBvX,MAC5EA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,eAAc3D,KAAKuX,iBAAkBvX,MAC1EA,KAAA4H,KAAA5G,iBAAAhB,KAAA2D,IAAA,aAAA3D,KAAAuX,iBAAAvX,MAEDA,KAAAqX,KAAArW,iBAA+BhB,KAAK2D,IACpC,gBAAA3D,KAAAwX,iBAAAxX,MACCA,KAAKqX,KAAArW,iBAAsBhB,KAAG2D,IAAQ,gBAAiB3D,KAAGwX,iBAAoBxX,MAC9EA,KAAAqX,KAAArW,iBAAAhB,KAAA2D,IAAA,eAAA3D,KAAAwX,iBAAAxX,MAEDA,KAAAqX,KAAArW,iBAA+BhB,KAAM2D,IACrC,eAAA3D,KAAAwX,iBAAAxX,MACCA,KAAKqX,KAAArW,iBAAsBhB,KAAI2D,IAAO,aAAc3D,KAAGwX,iBAAoBxX,K,EAG5EsX,oBAAkB,SAAahT,EAAE7C,GAEhCzB,KAAKyX,aAAa,UAAYnT,EAAC4F,KAAQ,GAAAC,cAAmB7F,EAAC4F,KAAK5D,OAAS,GAAE7E,GAAMiW,UAAapT,EAACE,QAAQmT,Q,EAGxGJ,iBAAA,SAAAjT,EAAA7C,GAQCzB,KAAIyX,aAAY,OAAInT,EACpB4F,KAAA,GAAAC,cAAA7F,EAAA4F,KAAA5D,OAAA,GAAA7E,GAAAiW,UAAApT,EAAAE,QAAAmT,Q,mBAEQ,SAAOrT,EAAA7C,G,KACdgW,aAAA,OAAAnT,EAAA4F,KAAA,GAAAC,cAAA7F,EAAA4F,KAAA5D,OAAA,GAAA7E,GAAAiW,UAAApT,EAAAE,QAAAmT,Q,UAYA,SAAAC,EAAA,OAAAvE,EAAA,MAES,mBAALuE,IACJvE,EAASuE,EACTA,EAAI,QAGH5X,KAAA6X,WAEErS,aAAaxF,KACjB6X,UACC7X,KAAI6X,SAAU,M,MAEdzF,EAEI,KACLpS,KAAA6X,SAAA,KAEDC,EAAAvE,gBAMQvT,KAAI4W,cACX,QAD6BgB,GAC7B,UAAAA,GAAA5X,KAAA+X,aACK/X,KAAI6W,aAAwB,QAAXe,GAAmB5X,KAAKgY,YACzChY,KAAK8W,aAEH9W,KAASiY,YAEbH,EAA0BtE,WAAAH,EAAA,G,0BAY3BwE,SAAalT,WAAOyN,EAAApS,KAAA0W,c,iBAYhBvH,EAAW+I,GAAS,G,WAExB5B,SAAM,CAAAC,EAAeC,K,MAGX,GAAT0B,EAAgB,KAAAlY,KAAA4H,KAAAuQ,KAAAhJ,GAAA,GACfiJ,EAM+B7B,EAAA6B,EAAAlJ,OAN/BlP,KAAAqY,SAAAlJ,GAAAmJ,IACDA,GAAA,KAAAA,EAAAtE,UACHsE,EAAArJ,KAAArN,OAAA,EAAA2U,EAAA+B,EAAArJ,KAAA,IAIWuH,EAAA8B,EAAA,GAAwB,G,SASlC,SAAKhY,G,OACH,IAAAgW,SAAA,CAAAC,EAAAC,KACHxW,KAAAuY,YAAAjY,GAAAgY,IAGD,KADWA,EAAAtE,SACXuC,EAAA+B,GACY9B,EAAA8B,EAAAE,MAAA,GAAC,G,YAIP,WAEL,IAAAvJ,EAAA,IACCjP,KAAK2W,QAAKzH,O,EAEVoC,EAAKtR,KAAAgX,SAAc,Q,KACjBxV,cAAA,eACHsW,EAAA9B,MAAA/G,GAAAgH,MAAAqC,IAEDtY,KAAY4H,KAAA6Q,QACZ,KAAAH,EAAAtE,SAAAsE,EAAArJ,KAAA,MACKjP,KAAIwB,cAAG,cAACxB,KAAGwB,cAAgB,cAAE,G,YAI5B,WAEL,IAAAyN,EAAA,IACCjP,KAAK2W,QAAUzH,O,EAEfoC,EAAKtR,KAAAgX,SAAc,Q,KACjBxV,cAAA,eACHsW,EAAA9B,MAAA/G,GAAAgH,MAAAqC,IAEOtY,KAAEqX,KAAAoB,QACV,KAD0BH,EAAEtE,SAC5BsE,EAAArJ,KAAA,MACKjP,KAAIwB,cAAG,cAACxB,KAAGwB,cAAgB,cAAE,G,aAE3B,WAEN,IAAAyN,EAAA,IACCjP,KAAQ2W,QAAIzH,OAEbD,EAAAqC,EAAAtR,KAAAgX,SAAA,SAEDhX,KAAAwB,cAAuB,gBAElBsW,EAAO9B,MAAA/G,GAAAgH,MAAAqC,IAACtY,KAAG+W,MAAkB,KAAbuB,EAAOtE,SAAMsE,EAAAvB,MAAA,EAAE/W,KAAGwB,cAAM,eAAExB,KAAAwB,cAAA,kB,WAK7C,SAAWlB,EAAC+S,G,IACVpE,EAAA,IACHjP,KAAA2W,QAAAzH,SAEU5O,G,EAEEgR,EAAGtR,KAAKgX,SAAa,OAAEc,EAAS9B,MAAA/G,GAAAgH,MAAAqC,IAAEjF,EAAAiF,EAAA,G,cAM9C,SAAAhY,EAAA+S,GAED,IAAOpE,EAAE,IAEJjP,KAAO2W,QAAAzH,SAAI5O,G,EAA+BgR,EAAAtR,KAAAgX,SAAA,UAE1Cc,EACW9B,MAAA/G,GAAAgH,MAAAqC,IAEfjF,EAAOiF,EAAA,GAEP,E,oOClPiBnB,EAAArX,OAAA,CAElB2W,UAAS,WAETC,cAAS,IAETC,QAAA,K,IAMC,K,OASI,SAAQrF,EAAG2F,EAAI,MAEnBjX,KAAKC,OAAMyY,UAAWvY,SACT,OAAT8W,GAAiBxQ,OAAAyQ,OAAAlX,KAAAiX,GAEhBjX,KAAA2W,UAAQ3W,KAAA2W,QAAsB,CAAC,GACpC3W,KAAA2W,QAAArF,IAEDtR,KAAA2W,QAAmB,IAAEzS,EAAelE,KAAA2W,SAEnC3W,KAAK2D,IAAAuB,KAAAkB,SAAaC,WAAgBC,OAAQ,GAC1CtG,KAAA2Y,SAAA3Y,KAEDA,KAAA2W,QAAA3V,iBAAAhB,KAAA2D,IAAA,mBAAA3D,KAAAsX,oBAAAtX,K,sBAOe,SAAKsE,EAAS7C,G,KAC3BgW,aAAa,UAAQnT,EAAA4F,KAAA,GAAAC,cAAA7F,EAAA4F,KAAA5D,OAAA,GAAA7E,GAAAiW,UAAApT,EAAAE,QAAAmT,Q,UAOrB,SAAAtE,EAAA,KAAAuF,EAAA,M,QAECf,W,aACK7X,KAAA6X,U,KACLA,SAAK,OAIH,I,EAWJ,OATC7X,KAAAwB,cAAO,oBACPsW,EAAA9B,MAAAhW,KAAA2W,QAAAzH,OAAA+G,MAAAqC,IAEOtY,KAAGyY,QAAM,KAAAH,EAAAtE,SAAAsE,EAAArJ,KAAA,MACZjP,KAACwB,cAAc,cAClBxB,KAAAwB,cAAA,eAEwB,OAArBoX,GAA0BA,GAAK,I,2ECxEtC,MAAMC,EACN,CAKCC,YAAa,SAAUC,EAAKC,EAAKC,EAAUC,EAAQ7F,GAElD,IAAI8F,EAAO,GACPlK,EAAO,GACP8H,EAAQ,EAEZ,IAAK,IAAIqC,KAAKL,EAEbI,EAAKC,GAAK,EACVnK,EAAKmK,GAAKL,EAAIK,GACdrC,IAGD,IAAIsC,EAAWlE,KAAKC,MAAM,IACtBkE,EAAK,EAELC,EAAe,WAElB,IAAIC,EAAUrE,KAAKC,MAAM,IACzBkE,EAAKE,EAAUH,EACfA,EAAWG,EAEX,IAAK,IAAIJ,KAAKD,EACd,CACC,GAAIA,EAAKC,IAAMH,EAASG,GACvB,SAEDD,EAAKC,IAAME,EACPH,EAAKC,IAAMH,EAASG,KAEvBD,EAAKC,GAAKH,EAASG,GACnBrC,KAGD,IAAI0C,EAAIP,EAAOE,GAAID,EAAKC,GAAKH,EAASG,IACtCnK,EAAKmK,IAAM,EAAEK,GAAGV,EAAIK,GAAKK,EAAET,EAAII,E,CAGhC/F,EAAUpE,EAAe,GAAT8H,GAEH,GAATA,GACH2C,sBAAsBH,E,EAGxBA,G,EAIDI,OACA,CACCC,GAAI,SAAUH,GAEb,OAAOA,C,EAGRI,IAAK,SAAUJ,GAEd,OAAOA,C,EAGRK,OAAQ,SAAUL,GAEjB,OAAOA,C,GAKTM,KACA,CACC3W,EAAG,QAEHwW,GAAI,SAAUH,EAAGrW,GAGhB,YADUH,IAANG,IAAiBA,EAAIyV,EAAOkB,KAAK3W,GAC9BqW,EAAEA,IAAIrW,EAAE,GAAGqW,EAAIrW,E,EAGvByW,IAAK,SAAUJ,EAAGrW,GAEjB,OAAO,EAAIyV,EAAOkB,KAAKH,GAAG,EAAIH,EAAGrW,E,EAGlC0W,OAAQ,SAAUL,EAAGrW,GAEpB,OAAIqW,EAAI,GACAZ,EAAOkB,KAAKH,GAAK,EAAFH,EAAKrW,GAAG,EAEvByV,EAAOkB,KAAKF,IAAY,GAAPJ,EAAE,IAAQrW,GAAG,EAAI,E,GAK5C4W,OACA,CACCC,SAAU,SAAUR,GAEnB,OAAIA,EAAI,EAAI,KACJ,OAASA,EAAIA,EACZA,EAAI,EAAI,KACT,QAAUA,GAAK,IAAI,MAAMA,EAAI,IAC5BA,EAAI,IAAI,KACT,QAAUA,GAAK,KAAM,MAAQA,EAAI,MAElC,QAAUA,GAAK,MAAM,MAAQA,EAAI,O,EAGzCG,GAAI,SAAUH,GAEb,OAAO,EAAIZ,EAAOmB,OAAOC,SAAS,EAAER,E,EAGrCI,IAAK,SAAUJ,GAEd,OAAOZ,EAAOmB,OAAOC,SAASR,E,EAG/BK,OAAQ,SAAUL,GAEjB,OAAIA,EAAI,IACC,EAAIZ,EAAOmB,OAAOC,SAAS,EAAE,EAAER,IAAI,EAEpCZ,EAAQmB,OAAOC,SAAiB,GAAPR,EAAE,KAAQ,EAAG,E,GAKhDS,KACA,CACCN,GAAI,SAAUH,GAEb,OAAO,EAAIvU,KAAKC,KAAK,EAAIsU,EAAEA,E,EAG5BI,IAAK,SAAUJ,GAEd,OAAO,EAAIZ,EAAOqB,KAAKN,GAAG,EAAIH,E,EAG/BK,OAAQ,SAAUL,GAEjB,OAAIA,EAAI,GACCZ,EAAOqB,KAAKN,GAAK,EAAFH,GAAK,EAEpBZ,EAAOqB,KAAKL,IAAY,GAAPJ,EAAE,KAAQ,EAAI,E,GAK1CU,MACA,CACCP,GAAI,SAAUH,GAEb,OAAOA,EAAEA,EAAEA,C,EAGZI,IAAK,SAAUJ,GAEd,OAAO,EAAIZ,EAAOsB,MAAMP,GAAG,EAAIH,E,EAGhCK,OAAQ,SAAUL,GAEjB,OAAIA,EAAI,GACAZ,EAAOsB,MAAMP,GAAK,EAAFH,GAAK,EAErBZ,EAAOsB,MAAMN,IAAY,GAAPJ,EAAE,KAAQ,EAAI,E,GAK1CW,KACA,CACCR,GAAI,SAAUH,GAEb,OAAOvU,KAAKmV,IAAI,EAAG,IAAIZ,EAAE,G,EAG1BI,IAAK,SAAUJ,GAEd,OAA6B,EAArBvU,KAAKmV,IAAI,GAAG,GAAIZ,E,EAGzBK,OAAQ,SAAUL,GAEjB,OAAKA,GAAK,GAAK,EACPvU,KAAKmV,IAAK,EAAG,IAAMZ,EAAI,IAAM,GAEG,EAA9BvU,KAAKmV,IAAK,GAAG,IAAOZ,EAAI,KAAW,C,GAK/Ca,MACA,CACCC,EAAG,GAEHX,GAAI,SAAUH,GAEb,OAAOvU,KAAKmV,IAAIZ,EAAGZ,EAAOyB,MAAMC,E,EAGjCV,IAAK,SAAUJ,GAEd,OAAO,EAAIZ,EAAOyB,MAAMV,GAAG,EAAIH,E,EAGhCK,OAAQ,SAAUL,GAEjB,OAAIA,EAAI,GACAZ,EAAOyB,MAAMV,GAAK,EAAFH,GAAK,EAErBZ,EAAOyB,MAAMT,IAAY,GAAPJ,EAAE,KAAQ,EAAI,E,GAK1Ce,KACA,CACCZ,GAAI,SAAUH,GAEb,OAAOA,EAAEA,C,EAGVI,IAAK,SAAUJ,GAEd,OAAO,EAAIZ,EAAO2B,KAAKZ,GAAG,EAAIH,E,EAG/BK,OAAQ,SAAUL,GAEjB,OAAIA,EAAI,GACAZ,EAAO2B,KAAKZ,GAAK,EAAFH,GAAK,EAEpBZ,EAAO2B,KAAKX,IAAY,GAAPJ,EAAE,KAAQ,EAAI,E,GAKzCgB,QACA,CACCb,GAAI,SAAUH,GAEb,OAAOA,EAAEA,EAAEA,EAAEA,C,EAGdI,IAAK,SAAUJ,GAEd,OAAO,EAAIZ,EAAO4B,QAAQb,GAAG,EAAIH,E,EAGlCK,OAAQ,SAAUL,GAEjB,OAAIA,EAAI,GACAZ,EAAO4B,QAAQb,GAAK,EAAFH,GAAK,EAEvBZ,EAAO4B,QAAQZ,IAAY,GAAPJ,EAAE,KAAQ,EAAI,E,GAK5CiB,QACA,CACCd,GAAI,SAAUH,GAEb,OAAOA,EAAEA,EAAEA,EAAEA,EAAEA,C,EAGhBI,IAAK,SAAUJ,GAEd,OAAO,EAAIZ,EAAO6B,QAAQd,GAAG,EAAIH,E,EAGlCK,OAAQ,SAAUL,GAEjB,OAAIA,EAAI,GACCZ,EAAO6B,QAAQd,GAAK,EAAFH,GAAK,EAEvBZ,EAAO6B,QAAQb,IAAY,GAAPJ,EAAE,KAAQ,EAAI,E,GAK7CkB,KACA,CACCf,GAAI,SAAUH,GAEb,OAAO,EAAIvU,KAAK0V,IAAK,QAAU,EAAInB,G,EAGpCI,IAAK,SAAUJ,GAEd,OAAOvU,KAAK0V,IAAK,OAASnB,E,EAG3BK,OAAQ,SAAUL,GAEjB,OAAQvU,KAAK2V,IAAK,OAAOpB,GAAK,IAAK,C,GAKrCqB,KACA,CACClB,GAAI,SAAUH,GAEb,OAAY,GAALA,EAAW,EAAI,C,EAGvBI,IAAK,SAAUJ,GAEd,OAAY,GAALA,EAAW,EAAI,C,EAGvBK,OAAQ,SAAUL,GAEjB,OAAY,GAALA,EAAW,EAAI,C,QAKzBsB,EAAelC,ECpUf,MAAMmC,EAAOC,EAAMnb,OAClB,CACA8H,KAAM,KAENsT,YAAa,KACbjM,KAAM,KAENkM,MAAO,KACPC,MAAO,KAEPC,UAAW,EAAGlC,KAAM,EAAGmC,UAAW,EAClCC,MAAO,EAEPC,QAAQ,EACRC,UAAU,EAEVC,mBAAoB,KACpBC,kBAAmB,KAEnBxb,OAAQ,WAEPH,KAAK4H,KAAO,GAEZ5H,KAAKkb,YAAc,GACnBlb,KAAKiP,KAAO,GAEZjP,KAAKmb,MAAQ,GACbnb,KAAKob,MAAQpb,KAAK4H,KAElB5H,KAAK4b,O,EAGNC,OAAQ,WACR,EAGA7K,MAAO,WAEN,IAAIjO,EAAI,IAAIiY,EAKZ,OAHAjY,EAAE6E,KAAO5H,KAAK4H,KACd7E,EAAEmY,YAAclb,KAAKkb,YAEdnY,EAAE6Y,O,EAGVE,WAAY,SAAUzI,GAGrB,OADArT,KAAK0b,mBAAqBrI,EACnBrT,I,EAGR+b,UAAW,SAAU1I,GAGpB,OADArT,KAAK2b,kBAAoBtI,EAClBrT,I,EAIR4b,MAAO,WAEN5b,KAAKmb,MAAMvZ,OAAS,EACpB5B,KAAKsb,UAAY,EAEjBtb,KAAKmZ,KAAO,EACZnZ,KAAKub,MAAQ,EAEbvb,KAAKob,MAAQpb,KAAK4H,KAElB5H,KAAKwb,QAAS,EACdxb,KAAKyb,UAAW,EAChBzb,KAAKgc,OAAS,KAEd,IAAK,IAAIra,KAAK3B,KAAKkb,YAClBlb,KAAKiP,KAAKtN,GAAK3B,KAAKkb,YAAYvZ,GAEjC,OAAO3B,I,EAIRic,QAAS,SAAUhN,GAGlB,OADAjP,KAAKkb,YAAcjM,EACZjP,KAAK4b,O,EAIbM,MAAO,SAAU7b,GAGhB,OADAL,KAAKqb,UAAYhb,EAAQ,EAAMA,EAAQ,EAChCL,I,EAIRmc,UAAW,SAAUlN,GAGpB,OADAjP,KAAKiP,KAAOA,EACLjP,I,EAIRoc,MAAO,WAEFpc,KAAKwb,SAETa,cAAcrc,KAAKgc,QACnBhc,KAAKwb,QAAS,E,EAIf7D,OAAQ,WAEP,IAAK3X,KAAKwb,OAAQ,OAElB,IAAInC,EAAWlE,KAAKC,MAAM,IAE1BpV,KAAKgc,OAASM,aAAY,KAEzB,IAAI9C,EAAUrE,KAAKC,MAAM,IACrBkE,EAAKE,EAAUH,EACnBA,EAAWG,EAEXxZ,KAAKgJ,OAAOsQ,GAERtZ,KAAK2b,mBACR3b,KAAK2b,kBAAmB3b,KAAKiP,KAAMjP,KAAK,GAE1C,IAEIA,KAAK2b,mBACR3b,KAAK2b,kBAAmB3b,KAAKiP,KAAMjP,MAEpCA,KAAKwb,QAAS,C,EAIfxS,OAAQ,SAAUsQ,GAEjB,GAAItZ,KAAKwb,OAAQ,OAAO,EAExB,GAAIxb,KAAKub,OAASvb,KAAKob,MAAMxZ,OAC5B,OAAO,EAER,IAEI2a,EACAC,EACAC,EAJA9a,EAAI,EAQR,IAFA3B,KAAKmZ,MAAQG,EAAGtZ,KAAKqb,UAEdrb,KAAKub,MAAQvb,KAAKob,MAAMxZ,QAC/B,CACC,IACIqX,EADAyD,EAAM1c,KAAKob,MAAMpb,KAAKub,OAG1B,OAAQmB,EAAIC,IAEX,IAAK,WACJ,GAAmB,GAAfD,EAAIE,QAKP,IAHAF,EAAIG,OAAOjb,OAAS,EACpB8a,EAAIE,SAAU,EAETjb,EAAI,EAAGA,EAAI+a,EAAItB,MAAMxZ,OAAQD,IAEjC+a,EAAIG,OAAOnc,KAAK,CAACgc,EAAItB,MAAMzZ,KAC3B+a,EAAII,QAAQnb,GAAK,EACjB+a,EAAIK,WAAWpb,GAAK3B,KAAKsb,UAI3BiB,EAASvc,KAAKob,MACdoB,EAASxc,KAAKub,MACdkB,EAAazc,KAAKsb,UAElB,IAAI0B,EAAI,EACJ1B,EAAYmB,EAEhB,IAAK9a,EAAI,EAAGA,EAAI+a,EAAIG,OAAOjb,OAAQD,IAElC3B,KAAKob,MAAQsB,EAAIG,OAAOlb,GACxB3B,KAAKub,MAAQmB,EAAII,QAAQnb,GACzB3B,KAAKsb,UAAYoB,EAAIK,WAAWpb,IAET,IAAnB3B,KAAKgJ,OAAO,IACfgU,IAEGhd,KAAKsb,UAAYA,IACpBA,EAAYtb,KAAKsb,WAElBoB,EAAIK,WAAWpb,GAAK3B,KAAKsb,UACzBoB,EAAIG,OAAOlb,GAAK3B,KAAKob,MACrBsB,EAAII,QAAQnb,GAAK3B,KAAKub,MASvB,GANAvb,KAAKob,MAAQmB,EACbvc,KAAKub,MAAQiB,EACbxc,KAAKsb,UAAYmB,EAEbC,EAAItK,IAAIsK,EAAItK,GAAG7G,KAAKvL,MAEpBgd,GAAKN,EAAIG,OAAOjb,OACnB,OAAO,EAER8a,EAAIE,SAAU,EAEd5c,KAAKsb,UAAYA,EACjBtb,KAAKub,QACL,MAED,IAAK,SA8BJ,GA7BmB,GAAfmB,EAAIE,UAEPF,EAAIH,OAASG,EAAItB,MACjBsB,EAAIF,OAAS,EACbE,EAAID,WAAazc,KAAKsb,UAEtBoB,EAAIE,SAAU,GAGfL,EAASvc,KAAKob,MACdoB,EAASxc,KAAKub,MACdkB,EAAazc,KAAKsb,UAElBtb,KAAKob,MAAQsB,EAAIH,OACjBvc,KAAKub,MAAQmB,EAAIF,OACjBxc,KAAKsb,UAAYoB,EAAID,WAErB9a,EAAI3B,KAAKgJ,OAAO,GAEhB0T,EAAIH,OAASvc,KAAKob,MAClBsB,EAAIF,OAASxc,KAAKub,MAClBmB,EAAID,WAAazc,KAAKsb,UAEtBtb,KAAKob,MAAQmB,EACbvc,KAAKub,MAAQiB,EACbxc,KAAKsb,UAAYmB,EAEbC,EAAItK,IAAIsK,EAAItK,GAAG7G,KAAKvL,OAEd,IAAN2B,EAAY,OAAO,EAEvB+a,EAAIE,SAAU,EAEd5c,KAAKsb,UAAYoB,EAAID,WACrBzc,KAAKub,QACL,MAED,IAAK,SA+BJ,OA9BmB,GAAfmB,EAAIE,UAEPF,EAAIH,OAASG,EAAItB,MACjBsB,EAAIF,OAAS,EACbE,EAAID,WAAazc,KAAKsb,UACtBoB,EAAIO,OAASP,EAAI3F,MAEjB2F,EAAIE,SAAU,GAGfL,EAASvc,KAAKob,MACdoB,EAASxc,KAAKub,MACdkB,EAAazc,KAAKsb,UAElBtb,KAAKob,MAAQsB,EAAIH,OACjBvc,KAAKub,MAAQmB,EAAIF,OACjBxc,KAAKsb,UAAYoB,EAAID,WAErB9a,EAAI3B,KAAKgJ,OAAO,GAEhB0T,EAAIH,OAASvc,KAAKob,MAClBsB,EAAIF,OAASxc,KAAKub,MAClBmB,EAAID,WAAazc,KAAKsb,UAEtBtb,KAAKob,MAAQmB,EACbvc,KAAKub,MAAQiB,EACbxc,KAAKsb,UAAYmB,EAEbC,EAAItK,IAAIsK,EAAItK,GAAG7G,KAAKvL,OAEd,IAAN2B,IAEA+a,EAAIO,QAAU,GAEjBP,EAAIE,SAAU,EAEd5c,KAAKsb,UAAYoB,EAAID,WACrBzc,KAAKub,SAEE,IAIPmB,EAAIF,OAAS,EACbE,EAAIO,UAEG,IAKT,IAAK,MACJjd,KAAKiP,KAAKyN,EAAIQ,OAASR,EAAIrc,MAC3BL,KAAKub,QACL,MAED,IAAK,UACJvb,KAAKub,MAAQ,EACb,MAED,IAAK,OAGJ,GAFAtC,EAAwC,UAA7BhQ,EAAK0B,OAAO+R,EAAIzD,UAAwBjZ,KAAKiP,KAAKyN,EAAIzD,UAAYyD,EAAIzD,SAE7EjZ,KAAKmZ,KAAOnZ,KAAKsb,UAAYrC,EAChC,OAAO,EAERjZ,KAAKsb,WAAarC,EAClBjZ,KAAKub,QACL,MAED,IAAK,QAyBJ,GAxBmB,GAAfmB,EAAIE,UAEgB,OAAnBF,EAAIS,WACPT,EAAIU,YAAcpd,KAAKiP,KAAKyN,EAAIQ,OAEhCR,EAAIU,YAAcV,EAAIS,WAEvBT,EAAIW,UAAYX,EAAIY,SAEpBZ,EAAIE,SAAU,GAGf3D,EAAwC,UAA7BhQ,EAAK0B,OAAO+R,EAAIzD,UAAwBjZ,KAAKiP,KAAKyN,EAAIzD,UAAYyD,EAAIzD,SAGhFK,EADGtZ,KAAKmZ,KAAOnZ,KAAKsb,UAAYrC,GAC1BjZ,KAAKmZ,KAAOnZ,KAAKsb,WAAarC,EAE/B,EAEFyD,EAAIxD,QAAgB,GAANI,EACjBtZ,KAAKiP,KAAKyN,EAAIQ,OAASR,EAAIxD,OAAOI,IAAKoD,EAAIW,UAAYX,EAAIU,aAAeV,EAAIU,YAE9Epd,KAAKiP,KAAKyN,EAAIQ,OAAS5D,GAAIoD,EAAIW,UAAYX,EAAIU,aAAeV,EAAIU,YAEzD,GAAN9D,EAAS,OAAO,EAEpBoD,EAAIE,SAAU,EAEd5c,KAAKsb,WAAarC,EAClBjZ,KAAKub,QACL,MAED,IAAK,OAmBJ,GAlBmB,GAAfmB,EAAIE,UAEPF,EAAIE,SAAU,EACdF,EAAIa,KAAO,MAGZtE,EAAwC,UAA7BhQ,EAAK0B,OAAO+R,EAAIzD,UAAwBjZ,KAAKiP,KAAKyN,EAAIzD,UAAYyD,EAAIzD,SAGhFK,EADGtZ,KAAKmZ,KAAOnZ,KAAKsb,UAAYrC,GAC1BjZ,KAAKmZ,KAAOnZ,KAAKsb,WAAarC,EAE/B,EAEFyD,EAAIxD,QAAgB,GAANI,EACjBoD,EAAIc,OAASd,EAAIxD,OAAOI,GAAIoD,EAAI3F,OAEhC2F,EAAIc,OAASlE,EAAGoD,EAAI3F,OAEjB2F,EAAIc,KAAOd,EAAIa,KACnB,CACC,KACC5b,KAAOuD,KAAKkB,UAAUsW,EAAIY,SAAWZ,EAAIS,WAAa,IAAMT,EAAIS,WAC5Dxb,GAAK3B,KAAKiP,KAAKyN,EAAIQ,SAGxBld,KAAKiP,KAAKyN,EAAIQ,OAASvb,EACvB+a,EAAIa,KAAOb,EAAIc,G,CAGhB,GAAU,GAANlE,EAAS,OAAO,EAEpBoD,EAAIE,SAAU,EAEd5c,KAAKsb,WAAarC,EAClBjZ,KAAKub,QACL,MAED,IAAK,QAeJ,GAdAtC,EAAwC,UAA7BhQ,EAAK0B,OAAO+R,EAAIzD,UAAwBjZ,KAAKiP,KAAKyN,EAAIzD,UAAYyD,EAAIzD,SAGhFK,EADGtZ,KAAKmZ,KAAOnZ,KAAKsb,UAAYrC,GAC1BjZ,KAAKmZ,KAAOnZ,KAAKsb,WAAarC,EAE/B,EAGLtX,EADG+a,EAAIxD,QAAgB,GAANI,EACboD,EAAIxD,OAAOI,IAAKoD,EAAI3F,MAAM,GAE1BuC,GAAIoD,EAAI3F,MAAM,GAEnB/W,KAAKiP,KAAKyN,EAAIQ,OAASR,EAAIe,UAAU9b,EAAI+a,EAAI3F,OAAS2F,EAAI3F,QAEhD,GAANuC,EAAS,OAAO,EAEpBtZ,KAAKsb,WAAarC,EAClBjZ,KAAKub,QACL,MAED,IAAK,OACJmB,EAAIgB,IAAIC,OACR3d,KAAKub,QACL,MAED,IAAK,OACJmB,EAAItK,GAAG7G,KAAKvL,KAAMA,MAClBA,KAAKub,Q,CAcR,OATIvb,KAAKob,OAASpb,KAAK4H,OAEjB5H,KAAKyb,UAAuC,MAA3Bzb,KAAK0b,oBAC1B1b,KAAK0b,qBAEN1b,KAAKoc,QACLpc,KAAKyb,UAAW,IAGV,C,EAIRmC,SAAU,WAET,IAAIxC,EAAQ,GAOZ,OALApb,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,WAAYC,SAAS,EAAOxB,MAAOA,EAAOyB,OAAQ,GAAKC,QAAS,GAAKC,WAAY,KAEvG/c,KAAKmb,MAAMza,KAAMV,KAAKob,OACtBpb,KAAKob,MAAQA,EAENpb,I,EAIR6d,OAAQ,WAEP,IAAIzC,EAAQ,GAOZ,OALApb,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,SAAUC,SAAS,EAAOxB,MAAOA,IAEvDpb,KAAKmb,MAAMza,KAAMV,KAAKob,OACtBpb,KAAKob,MAAQA,EAENpb,I,EAIR8d,OAAQ,SAAU/G,GAEjB,IAAIqE,EAAQ,GAOZ,OALApb,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,SAAUC,SAAS,EAAOxB,MAAOA,EAAOrE,MAAOA,IAErE/W,KAAKmb,MAAMza,KAAMV,KAAKob,OACtBpb,KAAKob,MAAQA,EAENpb,I,EAIRqT,SAAU,SAAUjB,GAEnB,IAAIgJ,EAAQpb,KAAKmb,MAAMnb,KAAKmb,MAAMvZ,OAAO,GAGzC,OAFAwZ,EAAMA,EAAMxZ,OAAO,GAAGwQ,GAAKA,EAEpBpS,I,EAIR+d,IAAK,WAGJ,OADA/d,KAAKob,MAAQpb,KAAKmb,MAAM5O,MACjBvM,I,EAIRoO,IAAK,SAAU8O,EAAO7c,GAGrB,OADAL,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,MAAOO,MAAOA,EAAO7c,MAAOA,IAC3CL,I,EAIRge,QAAS,SAAU/E,GAGlB,OADAjZ,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,YACf3c,I,EAIRie,KAAM,SAAUhF,GAGf,OADAjZ,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,OAAQ1D,SAAUA,IACjCjZ,I,EAIRke,MAAO,SAAUhB,EAAOjE,EAAUkE,EAAYG,EAAUpE,GAGvD,OADAlZ,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,QAASC,SAAS,EAAOM,MAAOA,EAAOjE,SAAUA,EAAUkE,WAAYA,EAAYG,SAAUA,EAAUpE,OAAQA,GAAkB,OAChJlZ,I,EAIRme,KAAM,SAAUjB,EAAOjE,EAAUlC,EAAOoG,EAAYG,EAAUpE,GAG7D,OADAlZ,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,OAAQC,SAAS,EAAOM,MAAOA,EAAOjE,SAAUA,EAAUlC,MAAOA,EAAOoG,WAAYA,EAAYG,SAAUA,EAAUpE,OAAQA,GAAkB,OAC7JlZ,I,EAIRoe,MAAO,SAAUlB,EAAOjE,EAAUlC,EAAOoG,EAAYG,EAAUpE,GAE9D,IAAIuE,EAAQ,GAEZ,IAAK,IAAI9b,EAAI,EAAGA,EAAIoV,EAAOpV,IAC1B8b,EAAM/c,KAAMiB,GAAM2b,EAAWH,EAAa,GAAMA,GAEjD,IAAK,IAAIxP,EAAIoJ,GAAS,EAAGpJ,EAAI,EAAGA,IAChC,CACC,IAAI5K,KAAOmC,KAAKkB,SAAW2Q,GACvB/T,KAAOkC,KAAKkB,SAAW2Q,GAEvBsH,EAAIZ,EAAMza,GACdya,EAAMza,GAAKya,EAAM1a,GACjB0a,EAAM1a,GAAKsb,C,CAIZ,OADAre,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,QAASO,MAAOA,EAAOjE,SAAUA,EAAUlC,MAAOA,EAAOoG,WAAYA,EAAYG,SAAUA,EAAUG,MAAOA,EAAOvE,OAAQA,GAAkB,OAC5JlZ,I,EAIR2d,KAAM,SAAUD,GAGf,OADA1d,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,OAAQe,IAAKA,IAC5B1d,I,EAIRS,KAAM,SAAU2R,GAGf,OADApS,KAAKob,MAAM1a,KAAK,CAAEic,GAAI,OAAQvK,GAAIA,IAC3BpS,I,QAITse,EAAetD,ECzgBfuD,EAAehM,EAAQtC,SAAU,SACjC,CAICuO,UAAW,KAKXC,UAAW,KAKX,0BAA2B,SAAUna,GAEpCA,EAAIC,qBAAsB,EAEtBvE,KAAK0F,QAAQgZ,UAEhBpc,SAAW,IAAM2I,EAAO5I,aAAarC,KAAK0F,QAAQgZ,UAAUne,QAAQ,IAAK+D,EAAIE,OAAOkB,QAAQwE,OAI7FlK,KAAK2e,UAAWra,EAAIE,OAAOkB,QAAQwE,K,EAMpCrD,KAAM,WAEL7G,KAAK4e,cAAgB,CAACta,EAAK7C,KAEH,IAAnBwJ,EAAO3I,UAEVtC,KAAK0L,iBAAiB,UAAU9E,SAAQiY,IAElCA,EAAKC,OAEN7T,EAAO3I,SAAS0N,WAAW6O,EAAKC,KAAKxY,OAAOuY,EAAKC,KAAK7U,QAAQ,KAAK,IACtE4U,EAAKjV,UAAUC,IAAI,UAEnBgV,EAAKjV,UAAUvB,OAAO,UAAS,IAI7B5G,EAAK1B,MAAM8B,SAGhB7B,KAAK+e,QAAStd,EAAKud,QAAQ,C,EAO7BtX,MAAO,WAEF,cAAe1H,KAAK0F,QAEO,oBAA1B1F,KAAK0F,QAAQ8Y,UAChBxe,KAAKwe,UAAYxe,KAAKif,uBACY,gBAA1Bjf,KAAK0F,QAAQ8Y,UACrBxe,KAAKwe,UAAYxe,KAAKkf,mBACY,SAA1Blf,KAAK0F,QAAQ8Y,UACrBxe,KAAKwe,UAAY,KAEjBxe,KAAKwe,UAAYjX,SAAS2K,cAAclS,KAAK0F,QAAQ8Y,WAGtDxe,KAAKwe,UAAYxe,KAAKkf,mBAEvBlf,KAAKmf,gBAAgBnf,KAAK0F,QAAQuW,Q,EAMnCrN,YAAa,WAER5O,KAAK0F,QAAQgZ,WAChBzT,EAAOmU,SAAUpf,KAAK0F,QAAQgZ,UAAUne,QAAQ,IAAK,YAAaP,KAAK4e,c,EAMzE9P,eAAgB,WAEX9O,KAAK0F,QAAQgZ,WAChBzT,EAAOoU,YAAYrf,KAAK0F,QAAQgZ,UAAUne,QAAQ,IAAK,YAAaP,KAAK4e,c,EAO3EO,gBAAiB,SAAUG,GAErBA,IAAYA,EAAa,IAER,MAAlBtf,KAAKwe,WAERxe,KAAKwe,UAAU9S,iBAAiB,wBAAwB9E,SAAQjF,IAE3DA,EAAE+D,QAAQwE,MAAQoV,GAErB3d,EAAEiI,UAAUvB,OAAO,YACnBrI,KAAKmB,SAAS,WAAY,CAAE+I,KAAMvI,EAAE+D,QAAQwE,KAAMqV,GAAI5d,MAItDA,EAAEiI,UAAUC,IAAI,YAChB7J,KAAKmB,SAAS,YAAa,CAAE+I,KAAMvI,EAAE+D,QAAQwE,KAAMqV,GAAI5d,I,IAK1D3B,KAAK0L,iBAAiB,eAAe9E,SAAQiY,IAExCA,EAAKnZ,QAAQwE,MAAQoV,EACxBT,EAAKjV,UAAUC,IAAI,UAEnBgV,EAAKjV,UAAUvB,OAAO,SAAS,IAGjCrI,KAAKye,UAAYa,EACjBtf,KAAKmB,SAAS,aAAc,CAAE+I,KAAMoV,G,EAMrCP,QAAS,SAAU7U,GAElB,OAAOlK,KAAKmf,gBAAiBjV,E,EAM9ByU,UAAW,SAAUzU,GAEpB,GAAIlK,KAAK0F,QAAQgZ,UACjB,CACC,MAAMlc,EAAO,IAAMyI,EAAO5I,aAAarC,KAAK0F,QAAQgZ,UAAUne,QAAQ,IAAK2J,IAE3E,GAAI5H,SAASE,MAAQA,EAGpB,YADAF,SAAWE,E,CAKbxC,KAAK+e,QAAS7U,E,IC1KhBsV,EAAejN,EAAQtC,SAAU,SACjC,CAIC5L,OACA,CACC,sBAAuB,gBAEvB,0BAA2B,QAC3B,eAAgB,QAEhB,2BAA4B,SAC5B,4BAA6B,SAC7B,gBAAiB,SACjB,cAAe,UAMhBF,MAAO,GAKPuD,MAAO,WAEN,IAAI+X,EAAclY,SAASC,cAAc,QACzCiY,EAAY3J,UAAU9V,KAAKsI,YAC3BtI,KAAK8V,OAAO2J,GAEZ,IAAIC,EAAM,GACNC,EAAQ3f,KAAKmE,MAAM+K,MAEvBlP,KAAK0L,iBAAiB,gBAAgB9E,SAASjF,IAE9CA,EAAEuI,KAAOvI,EAAE+D,QAAQwX,MACnByC,EAAMhe,EAAEuI,MAAQvI,EAAEuM,KAElB,IAAIuB,EAAM9N,EAAE+D,QAAQka,QACpB,GAAW3c,MAAPwM,EAEH,OAAQ9N,EAAEuM,MAET,IAAK,QACJ,IAAKvM,EAAEwM,QAAS,OAChBsB,EAAM9N,EAAEtB,MACR,MAED,IAAK,WACJoP,EAAM9N,EAAEwM,QAAU,IAAM,IACxB,MAED,IAAK,QACJsB,EAAM9N,EAAE0M,WACR,MAMD,QACCoB,EAAM,GAKTiQ,EAAI/d,EAAE+D,QAAQwX,OAASzN,CAAG,IAG3B,IAAK,IAAIvF,KAAQyV,EAGfA,EAAMzV,GADHA,KAAQwV,EACGA,EAAIxV,GAEJ,GAGhBwV,EAAMC,EAEN3f,KAAKmE,MAAM0b,SAAWH,EACtB1f,KAAKmE,MAAMyX,QAEX5b,KAAK8f,c,EAMNC,aAAc,SAAUre,EAAK4W,GAE5B,OAAK5W,GAAS,aAAcmH,GAGxBnH,EAAIsO,WAAW,eAEdtO,EAAI4E,OAAO,MAAOuC,EAAOmX,WAC5Bte,EAAMyL,EAAS8S,KAAKpX,EAAOmX,SAASte,EAAI4E,OAAO,KAAMgS,IAGhD5W,GARCA,C,EAWTwe,QAAS,SAASxb,GAEjB,GAAI,gBAAiB6C,SACrB,CACC,IAAIjD,EAAMiD,SAAS4Y,YAAY,cAC/B7b,EAAI8b,UAAU,UAAU,GAAO,GAC/B1b,EAAKlD,cAAc8C,E,MAGnBI,EAAK2b,UAAU,W,EAGjBC,UAAW,SAAUhP,EAAGjR,EAAO8B,GAE9B,GAAKmP,EAEL,IAAKA,KAAKtR,KAAK0L,iBAAiB,gBAAgB4F,EAAE,MAEjD,OAAQA,EAAEpD,MAAQoD,EAAErK,QAAQI,eAE3B,IAAK,SACJiK,EAAE7B,IAAM6B,EAAE5L,QAAQrF,MAAQiR,EAAEiP,UAAYlgB,EAAQA,EAAMuF,MAAM,KAAgBvF,EAC5EiR,EAAEjR,MAAQiR,EAAE7B,IAAM6B,EAAE5L,QAAQrF,OAEb,IAAX8B,GAAiBnC,KAAKkgB,QAAQ5O,GAClC,MAED,IAAK,WACJA,EAAEnD,UAAUqS,SAASngB,GACrB,MAED,IAAK,QACJiR,EAAEnD,QAAU9N,GAASiR,EAAEjR,MACvB,MAED,IAAK,QACJiR,EAAE7B,IAAM6B,EAAE5L,QAAQrF,MAAQA,EAC1BiR,EAAE5B,SAASrP,GACX,MAED,IAAK,OACAA,aAAkBwV,MAAUxV,aAAiBsV,MAKxCtV,aAAiBogB,UAHzBnP,EAAE7B,IAAMpP,EACRiR,EAAE5L,QAAQrF,MAAQA,IASlBiR,EAAE7B,IAAM6B,EAAE5L,QAAQrF,MAAQ,GAC1BiR,EAAEjR,MAAQ,IAGX,MAED,QACCiR,EAAE7B,IAAM6B,EAAE5L,QAAQrF,MAAQA,EAC1BiR,EAAEjR,MAAQA,GAEK,IAAX8B,GAAiBnC,KAAKkgB,QAAQ5O,G,EAMtCoP,UAAW,SAAUpP,EAAGqP,EAAO,KAAMC,GAAe,GAEnD,IAAKtP,EAAG,OAAO,KAEf,GAAiB,iBAANA,EACX,CACC,IAAIjR,EAAmB,MAAXiR,EAAEjR,MAAgBiR,EAAE7B,IAAM6B,EAAEjR,MAGxC,OAFc,OAAVA,IAAgBA,EAAQsgB,GAEpBrP,EAAEpD,MAAQoD,EAAErK,QAAQI,eAE3B,IAAK,SACJsZ,EAASrP,EAAEiP,UAAYlgB,EAAQA,EAAMqU,KAAK,KAAgBrU,EAC1D,MAED,IAAK,WACJsgB,EAASrP,EAAEnD,QAAU,IAAM,IAC3B,MAED,IAAK,QACAmD,EAAEnD,UAASwS,EAASrP,EAAEjR,OAC1B,MAED,IAAK,QACJsgB,EAASrP,EAAEjD,WACX,MAED,IAAK,OACJsS,EAASC,EAAkBtP,EAAEuP,OAASvP,EAAEuP,MAAMjf,OAAU0P,EAAEiP,SAAWjP,EAAEuP,MAAQvP,EAAEuP,MAAM,GAAM,KAAQvP,EAAE7B,IACvG,MAED,QACCkR,EAAStgB,EAIX,OAAkB,OAAXsgB,EAAkB,GAAKA,C,CAK/B,IAAKrP,KAFLqP,EAAS,KAEC3gB,KAAK0L,iBAAiB,gBAAgB4F,EAAE,OACjDqP,EAAS3gB,KAAK0gB,UAAUpP,EAAGqP,GAE5B,OAAkB,OAAXA,EAAkB,GAAKA,C,EAG/BG,SAAU,SAAU5W,GAEnB,OAAOlK,KAAK0gB,UAAUxW,E,EAGvB4V,aAAc,WAEb9f,KAAK4J,UAAUvB,OAAO,QAEtBrI,KAAK0L,iBAAiB,YAAY9E,SAAQjF,GAAKA,EAAEiI,UAAUC,IAAI,cAC/D7J,KAAK0L,iBAAiB,oBAAoB9E,SAAQjF,GAAKA,EAAE0G,WAEzDrI,KAAK0L,iBAAiB,gBAAgB9E,SAAQjF,IAAOA,EAAEiI,UAAUvB,OAAO,eAAgB1G,EAAEiI,UAAUvB,OAAO,aAAa,IACxHrI,KAAK0L,iBAAiB,iBAAiB9E,SAAQjF,GAAKA,EAAEiI,UAAUvB,OAAO,iB,EAGxE0Y,cAAe,SAAUzc,GAExB,IAAIgN,EAAIhN,EAAIE,OAEE,QAAV8M,EAAEpD,KACLlO,KAAKmE,MAAMiK,IAAKkD,EAAE5L,QAAQwX,MAAOld,KAAK0gB,UAAUpP,EAAG,MAAM,IAAO,GAEhEtR,KAAKmE,MAAMiK,IAAKkD,EAAE5L,QAAQwX,MAAOld,KAAK0gB,UAAUpP,IAEjDhN,EAAIC,qBAAsB,C,EAG3BoL,uBAAwB,SAAUrL,EAAK7C,GAEtCzB,KAAKsgB,UAAW7e,EAAKyI,KAAMzI,EAAKpB,M,EAGjC2gB,WAAY,SAAS1I,GAGpB,IAAI/R,EADJvG,KAAK4J,UAAUvB,OAAO,QAGtBrI,KAAKmB,SAAU,cAAemX,GAE1BA,EAAE2I,SAA6D,OAAjD1a,EAAMvG,KAAKkS,cAAc,uBAE1C3L,EAAIsG,UAAY7M,KAAK+f,aAAazH,EAAE2I,QAAS3I,GAAG/X,QAAO,MAAQ,SAC/DgG,EAAIqD,UAAUvB,OAAO,YACrB9B,EAAI2a,eAAiB,IAAM3a,EAAIqD,UAAUC,IAAI,Y,EAI/CsX,WAAY,SAAS7I,GAGpB,IAAI/R,EAIJ,GALAvG,KAAK4J,UAAUvB,OAAO,QAGtBrI,KAAKmB,SAAU,YAAamX,GAExBA,EAAEnJ,OACN,CACC,IAAK,IAAIxN,KAAK2W,EAAEnJ,OAChB,CACC,IAAImC,EAAItR,KAAKkS,cAAc,0BAA0BvQ,EAAE,MACvD,IAAK2P,IAEJA,EAAItR,KAAKkS,cAAc,gBAAgBvQ,EAAE,OACpC2P,GAAG,SAGT,IAAI8P,EAAM7Z,SAASC,cAAc,QACjC4Z,EAAIxX,UAAUC,IAAI,eAClBuX,EAAIvU,UAAY7M,KAAK+f,aAAazH,EAAEnJ,OAAOxN,GAAI2W,GAAG/X,QAAO,MAAQ,SAEjE+Q,EAAE1H,UAAUC,IAAI,eAChByH,EAAE1H,UAAUC,IAAI,cAEa,UAAzB7J,KAAK0F,QAAQ2b,SAChB/P,EAAEpK,cAAc4O,OAAOsL,GACU,OAAzBphB,KAAK0F,QAAQ2b,SACrB/P,EAAEpK,cAAcoa,QAAQF,GAExB9P,EAAEpK,cAAcqa,aAAaH,EAAK9P,EAAE4N,oBAErCva,WAAW,SAAW4B,GAAO,OAAO,WAAaA,EAAIqD,UAAUC,IAAI,S,EAAxD,CAAwEuX,GAAM,G,CAGtF9I,EAAEE,OAAyD,OAA/CjS,EAAMvG,KAAKkS,cAAc,qBAExC3L,EAAIsG,UAAY7M,KAAK+f,aAAazH,EAAEE,MAAOF,GAAG/X,QAAO,MAAQ,SAC7DgG,EAAIqD,UAAUvB,OAAO,YACrB9B,EAAI2a,eAAiB,IAAM3a,EAAIqD,UAAUC,IAAI,Y,MAKM,OAA/CtD,EAAMvG,KAAKkS,cAAc,qBAE7B3L,EAAIsG,UAAY7M,KAAK+f,aAAazH,EAAEE,MAAOF,GAAG/X,QAAO,MAAQ,UAAa,UAAY+X,EAAEtE,SACxFzN,EAAIqD,UAAUvB,OAAO,YACrB9B,EAAI2a,eAAiB,IAAM3a,EAAIqD,UAAUC,IAAI,Y,EAKhD+R,MAAO,SAAU4F,GAKhB,GAHAxhB,KAAKmE,MAAMyX,MAAO4F,GAClBxhB,KAAK8f,gBAEW,IAAZ0B,EAEH,IAAK,IAAI7f,KAAK3B,KAAKmE,MAAM8K,KACxBjP,KAAKsgB,UAAW3e,EAAG3B,KAAKmE,MAAM8K,KAAKtN,IAAI,GAGzC,OAAO,C,EAGR8f,OAAQ,WAEP,GAAIzhB,KAAK4J,UAAUuI,SAAS,QAC3B,OAED,IAAIlD,EAAO,GAEgB,SAAvBjP,KAAK0F,QAAQgc,QAChBjb,OAAOyQ,OAAOjI,EAAMjP,KAAKmE,MAAM+K,OAEhC,IAAItH,EAAO,GACX5H,KAAK0L,iBAAiB,gBAAgB9E,SAAQsN,GAAKtM,EAAKsM,EAAExO,QAAQwX,QAAS,IAC3EzW,OAAOC,KAAKkB,GAAMhB,SAAQ0K,GAAKrC,EAAKqC,GAAKtR,KAAK0gB,UAAUpP,KAExDtR,KAAKmE,MAAMiK,IAAIa,GAEf,IAAIqC,EAAItR,KAAK0F,QAAQic,YAAc3hB,KAAK2hB,WACnCrQ,IAELtR,KAAK8f,eAEL9f,KAAK4J,UAAUC,IAAI,QAEF,mBAANyH,GAEVrC,EAAKqC,EAAIA,EACTwG,EAAIhE,QAAQ7E,GAAOqJ,GAAMtY,KAAmB,KAAdsY,EAAEtE,SAAkB,aAAe,cAAcsE,KAAKA,GAAMtY,KAAKmhB,WAAW,CAAE3I,MAAO,gCAAiCxY,KAAK0F,QAAQ4P,QAAU,SAG3KhE,EAAErC,GAAOqJ,GAAMtY,KAAmB,KAAdsY,EAAEtE,SAAkB,aAAe,cAAcsE,K,IC9WxEsJ,EAAerP,EAAQtC,SAAU,UACjC,CAIClQ,MAAO,KAKP8G,KAAM,WAEL7G,KAAKkG,MAAMC,QAAU,GAGrBnG,KAAK6hB,YAAc,CAACvd,EAAK7C,KAEnBA,EAAK1B,MAAM8B,SAGhB7B,KAAK8hB,MAAK,EAAK,EAIhB9hB,KAAK+hB,cAAgB,CAACzd,EAAK7C,KAE1BzB,KAAKgiB,MAAM,EAGZhiB,KAAKgiB,M,EAMNpT,YAAa,WAER5O,KAAK0F,QAAQ3F,OAEhBC,KAAKD,MAAQkL,EAAOmU,SAAUpf,KAAK0F,QAAQ3F,MAAOC,KAAK6hB,YAAa7hB,KAAK+hB,eACzE/hB,KAAK4J,UAAUvB,OAAO,WAGtBrI,KAAK4J,UAAUC,IAAI,S,EAMrBiF,eAAgB,WAEX9O,KAAK0F,QAAQ3F,OAChBkL,EAAOoU,YAAYrf,KAAK0F,QAAQ3F,MAAOC,KAAK6hB,YAAa7hB,KAAK+hB,c,EAMhEC,KAAM,WAELhiB,KAAK4J,UAAUvB,OAAO,UACtBrI,KAAKmB,SAAS,cAAenB,KAAKD,MAAQC,KAAKD,MAAM0B,KAAO,G,EAO7DqgB,KAAM,SAAU3f,GAAO,GAEtB,GAAInC,KAAK0F,QAAQ3F,QAAUoC,EAC3B,CACC,IAAIK,EAAO,IAAMxC,KAAK0F,QAAQ3F,MAE9B,GAAIsS,OAAO/P,SAASE,KAAK8D,OAAO,EAAG9D,EAAKZ,SAAWY,EAGlD,YADA6P,OAAO/P,SAAWE,E,CAKpBxC,KAAK4J,UAAUC,IAAI,UACnB7J,KAAKmB,SAAS,aAAcnB,KAAKD,MAAQC,KAAKD,MAAM0B,KAAO,G,IC7D7DwgB,EAAe1P,EAAQtC,SAAU,SACjC,CACCrI,KAAM,KAEN4W,UAAW,KACX0D,SAAU,KACVC,SAAS,EACTC,mBAAmB,EAKnB1a,MAAO,WAEN1H,KAAKwe,UAAYxe,KAAKkS,cAAclS,KAAK0F,QAAQ8Y,WAAa,WACzDxe,KAAKwe,YAETxe,KAAKwe,UAAYjX,SAASC,cAAc,OACxCxH,KAAKwe,UAAU/H,UAAY,SAC3BzW,KAAKsH,YAAYtH,KAAKwe,YAGvB,IAAIjY,EAAMvG,KAAKqiB,cAAgBriB,KAAKkS,cAAc,YAC9C3L,GAEqB,WAApBA,EAAIb,QAAQkS,KAEf5X,KAAKkiB,SAAW/U,EAASC,QAAQ7G,EAAIsG,YAIrC7M,KAAKkiB,SAAW,IAAM3b,EAAIsG,UAC1B7M,KAAKoiB,mBAAoB,GAG1B7b,EAAI8B,UAGJrI,KAAKkiB,SAAW,IAAM,GAEvBliB,KAAKwe,UAAU8D,YAAc,IAE7BtiB,KAAKuiB,SAAS,MACdviB,KAAKwiB,WAAW,K,EAMjB7a,OAAQ,WAEP,IAAIC,EAAO5H,KAAK+H,eAAe/H,KAAK0F,QAAQkC,MACvCA,EAML5H,KAAKyiB,QAAS7a,GAJbb,QAAQyR,MAAM,mBAAqBxY,KAAK0F,QAAQkC,K,EAUlD2a,SAAU,SAAUliB,GAEfL,KAAKmiB,UAAY9hB,KAGP,IAAVA,GAEHL,KAAK0L,iBAAiB,YAAY9E,SAAQjF,GAAKA,EAAEiI,UAAUvB,OAAO,cAClErI,KAAK0L,iBAAiB,gBAAgB9E,SAAQjF,GAAKA,EAAEiI,UAAUC,IAAI,cACnE7J,KAAK0L,iBAAiB,iBAAiB9E,SAAQjF,GAAKA,EAAEiI,UAAUC,IAAI,gBAElD,IAAVxJ,GAERL,KAAK0L,iBAAiB,YAAY9E,SAAQjF,GAAKA,EAAEiI,UAAUC,IAAI,cAC/D7J,KAAK0L,iBAAiB,gBAAgB9E,SAAQjF,GAAKA,EAAEiI,UAAUvB,OAAO,cACtErI,KAAK0L,iBAAiB,iBAAiB9E,SAAQjF,GAAKA,EAAEiI,UAAUC,IAAI,gBAIpE7J,KAAK0L,iBAAiB,YAAY9E,SAAQjF,GAAKA,EAAEiI,UAAUC,IAAI,cAC/D7J,KAAK0L,iBAAiB,gBAAgB9E,SAAQjF,GAAKA,EAAEiI,UAAUC,IAAI,cACnE7J,KAAK0L,iBAAiB,iBAAiB9E,SAAQjF,GAAKA,EAAEiI,UAAUvB,OAAO,eAGxErI,KAAKmiB,QAAU9hB,E,EAMhBmiB,WAAY,SAAUniB,IAEP,IAAVA,EACHL,KAAK0L,iBAAiB,cAAc9E,SAAQjF,GAAKA,EAAEiI,UAAUvB,OAAO,cAEpErI,KAAK0L,iBAAiB,cAAc9E,SAAQjF,GAAKA,EAAEiI,UAAUC,IAAI,a,EAMnE4Y,QAAS,SAAU7a,GAEbA,GAASqB,EAAKyZ,aAAa9a,EAAMuP,IAAcnX,KAAK4H,OAASA,IAGjD,MAAb5H,KAAK4H,OAEJ5H,KAAK4H,KAAKwP,YACbpX,KAAK4H,KAAKwP,WAAWlW,oBAAqBlB,KAAK2D,IAAI,MAEhD3D,KAAK4H,KAAK+Q,UACb3Y,KAAK4H,KAAK+Q,SAASzX,oBAAqBlB,KAAK2D,IAAI,MAElD3D,KAAK4H,KAAK1G,oBAAqBlB,KAAK2D,IAAI,OAGzC3D,KAAK4H,KAAOA,EAER5H,KAAK4H,KAAKwP,aAEbpX,KAAK4H,KAAKwP,WAAWpW,iBAAkBhB,KAAK2D,IAAI,eAAgB3D,KAAK2iB,UAAW3iB,MAChFA,KAAK4H,KAAKwP,WAAWpW,iBAAkBhB,KAAK2D,IAAI,cAAe3D,KAAK4iB,SAAU5iB,OAG3EA,KAAK4H,KAAK+Q,WAEb3Y,KAAK4H,KAAK+Q,SAAS3X,iBAAkBhB,KAAK2D,IAAI,eAAgB3D,KAAK2iB,UAAW3iB,MAC9EA,KAAK4H,KAAK+Q,SAAS3X,iBAAkBhB,KAAK2D,IAAI,cAAe3D,KAAK4iB,SAAU5iB,OAG7EA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,gBAAiB3D,KAAK6iB,eAAgB7iB,MAC3EA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,gBAAiB3D,KAAK8iB,eAAgB9iB,MAC3EA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,eAAgB3D,KAAK+iB,cAAe/iB,MACzEA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,eAAgB3D,KAAKgjB,cAAehjB,MACzEA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,aAAc3D,KAAKijB,YAAajjB,M,EAMtEkjB,UAAW,SAAUC,EAAKlU,EAAMmU,GAAO,GAEtC,IAAIC,EAAOrjB,KAAKkiB,SAASjT,EAAKC,OAC9B,GAAIkU,EAAQ,OAAOC,EAEnB,IAAI3e,EAAO6C,SAASC,cAAc,OAElC9C,EAAKgB,QAAQyd,IAAMA,EACnBze,EAAKmI,UAAYwW,EAEjB3e,EAAKgH,iBAAiB,6BAA6B9E,SAAQjF,IAC1DA,EAAEwC,MAAQ8K,EACVtN,EAAE+D,QAAQvB,MAAQ,YAAY,IAG/B,IAAK,IAAImf,KAAQtjB,KAAKqiB,cAAckB,WAE/BD,EAAKE,SAASxT,WAAW,WAA8B,aAAjBsT,EAAKE,UAG/C9e,EAAK+e,aAAaH,EAAKE,SAAUF,EAAKI,WAGvC,OAAOhf,C,EAMRie,UAAW,WAEV3iB,KAAKwiB,YAAW,E,EAMjBI,SAAU,WAET5iB,KAAKwiB,YAAW,E,EAMjBK,eAAgB,WAEf7iB,KAAKwe,UAAU3G,SAAWlT,YAAW,KACpC3E,KAAKuiB,UAAS,GACdviB,KAAKwe,UAAU3G,SAAW,KAC1B7X,KAAKwe,UAAU8D,YAAc,EAAE,GAC7B,I,EAMJQ,eAAgB,WAEf,GAA0B,GAAtB9iB,KAAK4H,KAAKhG,SACb,OAEG5B,KAAKwe,UAAU3G,UAClBrS,aAAaxF,KAAKwe,UAAU3G,UAE7B7X,KAAKwe,UAAU3G,SAAW,KAC1B7X,KAAKwe,UAAU8D,YAAc,GAE7B,IAAI3gB,EAAI,EAER,IAAK,IAAIsN,KAAQjP,KAAK4H,KAAK+b,UAED,SAArB3jB,KAAK0F,QAAQke,KAChB5jB,KAAKwe,UAAU1I,OAAO9V,KAAKkjB,UAAUljB,KAAK4H,KAAKic,OAAOliB,KAAMsN,IAE5DjP,KAAKwe,UAAU3R,WAAa7M,KAAKkjB,UAAUljB,KAAK4H,KAAKic,OAAOliB,KAAMsN,GAAM,GAG1EjP,KAAKuiB,SAAc,GAAL5gB,E,EAMfohB,cAAe,SAASze,EAAK7C,GAE5B,GAAyB,SAArBzB,KAAK0F,QAAQke,KAGhB,YADA5jB,KAAK8iB,iBAIN,IAAIpe,EAAO1E,KAAKwe,UAAUtM,cAAc,cAAczQ,EAAKqiB,GAAG,MACzDpf,IAELA,EAAK2D,SACLrI,KAAKuiB,SAA+B,GAAtBviB,KAAK4H,KAAKhG,U,EAMzBohB,cAAe,SAAS1e,EAAK7C,GAE5B,GAAIzB,KAAKoiB,kBAAmB,OAE5B,GAAyB,SAArBpiB,KAAK0F,QAAQke,KAGhB,YADA5jB,KAAK8iB,iBAIN,IAAIpe,EAAO1E,KAAKwe,UAAUtM,cAAc,cAAczQ,EAAKqiB,GAAG,MACzDpf,IAELA,EAAKmI,UAAY7M,KAAKkiB,SAASzgB,EAAK2W,M,EAMrC6K,YAAa,SAAS3e,EAAK7C,GAEL,QAAjBA,EAAKsiB,SAEiB,SAArB/jB,KAAK0F,QAAQke,KAChB5jB,KAAKwe,UAAU8C,QAAQthB,KAAKkjB,UAAUzhB,EAAKqiB,GAAIriB,EAAK2W,OAEpDpY,KAAKwe,UAAU3R,UAAY7M,KAAKkjB,UAAUzhB,EAAKqiB,GAAIriB,EAAK2W,MAAM,GAAQpY,KAAKwe,UAAU3R,UAI7D,SAArB7M,KAAK0F,QAAQke,KAChB5jB,KAAKwe,UAAU1I,OAAO9V,KAAKkjB,UAAUzhB,EAAKqiB,GAAIriB,EAAK2W,OAEnDpY,KAAKwe,UAAU3R,WAAa7M,KAAKkjB,UAAUzhB,EAAKqiB,GAAIriB,EAAK2W,MAAM,GAGjEpY,KAAKuiB,UAAS,E,EAMfyB,QAAS,WAERhkB,KAAK8iB,gB,IClUPmB,EAAe1R,EAAQtC,SAAU,SACjC,CAICpJ,KAAM,WACN,EAMAc,OAAQ,WAEP,IAAIxD,EAAQnE,KAAK+H,eAAe/H,KAAK0F,QAAQvB,OACxCA,IAAOA,EAAQ,IAEpBnE,KAAKwG,SAAUrC,E,ICFjB+f,EAAe3R,EAAQtC,SAAU,cACjC,CACCzL,OAAQ,KACR0d,SAAU,KAKVrb,KAAM,WAEL7G,KAAKwG,SAAS,CACb2d,YAAa,EACbC,UAAW,EACXrN,MAAO,EAAGsN,OAAQ,EAClBC,gBAAiBtkB,KAAK0F,QAAQ6e,UAAY,GAC1CA,SAAUvkB,KAAK0F,QAAQ6e,UAAY,KAGpCvkB,KAAK6K,OAAO,4BAA4B,CAACvG,EAAK7C,KAEzCzB,KAAKmE,MAAM+K,IAAI,oBAAsBzN,EAAKpB,QAG9CL,KAAKmE,MAAMiK,IAAI,kBAAmB3M,EAAKpB,OACvCL,KAAKwkB,aAAa,SAAQ,G,EAO5B7c,OAAQ,WAEP,IAAInD,EAASxE,KAAK+H,eAAe/H,KAAK0F,QAAQlB,QACzCA,EAMLxE,KAAK0X,UAAUlT,GAJduC,QAAQyR,MAAM,0BAA4BxY,KAAK0F,QAAQlB,O,EAUzDkT,UAAW,SAAUlT,GAEfA,GAAWyE,EAAKyZ,aAAale,EAAQigB,IAAezkB,KAAKwE,SAAWA,IAGtD,MAAfxE,KAAKwE,SAERxE,KAAKwE,OAAOtD,oBAAqBlB,KAAK2D,IAAI,MAC1C3D,KAAKwE,OAAOoS,cAAe,GAG5B5W,KAAKwE,OAASA,EAEdxE,KAAKwE,OAAOoS,cAAe,EAC3B5W,KAAKwkB,eAELxkB,KAAKwE,OAAOxD,iBAAkBhB,KAAK2D,IAAI,0BAA2B3D,KAAK0kB,yBAA0B1kB,MACjGA,KAAKwE,OAAOxD,iBAAkBhB,KAAK2D,IAAI,gBAAiB3D,KAAK2kB,eAAgB3kB,MAC7EA,KAAKwE,OAAOxD,iBAAkBhB,KAAK2D,IAAI,mBAAoB3D,KAAK+iB,cAAe/iB,MAC/EA,KAAKwE,OAAOxD,iBAAkBhB,KAAK2D,IAAI,iBAAkB3D,KAAKijB,YAAajjB,MAE3EA,KAAKwE,OAAO+E,aAAavJ,KAAK2D,KAC9B3D,KAAKwE,OAAOmS,QAAQ3N,QAAO,GAC3BhJ,KAAKwE,OAAO+E,aAAa,M,EAM1Bib,aAAc,SAAS5M,EAAK,MAE3B5X,KAAKmE,MAAMiK,IAAI,cAA0C,GAA3BpO,KAAKmE,MAAM+K,IAAI,SAAgBlP,KAAKmE,MAAM+K,IAAI,UAAY,EAAI,GAC5FlP,KAAKmE,MAAMiK,IAAI,YAAalJ,KAAK0f,IAAI5kB,KAAKmE,MAAM+K,IAAI,SAAUlP,KAAKmE,MAAM+K,IAAI,eAAiBlP,KAAKmE,MAAM0gB,OAAO,YAAc,IAC9H7kB,KAAKmE,MAAM6E,OAAO,SAElB,IAAIiU,EAASjd,KAAKwE,OAAOmS,QAAQzH,IAAI,SACjC4V,EAAU9kB,KAAKwE,OAAOmS,QAAQzH,IAAI,UAEtClP,KAAKwE,OAAOmS,QAAQvI,IAAI,QAASpO,KAAKmE,MAAM0gB,OAAO,aACnD7kB,KAAKwE,OAAOmS,QAAQvI,IAAI,SAAUpO,KAAKmE,MAAM+K,IAAI,YAE7C0I,GAASqF,GAAUjd,KAAKwE,OAAOmS,QAAQzH,IAAI,UAAY4V,GAAW9kB,KAAKwE,OAAOmS,QAAQzH,IAAI,WAC7FlP,KAAKwE,OAAOwf,QAAQpM,E,EAMtB8M,yBAA0B,SAASpgB,EAAK7C,GAEtB,SAAbA,EAAKyI,MAAgC,UAAbzI,EAAKyI,MAGjClK,KAAKmE,MAAMiK,IAAI3M,EAAKyI,KAAMzI,EAAKpB,M,EAMhCsP,uBAAwB,SAAUrL,EAAK7C,IAWJ,GATpB,CACb,cACA,YACA,QACA,SACA,kBACA,YAGWwI,QAAQxI,EAAKyI,OAGrBlK,KAAKwE,OAAOmS,QAAQzH,IAAIzN,EAAKyI,OAASzI,EAAKpB,QAG/CL,KAAKwE,OAAOmS,QAAQvI,IAAI3M,EAAKyI,KAAMzI,EAAKpB,OACxCL,KAAKwE,OAAOwf,QAAQ,U,EAMrBW,eAAgB,SAASrgB,EAAK7C,GAE7BzB,KAAKmE,MAAMiK,IAAI,QAAS9J,EAAIE,OAAOuS,OAAO,GAC1C/W,KAAKwkB,c,EAMNzB,cAAe,SAASze,EAAK7C,GAE5BzB,KAAKmE,MAAMiK,IAAI,QAASpO,KAAKmE,MAAM0gB,OAAO,SAAW,GAAG,GACxD7kB,KAAKwkB,c,EAMNvB,YAAa,SAAS3e,EAAK7C,GAE1BzB,KAAKmE,MAAMiK,IAAI,QAASpO,KAAKmE,MAAM0gB,OAAO,SAAW,GAAG,GACxD7kB,KAAKwkB,c,EAMNO,SAAU,WAET,GAAI/kB,KAAKmE,MAAM+K,IAAI,WAAa,EAC/B,OAED,IAAI8V,EAAOhlB,KAAKmE,MAAM+K,IAAI,UAAYlP,KAAKmE,MAAM0gB,OAAO,YACpDG,EAAO,IAAGA,EAAO,GAErBhlB,KAAKmE,MAAMiK,IAAI,SAAU4W,GACzBhlB,KAAKwkB,aAAa,Q,EAMnBS,SAAU,WAET,IAAID,EAAOhlB,KAAKmE,MAAM+K,IAAI,UAAYlP,KAAKmE,MAAM0gB,OAAO,YACpDG,GAAQhlB,KAAKmE,MAAM+K,IAAI,WAE3BlP,KAAKmE,MAAMiK,IAAI,SAAU4W,GACzBhlB,KAAKwkB,aAAa,S,EAMnBU,UAAW,WAEVllB,KAAKmE,MAAMiK,IAAI,SAAU,GACzBpO,KAAKwkB,aAAa,Q,EAMnBW,SAAU,WAET,IAAIH,EAAOhlB,KAAKmE,MAAM+K,IAAI,SAAWlP,KAAKmE,MAAM0gB,OAAO,YACnDG,EAAO,IAAGA,EAAO,GAErBhlB,KAAKmE,MAAMiK,IAAI,SAAU4W,GACzBhlB,KAAKwkB,aAAa,Q,EAMnBR,QAAS,WAERhkB,KAAKwE,OAAOwf,QAAQ,O,EAMrBoB,MAAO,SAAS3jB,GAEf,IAAK,IAAIE,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAChC3B,KAAKmE,MAAMiK,IAAI3M,EAAKE,GAAI,G,IC3L3B0jB,EAAe9S,EAAQtC,SAAU,UACjC,CACCzL,OAAQ,KACR0d,SAAU,KACV1D,UAAW,KACX2D,QAAS,KAKTtb,KAAM,WAEL7G,KAAKwG,SAAS,G,EAMfkB,MAAO,WAGN,GADA1H,KAAKwe,UAAYxe,KAAKkS,cAAclS,KAAK0F,QAAQ8Y,WAAa,iBACzDxe,KAAKwe,UAAW,MAAM,IAAI8G,MAAO,gCAEH,WAA/BtlB,KAAKwe,UAAU9Y,QAAQkS,KAC1B5X,KAAKkiB,SAAW/U,EAASC,QAAQpN,KAAKwe,UAAU3R,WAEhD7M,KAAKkiB,SAAW,IAAMliB,KAAKwe,UAAU3R,UAEtC7M,KAAKulB,aAAehe,SAASC,cAAc,SAC3CxH,KAAKwe,UAAU8D,YAAc,IAE7BtiB,KAAKuiB,UAAS,E,EAMf5a,OAAQ,WAEP,IAAInD,EAASxE,KAAK+H,eAAe/H,KAAK0F,QAAQlB,QACzCA,EAMLxE,KAAK0X,UAAWlT,GAJfuC,QAAQyR,MAAM,0BAA4BxY,KAAK0F,QAAQlB,O,EAUzD+d,SAAU,SAAUliB,GAEfL,KAAKmiB,UAAY9hB,IAGjBA,GAEHL,KAAK0L,iBAAiB,YAAY9E,SAAQ+G,GAAKA,EAAE/D,UAAUvB,OAAO,cAClErI,KAAK0L,iBAAiB,gBAAgB9E,SAAQ+G,GAAKA,EAAE/D,UAAUC,IAAI,gBAInE7J,KAAK0L,iBAAiB,YAAY9E,SAAQ+G,GAAKA,EAAE/D,UAAUC,IAAI,cAC/D7J,KAAK0L,iBAAiB,gBAAgB9E,SAAQ+G,GAAKA,EAAE/D,UAAUvB,OAAO,eAGvErI,KAAKmiB,QAAU9hB,E,EAMhBqX,UAAW,SAAUlT,GAEfA,GAAWyE,EAAKyZ,aAAale,EAAQigB,IAAezkB,KAAKwE,SAAWA,IAGtD,MAAfxE,KAAKwE,QACRxE,KAAKwE,OAAOtD,oBAAqBlB,KAAK2D,IAAI,MAE3C3D,KAAKwE,OAASA,EAEdxE,KAAKwE,OAAOxD,iBAAkBhB,KAAK2D,IAAI,0BAA2B3D,KAAK0kB,yBAA0B1kB,MACjGA,KAAKwE,OAAOxD,iBAAkBhB,KAAK2D,IAAI,oBAAqB3D,KAAK6iB,eAAgB7iB,MACjFA,KAAKwE,OAAOxD,iBAAkBhB,KAAK2D,IAAI,oBAAqB3D,KAAK8iB,eAAgB9iB,MACjFA,KAAKwE,OAAOxD,iBAAkBhB,KAAK2D,IAAI,mBAAoB3D,KAAK+iB,cAAe/iB,MAC/EA,KAAKwE,OAAOxD,iBAAkBhB,KAAK2D,IAAI,mBAAoB3D,KAAKgjB,cAAehjB,MAC/EA,KAAKwE,OAAOxD,iBAAkBhB,KAAK2D,IAAI,iBAAkB3D,KAAKijB,YAAajjB,MAE3EA,KAAKwE,OAAO+E,aAAavJ,KAAK2D,KAC9B3D,KAAKwE,OAAOmS,QAAQ3N,QAAO,GAC3BhJ,KAAKwE,OAAO+E,aAAa,M,EAM1Bmb,yBAA0B,SAASpgB,EAAK7C,GAIvC,GAFAzB,KAAKmE,MAAMiK,IAAI3M,EAAKyI,KAAMzI,EAAKpB,OAEd,QAAboB,EAAKyI,KAERlK,KAAK0L,iBAAiB,qBAAqB9E,SAAQ+G,GAAKA,EAAEjI,QAAQ8f,MAAQ,UAEtE,GAAiB,SAAb/jB,EAAKyI,KACd,CACC,IAAIxF,EAAO1E,KAAKkS,cAAc,qBAAqB5N,EAAIE,OAAO0K,IAAI,QAAQ,MACtExK,IAAMA,EAAKgB,QAAQ8f,MAAQ/jB,EAAKpB,M,GAOtCsP,uBAAwB,SAAUrL,EAAK7C,GAEtC,GAAIzB,KAAKwE,OAAOmS,QAAQzH,IAAIzN,EAAKyI,OAASzI,EAAKpB,MAC9C,OAEDL,KAAKwE,OAAOmS,QAAQvI,IAAI3M,EAAKyI,KAAMzI,EAAKpB,QAON,GALpB,CACb,QACA,UAGW4J,QAAQxI,EAAKyI,OAGzBlK,KAAKwE,OAAOwf,QAAQ,S,EAMrB1a,uBAAwB,SAAUhF,EAAK7C,GAEX,iBAAhBA,EAAK0N,OACfnP,KAAKwE,OAAOmS,QAAQtO,OAAO1G,GAE3BF,EAAK0N,OAAOvI,SAAQ+G,GAAK3N,KAAKwE,OAAOmS,QAAQtO,OAAOsF,KAErD3N,KAAKwE,OAAOwf,QAAQ,S,EAMrBd,UAAW,SAAUC,EAAKlU,GAEzB,IAAIvK,EAAO1E,KAAKulB,aAYhB,OAVA7gB,EAAKmI,UAAY7M,KAAKkiB,SAASjT,EAAKC,OAEpCxK,EAAKgH,iBAAiB,6BAA6B9E,SAAQ+G,IAC1DA,EAAExJ,MAAQ8K,EACVtB,EAAEjI,QAAQvB,MAAQ,YAAY,IAG/BO,EAAOA,EAAK+gB,kBACZ/gB,EAAKgB,QAAQyd,IAAMA,EAEZze,C,EAMRme,eAAgB,SAASve,EAAK7C,GAE7BzB,KAAKwe,UAAU3G,SAAWlT,YAAW,KACpC3E,KAAKuiB,UAAS,GACdviB,KAAKwe,UAAU3G,SAAW,KAC1B7X,KAAKwe,UAAU8D,YAAc,EAAE,GAC7B,I,EAMJQ,eAAgB,SAASxe,EAAK7C,GAE7B,GAAiC,GAA7BzB,KAAKwE,OAAOoD,KAAKhG,SACpB,OAEG5B,KAAKwe,UAAU3G,UAClBrS,aAAaxF,KAAKwe,UAAU3G,UAE7B7X,KAAKwe,UAAU3G,SAAW,KAC1B7X,KAAKwe,UAAU8D,YAAc,GAE7B,IAAI3U,EAAI,EAER,IAAK,IAAIsB,KAAQjP,KAAKwE,OAAOoD,KAAK+b,UACjC3jB,KAAKwe,UAAU1I,OAAO9V,KAAKkjB,UAAUljB,KAAKwE,OAAOoD,KAAKic,OAAOlW,KAAMsB,IAEpEjP,KAAKuiB,SAAc,GAAL5U,E,EAMfoV,cAAe,SAASze,EAAK7C,GAE5B,IAAIiD,EAAO1E,KAAKwe,UAAUtM,cAAc,cAAczQ,EAAKqiB,GAAG,MACzDpf,IAELA,EAAK2D,SACLrI,KAAKuiB,SAAsC,GAA7BviB,KAAKwE,OAAOoD,KAAKhG,U,EAMhCohB,cAAe,SAAS1e,EAAK7C,GAE5B,IAAIiD,EAAO1E,KAAKwe,UAAUtM,cAAc,cAAczQ,EAAKqiB,GAAG,MAC9D,IAAKpf,EAAM,OAEX,IAAIghB,EAAQ1lB,KAAKkjB,UAAUzhB,EAAKqiB,GAAIriB,EAAK2W,MACzCpY,KAAKwe,UAAUmH,aAAaD,EAAOhhB,E,EAMpCue,YAAa,SAAS3e,EAAK7C,GAEL,QAAjBA,EAAKsiB,SACR/jB,KAAKwe,UAAU8C,QAAQthB,KAAKkjB,UAAUzhB,EAAKqiB,GAAIriB,EAAK2W,OAEpDpY,KAAKwe,UAAU1I,OAAO9V,KAAKkjB,UAAUzhB,EAAKqiB,GAAIriB,EAAK2W,OAEpDpY,KAAKuiB,UAAS,E,EAMf,gCAAiC,SAASje,EAAK7C,GAE1CzB,KAAKwE,OAAOmS,QAAQzH,IAAI,SAAW5K,EAAIE,OAAOkB,QAAQ5C,MAEzD9C,KAAKwE,OAAOmS,QAAQvI,IAAI,QAA6C,OAApCpO,KAAKwE,OAAOmS,QAAQzH,IAAI,SAAoB,OAAS,OACtFlP,KAAKwE,OAAOwf,QAAQ,WAIpBhkB,KAAKwE,OAAOmS,QAAQvI,IAAI,OAAQ9J,EAAIE,OAAOkB,QAAQ5C,MACnD9C,KAAKwE,OAAOmS,QAAQvI,IAAI,QAAS,OAAO,GACxCpO,KAAKwE,OAAOwf,QAAQ,S,EAOtBA,QAAS,WAERhkB,KAAKwE,OAAOwf,QAAQ,O,EAMrBoB,MAAO,SAAS3jB,GAEf,IAAK,IAAIkM,EAAI,EAAGA,EAAIlM,EAAKG,OAAQ+L,IAChC3N,KAAKmE,MAAMiK,IAAI3M,EAAKkM,GAAI,G,ICtT3BiY,EAAerT,EAAQtC,SAAU,WACjC,CACCrI,KAAM,KACN4W,UAAW,KAEXne,MAAO,GAKPwG,KAAM,WAEL7G,KAAKwe,UAAYjX,SAASC,cAAc,UACxCxH,KAAKkH,cAAcqa,aAAavhB,KAAKwe,UAAWxe,MAEhD,IAAI4H,EAAO,GAEX,IAAK,IAAI0b,KAAQtjB,KAAKujB,WAEjBD,EAAKE,SAASxT,WAAW,WAA8B,aAAjBsT,EAAKE,UAA4C,cAAjBF,EAAKE,WAG/ExjB,KAAKwe,UAAUiF,aAAaH,EAAKE,SAAUF,EAAKI,WAChD9b,EAAKlH,KAAK4iB,EAAKE,WAGhB5b,EAAKhB,SAAQjF,GAAK3B,KAAKwN,gBAAgB7L,KAEvC3B,KAAKsiB,YAAc,IACnBtiB,KAAKkG,MAAMC,QAAU,M,EAMtBwB,OAAQ,WAEP,IAAIC,EAAO5H,KAAK+H,eAAe/H,KAAK0F,QAAQkC,MACvCA,GAML5H,KAAKyiB,QAAQ7a,GAET5H,KAAKkH,cAAc2e,mBAAqB7lB,MAC3CA,KAAKkH,cAAc4O,OAAO9V,OAP1B+G,QAAQyR,MAAM,mBAAqBxY,KAAK0F,QAAQkC,K,EAalD6a,QAAS,SAAU7a,GAEbA,GAASqB,EAAKyZ,aAAa9a,EAAMuP,IAAcnX,KAAK4H,OAASA,IAGjD,MAAb5H,KAAK4H,MACR5H,KAAK4H,KAAK1G,oBAAqBlB,KAAK2D,IAAI,MAEzC3D,KAAK4H,KAAOA,EAER5H,KAAK4H,KAAKwP,aACbpX,KAAK4H,KAAKwP,WAAWP,aAAc,GAEpC7W,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,gBAAiB3D,KAAK6iB,eAAgB7iB,MAC3EA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,gBAAiB3D,KAAK8iB,eAAgB9iB,MAC3EA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,eAAgB3D,KAAK8iB,eAAgB9iB,MAC1EA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,eAAgB3D,KAAK8iB,eAAgB9iB,MAC1EA,KAAK4H,KAAK5G,iBAAkBhB,KAAK2D,IAAI,aAAc3D,KAAK8iB,eAAgB9iB,MAExEA,KAAK8iB,iB,EAMND,eAAgB,SAASve,EAAK7C,GAE7BzB,KAAKwe,UAAU8D,YAAc,E,EAM9BQ,eAAgB,SAASxe,EAAK7C,GAE7B,GAA0B,GAAtBzB,KAAK4H,KAAKhG,SACb,OAED,IACIvB,EAAOylB,EADPle,EAAO5H,KAAK4H,KAAK+b,UACHpP,EAAI,GAWtB,GATI3M,EAAK,GAAGme,IAAI,SAAU1lB,EAAQ,QACzBuH,EAAK,GAAGme,IAAI,QAAO1lB,EAAQ,MAEhCuH,EAAK,GAAGme,IAAI,SAAUD,EAAQ,QACzBle,EAAK,GAAGme,IAAI,UAASD,EAAQ,QAElC,UAAW9lB,KAAK0F,UACnB6O,GAAK,oBAAoBvU,KAAK0F,QAAQsgB,MAAM,aAEzCpe,EAAK,GAAGme,IAAI,SAChB,CACC,IAAIE,EAAS,GACbre,EAAKhB,SAAQjF,GAAKskB,EAAOtkB,EAAEuN,IAAI,UAAY,OAE3C,IAAK,IAAIvN,KAAKskB,EACbA,EAAOtkB,GAAK,CAAEuI,KAAMvI,EAAGiG,KAAM,IAE9BA,EAAKhB,SAAQjF,GAAKskB,EAAOtkB,EAAEuN,IAAI,UAAUtH,KAAKlH,KAAKiB,KAEnDskB,EAASxf,OAAOyf,OAAOD,GACvBA,EAAOrf,SAAQuf,IACd5R,GAAK,oBAAoB4R,EAAEjc,KAAK,KAChCic,EAAEve,KAAKhB,SAAQjF,GAAK4S,GAAK,kBAAkB5S,EAAEuN,IAAI7O,GAAO,KAAKsB,EAAEuN,IAAI4W,GAAO,cAC1EvR,GAAK,aAAa,G,MAInB3M,EAAKhB,SAAQjF,GAAK4S,GAAK,kBAAkB5S,EAAEuN,IAAI7O,GAAO,KAAKsB,EAAEuN,IAAI4W,GAAO,cAEzE9lB,KAAKwe,UAAU3R,UAAY0H,EAC3BvU,KAAKwe,UAAUne,MAAQL,KAAKwe,UAAU9Y,QAAQrF,K,EAM/C2jB,QAAS,WAERhkB,KAAK8iB,gB,IC9JP,MAAMsD,EACN,CAICC,aAAc,SAAUC,EAAUC,GAEjC,IAAI1H,EAAOtX,SAASC,cAAc,KAClCqX,EAAKC,KAAOyH,EAEZ1H,EAAK3Y,MAAMC,QAAU,OACrB0Y,EAAK2H,SAAWF,EAChBzH,EAAKxT,OAAS,SAEd9D,SAASgO,KAAKjO,YAAYuX,GAC1BA,EAAK4H,QACLlf,SAASgO,KAAKmR,YAAY7H,E,EAM3B8H,eAAgB,SAAUC,EAAeC,EAAQxT,GAEhD,IAAIyT,EAAQvf,SAASC,cAAc,SAEnCsf,EAAM5Y,KAAO,OACb4Y,EAAMD,OAASA,EACfC,EAAM5gB,MAAMC,QAAU,OACtB2gB,EAAMvG,SAAWqG,EAEjBrf,SAASgO,KAAKjO,YAAYwf,GAE1BA,EAAM9Y,SAAW,WAChBqF,EAASyT,EAAMjG,M,EAGhBtZ,SAASgO,KAAKwR,QAAU,WAEvBxf,SAASgO,KAAKwR,QAAU,KACxBxf,SAASgO,KAAKmR,YAAYI,E,EAG3BA,EAAML,O,EAMPO,cAAe,SAAUC,EAAM5T,GAE9B,IAAI6T,EAAS,IAAIC,WAEjBD,EAAOE,OAAS,SAASlT,GACxBb,EAAUa,EAAE7I,OAAO9C,OAAQ,K,EAG5B2e,EAAOG,QAAU,SAASnT,GACzBb,EAAU,KAAMa,E,EAGjBgT,EAAOI,cAAcL,E,EAMtBM,WAAY,SAAUN,EAAM5T,GAE3B,IAAI6T,EAAS,IAAIC,WAEjBD,EAAOE,OAAS,SAASlT,GACxBb,EAAUa,EAAE7I,OAAO9C,O,EAGpB2e,EAAOM,WAAWP,E,EAMnBQ,kBAAmB,SAAUR,EAAM5T,GAElC,IAAI6T,EAAS,IAAIC,WAEjBD,EAAOE,OAAS,SAASlT,GACxBb,EAAUa,EAAE7I,OAAO9C,O,EAGpB2e,EAAOQ,kBAAkBT,E,EAM1BU,iBAAkB,SAAUC,EAAUvU,GAErC,IAAI9K,EAAS,GAEb,GAAKqf,GAAaA,EAAShmB,OAA3B,CAMA,IAAIimB,EAAW,SAAUlmB,GAEpBA,GAAKimB,EAAShmB,OAMlBwkB,EAAMY,cAAeY,EAASjmB,IAAI,SAASgT,EAAKyB,GAC1CA,GACJ7N,EAAO7H,KAAK,CAAEwJ,KAAM0d,EAASjmB,GAAGuI,KAAM4d,KAAMF,EAASjmB,GAAGmmB,KAAMnT,IAAKA,IAEpEkT,EAASlmB,EAAE,E,IARX0R,EAAS9K,E,EAYXsf,EAAS,E,MApBRxU,EAAS9K,E,EA0BXwf,iBAAkB,SAAUpT,EAAKtB,GAEhC,IAAI2U,EAAQ,IAAIC,MAChBD,EAAMZ,OAAS,IAAM/T,EAAS2U,GAC9BA,EAAMX,QAAU,IAAMhU,EAAS,MAC/B2U,EAAMjP,IAAMpE,C,OAIduT,EAAe9B,EC9Hf+B,EAAe,CACdC,KAAM7J,EACN8J,KAAM7I,EACN8I,MAAO1G,EACP2G,KAAMtG,EACNuG,KAAMvE,EACNwE,UAAWvE,EACXwE,MAAOrD,EACPsD,OAAQ/C,EACRgD,aCIcrW,EAAQtC,SAAU,kBACjC,CAIC4Y,YAAa,EAKbC,YAAa,EAAGC,WAAY,EAK5BC,WAAY,EAAGC,WAAY,EAK3BC,SAAU,KAAMC,SAAU,KAK1BC,OAAQ,KAKRviB,KAAM,WAEL7G,KAAKqpB,OAAS9hB,SAASC,cAAc,UACrCxH,KAAKsH,YAAYtH,KAAKqpB,QAEtBrpB,KAAKmmB,EAAInmB,KAAKqpB,OAAOC,WAAW,MAEhCtpB,KAAKkpB,SAAW,CAAEpF,GAAI,KAAMviB,QAAQ,EAAOgoB,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GAClF5pB,KAAKmpB,SAAW,CAAErF,GAAI,KAAMviB,QAAQ,EAAOgoB,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GAElF5pB,KAAKgH,IAAMO,SAASC,cAAc,OAClCxH,KAAKsH,YAAYtH,KAAKgH,I,EAMvB6iB,YAAa,SAASlV,GAErBuT,EAAMH,iBAAiBpT,GAAMqT,IAC5BhoB,KAAK8pB,SAAS9B,EAAM,G,EAOtB+B,aAAc,SAAS9C,GAEtBiB,EAAMlB,cAAcC,GAAOtS,IAC1BuT,EAAMH,iBAAiBpT,GAAMqT,IAC5BhoB,KAAK8pB,SAAS9B,EAAM,GACnB,G,EAOJ8B,SAAU,SAAS9B,GAElBhoB,KAAKgoB,MAAQA,EAEbhoB,KAAK4b,QAEL5b,KAAK+oB,WAAa7jB,KAAK8kB,IAAIhqB,KAAKqpB,OAAO/e,MAAQtK,KAAKgoB,MAAM1d,MAAOtK,KAAKqpB,OAAO7e,OAASxK,KAAKgoB,MAAMxd,QAEjGxK,KAAKgpB,WAAoE,IAAtDhpB,KAAKqpB,OAAO/e,MAAQtK,KAAK+oB,WAAW/oB,KAAKgoB,MAAM1d,OAClEtK,KAAKipB,WAAsE,IAAxDjpB,KAAKqpB,OAAO7e,OAASxK,KAAK+oB,WAAW/oB,KAAKgoB,MAAMxd,QAEnExK,KAAKiqB,Q,EAMNC,cAAe,SAAS7W,EAAUnF,EAAK,YAAaic,EAAQ,IAE3DnqB,KAAKqpB,OAAOe,QAAQC,IACnBhX,EAASgX,EAAMC,IAAIC,gBAAgBF,GAAM,GAE1Cnc,EAAMic,E,EAMPvO,MAAO,WAEN5b,KAAKopB,OAASppB,KAAKqK,wBAEnBrK,KAAKqpB,OAAO/e,MAAQtK,KAAKopB,OAAO9e,MAChCtK,KAAKqpB,OAAO7e,OAASxK,KAAKopB,OAAO9e,MAAMtK,KAAK6oB,W,EAM7CoB,OAAQ,WAEPjqB,KAAKqpB,OAAO/e,MAAQtK,KAAKqpB,OAAO/e,MAEhCtK,KAAKmmB,EAAEqE,UAAY,OACnBxqB,KAAKmmB,EAAEsE,YACPzqB,KAAKmmB,EAAEuE,KAAK,EAAG,EAAG1qB,KAAKqpB,OAAO/e,MAAOtK,KAAKqpB,OAAO7e,QACjDxK,KAAKmmB,EAAEwE,OAEP3qB,KAAKmmB,EAAEyE,UAAU5qB,KAAKgpB,WAAYhpB,KAAKipB,YACvCjpB,KAAKmmB,EAAE0E,MAAM7qB,KAAK+oB,WAAY/oB,KAAK+oB,YACnC/oB,KAAKmmB,EAAE2E,UAAU9qB,KAAKgoB,MAAO,EAAG,E,EAMjC+C,eAAgB,SAASC,EAAOC,GAE/BjrB,KAAKgpB,YAAcgC,EACnBhrB,KAAKipB,YAAcgC,EAEnBjrB,KAAKiqB,QAAO,E,EAMb,yBAA0B,SAAS3lB,GAE9BtE,KAAKkpB,SAAS3nB,SAEjBvB,KAAKkpB,SAASO,GAAKnlB,EAAIe,QACvBrF,KAAKkpB,SAASQ,GAAKplB,EAAIgB,QAEvBtF,KAAK+qB,eAAe/qB,KAAKkpB,SAASO,GAAKzpB,KAAKkpB,SAASK,GAAIvpB,KAAKkpB,SAASQ,GAAK1pB,KAAKkpB,SAASM,IAE1FxpB,KAAKkpB,SAASK,GAAKvpB,KAAKkpB,SAASO,GACjCzpB,KAAKkpB,SAASM,GAAKxpB,KAAKkpB,SAASQ,IAGlC1pB,KAAKkpB,SAASS,IAAMrlB,EAAKe,QAAQrF,KAAKopB,OAAO8B,KAAQlrB,KAAKgpB,YAAchpB,KAAK+oB,WAC7E/oB,KAAKkpB,SAASU,IAAMtlB,EAAKgB,QAAQtF,KAAKopB,OAAO+B,IAAOnrB,KAAKipB,YAAcjpB,KAAK+oB,U,EAG7E,yBAA0B,SAASzkB,GAElCtE,KAAKkpB,SAAS3nB,QAAS,EACvBvB,KAAKkpB,SAASK,GAAKjlB,EAAIe,QACvBrF,KAAKkpB,SAASM,GAAKllB,EAAIgB,O,EAGxB,uBAAwB,SAAShB,GAEhCtE,KAAKkpB,SAAS3nB,QAAS,C,EAGxB,qBAAsB,SAAS+C,GAE1BA,EAAI8mB,OAAS,EAChBprB,KAAK+oB,YAAc,KAEnB/oB,KAAK+oB,YAAc,KAEhB/oB,KAAK+oB,WAAa,KAAK/oB,KAAK+oB,WAAa,IAE7C/oB,KAAKgpB,aAAehpB,KAAKkpB,SAASS,GAAG3pB,KAAK+oB,YAAczkB,EAAIe,QAAQrF,KAAKopB,OAAO8B,MAAQlrB,KAAKgpB,WAC7FhpB,KAAKipB,aAAejpB,KAAKkpB,SAASU,GAAG5pB,KAAK+oB,YAAczkB,EAAIgB,QAAQtF,KAAKopB,OAAO+B,KAAOnrB,KAAKipB,WAE5FjpB,KAAKiqB,Q,EAMN,yBAA0B,SAAS3lB,GAElC,IAAK,IAAI3C,KAAK2C,EAAI+mB,eAEbrrB,KAAKkpB,SAASpF,IAAMniB,EAAE2pB,YAEzBtrB,KAAKkpB,SAASO,GAAK9nB,EAAE0D,QACrBrF,KAAKkpB,SAASQ,GAAK/nB,EAAE2D,SAEbtF,KAAKmpB,SAASrF,IAAMniB,EAAE2pB,aAE9BtrB,KAAKmpB,SAASM,GAAK9nB,EAAE0D,QACrBrF,KAAKmpB,SAASO,GAAK/nB,EAAE2D,SAIvB,GAAItF,KAAKkpB,SAAS3nB,QAAUvB,KAAKmpB,SAAS5nB,OAC1C,CACC,IAAIgqB,EAAKrmB,KAAKC,KAAKD,KAAKmV,IAAIra,KAAKkpB,SAASK,GAAGvpB,KAAKmpB,SAASI,GAAI,GAAKrkB,KAAKmV,IAAIra,KAAKkpB,SAASM,GAAGxpB,KAAKmpB,SAASK,GAAI,IAG5GgC,EAFKtmB,KAAKC,KAAKD,KAAKmV,IAAIra,KAAKkpB,SAASO,GAAGzpB,KAAKmpB,SAASM,GAAI,GAAKvkB,KAAKmV,IAAIra,KAAKkpB,SAASQ,GAAG1pB,KAAKmpB,SAASO,GAAI,IAEnG6B,EACbvrB,KAAK+oB,YAAcyC,EAAG,GAAI,KACtBxrB,KAAK+oB,WAAa,KAAK/oB,KAAK+oB,WAAa,IAE7C/oB,KAAKgpB,aAAehpB,KAAKkpB,SAASS,GAAG3pB,KAAK+oB,YAAc/oB,KAAKkpB,SAASO,GAAGzpB,KAAKopB,OAAO8B,MAAQlrB,KAAKgpB,WAClGhpB,KAAKipB,aAAejpB,KAAKkpB,SAASU,GAAG5pB,KAAK+oB,YAAc/oB,KAAKkpB,SAASQ,GAAG1pB,KAAKopB,OAAO+B,KAAOnrB,KAAKipB,WAEjGjpB,KAAKkpB,SAASK,GAAKvpB,KAAKkpB,SAASO,GACjCzpB,KAAKkpB,SAASM,GAAKxpB,KAAKkpB,SAASQ,GAEjC1pB,KAAKmpB,SAASI,GAAKvpB,KAAKmpB,SAASM,GACjCzpB,KAAKmpB,SAASK,GAAKxpB,KAAKmpB,SAASO,GAEjC1pB,KAAKiqB,Q,KAGN,CACC,IAAI1P,EAAIva,KAAKkpB,SAAS3nB,OAASvB,KAAKkpB,SAAYlpB,KAAKmpB,SAAS5nB,OAASvB,KAAKmpB,SAAW,KACvF,IAAK5O,EAAG,OAERva,KAAK+qB,eAAexQ,EAAEkP,GAAKlP,EAAEgP,GAAIhP,EAAEmP,GAAKnP,EAAEiP,IAE1CjP,EAAEgP,GAAKhP,EAAEkP,GACTlP,EAAEiP,GAAKjP,EAAEmP,E,GAIX,0BAA2B,SAASplB,GAEnCtE,KAAK8oB,YAAc9oB,KAAK+oB,WAExB,IAAK,IAAIpnB,KAAK2C,EAAI+mB,eAEQ,OAArBrrB,KAAKkpB,SAASpF,IAEjB9jB,KAAKkpB,SAASpF,GAAKniB,EAAE2pB,WACrBtrB,KAAKkpB,SAAS3nB,QAAS,EACvBvB,KAAKkpB,SAASK,GAAK5nB,EAAE0D,QACrBrF,KAAKkpB,SAASM,GAAK7nB,EAAE2D,QACrBtF,KAAKkpB,SAASS,IAAMhoB,EAAG0D,QAAQrF,KAAKopB,OAAO8B,KAAQlrB,KAAKgpB,YAAchpB,KAAK+oB,WAC3E/oB,KAAKkpB,SAASU,IAAMjoB,EAAG2D,QAAQtF,KAAKopB,OAAO+B,IAAOnrB,KAAKipB,YAAcjpB,KAAK+oB,YAE7C,OAArB/oB,KAAKmpB,SAASrF,KAEtB9jB,KAAKmpB,SAASrF,GAAKniB,EAAE2pB,WACrBtrB,KAAKmpB,SAAS5nB,QAAS,EACvBvB,KAAKmpB,SAASI,GAAK5nB,EAAE0D,QACrBrF,KAAKmpB,SAASK,GAAK7nB,EAAE2D,QACrBtF,KAAKmpB,SAASQ,IAAMhoB,EAAG0D,QAAQrF,KAAKopB,OAAO8B,KAAQlrB,KAAKgpB,YAAchpB,KAAK+oB,WAC3E/oB,KAAKmpB,SAASS,IAAMjoB,EAAG2D,QAAQtF,KAAKopB,OAAO+B,IAAOnrB,KAAKipB,YAAcjpB,KAAK+oB,W,EAK7E,wBAAyB,SAASzkB,GAEjC,IAAK,IAAI3C,KAAK2C,EAAI+mB,eAEbrrB,KAAKkpB,SAASpF,IAAMniB,EAAE2pB,YAEzBtrB,KAAKkpB,SAASpF,GAAK,KACnB9jB,KAAKkpB,SAAS3nB,QAAS,GAEfvB,KAAKmpB,SAASrF,IAAMniB,EAAE2pB,aAE9BtrB,KAAKmpB,SAASrF,GAAK,KACnB9jB,KAAKmpB,SAAS5nB,QAAS,E,EAK1B,2BAA4B,SAAS+C,GAEpC,IAAK,IAAI3C,KAAK2C,EAAI+mB,eAEbrrB,KAAKkpB,SAASpF,IAAMniB,EAAE2pB,YAEzBtrB,KAAKkpB,SAASpF,GAAK,KACnB9jB,KAAKkpB,SAAS3nB,QAAS,GAEfvB,KAAKmpB,SAASrF,IAAMniB,EAAE2pB,aAE9BtrB,KAAKmpB,SAASrF,GAAK,KACnB9jB,KAAKmpB,SAAS5nB,QAAS,E;AClT3BkqB,EACA,CAICC,GAAI,KAUJ7kB,KAAM,SAAU8kB,EAAQC,EAASC,GAEhC,OAAO,IAAIvV,SAAQ,CAACC,EAASC,KAE5B,IAAK3N,EAAOijB,UAGX,YADAtV,EAAQ,8CAIT,IAAIrD,EAAM2Y,UAAUC,KAAKJ,EAAQC,GACjCzY,EAAIkU,QAAW/iB,IAEd,IAAI8R,EAAM9R,EAAI+G,OAAOmN,MAAQ,IAEK,IAA9BpC,EAAInM,QAAQ,gBACfmM,EAAM,KAAOjD,EAAI8N,SAElBzK,EAAO,4BAA8BJ,EACrC,EAGDjD,EAAI6Y,gBAAkBC,MAAO3nB,IAE5B,IAEC,MAAMonB,EAAKpnB,EAAI+G,OAAO9C,OAChB2jB,EAAM5nB,EAAI+G,OAAO8gB,YAEnB7nB,EAAI8nB,WAAa,GACpBV,EAAGW,kBAAkB,SAAU,CAAEC,QAAS,CAAC,gBAEtCT,EAAgBH,EAAIQ,EAAK5nB,EAAI8nB,W,CAEpC,MAAOlY,GACNf,EAAI8N,QAAU/M,EAAE+M,QAChB9N,EAAIgZ,YAAYI,O,GAIlBpZ,EAAIqZ,UAAYP,MAAO3nB,IAEtBtE,KAAK0rB,GAAKpnB,EAAI+G,OAAO9C,OACrBgO,GAAS,CACT,G,EAOHkW,gBAAiB,WAEXzsB,KAAK0rB,IACTgB,MAAM,mC,EAURnR,MAAO,SAAUoR,EAAWC,GAE3B5sB,KAAKysB,kBAEL,IAEIlR,EAFQvb,KAAK0rB,GAAGS,YAAYQ,EAAW,aAAaE,YAAYF,GAElDpR,MAAMqR,GACxB,IAAKrR,EAAO,MAAM,IAAI+J,MAAO,yBAA2BsH,EAAY,cAAgBD,GAEpF,OAAOpR,C,EAWR3U,QAAS,SAAU+lB,EAAW7I,EAAIzQ,GAUjC,OARArT,KAAKysB,kBAEc,mBAAR3I,IAEVzQ,EAAWyQ,EACXA,EAAK,MAGC,IAAIxN,SAAQ2V,MAAO1V,EAASC,KAElC,IAAIG,EAASmW,EAGZA,EADyB,iBAAfH,EACF3sB,KAAK0rB,GAAGS,YAAYQ,EAAW,aAAaE,YAAYF,GAExDA,EAGRhW,EADU,OAAPmN,EACOgJ,EAAMC,aAEND,EAAMC,WAAWjJ,GAE5BnN,EAAQ6V,UAAYP,MAAOe,IAE1B,IAAIC,EAASD,EAAM3hB,OAAO9C,OACrB0kB,IAOU,UADI5Z,EAAU4Z,EAAO5sB,MAAO4sB,GAO3CA,EAAOC,WAXN3W,GAWgB,EAGlBI,EAAQ0Q,QAAW/iB,IAClBkS,EAAOlS,EAAI+G,OAAOmN,MAAM,CACxB,G,EAUHzB,MAAO,SAAU4V,GAIhB,OAFA3sB,KAAKysB,kBAEE,IAAInW,SAAQ,CAACC,EAASC,KAE5B,IAAIsW,EAGHA,EADyB,iBAAfH,EACF3sB,KAAK0rB,GAAGS,YAAYQ,EAAW,YAAYE,YAAYF,GAEvDA,EAET,IAAIhW,EAAUmW,EAAM/V,QAEpBJ,EAAQ6V,UAAaloB,IACpBiS,EAAQjS,EAAI+G,OAAO9C,OAAO,EAG3BoO,EAAQ0Q,QAAW/iB,IAClBkS,EAAOlS,EAAI+G,OAAOmN,MAAM,CACxB,G,EAWH2U,OAAQ,SAAUR,EAAWle,EAAO,MAInC,OAFAzO,KAAKysB,kBAEE,IAAInW,SAAQ,CAACC,EAASC,KAE5B,IAAIsW,EAGHA,EADyB,iBAAfH,EACF3sB,KAAK0rB,GAAGS,YAAYQ,EAAW,YAAYE,YAAYF,GAEvDA,EAET,IAAIhW,EAAUmW,EAAMK,OAAO1e,GAE3BkI,EAAQ6V,UAAaloB,IACpBiS,EAAQjS,EAAI+G,OAAO9C,OAAO,EAG3BoO,EAAQ0Q,QAAW/iB,IAClBkS,EAAOlS,EAAI+G,OAAOmN,MAAM,CACxB,G,EAWH4U,WAAY,SAAUT,EAAWle,EAAO,MAIvC,OAFAzO,KAAKysB,kBAEE,IAAInW,SAAQ,CAACC,EAASC,KAE5B,IAAIsW,EAGHA,EADyB,iBAAfH,EACF3sB,KAAK0rB,GAAGS,YAAYQ,EAAW,YAAYE,YAAYF,GAEvDA,EAET,IAAIhW,EAAUmW,EAAMM,WAAW3e,GAE/BkI,EAAQ6V,UAAaloB,IACpBiS,EAAQjS,EAAI+G,OAAO9C,OAAO,EAG3BoO,EAAQ0Q,QAAW/iB,IAClBkS,EAAOlS,EAAI+G,OAAOmN,MAAM,CACxB,G,EAWH6U,aAAc,SAAUV,EAAWW,EAAU,MAI5C,OAFAttB,KAAKysB,kBAEE,IAAInW,SAAQ,CAACC,EAASC,KAE5B,IAAIsW,EAGHA,EADyB,iBAAfH,EACF3sB,KAAK0rB,GAAGS,YAAYQ,EAAW,YAAYE,YAAYF,GAEvDA,EAET,IAAIhW,EAAUmW,EAAMC,WAAW,KAAM,cACjCnlB,EAAO,GAEX+O,EAAQ6V,UAAaQ,IAEpB,IAAIC,EAASD,EAAM3hB,OAAO9C,OACrB0kB,GAMLrlB,EAAKlH,KAAK4sB,EAAYL,EAAO5sB,MAAMitB,GAAaL,EAAO5sB,OACvD4sB,EAAOC,YALN3W,EAAQ3O,EAKQ,EAGlB+O,EAAQ0Q,QAAW/iB,IAClBkS,EAAOlS,EAAI+G,OAAOmN,MAAM,CACxB,G,EAWHtJ,IAAK,SAAUyd,EAAW7I,GAIzB,OAFA9jB,KAAKysB,kBAEE,IAAInW,SAAQ,CAACC,EAASC,KAE5B,IAAIsW,EAGHA,EADyB,iBAAfH,EACF3sB,KAAK0rB,GAAGS,YAAYQ,EAAW,YAAYE,YAAYF,GAEvDA,EAET,IAAIhW,EAAUmW,EAAM5d,IAAI4U,GAExBnN,EAAQ6V,UAAaloB,IACpBiS,EAAQjS,EAAI+G,OAAO9C,QAAU,KAAK,EAGnCoO,EAAQ0Q,QAAW/iB,IAClBkS,EAAOlS,EAAI+G,OAAOmN,MAAM,CACxB,G,EAYH+U,IAAK,SAAUZ,EAAW1d,GAIzB,OAFAjP,KAAKysB,kBAEE,IAAInW,SAAQ,CAACC,EAASC,KAE5B,IACIG,EADQ3W,KAAK0rB,GAAGS,YAAYQ,EAAW,aAAaE,YAAYF,GAChDY,IAAIte,GAExB0H,EAAQ6V,UAAaloB,IACpBiS,GAAS,EAGVI,EAAQ0Q,QAAW/iB,IAClBkS,EAAOlS,EAAI+G,OAAOmN,MAAM,CACxB,G,EAWHgV,OAAQvB,eAAgB/hB,EAAMujB,GAAK,GAElC,IAAIxe,QAAajP,KAAKkP,IAAI,SAAU,CAAChF,IACrC,OAAO+E,EAAQwe,EAAOxe,EAAOA,EAAK5O,MAAS,I,EAW5CqtB,OAAQzB,eAAgB/hB,EAAM7J,EAAOotB,GAAK,GAErCA,GAEHptB,EAAM6J,KAAOA,QACPlK,KAAKutB,IAAI,SAAUltB,UAGnBL,KAAKutB,IAAI,SAAU,CAAErjB,KAAMA,EAAM7J,MAAOA,G,EAWhDstB,QAAS,SAAUhB,EAAWiB,EAAQ,KAAMC,EAAW,MAItD,OAFA7tB,KAAKysB,kBAEE,IAAInW,SAAQ,CAACC,EAASC,KAE5B,IAAIsW,EAGHA,EADyB,iBAAfH,EACF3sB,KAAK0rB,GAAGS,YAAYQ,EAAW,YAAYE,YAAYF,GAEvDA,EAET,IAAIhW,EAAUmW,EAAMC,aAEpBpW,EAAQ6V,UAAaQ,IAEpB,IAAIC,EAASD,EAAM3hB,OAAO9C,OAC1B,GAAK0kB,EAML,OAAgB,OAAZW,GAAoB3kB,EAAK6kB,eAAeb,EAAO5sB,MAAOutB,GAEtC,OAAfC,GAEC5kB,EAAK6kB,eAAeb,EAAO5sB,MAAOwtB,QAErCZ,EAAOC,gBAKT3W,EAAQ0W,EAAO5sB,YAIhB4sB,EAAOC,WAnBN3W,EAAQ,KAmBQ,EAGlBI,EAAQ0Q,QAAW/iB,IAClBkS,EAAOlS,EAAI+G,OAAOmN,MAAM,CACxB,G,EAWHuV,OAAQ,SAAUpB,EAAW7I,GAI5B,OAFA9jB,KAAKysB,kBAEE,IAAInW,SAAQ,CAACC,EAASC,KAE5B,IAEIG,EAFQ3W,KAAK0rB,GAAGS,YAAYQ,EAAW,aAAaE,YAAYF,GAEhDoB,OAAOjK,GAC3BnN,EAAQ6V,UAAaloB,IACpBiS,GAAS,EAGVI,EAAQ0Q,QAAW/iB,IAClBkS,EAAOlS,EAAI+G,OAAOmN,MAAM,CACxB,G,EAWHwV,UAAW,SAAUrB,EAAW7I,EAAG,MAElC,OAAO9jB,KAAK4G,QAAQ+lB,EAAW7I,GAAImI,MAAO5rB,EAAO4sB,WAC1CA,EAAOc,QAAQ,G,EAWvBE,OAAQ,SAAUtB,EAAW1d,GAI5B,OAFAjP,KAAKysB,kBAEE,IAAInW,SAAQ,CAACC,EAASC,KAE5B,IACIG,EADQ3W,KAAK0rB,GAAGS,YAAYQ,EAAW,aAAaE,YAAYF,GAChD9iB,IAAIoF,GAExB0H,EAAQ6V,UAAaloB,IACpBiS,GAAS,EAGVI,EAAQ0Q,QAAW/iB,IAClBkS,EAAOlS,EAAI+G,OAAOmN,MAAM,CACxB,G,GC/eG,SAAS0V,EAAM7tB,GAErBL,KAAKK,MAAQ,KACbL,KAAKmuB,KAAO,KACZnuB,KAAKouB,KAAO,KACZpuB,KAAK4H,KAAO,I,CAwGN,SAASymB,IAEfruB,KAAKsuB,KAAO,KACZtuB,KAAKuuB,KAAO,KACZvuB,KAAK4B,OAAS,C,CApGfssB,EAAKM,OAAS,SAAUnuB,GAEvB,IAAIouB,EAAO,IAAIP,EAEf,OADAO,EAAKpuB,MAAQA,EACNouB,C,EAORP,EAAK1d,UAAUke,KAAO,WAErB,IAAIruB,EAAQL,KAAKK,MAOjB,OANAL,KAAK2uB,SAEL3uB,KAAKmuB,KAAOnuB,KAAKouB,KAAO,KACxBpuB,KAAK4H,KAAO,KAEZ5H,KAAKK,MAAQ,KACNA,C,EASR6tB,EAAK1d,UAAUoe,UAAY,SAAU9mB,EAAKF,GAkBzC,OAhBA5H,KAAKmuB,KAAe,OAARrmB,EAAeA,EAAIqmB,KAAO,KACtCnuB,KAAKouB,KAAOtmB,EACZ9H,KAAK4H,KAAOA,EAEA,OAARE,IACc,OAAbA,EAAIqmB,OAAermB,EAAIqmB,KAAKC,KAAOpuB,MACvC8H,EAAIqmB,KAAOnuB,MAGR4H,EAAK2mB,OAASzmB,IACjBF,EAAK2mB,KAAOvuB,MAEK,OAAd4H,EAAK0mB,OACR1mB,EAAK0mB,KAAOtuB,MAEb4H,EAAKhG,SACE5B,I,EASRkuB,EAAK1d,UAAUqe,WAAa,SAAU/mB,EAAKF,GAkB1C,OAhBA5H,KAAKouB,KAAe,OAARtmB,EAAeA,EAAIsmB,KAAO,KACtCpuB,KAAKmuB,KAAOrmB,EACZ9H,KAAK4H,KAAOA,EAEA,OAARE,IACc,OAAbA,EAAIsmB,OAAetmB,EAAIsmB,KAAKD,KAAOnuB,MACvC8H,EAAIsmB,KAAOpuB,MAGR4H,EAAK0mB,OAASxmB,IACjBF,EAAK0mB,KAAOtuB,MAEK,OAAd4H,EAAK2mB,OACR3mB,EAAK2mB,KAAOvuB,MAEb4H,EAAKhG,SACE5B,I,EAORkuB,EAAK1d,UAAUme,OAAS,WASvB,OAPI3uB,KAAKouB,OAAMpuB,KAAKouB,KAAKD,KAAOnuB,KAAKmuB,MACjCnuB,KAAKmuB,OAAMnuB,KAAKmuB,KAAKC,KAAOpuB,KAAKouB,MAEjCpuB,KAAK4H,KAAK0mB,OAAStuB,OAAMA,KAAK4H,KAAK0mB,KAAOtuB,KAAKmuB,MAC/CnuB,KAAK4H,KAAK2mB,OAASvuB,OAAMA,KAAK4H,KAAK2mB,KAAOvuB,KAAKouB,MAEnDpuB,KAAK4H,KAAKhG,SACH5B,I,EAiBRquB,EAAKG,OAAS,WAEb,OAAO,IAAIH,C,EAMZA,EAAK7d,UAAUke,KAAO,WAErB1uB,KAAKolB,O,EAONiJ,EAAK7d,UAAUoL,MAAQ,WAEtB,KAAqB,OAAd5b,KAAKsuB,MACXtuB,KAAKsuB,KAAKI,OAEX,OAAO1uB,I,EAORquB,EAAK7d,UAAU4U,MAAQ,WAEtB,KAAqB,OAAdplB,KAAKsuB,MAEa,OAApBtuB,KAAKsuB,KAAKjuB,OACbL,KAAKsuB,KAAKjuB,MAAMquB,OAEjB1uB,KAAKsuB,KAAKI,OAGX,OAAO1uB,I,EAORquB,EAAK7d,UAAUse,MAAQ,WAEtB,OAAqB,OAAd9uB,KAAKsuB,KAAgBtuB,KAAKsuB,KAAKjuB,MAAQ,I,EAO/CguB,EAAK7d,UAAU+M,KAAO,WAErB,OAAqB,OAAdvd,KAAKuuB,KAAgBvuB,KAAKuuB,KAAKluB,MAAQ,I,EAO/CguB,EAAK7d,UAAU2H,KAAO,SAAU9X,GAE/B,IAAK,IAAIsB,EAAI3B,KAAKsuB,KAAY,OAAN3sB,EAAYA,EAAIA,EAAEwsB,KAEzC,GAAIxsB,EAAEtB,QAAUA,EACf,OAAOsB,EAGT,OAAO,I,EAQR0sB,EAAK7d,UAAUue,QAAU,SAAU1uB,GAGlC,OADA6tB,EAAKM,OAAOnuB,GAAOwuB,WAAW7uB,KAAKsuB,KAAMtuB,MAClCK,C,EAORguB,EAAK7d,UAAU1H,MAAQ,WAEtB,OAAqB,OAAd9I,KAAKsuB,KAAgB,KAAOtuB,KAAKsuB,KAAKI,M,EAQ9CL,EAAK7d,UAAU9P,KAAO,SAAUL,GAG/B,OADA6tB,EAAKM,OAAOnuB,GAAOuuB,UAAU5uB,KAAKuuB,KAAMvuB,MACjCK,C,EAORguB,EAAK7d,UAAUjE,IAAM,WAEpB,OAAqB,OAAdvM,KAAKuuB,KAAgB,KAAOvuB,KAAKuuB,KAAKG,M,ECvO9C,IAAIM,EAAgB,KAChBC,GAAqB,EAIrBC,EAAmBb,EAAKG,SACxBW,GAAuB,EAI3B,SAASC,EAAWC,GAEnB,IAA6B,IAAzBA,EAAOC,cACV,OAEDD,EAAOC,eAAgB,EAEvB,IAAIC,EAAkBF,EAAOG,SAG7B,IAFAH,EAAOG,SAAWnB,EAAKG,SAEhBe,EAAgB3tB,QACtB2tB,EAAgBzmB,OAAhBymB,GAGDA,EAAgBb,OAEhBW,EAAOC,eAAgB,EACvBD,EAAOI,WAAY,C,CAKpB,SAASC,IAIR,IAFAT,GAAqB,EAEdC,EAAiBttB,QACvBwtB,EAAUF,EAAiBpmB,SAG5BmmB,GAAqB,EACrBE,GAAuB,C,CAyDjB,SAASQ,EAAQtvB,EAAM,MAE7B,MAAM4O,EAAO,CACZugB,SAAUnB,EAAKG,SACfnuB,MAAOA,EACPivB,eAAe,EACfG,WAAW,GAQZ,OALAxgB,EAAK2gB,SAAW,CAACC,EAAoB3X,GAAO,IA7D7C,SAA0BmX,EAAQQ,EAAU3X,GAE3C,YAAiBjV,IAAb4sB,GAEmB,OAAlBb,GAEyC,OAAxCK,EAAOG,SAASrX,KAAK6W,IACxBK,EAAOG,SAAS9uB,KAAKsuB,GAGhBK,EAAOhvB,OAIXgvB,EAAOhvB,QAAUwvB,IAAuB,IAAX3X,EACzBmX,EAAOO,UAEfP,EAAOS,cAAgBT,EAAOhvB,MAC9BgvB,EAAOhvB,MAAQwvB,EACfR,EAAOO,SAASvvB,MAAQwvB,GAEG,IAAvBZ,GAECI,EAAOC,gBAGc,IAArBD,EAAOI,YAEVP,EAAiBxuB,KAAK2uB,GACtBA,EAAOI,WAAY,GAEU,IAAzBN,IAEHY,eAAeL,GACfP,GAAuB,IAVjBE,EAAOO,WAiBhBX,GAAqB,EACrBG,EAAUC,GACVJ,GAAqB,EAEdI,EAAOO,U,CAiBNI,CAAiB/gB,EAAM4gB,EAAU3X,GAGzCjJ,EAAK2gB,SAASvvB,MAAQ4O,EAAK5O,MACpB4O,EAAK2gB,Q,CAON,SAASK,EAAQ7d,EAAI0R,EAAG,MAE9B,IAAIoM,EAAkB,KAClB3uB,GAAS,EAEb,MAAM4uB,EAAU,YAEA,IAAX5uB,IACJA,GAAS,EAET2uB,EAAkBlB,EAClBA,EAAgBmB,EAGf/d,IAKD4c,EAAgBkB,EAChB3uB,GAAS,E,EAMV,OAHA4uB,EAAQrM,GAAKA,EACbqM,IAEOA,C,CAOD,SAASC,EAAU/vB,EAAM,MAE/B,IAAIuvB,EAAYC,QAEE5sB,IAAb4sB,EACID,EAASvvB,OAEjBuvB,EAASvvB,MAAQwvB,EACVD,GAIR,OADAA,EAASvvB,MAAQA,EACVuvB,C,CAMD,MAAMS,EACb,CASCC,YAAa,SAAU7B,EAAMpuB,EAAOkwB,GAEnC,IAAIhoB,EAASlI,EAEb,GAAIouB,aAAgB+B,MACpB,CACC,GAAInwB,aAAiBmwB,MACrB,CAEC,GAAoB,GAAhBnwB,EAAMuB,OACV,CACC,KAAO6sB,EAAK7sB,OAAS,GACpB6sB,EAAKliB,MAAMlE,SAIZ,OAFAhI,EAAQkH,SAASC,cAAc+oB,GAC/B9B,EAAK,GAAGgC,YAAYpwB,GACbA,C,CAGR,IAAIqwB,EAASjC,EAAK,GAAGvnB,cACjBY,EAAM4oB,EAAOC,UAEL,OAAR7oB,GAAgBA,IAAQzH,EAAMA,EAAMuB,OAAO,KAG9CkG,EAAMzH,EAAMA,EAAMuB,OAAO,GACzB8uB,EAAOppB,YAAYQ,IAGpB,IAAK,IAAInG,KAAK8sB,EACb9sB,EAAEivB,SAAU,EAEb9oB,EAAI8oB,SAAU,EACd,IAAI5T,EAAI,EAER,IAAK,IAAIrP,EAAItN,EAAMuB,OAAO,EAAG+L,GAAK,EAAGA,IAEpCtN,EAAMsN,GAAGijB,SAAU,EAEfvwB,EAAMsN,GAAGkjB,cAAgBxwB,EAAMsN,EAAE,KAGrC+iB,EAAOnP,aAAalhB,EAAMsN,GAAItN,EAAMsN,EAAE,IACtCqP,KAIDA,EAAI,EAEJ,IAAK,IAAIjP,KAAK0gB,GAEK,IAAd1gB,EAAE6iB,UAGN7iB,EAAE1F,SACF2U,KAID,MAAO,IAAI3c,E,CAGZ,KAAOouB,EAAK7sB,OAAS,GACpB6sB,EAAKliB,MAAMlE,SAEZomB,EAAOA,EAAK7sB,OAAS6sB,EAAK,GAAK,I,CAMhC,GAHIpuB,UACHkI,EAASlI,EAAQkH,SAASC,cAAc+oB,IAErClwB,aAAiBmwB,MACrB,CACC,IAAI9rB,EAAO6C,SAASupB,yBACpBvoB,EAAS,GAET,IAAK,IAAIwoB,KAAK1wB,EACd,CACC,KAAM0wB,aAAaC,MAElB,GAAID,aAAaP,MACjB,CACC,IAAI/W,EAAIlS,SAASC,cAAc,OAC/BiS,EAAE5M,UAAYkkB,EAAE,GAChBA,EAAItX,EAAEwX,SAAS,E,MAGfF,EAAIxpB,SAAS2pB,eAAeH,GAG9BxoB,EAAO7H,KAAKqwB,GACZrsB,EAAK4C,YAAYypB,E,CAGlB1wB,EAAQqE,EAEa,GAAjB6D,EAAO3G,SACV2G,EAASlI,EAAQkH,SAASC,cAAc+oB,G,MAInClwB,aAAiB2wB,OACtBzoB,EAASlI,EAAQkH,SAAS2pB,eAAe7wB,IAG3C,OAAa,OAATouB,GAGJA,EAAKgC,YAAYpwB,GAFTkI,C,EAWT4oB,iBAAkB1C,EAAMxf,GAEvB,IAAK,IAAItN,KAAKsN,EACbjP,KAAKyjB,aAAagL,EAAM9sB,EAAGsN,EAAKtN,G,EASlC8hB,aAAcgL,EAAMvkB,EAAM+E,GAErBA,aAAgBuhB,MAEN,UAATtmB,EACHukB,EAAKhY,UAAYxH,EAAKyF,KAAK,KAE3B+Z,EAAKvkB,GAAQ+E,EAID,UAAT/E,GAAoC,iBAAT+E,EAE9BxI,OAAOyQ,OAAOuX,EAAKvoB,MAAO+I,GAElB/E,EAAK8F,WAAW,SAExBye,EAAK/oB,QAAQwE,EAAKknB,UAAU,IAAMniB,EAE1B/E,EAAK8F,WAAW,MAExBye,EAAKvkB,EAAK7C,eAAiB4H,EAG3Bwf,EAAKhL,aAAavZ,EAAM+E,E,GCjVoBoiB,EAASpmB,EAEPqmB,EAAU/e,EAAuBgf,EAAWhf,EAEpDif,GAAM1Z,EAES2Z,GAAahN,EAEjBiN,GAAWC,EAEhBC,GAAS7W,EAEb8W,GAAOvT,EAECwT,GAAW3J,EAEjB4J,GAAQ7J,EAEd8J,GAAKvG,EAIhCwG,GAAOhpB,EACPipB,GAAQjX,EACRkX,GAAQC,EACRC,GAAkBxyB,EAClByyB,GAAQpuB,EACRquB,GAAYpb,EACZqb,GAASC,EACTC,GAAcC,EACdC,GAAaC,EACbC,GAAW3lB,S","sources":["src/router.js","src/element.js","src/api.js","src/data-source.js","src/data-list.js","src/easing.js","src/anim.js","src/elems/r-tabs.js","src/elems/r-form.js","src/elems/r-panel.js","src/elems/r-list.js","src/elems/r-item.js","src/elems/r-paginator.js","src/elems/r-table.js","src/elems/r-select.js","src/utils.js","src/elements.js","src/elems/r-image-cropper.js","src/db.js","src/utils-jsx.js","src/runtime-jsx.js","src/main.js"],"sourcesContent":["\r\nimport { EventDispatcher } from 'rinn';\r\n\r\n/*\r\n**\tThe Router is a special module that detects local URL changes (when a hash-change occurs) and\r\n**\tforwards events to the appropriate handlers.\r\n*/\r\n\r\nconst _Router =\r\n{\r\n\tRoute: EventDispatcher.extend\r\n\t({\r\n\t\t/*\r\n\t\t**\tRegular expression for the route. This is generated from a simpler expression provided\r\n\t\t**\tin the constructor.\r\n\t\t*/\r\n\t\trouteRegex: null,\r\n\r\n\t\t/*\r\n\t\t**\tOriginal route string value.\r\n\t\t*/\r\n\t\tvalue: null,\r\n\r\n\t\t/*\r\n\t\t**\tMap with the indices and the names of each paremeter obtained from the route expression.\r\n\t\t*/\r\n\t\tparams: null,\r\n\r\n\t\t/*\r\n\t\t**\tArguments obtained from the current route (uses `params` to determine name of arguments).\r\n\t\t*/\r\n\t\targs: null,\r\n\r\n\t\t/*\r\n\t\t**\tArguments string obtained from the last route dispatch. Used to check if the arguments changed.\r\n\t\t*/\r\n\t\ts_args: null,\r\n\r\n\t\t/*\r\n\t\t**\tIndicates if the route is active because of a past positive dispatch.\r\n\t\t*/\r\n\t\tactive: false,\r\n\r\n\t\t/*\r\n\t\t**\tIndicates if the params have changed since last event. Transition from inactive to active route will always set this value to true.\r\n\t\t*/\r\n\t\tchanged: false,\r\n\r\n\t\t/*\r\n\t\t**\tConstructor of the route, the specified argument is a route expression.\r\n\t\t**\r\n\t\t**\t>> void __ctor (string route);\r\n\t\t*/\r\n\t\t__ctor: function (route)\r\n\t\t{\r\n\t\t\tthis._super.EventDispatcher.__ctor();\r\n\t\t\tthis._compileRoute (this.value = route);\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tTransforms the specified route expression into a regular expression and a set of parameter\r\n\t\t**\tnames and stores them in the 'param' array.\r\n\t\t**\r\n\t\t**\t>> void _compileRoute (string route);\r\n\t\t*/\r\n\t\t_compileRoute: function (route)\r\n\t\t{\r\n\t\t\tthis.params = [];\r\n\r\n\t\t\troute = route.replace(/\\/\\*\\//g, '/.+/');\r\n\r\n\t\t\twhile (true)\r\n\t\t\t{\r\n\t\t\t\tvar m = /:([!@A-Za-z0-9_-]+)/.exec(route);\r\n\t\t\t\tif (!m) break;\r\n\t\r\n\t\t\t\troute = route.replace(m[0], '([^/]+)');\r\n\t\t\t\tthis.params.push (m[1]);\r\n\t\t\t}\r\n\r\n\t\t\tthis.routeRegex = '^' + route.replace(/##/g, '');\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tAdds a handler to the route dispatcher. The handler can be removed later using removeHandler and\r\n\t\t**\tspecifying the same parameters. If unrouted boolean is specified the event to listen to will be\r\n\t\t**\tthe unrouted event (when the route changes and the route is not activated).\r\n\t\t**\r\n\t\t**\tvoid addHandler (handler: function, unrouted: bool, context:object=null);\r\n\t\t*/\r\n\t\taddHandler: function (handler, unrouted=false, context=null)\r\n\t\t{\r\n\t\t\tthis.addEventListener ((unrouted === true ? 'un' : '') + 'routed', handler, context);\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tRemoves a handler from the route dispatcher.\r\n\t\t**\r\n\t\t**\tvoid removeHandler (handler: function, unrouted: bool, context: object=null);\r\n\t\t*/\r\n\t\tremoveHandler: function (handler, unrouted=false, context=null)\r\n\t\t{\r\n\t\t\tthis.removeEventListener ((unrouted === true ? 'un' : '') + 'routed', handler, context);\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t**\tVerifies if the specified route matches the internal route and if so dispatches a (depends on doUnroute parameter) \"routed\" or \"unrouted\" event with the\r\n\t\t**\tparameters obtained from the location to all attached handlers.\r\n\t\t**\r\n\t\t**\tvoid dispatch (route:string, doUnroute:bool);\r\n\t\t*/\r\n\t\tdispatch: function (route)\r\n\t\t{\r\n\t\t\tvar matches = route.match(this.routeRegex);\r\n\t\t\tif (!matches)\r\n\t\t\t{\r\n\t\t\t\tthis.s_args = null;\r\n\r\n\t\t\t\tif (this.active)\r\n\t\t\t\t\tthis.dispatchEvent ('unrouted', { route: this });\r\n\r\n\t\t\t\tthis.active = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar args = { route: this };\r\n\t\t\tvar str = '';\r\n\r\n\t\t\tfor (var i = 0; i < this.params.length; i++)\r\n\t\t\t{\r\n\t\t\t\targs[this.params[i]] = matches[i+1];\r\n\t\t\t\tstr += '_' + matches[i+1];\r\n\t\t\t}\r\n\r\n\t\t\tthis.changed = str != this.s_args;\r\n\t\t\tthis.s_args = str;\r\n\r\n\t\t\tthis.dispatchEvent ('routed', this.args = args);\r\n\t\t\tthis.active = true;\r\n\t\t}\r\n\t}),\r\n\r\n\t/*\r\n\t**\tMap with route objects. The key of the map is the route and the value a handler.\r\n\t*/\r\n\troutes: { },\r\n\r\n\t/*\r\n\t**\tSorted list of routes. Smaller routes are processed first than larger ones. This array stores\r\n\t**\tonly the keys to the Router.routes map.\r\n\t*/\r\n\tsortedRoutes: [ ],\r\n\r\n\t/*\r\n\t**\tIndicates the number of times the onLocationChanged handler should ignore the hash change event.\r\n\t*/\r\n\tignoreHashChangeEvent: 0,\r\n\r\n\t/*\r\n\t**\tCurrent relative location (everything after the location hash symbol).\r\n\t*/\r\n\tlocation: '',\r\n\r\n\t/*\r\n\t**\tCurrent relative location as an array of elements (obtained by splitting the location by slash).\r\n\t*/\r\n\targs: [],\r\n\r\n\t/*\r\n\t**\tInitializes the router module. Ensure to call `refresh` once to force a hashchange when the page loads.\r\n\t*/\r\n\tinit: function ()\r\n\t{\r\n\t\tif (this.alreadyAttached)\r\n\t\t\treturn;\r\n\r\n\t\tthis.alreadyAttached = true;\r\n\r\n\t\tif ('onhashchange' in globalThis)\r\n\t\t\tglobalThis.onhashchange = this.onLocationChanged.bind(this);\r\n\t},\r\n\r\n\t/*\r\n\t**\tRefreshes the current route by forcing a hashchange event.\r\n\t*/\r\n\trefresh: function ()\r\n\t{\r\n\t\tthis.onLocationChanged();\r\n\t},\r\n\r\n\t/*\r\n\t**\tChanges the current location and optionally prevents a trigger of the hashchange event.\r\n\t*/\r\n\tsetRoute: function (route, silent)\r\n\t{\r\n\t\tvar location = this.realLocation (route);\r\n\t\tif (location == this.location) return;\r\n\r\n\t\tif (silent) this.ignoreHashChangeEvent++;\r\n\t\tglobalThis.location.hash = location;\r\n\t},\r\n\r\n\t/*\r\n\t**\tAdds the specified route to the routing map. When the specified route is detected, the `onRoute` handler will be called, and then\r\n\t**\twhen the route exits `onUnroute` will be called.\r\n\t*/\r\n\taddRoute: function (route, onRoute, onUnroute=null)\r\n\t{\r\n\t\tif (!this.routes[route])\r\n\t\t{\r\n\t\t\tthis.routes[route] = new this.Route (route);\r\n\t\t\tthis.sortedRoutes.push (route);\r\n\r\n\t\t\tthis.sortedRoutes.sort ((a, b) => {\r\n\t\t\t\treturn this.routes[a].routeRegex.length - this.routes[b].routeRegex.length;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (onUnroute !== null)\r\n\t\t{\r\n\t\t\tthis.routes[route].addHandler (onRoute, false);\r\n\t\t\tthis.routes[route].addHandler (onUnroute, true);\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis.routes[route].addHandler (onRoute, false);\r\n\r\n\t\treturn this.routes[route];\r\n\t},\r\n\r\n\t/*\r\n\t**\tReturns the Route object for the specified route.\r\n\t*/\r\n\tgetRoute: function (route)\r\n\t{\r\n\t\tif (!this.routes[route])\r\n\t\t{\r\n\t\t\tthis.routes[route] = new this.Route (route);\r\n\t\t\tthis.sortedRoutes.push (route);\r\n\r\n\t\t\tthis.sortedRoutes.sort ((a, b) => {\r\n\t\t\t\treturn this.routes[a].routeRegex.length - this.routes[b].routeRegex.length;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this.routes[route];\r\n\t},\r\n\r\n\t/*\r\n\t**\tAdds the specified routes to the routing map. The routes map should contain the route expression\r\n\t**\tin the key of the map and a handler function in the value.\r\n\t*/\r\n\taddRoutes: function (routes)\r\n\t{\r\n\t\tfor (var i in routes)\r\n\t\t{\r\n\t\t\tif (!this.routes[i])\r\n\t\t\t{\r\n\t\t\t\tthis.routes[i] = new this.Route (i);\r\n\t\t\t\tthis.sortedRoutes.push (i);\r\n\t\t\t}\r\n\r\n\t\t\tthis.routes[i].addHandler (routes[i], false);\r\n\t\t}\r\n\r\n\t\tthis.sortedRoutes.sort ((a, b) => {\r\n\t\t\treturn this.routes[a].routeRegex.length - this.routes[b].routeRegex.length;\r\n\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t**\tRemoves the specified route from the routing map.\r\n\t*/\r\n\tremoveRoute: function (route, onRoute, onUnroute)\r\n\t{\r\n\t\tif (!this.routes[route]) return;\r\n\r\n\t\tif (onUnroute !== undefined)\r\n\t\t{\r\n\t\t\tthis.routes[route].removeHandler (onRoute, false);\r\n\t\t\tthis.routes[route].removeHandler (onUnroute, true);\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis.routes[route].removeHandler (onRoute);\r\n\t},\r\n\r\n\t/*\r\n\t**\tRemoves the specified routes from the routing map. The routes map should contain the route\r\n\t**\texpression in the key of the map and a handler function in the value.\r\n\t*/\r\n\tremoveRoutes: function (routes)\r\n\t{\r\n\t\tfor (var i in routes)\r\n\t\t{\r\n\t\t\tif (!this.routes[i]) continue;\r\n\r\n\t\t\tthis.routes[i].removeHandler (routes[i]);\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t**\tGiven a formatted location and a previous one it will return the correct real location.\r\n\t*/\r\n\trealLocation: function (cLocation, pLocation)\r\n\t{\r\n\t\tif (!pLocation) pLocation = this.location;\r\n\t\tif (!pLocation) pLocation = ' ';\r\n\r\n\t\tvar state = 0, i = 0, j = 0, k;\r\n\t\tvar rLocation = '';\r\n\r\n\t\twhile (state != -1 && i < cLocation.length && j < pLocation.length)\r\n\t\t{\r\n\t\t\tswitch (state)\r\n\t\t\t{\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tif (cLocation.substr(i++, 1) == '*')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstate = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (cLocation.substr(i-1, 1) != pLocation.substr(j++, 1))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trLocation += cLocation.substr(i-1);\r\n\t\t\t\t\t\tstate = -1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trLocation += pLocation.substr(j-1, 1);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tif (cLocation.substr(i, 1) == '*')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstate = 3;\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate = 2;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tk = pLocation.indexOf(cLocation.substr(i, 1), j);\r\n\t\t\t\t\tif (k == -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trLocation += pLocation.substr(j) + cLocation.substr(i);\r\n\t\t\t\t\t\tstate = -1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trLocation += pLocation.substr(j, k-j);\r\n\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t\tj = k;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tk = pLocation.lastIndexOf(cLocation.substr(i, 1));\r\n\t\t\t\t\tif (k == -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trLocation += cLocation.substr(i);\r\n\t\t\t\t\t\tstate = -1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trLocation += pLocation.substr(j, k-j);\r\n\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t\tj = k;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (state != -1)\r\n\t\t\trLocation += cLocation.substr(i);\r\n\r\n\t\treturn rLocation.trim();\r\n\t},\r\n\r\n\t/*\r\n\t**\tEvent handler called when the location hash changes.\r\n\t*/\r\n\tonLocationChanged: function ()\r\n\t{\r\n\t\tvar cLocation = location.hash.substr(1);\r\n\t\tvar rLocation = this.realLocation (cLocation);\r\n\r\n\t\tif (cLocation != rLocation)\r\n\t\t{\r\n\t\t\tglobalThis.location.replace('#' + rLocation);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.location = cLocation;\r\n\t\tthis.args = this.location.split ('/');\r\n\r\n\t\tif (this.ignoreHashChangeEvent > 0)\r\n\t\t{\r\n\t\t\tthis.ignoreHashChangeEvent--;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < this.sortedRoutes.length; i++)\r\n\t\t\tthis.routes[this.sortedRoutes[i]].dispatch (this.location);\r\n\t},\r\n\r\n\t/*\r\n\t**\tNavigates to the given hash-based URL.\r\n\t*/\r\n\tnavigate: function (location, replace=false)\r\n\t{\r\n\t\tlocation = this.realLocation(location);\r\n\r\n\t\tif (globalThis.location.hash == '#'+location)\r\n\t\t{\r\n\t\t\tthis.refresh();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (replace)\r\n\t\t\tglobalThis.location.replace('#'+location);\r\n\t\telse\r\n\t\t\tglobalThis.location.hash = location;\r\n\t}\r\n};\r\n\r\n_Router.init();\r\n\r\nexport default _Router;\r\n","\nimport { Rinn, Model, Template } from 'rinn';\nimport Router from './router.js';\n\n/**\n * Map containing the original prototypes for all registered elements.\n */\nconst elementPrototypes = { };\n\n/**\n * Map containing the final classes for all registered elements.\n */\nconst elementClasses = { };\n\n/**\n * Base class for custom elements. Provides support for model-triggered events, easy definition of handlers for events originated in\n * self or child-elements, and several utility methods.\n */\n\nconst Element = \n{\n\t/**\n\t * Internal element ID. Added as namespace to model events. Ensures that certain model events are run locally only, not affecting other event handlers.\n\t */\n\teid: null,\n\n\t/**\n\t * Indicates if the element is a root element, that is, the target element to attach child elements having `data-ref` attribute.\n\t */\n\tisRoot: true,\n\n\t/**\n\t * Root element to which this element is attached (when applicable).\n\t */\n\troot: null,\n\n\t/**\n\t * Indicates ready-state of the element. Possible values are: 0: \"Not ready\", 1: \"Children Initialized\", and 2: \"Parent Ready\".\n\t */\n\tisReady: 0,\n\treadyReenter: 0,\n\treadyLocked: 0,\n\n\t/**\n\t * Model type (class) for the element's model.\n\t */\n\tmodelt: Model,\n\n\t/**\n\t * Data model related to the element.\n\t */\n\tmodel: null,\n\n\t/**\n\t * Contents of the element. When set, the innerHTML will be set to this value.\n\t */\n\tcontents: null,\n\n\t/**\n\t * \tEvents map.\n\t */\n\tevents:\n\t{\n\t\t'mousedown [data-long-press]': function (evt)\n\t\t{\n\t\t\tevt.continuePropagation = true;\n\t\t\tif (evt.source._long_press) return;\n\n\t\t\tlet elem = evt.source;\n\n\t\t\telem._long_press = setTimeout(() =>\n\t\t\t{\n\t\t\t\tlet dx = elem._pos_fx - elem._pos_sx;\n\t\t\t\tlet dy = elem._pos_fy - elem._pos_sy;\n\n\t\t\t\telem._long_press = null;\n\n\t\t\t\tlet d = Math.sqrt(dx*dx + dy*dy);\n\t\t\t\tif (d < 5) {\n\t\t\t\t\telem._long_press = false;\n\t\t\t\t\tthis.dispatchOn (elem, 'long-press');\n\t\t\t\t}\n\t\t\t},\n\t\t\t500);\n\n\t\t\telem._pos_sx = evt.clientX;\n\t\t\telem._pos_sy = evt.clientY;\n\n\t\t\telem._pos_fx = evt.clientX;\n\t\t\telem._pos_fy = evt.clientY;\n\t\t},\n\n\t\t'mousemove [data-long-press]': function (evt)\n\t\t{\n\t\t\tevt.continuePropagation = true;\n\t\t\tif (!evt.source._long_press) return;\n\n\t\t\tevt.source._pos_fx = evt.clientX;\n\t\t\tevt.source._pos_fy = evt.clientY;\n\t\t},\n\n\t\t'touchstart [data-long-press]': function (evt)\n\t\t{\n\t\t\tevt.continuePropagation = true;\n\t\t\tif (evt.source._long_press) return;\n\n\t\t\tlet elem = evt.source;\n\n\t\t\telem._long_press = setTimeout(() => {\n\t\t\t\tlet dx = elem._pos_fx - elem._pos_sx;\n\t\t\t\tlet dy = elem._pos_fy - elem._pos_sy;\n\n\t\t\t\telem._long_press = null;\n\n\t\t\t\tlet d = Math.sqrt(dx*dx + dy*dy);\n\t\t\t\tif (d < 5) {\n\t\t\t\t\telem._long_press = false;\n\t\t\t\t\tthis.dispatchOn (elem, 'long-press');\n\t\t\t\t}\n\t\t\t}, 500);\n\n\t\t\telem._pos_sx = evt.touches[0].clientX;\n\t\t\telem._pos_sy = evt.touches[0].clientY;\n\n\t\t\telem._pos_fx = evt.touches[0].clientX;\n\t\t\telem._pos_fy = evt.touches[0].clientY;\n\t\t},\n\n\t\t'touchmove [data-long-press]': function (evt)\n\t\t{\n\t\t\tevt.continuePropagation = true;\n\t\t\tif (!evt.source._long_press) return;\n\n\t\t\tevt.source._pos_fx = evt.touches[0].clientX;\n\t\t\tevt.source._pos_fy = evt.touches[0].clientY;\n\t\t},\n\n\t\t'mouseup [data-long-press]': function (evt)\n\t\t{\n\t\t\tif (evt.source._long_press === false)\n\t\t\t\treturn;\n\n\t\t\tif (evt.source._long_press) {\n\t\t\t\tclearTimeout(evt.source._long_press);\n\t\t\t\tevt.source._long_press = null;\n\t\t\t}\n\t\n\t\t\tevt.continuePropagation = true;\n\t\t},\n\t\n\t\t'touchend [data-long-press]': function (evt)\n\t\t{\n\t\t\tif (evt.source._long_press === false)\n\t\t\t\treturn;\n\t\n\t\t\tif (evt.source._long_press) {\n\t\t\t\tclearTimeout(evt.source._long_press);\n\t\t\t\tevt.source._long_press = null;\n\t\t\t}\n\t\n\t\t\tevt.continuePropagation = true;\n\t\t},\n\n\t\t'click [data-action]': function(evt)\n\t\t{\n\t\t\tif (evt.source._long_press === false)\n\t\t\t\treturn;\n\n\t\t\tlet opts = evt.source.dataset.action.split(' ');\n\n\t\t\tif (opts[0] in this)\n\t\t\t\tthis[opts[0]] ({ ...evt.params, ...evt.source.dataset, ...opts, length: opts.length }, evt);\n\t\t\telse\n\t\t\t\tevt.continuePropagation = true;\n\t\t},\n\n\t\t'long-press [data-long-press]': function(evt)\n\t\t{\n\t\t\tlet opts = evt.source.dataset.longPress.split(' ');\n\n\t\t\tif (opts[0] in this)\n\t\t\t\tthis[opts[0]] ({ ...evt.params, ...evt.source.dataset, ...opts, length: opts.length }, evt);\n\t\t\telse\n\t\t\t\tevt.continuePropagation = true;\n\t\t},\n\n\t\t'keyup(13) input[data-enter]': function(evt)\n\t\t{\n\t\t\tlet opts = evt.source.dataset.enter.split(' ');\n\n\t\t\tif (opts[0] in this)\n\t\t\t\tthis[opts[0]] ({ ...evt.params, ...evt.source.dataset, ...opts, length: opts.length }, evt);\n\t\t\telse\n\t\t\t\tevt.continuePropagation = true;\n\t\t}\n\t},\n\n\t/**\n\t * Internal routes map, set by `bindRoutes`.\n\t */\n\troutes: null,\n\n\t/**\n\t * \tElement constructor.\n\t */\n\t__ctor: function()\n\t{\n\t\tthis._list_watch = [];\n\t\tthis._list_visible = [];\n\t\tthis._list_property = [];\n\n\t\tif ('root' in this.dataset)\n\t\t{\n\t\t\tif (this.dataset.root == 'false')\n\t\t\t\tthis.isRoot = false;\n\t\t}\n\n\t\tthis.style.display = 'block';\n\n\t\tthis.eid = Math.random().toString().substr(2);\n\n\t\tif (this.model != null)\n\t\t{\n\t\t\tlet tmp = this.model;\n\t\t\tthis.model = null;\n\t\t\tthis.setModel (tmp, false);\n\t\t}\n\n\t\tObject.keys(this._super).reverse().forEach(i =>\n\t\t{\n\t\t\tif ('init' in this._super[i])\n\t\t\t\tthis._super[i].init();\n\t\t});\n\n\t\tif (Element.debug)\n\t\t\tconsole.log('>> ' + this.tagName + ' INIT ON ' + this.parentElement.tagName);\n\n\t\tthis.init();\n\n\t\tif (this.events)\n\t\t\tthis.bindEvents (this.events);\n\n\t\tif (this.contents)\n\t\t\tthis.setInnerHTML(this.contents);\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.tagName.toLowerCase() !== 'r-dom-probe')\n\t\t\t\tthis.appendChild(document.createElement('r-dom-probe'));\n\t\t\telse\n\t\t\t\tthis.markReady();\n\t\t}, 0);\n\t},\n\n\t/**\n\t * \tInitializes the element. Called after construction of the instance.\n\t */\n\tinit: function()\n\t{\n\t},\n\n\t/**\n\t * \tExecuted when the children of the element are ready.\n\t */\n\tready: function()\n\t{\n\t},\n\n\t/**\n\t * \tExecuted after ready and after the root is also ready.\n\t */\n\trready: function()\n\t{\n\t},\n\n\t/**\n\t * \tMarks the element as ready.\n\t */\n\tmarkReady: function (list=null)\n\t{\n\t\tthis.readyLocked++;\n\n\t\tif (!this.isReady)\n\t\t{\n\t\t\tthis.isReady = 1;\n\n\t\t\t// Set model is `model` property was set in the element.\n\t\t\tif ('model' in this.dataset)\n\t\t\t{\n\t\t\t\tlet ref = this.getFieldByPath(this.dataset.model);\n\t\t\t\tif (ref) this.setModel(ref);\n\t\t\t}\n\n\t\t\t// Run ready methods in class hierarchy.\n\t\t\tObject.keys(this._super).reverse().forEach(i =>\n\t\t\t{\n\t\t\t\tif ('ready' in this._super[i])\n\t\t\t\t\tthis._super[i].ready();\n\t\t\t});\n\n\t\t\tif (Element.debug)\n\t\t\t\tconsole.log('>> ' + this.tagName + ' READY');\n\n\t\t\tthis.ready();\n\t\t\tthis.collectWatchers();\n\t\t}\n\t\telse\n\t\t\tthis.collectWatchers();\n\n\t\tlet root = this.findCustomParent(this);\n\n\t\tif (Element.debug)\n\t\t\tconsole.log(this.tagName + ' ROOT IS ' + (root ? root.tagName : 'NULL'));\n\n\t\tif (root && root.isReady === 0 && this.isReady != 0)\n\t\t\troot.checkReady();\n\n\t\tlet rootReady = false;\n\n\t\tif (root && root.isReady === 2 && this.isReady !== 2)\n\t\t{\n\t\t\tthis.getRoot();\n\n\t\t\tif (this.root && this.dataset.ref)\n\t\t\t{\n\t\t\t\tif (Element.debug)\n\t\t\t\t\tconsole.log(this.tagName + ' REF AS `' + this.dataset.ref + '` ON ' + this.root.tagName);\n\n\t\t\t\tthis.root[this.dataset.ref] = this;\n\t\t\t\tthis.root.onRefAdded (this.dataset.ref, this);\n\t\t\t}\n\n\t\t\trootReady = true;\n\t\t}\n\n\t\tif (!root && this.isReady !== 2)\n\t\t{\n\t\t\trootReady = true;\n\t\t}\n\n\t\tif (rootReady)\n\t\t{\n\t\t\tthis.isReady = 2;\n\n\t\t\tif (list !== null) {\n\t\t\t\tfor (let elem of list)\n\t\t\t\t\telem.checkReady();\n\t\t\t}\n\n\t\t\tif (Element.debug)\n\t\t\t\tconsole.log('>> ' + this.tagName + ' RREADY');\n\n\t\t\tObject.keys(this._super).reverse().forEach(i =>\n\t\t\t{\n\t\t\t\tif ('rready' in this._super[i])\n\t\t\t\t\tthis._super[i].rready();\n\t\t\t});\n\t\t\n\t\t\tthis.rready();\n\t\t}\n\n\t\tthis.readyLocked--;\n\n\t\tif (this.readyReenter && !this.readyLocked)\n\t\t{\n\t\t\tthis.readyReenter = false;\n\t\t\tthis.checkReady();\n\t\t}\n\n\t\tif (this.tagName.toLowerCase() === 'r-dom-probe')\n\t\t\tthis.remove();\n\t},\n\n\t/**\n\t *\tChecks if all children are ready and fires the appropriate function (`ready` and/or `rready`).\n\t */\n\tcheckReady: function()\n\t{\n\t\tif (this.childNodes.length == 0)\n\t\t\treturn;\n\n\t\tif (this.readyLocked)\n\t\t{\n\t\t\tthis.readyReenter = true;\n\t\t\treturn;\n\t\t}\n\n\t\tlet isReady = true;\n\t\tlet list = [];\n\n\t\tlet result = document.evaluate(\".//*[contains(name(),'-')]\", this, null, XPathResult.ANY_TYPE, null);\n\n\t\tif (Element.debug)\n\t\t\tconsole.log('# CHECKING ' + this.tagName);\n\n\t\twhile (true)\n\t\t{\n\t\t\tlet elem = result.iterateNext();\n\t\t\tif (!elem) break;\n\n\t\t\tif (elem === this)\n\t\t\t\tcontinue;\n\n\t\t\tlet root = this.findCustomParent(elem);\n\t\t\tif (root !== this) continue;\n\n\t\t\tif (Element.debug)\n\t\t\t\tconsole.log('   ' + elem.tagName + ' = ' + elem.isReady);\n\n\t\t\tif (!elem.isReady)\n\t\t\t\tisReady = false;\n\n\t\t\tlist.push(elem);\n\t\t}\n\n\t\tif (!isReady) return;\n\n\t\tthis.markReady(list);\n\t},\n\n\t/**\n\t * \tReturns the value of a field given its path. Starts from `global`, unless the first item in the path is `this`, in which case it will start from the element.\n\t */\n\tgetFieldByPath: function(path)\n\t{\n\t\tif (!path) return null;\n\n\t\tlet tmp = path.split('.');\n\t\tlet ref = global;\n\n\t\tif (tmp.length && tmp[0] == 'this')\n\t\t{\n\t\t\tref = this;\n\t\t\ttmp.shift();\n\t\t}\n\n\t\tif (tmp.length && tmp[0] == 'root')\n\t\t{\n\t\t\tref = this.getRoot();\n\t\t\ttmp.shift();\n\t\t}\n\n\t\twhile (ref != null && tmp.length != 0)\n\t\t\tref = ref[tmp.shift()];\n\n\t\treturn ref;\n\t},\n\n\t/**\n\t * \tReturns the root of the element (that is, the `root` property). If not set it will attempt to find the root first.\n\t */\n\tgetRoot: function()\n\t{\n\t\treturn this.root ? this.root : (this.root = this.findRoot());\n\t},\n\n\t/**\n\t * \tSets the model of the element and executes the `modelChanged` event handler (unless `update` is set to false).\n\t */\n\tsetModel: function (model, update=true)\n\t{\n\t\tif (!model) return this;\n\n\t\tmodel = Rinn.ensureTypeOf(this.modelt, model);\n\n\t\tif (this.model !== model)\n\t\t{\n\t\t\tif (this.model != null)\n\t\t\t{\n\t\t\t\tthis.model.removeEventListener (this.eid+':modelChanged', this.onModelPreChanged, this);\n\t\t\t\tthis.model.removeEventListener (this.eid+':propertyChanging', this.onModelPropertyChanging, this);\n\t\t\t\tthis.model.removeEventListener (this.eid+':propertyChanged', this.onModelPropertyPreChanged, this);\n\t\t\t\tthis.model.removeEventListener (this.eid+':propertyRemoved', this.onModelPropertyRemoved, this);\n\t\t\t}\n\n\t\t\tthis.model = model;\n\n\t\t\tthis.model.addEventListener (this.eid+':modelChanged', this.onModelPreChanged, this);\n\t\t\tthis.model.addEventListener (this.eid+':propertyChanging', this.onModelPropertyChanging, this);\n\t\t\tthis.model.addEventListener (this.eid+':propertyChanged', this.onModelPropertyPreChanged, this);\n\t\t\tthis.model.addEventListener (this.eid+':propertyRemoved', this.onModelPropertyRemoved, this);\n\t\t}\n\n\t\tif (update !== false)\n\t\t\tthis.model.setNamespace(this.eid).update(true).setNamespace(null);\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * \tReturns the model of the element. Added for symmetry only, exactly the same as accesing public property `model` of this class.\n\t */\n\tgetModel: function ()\n\t{\n\t\treturn this.model;\n\t},\n\n\t/**\n\t * \tAdds one or more CSS classes (separated by space) to the element.\n\t */\n\taddClass: function (classString)\n\t{\n\t\tif (!classString) return this;\n\n\t\tclassString.split(' ').forEach(i =>\n\t\t{\n\t\t\ti = i.trim();\n\t\t\tif (!i) return;\n\n\t\t\tif (i[0] == '-' || i[0] == '+')\n\t\t\t\tthis.classList[i[0] == '-' ? 'remove' : 'add'](i.substr(1));\n\t\t\telse\n\t\t\t\tthis.classList.add(i);\n\t\t});\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * \tRemoves one or more CSS classes (separated by space) from the element.\n\t */\n\tremoveClass: function (classString)\n\t{\n\t\tif (!classString) return this;\n\n\t\tclassString.split(' ').forEach(i =>\n\t\t{\n\t\t\ti = i.trim();\n\t\t\tif (!i) return;\n\n\t\t\tif (i[0] == '-' || i[0] == '+')\n\t\t\t\tthis.classList[i[0] == '-' ? 'remove' : 'add'](i.substr(1));\n\t\t\telse\n\t\t\t\tthis.classList.remove(i);\n\t\t});\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * \tSets one or more style properties to the element (separated by semi-colon).\n\t */\n\tsetStyle: function (styleString)\n\t{\n\t\tif (!styleString) return this;\n\n\t\tstyleString.split(';').forEach(i => {\n\t\t\tlet j = (i = i.trim()).indexOf(':');\n\t\t\tif (j == -1) return;\n\n\t\t\tlet name = i.substr(0, j).trim();\n\t\t\tfor (let k = name.indexOf('-'); k != -1; k = name.indexOf('-')) {\n\t\t\t\tname = name.substr(0, k) + name.substr(k+1, 1).toUpperCase() + name.substr(k+2);\n\t\t\t}\n\n\t\t\tthis.style[name] = i.substr(j+1).trim();\n\t\t});\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * \tReturns the width of the specified element (or of itself it none provided), uses `getBoundingClientRect`.\n\t */\n\tgetWidth: function (elem=null)\n\t{\n\t\treturn (elem || this).getBoundingClientRect().width;\n\t},\n\n\t/**\n\t * \tReturns the height of the specified element (or of itself it none provided), uses `getBoundingClientRect`.\n\t */\n\tgetHeight: function (elem=null)\n\t{\n\t\treturn (elem || this).getBoundingClientRect().height;\n\t},\n\n\t/**\n\t**\tBinds all events in the specified map to the element, the events map can have one of the following forms:\n\t**\n\t**\t\t\"click .button\": \"doSomething\",\t\t(Delegated Event)\n\t**\t\t\"click .button\": function() { },\t(Delegated Event)\n\t**\t\t\"myevt &this\": \"...\",\t\t\t\t(Self Event)\n\t**\t\t\"myevt\": \"...\",\t\t\t\t\t\t(Element Event)\n\t**\t\t\"myevt @objName\": \"...\",\t\t\t(EventDispatcher Event)\n\t**\t\t\"#propname\": \"...\",\t\t\t\t\t(Property Changed Event)\n\t**\t\t\"keyup(10) .input\": \"...\"\t\t\t(Delegated Event with Parameters)\n\t**\n\t**\t>> Element bindEvents (object events);\n\t*/\n\tbindEvents: function (events)\n\t{\n\t\tfor (let evtstr in events)\n\t\t{\n\t\t\tlet hdl = events[evtstr];\n\n\t\t\tif (Rinn.typeOf(hdl) == 'string')\n\t\t\t\thdl = this[hdl];\n\n\t\t\thdl = hdl.bind(this);\n\n\t\t\tvar i = evtstr.indexOf(' ');\n\n\t\t\tvar name = i == -1 ? evtstr : evtstr.substr(0, i);\n\t\t\tvar selector = i == -1 ? '' : evtstr.substr(i + 1);\n\n\t\t\tlet args = null;\n\n\t\t\tvar j = name.indexOf('(');\n\t\t\tif (j != -1)\n\t\t\t{\n\t\t\t\targs = name.substr(j+1, name.length-j-2).split(',');\n\t\t\t\tname = name.substr(0, j);\n\t\t\t}\n\n\t\t\tif (selector[0] == '@')\n\t\t\t{\n\t\t\t\tif (selector != '@this')\n\t\t\t\t{\n\t\t\t\t\tthis[selector.substr(1)].addEventListener(name, hdl);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tselector = this;\n\t\t\t}\n\t\t\telse if (selector[0] == '&')\n\t\t\t{\n\t\t\t\tif (selector != '&this')\n\t\t\t\t\tselector = \"[data-ref='\"+selector.substr(1)+\"']\";\n\t\t\t\telse\n\t\t\t\t\tselector = this;\n\t\t\t}\n\n\t\t\tif (name.substr(0, 1) == '#')\n\t\t\t{\n\t\t\t\tthis.listen('propertyChanged.'+name.substr(1), this, hdl);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (args != null)\n\t\t\t{\n\t\t\t\tswitch (name)\n\t\t\t\t{\n\t\t\t\t\tcase 'keyup': case 'keydown':\n\t\t\t\t\t\tthis.listen (name, selector, function (evt)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (Rinn.indexOf(args, evt.keyCode.toString()) != -1)\n\t\t\t\t\t\t\t\treturn hdl (evt, args);\n\n\t\t\t\t\t\t\tevt.continuePropagation = true;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.listen (name, selector, hdl);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t/**\n\t**\tBinds all routes in the specified map to the Router object.\n\t**\n\t**\t\t\"route-path\": \"doSomething\"\t\t\t\t\t\tOn-Route\n\t**\t\t\"route-path\": function (evt, args) { }\t\t\tOn-Route\n\t**\t\t\"!route-path\": \"doSomething\"\t\t\t\t\tOn-UnRoute\n\t**\t\t\"!route-path\": function (evt, args) { }\t\t\tOn-UnRoute\n\t**\n\t**\t>> Element bindRoutes ();\n\t*/\n\tbindRoutes: function ()\n\t{\n\t\tif (!this.routes)\n\t\t\treturn;\n\n\t\tfor (let routeStr in this.routes)\n\t\t{\n\t\t\tlet route = routeStr[0] === '!' ? Router.getRoute(routeStr.substr(1)) : Router.getRoute(routeStr);\n\t\t\tlet handler = this.routes[routeStr];\n\n\t\t\tif (Rinn.typeOf(handler) === 'string')\n\t\t\t\thandler = this[handler];\n\n\t\t\tif (routeStr[0] === '!')\n\t\t\t\troute.addHandler(handler, true, this);\n\t\t\telse\n\t\t\t\troute.addHandler(handler, false, this);\n\t\t}\n\t},\n\n\t/**\n\t * Unbinds all routes added by bindRoutes.\n\t */\n\tunbindRoutes: function ()\n\t{\n\t\tif (!this.routes)\n\t\t\treturn;\n\n\t\tfor (let routeStr in this.routes)\n\t\t{\n\t\t\tlet route = routeStr[0] === '!' ? Router.getRoute(routeStr.substr(1)) : Router.getRoute(routeStr);\n\t\t\tlet handler = this.routes[routeStr];\n\n\t\t\tif (Rinn.typeOf(handler) === 'string')\n\t\t\t\thandler = this[handler];\n\n\t\t\tif (routeStr[0] === '!')\n\t\t\t\troute.removeHandler(handler, true, this);\n\t\t\telse\n\t\t\t\troute.removeHandler(handler, false, this);\n\t\t}\n\t},\n\n\t/**\n\t**\tExecutes the underlying event handler given an event and a selector. Called internally by listen().\n\t**\n\t**\t>> void _eventHandler (event evt, string selector, function handler);\n\t*/\n\t_eventHandler: function (evt, selector, handler)\n\t{\n\t\tif (evt.continuePropagation === false)\n\t\t\treturn;\n\n\t\tevt.continuePropagation = true;\n\t\tevt.source = evt.target;\n\n\t\tif (selector && selector instanceof HTMLElement)\n\t\t{\n\t\t\tif (evt.source === selector)\n\t\t\t{\n\t\t\t\tevt.continuePropagation = false;\n\n\t\t\t\tif (handler.call (this, evt, evt.detail) === true)\n\t\t\t\t\tevt.continuePropagation = true;\n\t\t\t}\n\t\t}\n\t\telse if (selector && selector != '*')\n\t\t{\n\t\t\tlet elems = this.querySelectorAll(selector);\n\n\t\t\twhile (evt.source !== this)\n\t\t\t{\n\t\t\t\tlet i = Rinn.indexOf (elems, evt.source, true);\n\t\t\t\tif (i !== -1)\n\t\t\t\t{\n\t\t\t\t\tevt.continuePropagation = false;\n\n\t\t\t\t\tif (handler.call (this, evt, evt.detail) === true)\n\t\t\t\t\t\tevt.continuePropagation = true;\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tevt.source = evt.source.parentElement;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tevt.continuePropagation = false;\n\n\t\t\tif (handler.call (this, evt, evt.detail) === true)\n\t\t\t\tevt.continuePropagation = true;\n\t\t}\n\n\t\tif (evt.continuePropagation === false)\n\t\t{\n\t\t\tevt.preventDefault();\n\t\t\tevt.stopPropagation();\n\t\t}\n\t},\n\n\t/**\n\t**\tListens for an event on elements matching the specified selector, returns an object with a single method `remove` used\n\t**\tto remove the listener when it is no longer needed.\n\t**\n\t**\t>> object listen (string eventName, string selector, function handler);\n\t**\t>> object listen (string eventName, function handler);\n\t*/\n\tlisten: function (eventName, selector, handler)\n\t{\n\t\tlet eventCatcher = false;\n\t\tlet eventImmediate = false;\n\n\t\tif (Rinn.typeOf(selector) == 'function')\n\t\t{\n\t\t\thandler = selector;\n\t\t\tselector = null;\n\t\t}\n\n\t\tif (eventName[eventName.length-1] == '!')\n\t\t{\n\t\t\teventName = eventName.substr(0, eventName.length-1);\n\t\t\teventCatcher = true;\n\t\t}\n\n\t\tif (eventName[0] == '!')\n\t\t{\n\t\t\teventName = eventName.substr(1);\n\t\t\teventImmediate = true;\n\t\t}\n\n\t\tlet callback0 = null;\n\t\tlet callback1 = null;\n\t\tlet self = this;\n\n\t\tthis.addEventListener (eventName, callback0 = (evt) =>\n\t\t{\n\t\t\tif (evt.continuePropagation === false)\n\t\t\t\treturn;\n\n\t\t\tif (!evt.firstCapture)\n\t\t\t{\n\t\t\t\tevt.firstCapture = this;\n\t\t\t\tevt.firstCaptureCount = 0;\n\t\t\t\tevt.queue = [];\n\t\t\t}\n\n\t\t\tif (evt.firstCapture === this)\n\t\t\t\tevt.firstCaptureCount++;\n\n\t\t\tif (eventCatcher == true)\n\t\t\t\tevt.queue.push([this, selector, handler]);\n\n\t\t\tif (eventImmediate == true)\n\t\t\t\tthis._eventHandler(evt, selector, handler);\n\t\t},\n\t\ttrue);\n\n\t\tthis.addEventListener (eventName, callback1 = (evt) =>\n\t\t{\n\t\t\tif (evt.continuePropagation === false)\n\t\t\t\treturn;\n\n\t\t\tif (eventCatcher != true && eventImmediate != true)\n\t\t\t\tthis._eventHandler(evt, selector, handler);\n\n\t\t\tif (evt.firstCapture === this && evt.continuePropagation !== false)\n\t\t\t{\n\t\t\t\tif (--evt.firstCaptureCount == 0)\n\t\t\t\t{\n\t\t\t\t\twhile (evt.queue.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet q = evt.queue.pop();\n\t\t\t\t\t\tq[0]._eventHandler(evt, q[1], q[2]);\n\t\t\t\t\t}\n\n\t\t\t\t\tevt.continuePropagation = false;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tfalse);\n\n\t\treturn {\n\t\t\tremoved: false,\n\t\t\tremove: function() {\n\t\t\t\tif (this.removed) return;\n\t\t\t\tthis.removed = true;\n\t\t\t\tself.removeEventListener(eventName, callback0, true);\n\t\t\t\tself.removeEventListener(eventName, callback1, false);\n\t\t\t}\n\t\t};\n\t},\n\n\t/**\n\t**\tCreates an event object for later dispatch.\n\t*/\n\tcreateEventObject: function(eventName, args, bubbles)\n\t{\n\t\tlet evt;\n\n\t\tif (eventName == 'click')\n\t\t\tevt = new MouseEvent(eventName, { bubbles: bubbles, detail: args });\n\t\telse\n\t\t\tevt = new CustomEvent (eventName, { bubbles: bubbles, detail: args });\n\n\t\treturn evt;\n\t},\n\n\t/**\n\t**\tDispatches a new event with the specified name and the given arguments.\n\t*/\n\tdispatch: function (eventName, args=null, bubbles=true)\n\t{\n\t\tthis.dispatchEvent (this.createEventObject(eventName, args, bubbles));\n\t},\n\n\t/**\n\t**\tDispatches a new event on the specified element with the given name and arguments (uses `CustomEvent`).\n\t*/\n\tdispatchOn: function (elem, eventName, args=null, bubbles=true)\n\t{\n\t\telem.dispatchEvent (this.createEventObject(eventName, args, bubbles));\n\t},\n\n\t/**\n\t**\tSets the innerHTML property of the element and runs some post set-content tasks.\n\t**\n\t**\t>> void setInnerHTML (value);\n\t*/\n\tsetInnerHTML: function (value)\n\t{\n\t\tthis.readyLocked++;\n\t\tthis.innerHTML = value;\n\t\tthis.readyLocked--;\n\t},\n\n\t/**\n\t**\tCollects all watchers (data-watch, data-visible, data-property), that depend on the model, should be invoked when the structure\n\t**\tof the element changed (added/removed children). This is automatically called when the setInnerHTML method is called.\n\t**\n\t**\tNote that for 3rd party libs that add children to this element (which could probably have a watcher) will possibly result in\n\t**\tduplication of the added elements when compiling the innerHTML template. To prevent this add the 'pseudo' CSS class to any\n\t**\telement that should not be added to the HTML template.\n\t**\n\t**\t>> void collectWatchers ();\n\t*/\n\tcollectWatchers: function ()\n\t{\n\t\tlet self = this;\n\t\tlet modified = false;\n\t\tlet list;\n\n\t\tif (!this.isRoot) return;\n\n\t\tlet _list_watch_length = this._list_watch.length;\n\t\tlet _list_visible_length = this._list_visible.length;\n\t\tlet _list_property_length = this._list_property.length;\n\n\t\t/* *** */\n\t\tlist = this.querySelectorAll('[data-watch]');\n\t\tfor (let i = 0; i < list.length; i++)\n\t\t{\n\t\t\tfor (let j of list[i].querySelectorAll('.pseudo'))\n\t\t\t\tj.remove();\n\n\t\t\tlist[i]._template = Template.compile(list[i].innerHTML);\n\t\t\tlist[i]._watch = new RegExp('^(' + list[i].dataset.watch + ')$');\n\t\t\tlist[i].innerHTML = '';\n\n\t\t\tlist[i].removeAttribute('data-watch');\n\t\t\tthis._list_watch.push(list[i]);\n\t\t}\n\n\t\tif ('selfWatch' in this.dataset)\n\t\t{\n\t\t\tfor (let j of this.querySelectorAll('.pseudo'))\n\t\t\t\tj.remove();\n\n\t\t\tthis._template = Template.compile(this.innerHTML);\n\t\t\tthis._watch = new RegExp('^(' + this.dataset.selfWatch + ')$');\n\t\t\tthis.innerHTML = '';\n\n\t\t\tthis.removeAttribute('data-self-watch');\n\t\t\tthis._list_watch.push(this);\n\t\t}\n\n\t\t/* *** */\n\t\tlist = this.querySelectorAll('[data-visible]');\n\t\tfor (let i = 0; i < list.length; i++)\n\t\t{\n\t\t\tlist[i]._visible = Template.compile(list[i].dataset.visible);\n\n\t\t\tlist[i].removeAttribute('data-visible');\n\t\t\tthis._list_visible.push(list[i]);\n\t\t}\n\n\t\tif ('selfVisible' in this.dataset)\n\t\t{\n\t\t\tthis._visible = Template.compile(this.dataset.selfVisible);\n\n\t\t\tthis.removeAttribute('data-self-visible');\n\t\t\tthis._list_visible.push(this);\n\t\t}\n\n\t\t/* *** */\n\t\tlist = this.querySelectorAll('[data-property]');\n\t\tfor (let i = 0; i < list.length; i++)\n\t\t{\n\t\t\tlist[i].onchange = list[i].onblur = function()\n\t\t\t{\n\t\t\t\tswitch (this.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'radio':\n\t\t\t\t\t\tif (this.checked) self.getModel().set(this.name, this.value);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\tself.getModel().set(this.name, this.checked ? '1' : '0');\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'field':\n\t\t\t\t\t\tself.getModel().set(this.name, this.getValue());\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tself.getModel().set(this.name, this.value);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (list[i].tagName == 'SELECT')\n\t\t\t{\n\t\t\t\tlist[i].onmouseup = function()\n\t\t\t\t{\n\t\t\t\t\tself.getModel().set(this.name, this.value);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tlist[i].name = list[i].dataset.property;\n\n\t\t\tlist[i].removeAttribute('data-property');\n\t\t\tthis._list_property.push(list[i]);\n\t\t}\n\n\t\tif ('selfProperty' in this.dataset)\n\t\t{\n\t\t\tthis.onchange = this.onblur = function()\n\t\t\t{\n\t\t\t\tswitch (this.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'radio':\n\t\t\t\t\t\tif (this.checked) self.getModel().set(this.name, this.value);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\tself.getModel().set(this.name, this.checked ? '1' : '0');\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'field':\n\t\t\t\t\t\tself.getModel().set(this.name, this.getValue());\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tself.getModel().set(this.name, this.value);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (this.tagName == 'SELECT')\n\t\t\t{\n\t\t\t\tthis.onmouseup = function()\n\t\t\t\t{\n\t\t\t\t\tself.getModel().set(this.name, this.value);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tthis.name = this.dataset.selfProperty;\n\n\t\t\tthis.removeAttribute('data-self-property');\n\t\t\tthis._list_property.push(this);\n\t\t}\n\n\t\t/* *** */\n\t\tthis._list_watch = this._list_watch.filter(i => i.parentElement != null);\n\t\tif (_list_watch_length != this._list_watch.length) modified = true;\n\n\t\tthis._list_visible = this._list_visible.filter(i => i.parentElement != null);\n\t\tif (_list_visible_length != this._list_visible.length) modified = true;\n\n\t\tthis._list_property = this._list_property.filter(i => i.parentElement != null);\n\t\tif (_list_property_length != this._list_property.length) modified = true;\n\n\t\tif (this.model != null && modified)\n\t\t\tthis.model.setNamespace(this.eid).update(true).setNamespace(null);\n\t},\n\n\t/**\n\t**\tExecuted when the element is created and yet not attached to the DOM tree.\n\t*/\n\tonCreated: function()\n\t{\n\t},\n\n\t/**\n\t * Executed when the element is attached to the DOM tree.\n\t */\n\telementConnected: function()\n\t{\n\t\tthis.bindRoutes();\n\t\tthis.onConnected();\n\t},\n\n\t/**\n\t * Executed when the element is no longer a part of the DOM tree.\n\t */\n\telementDisconnected: function()\n\t{\n\t\tthis.unbindRoutes();\n\t},\n\n\t/**\n\t**\tExecuted when the element is attached to the DOM tree.\n\t*/\n\tonConnected: function()\n\t{\n\t},\n\n\t/**\n\t**\tExecuted when the element is no longer a part of the DOM tree.\n\t*/\n\tonDisconnected: function()\n\t{\n\t},\n\n\t/**\n\t**\tExecuted on the root element when a child element has `data-ref` attribute and it was added to it.\n\t*/\n\tonRefAdded: function (name, element)\n\t{\n\t},\n\n\t/**\n\t**\tExecuted on the root element when a child element has `data-ref` attribute and it was removed from it.\n\t*/\n\tonRefRemoved: function (name, element)\n\t{\n\t},\n\n\t/**\n\t**\tEvent handler invoked when the model has changed, executed before onModelChanged() to update internal dependencies,\n\t**\tshould not be overriden or elements watching the model will not be updated.\n\t**\n\t**\t>> void onModelPreChanged (evt, args);\n\t*/\n\tonModelPreChanged: function (evt, args)\n\t{\n\t\tlet data = this.getModel().get();\n\n\t\tfor (let i = 0; i < this._list_watch.length; i++)\n\t\t{\n\t\t\tfor (let j of args.fields)\n\t\t\t{\n\t\t\t\tif (!this._list_watch[i]._watch.test(j))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tthis._list_watch[i].innerHTML = this._list_watch[i]._template(data);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < this._list_visible.length; i++)\n\t\t{\n\t\t\tif (!!this._list_visible[i]._visible(data, 'arg'))\n\t\t\t\tthis._list_visible[i].style.removeProperty('display');\n\t\t\telse\n\t\t\t\tthis._list_visible[i].style.setProperty('display', 'none', 'important');\n\t\t}\n\n\t\tthis.onModelChanged(evt, args);\n\t},\n\n\t/**\n\t**\tEvent handler invoked when the model has changed.\n\t*/\n\tonModelChanged: function (evt, args) // @override\n\t{\n\t},\n\n\t/**\n\t**\tEvent handler invoked when a property of the model is changing. Fields `name` and `value` can be found in the `args` object.\n\t*/\n\tonModelPropertyChanging: function (evt, args) // @override\n\t{\n\t},\n\n\t/**\n\t**\tEvent handler invoked when a property of the model has changed, executed before onModelPropertyChanged() to update internal\n\t**\tdependencies. Automatically triggers internal events named `propertyChanged.<propertyName>` and `propertyChanged`.\n\t**\tShould not be overriden or elements depending on the property will not be updated.\n\t*/\n\tonModelPropertyPreChanged: function (evt, args)\n\t{\n\t\tfor (let i = 0; i < this._list_property.length; i++)\n\t\t{\n\t\t\tif (this._list_property[i].name == args.name)\n\t\t\t{\n\t\t\t\tlet trigger = true;\n\n\t\t\t\tswitch (this._list_property[i].type)\n\t\t\t\t{\n\t\t\t\t\tcase 'radio':\n\t\t\t\t\t\tif (this._list_property[i].value != args.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis._list_property[i].parentElement.classList.remove('active');\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._list_property[i].checked = true;\n\t\t\t\t\t\tthis._list_property[i].parentElement.classList.add('active');\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\tif (~~args.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis._list_property[i].checked = true;\n\t\t\t\t\t\t\tthis._list_property[i].parentElement.classList.add('active');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis._list_property[i].checked = false;\n\t\t\t\t\t\t\tthis._list_property[i].parentElement.classList.remove('active');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'field':\n\t\t\t\t\t\tthis._list_property[i].val = this._list_property[i].dataset.value = args.value;\t\n\t\t\t\t\t\tthis._list_property[i].setValue (args.value);\n\t\t\t\t\t\ttrigger = false;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis._list_property[i].value = args.value;\n\t\t\t\t\t\tthis._list_property[i].val = this._list_property[i].dataset.value = args.value;\t\n\n\t\t\t\t\t\tif (this._list_property[i].value != args.value)\n\t\t\t\t\t\t\ttrigger = false;\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (trigger && this._list_property[i].onchange)\n\t\t\t\t\tthis._list_property[i].onchange();\n\t\t\t}\n\t\t}\n\n\t\tthis.dispatch ('propertyChanged.' + args.name, args, false);\n\t\tthis.dispatch ('propertyChanged', args, false);\n\n\t\tthis.onModelPropertyChanged(evt, args);\n\t},\n\n\t/**\n\t**\tEvent handler invoked when a property of the model has changed.\n\t*/\n\tonModelPropertyChanged: function (evt, args) // @override\n\t{\n\t},\n\n\t/**\n\t**\tEvent handler invoked when a property of the model is removed. Field `name` can be found in the `args` object.\n\t*/\n\tonModelPropertyRemoved: function (evt, args) // @override\n\t{\n\t},\n\n\t/*\n\t**\tRuns the following preparation procedures on the specified prototype:\n\t**\t\t- All functions named 'event <event-name> [event-selector]' will be moved to the 'events' map.\n\t**\t\t- All functions named 'route <route-path>' will be moved to the 'routes' map.\n\t**\n\t**\t>> void preparePrototype (object proto);\n\t*/\n\tpreparePrototype: function (proto)\n\t{\n\t\tif (proto.__prototypePrepared === true)\n\t\t\treturn;\n\n\t\tproto.__prototypePrepared = true;\n\n\t\tif (!proto.hasOwnProperty('events') || !proto.events)\n\t\t\tproto.events = { };\n\n\t\tif (!proto.hasOwnProperty('routes') || !proto.routes)\n\t\t\tproto.routes = { };\n\n\t\tfor (let i in proto)\n\t\t{\n\t\t\tif (i.startsWith('event '))\n\t\t\t{\n\t\t\t\tproto.events[i.substr(6)] = proto[i];\n\t\t\t\tdelete proto[i];\n\t\t\t}\n\t\t\telse if (i.startsWith('route '))\n\t\t\t{\n\t\t\t\tproto.routes[i.substr(6)] = proto[i];\n\t\t\t\tdelete proto[i];\n\t\t\t}\n\t\t}\n\t},\n\n\t/*\n\t**\tRegisters a new custom element with the specified name. Extra functionality can be added with one or more prototypes, by default\n\t**\tall elements also get the `Element` prototype. Note that the final prototypes of all registered elements are stored, and if you want\n\t**\tto inherit another element's prototype just provide its name (string) in the protos argument list.\n\t**\n\t**\t>> class register (string name, ...(object|string) protos);\n\t*/\n\tregister: function (name, ...protos)\n\t{\n\t\tconst newElement = class extends HTMLElement\n\t\t{\n\t\t\tconstructor()\n\t\t\t{\n\t\t\t\tsuper();\n\t\t\t\tthis.invokeConstructor = true;\n\n\t\t\t\tif (Element.debug)\n\t\t\t\t\tconsole.log('CREATED ' + this.tagName);\n\n\t\t\t\tthis._super = { };\n\n\t\t\t\tfor (let i of Object.entries(this.constructor.prototype._super))\n\t\t\t\t{\n\t\t\t\t\tthis._super[i[0]] = { };\n\n\t\t\t\t\tfor (let j of Object.entries(i[1])) {\n\t\t\t\t\t\tthis._super[i[0]][j[0]] = j[1].bind(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.onCreated();\n\t\t\t}\n\n\t\t\tfindRoot (srcElement)\n\t\t\t{\n\t\t\t\tlet elem = srcElement ? srcElement : this.parentElement;\n\n\t\t\t\twhile (elem != null)\n\t\t\t\t{\n\t\t\t\t\tif ('isRoot' in elem && elem.isRoot === true)\n\t\t\t\t\t\treturn elem;\n\n\t\t\t\t\telem = elem.parentElement;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfindCustomParent (srcElement)\n\t\t\t{\n\t\t\t\tlet elem = srcElement ? srcElement.parentElement : this.parentElement;\n\n\t\t\t\twhile (elem != null)\n\t\t\t\t{\n\t\t\t\t\tif (elem.tagName.indexOf('-') !== -1)\n\t\t\t\t\t\treturn elem;\n\n\t\t\t\t\telem = elem.parentElement;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconnectReference (root=null, flags=255)\n\t\t\t{\n\t\t\t\tif (!this.root && (flags & 1) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (root == null) root = this.findRoot();\n\t\t\t\t\tif (root != null)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.dataset.ref)\n\t\t\t\t\t\t\troot[this.dataset.ref] = this;\n\n\t\t\t\t\t\tthis.root = root;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconnectedCallback ()\n\t\t\t{\n\t\t\t\tthis.connectReference(null, 1);\n\n\t\t\t\tif (this.invokeConstructor)\n\t\t\t\t{\n\t\t\t\t\tthis.invokeConstructor = false;\n\t\t\t\t\tthis.__ctor();\n\t\t\t\t}\n\n\t\t\t\tthis.connectReference(null, 2);\n\t\t\t\tthis.elementConnected();\n\n\t\t\t\tif (this.dataset.xref)\n\t\t\t\t\tglobalThis[this.dataset.xref] = this;\n\t\t\t}\n\n\t\t\tdisconnectedCallback()\n\t\t\t{\n\t\t\t\tif (this.root)\n\t\t\t\t{\n\t\t\t\t\tif (this.dataset.ref)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.root.onRefRemoved (this.dataset.ref, this);\n\n\t\t\t\t\t\tdelete this.root[this.dataset.ref];\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.root = null;\n\t\t\t\t}\n\n\t\t\t\tthis.elementDisconnected();\n\n\t\t\t\tif (this.dataset.xref)\n\t\t\t\t\tdelete globalThis[this.dataset.xref];\n\t\t\t}\n\t\t};\n\n\t\tRinn.override (newElement.prototype, Element);\n\n\t\tconst proto = { };\n\t\tconst _super = { };\n\t\tconst events = Rinn.clone(Element.events);\n\n\t\tlet __init = true;\n\t\tlet __ready = true;\n\t\tlet __rready = true;\n\t\tlet __check;\n\n\t\tfor (let i = 0; i < protos.length; i++)\n\t\t{\n\t\t\tif (!protos[i]) continue;\n\n\t\t\tif (Rinn.typeOf(protos[i]) == 'string')\n\t\t\t{\n\t\t\t\tconst name = protos[i];\n\n\t\t\t\tprotos[i] = elementPrototypes[name];\n\t\t\t\tif (!protos[i]) continue;\n\n\t\t\t\t_super[name] = { };\n\n\t\t\t\tfor (let f in protos[i])\n\t\t\t\t{\n\t\t\t\t\tif (Rinn.typeOf(protos[i][f]) != 'function')\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t_super[name][f] = protos[i][f];\n\t\t\t\t}\n\n\t\t\t\t__init = false;\n\t\t\t\t__ready = false;\n\t\t\t\t__rready = false;\n\t\t\t\t__check = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tElement.preparePrototype(protos[i]);\n\t\t\t\t__check = true;\n\t\t\t}\n\n\t\t\tif ('_super' in protos[i])\n\t\t\t\tRinn.override (_super, protos[i]._super);\n\n\t\t\tif ('events' in protos[i])\n\t\t\t\tRinn.override (events, protos[i].events);\n\n\t\t\tRinn.override (newElement.prototype, protos[i]);\n\t\t\tRinn.override (proto, protos[i]);\n\n\t\t\tif (__check)\n\t\t\t{\n\t\t\t\tif (!__init && 'init' in protos[i]) __init = true;\n\t\t\t\tif (!__ready && 'ready' in protos[i]) __ready = true;\n\t\t\t\tif (!__rready && 'rready' in protos[i]) __rready = true;\n\t\t\t}\n\t\t}\n\n\t\tlet dummy = function(){};\n\n\t\tif (!__init)\n\t\t{\n\t\t\tnewElement.prototype.init = dummy;\n\t\t\tproto.init = dummy;\n\t\t}\n\n\t\tif (!__ready)\n\t\t{\n\t\t\tnewElement.prototype.ready = dummy;\n\t\t\tproto.ready = dummy;\n\t\t}\n\n\t\tif (!__rready)\n\t\t{\n\t\t\tnewElement.prototype.rready = dummy;\n\t\t\tproto.rready = dummy;\n\t\t}\n\n\t\tnewElement.prototype._super = _super;\n\t\tnewElement.prototype.events = events;\n\n\t\tproto._super = _super;\n\t\tproto.events = events;\n\n\t\tcustomElements.define (name, newElement);\n\n\t\telementPrototypes[name] = proto;\n\t\telementClasses[name] = newElement;\n\n\t\treturn newElement;\n\t},\n\n\t/*\n\t**\tExpands an already created custom element with the specified prototype(s).\n\t**\n\t**\t>> void expand (string elementName, ...object protos);\n\t*/\n\texpand: function (name, ...protos)\n\t{\n\t\tif (!(name in elementPrototypes))\n\t\t\treturn;\n\n\t\tconst self = elementPrototypes[name];\n\t\tconst elem = elementClasses[name];\n\n\t\tconst _super = self._super;\n\t\tconst events = self.events;\n\n\t\tfor (let proto of protos)\n\t\t{\n\t\t\tElement.preparePrototype(proto);\n\n\t\t\tif ('_super' in proto)\n\t\t\t\tRinn.override (_super, proto._super);\n\n\t\t\tif ('events' in proto)\n\t\t\t\tRinn.override (events, proto.events);\n\n\t\t\tRinn.override (elem.prototype, proto);\n\t\t\tRinn.override (self, proto);\n\t\t}\n\n\t\telem.prototype._super = _super;\n\t\telem.prototype.events = events;\n\n\t\tself._super = _super;\n\t\tself.events = events;\n\t},\n\n\t/*\n\t**\tAppends a hook to a function of a custom element.\n\t*/\n\thookAppend: function (name, functionName, newFunction)\n\t{\n\t\tif (!(name in elementPrototypes))\n\t\t\treturn;\n\n\t\tlet hook1 = Rinn.hookAppend(elementPrototypes[name], functionName, newFunction);\n\t\tlet hook2 = Rinn.hookAppend(elementClasses[name].prototype, functionName, newFunction);\n\n\t\treturn { \n\t\t\tunhook: function() {\n\t\t\t\thook1.unhook();\n\t\t\t\thook2.unhook();\n\t\t\t}\n\t\t};\n\t},\n\n\t/*\n\t**\tPrepends a hook to a function of a custom element.\n\t*/\n\thookPrepend: function (name, functionName, newFunction)\n\t{\n\t\tif (!(name in elementPrototypes))\n\t\t\treturn;\n\n\t\tlet hook1 = Rinn.hookPrepend(elementPrototypes[name], functionName, newFunction);\n\t\tlet hook2 = Rinn.hookPrepend(elementClasses[name].prototype, functionName, newFunction);\n\n\t\treturn { \n\t\t\tunhook: function() {\n\t\t\t\thook1.unhook();\n\t\t\t\thook2.unhook();\n\t\t\t}\n\t\t};\n\t},\n\n\t/**\n\t**\tBuilt-in action handlers.\n\t*/\n\n\t/**\n\t**\t:toggleClass <className> [<selector>]\n\t**\n\t**\tToggles a CSS class on the element.\n\t*/\n\t':toggleClass': function (args, evt)\n\t{\n\t\tlet elem = evt.source;\n\n\t\tif ('2' in args)\n\t\t\telem = document.querySelector(args[2]);\n\n\t\tif (!elem) return;\n\n\t\tif (elem.classList.contains(args[1]))\n\t\t\telem.classList.remove(args[1]);\n\t\telse\n\t\t\telem.classList.add(args[1]);\n\t},\n\n\t/**\n\t**\t:setClass <className> [<selector>]\n\t**\n\t**\tSets a CSS class on the element.\n\t*/\n\t':setClass': function (args, evt)\n\t{\n\t\tlet elem = evt.source;\n\n\t\tif ('2' in args)\n\t\t\telem = document.querySelector(args[2]);\n\n\t\tif (!elem) return;\n\n\t\telem.classList.add(args[1]);\n\t},\n\n\t/**\n\t**\t:volatileClass <className> [<selector>]\n\t**\n\t**\tAdds the CSS class to the element and any click outside will cause it to be removed.\n\t*/\n\t':volatileClass': function (args, evt)\n\t{\n\t\tlet elem = evt.source;\n\n\t\tif ('2' in args)\n\t\t\telem = document.querySelector(args[2]);\n\n\t\tif (!elem) return;\n\n\t\telem.classList.add(args[1]);\n\n\t\tlet fn = () => {\n\t\t\twindow.removeEventListener('click', fn, true);\n\t\t\telem.classList.remove(args[1]);\n\t\t};\n\n\t\twindow.addEventListener('click', fn, true);\n\t},\n\n\t/**\n\t**\t:toggleClassUnique <className> <parentSelector> <childSelector>\n\t**\n\t**\tToggles a CSS class on the element and only one element in the selected parent can have the class.\n\t*/\n\t':toggleClassUnique': function (args, evt)\n\t{\n\t\tlet elem = evt.source;\n\t\tif (!elem) return;\n\n\t\tif (elem.classList.contains(args[1]))\n\t\t{\n\t\t\telem.classList.remove(args[1]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\telem.querySelectorParent(args[2]).querySelectorAll(args[3]).forEach(elem => elem.classList.remove(args[1]));\n\t\t\telem.classList.add(args[1]);\n\t\t}\n\t},\n\n\t/**\n\t**\t:setClassUnique <className> <parentSelector> <childSelector>\n\t**\n\t**\tSets a CSS class on the element and only that element in the selected parent can have the class.\n\t*/\n\t':setClassUnique': function (args, evt)\n\t{\n\t\tlet elem = evt.source;\n\t\tif (!elem) return;\n\n\t\telem.querySelectorParent(args[2]).querySelectorAll(args[3]).forEach(elem => elem.classList.remove(args[1]));\n\t\telem.classList.add(args[1]);\n\t}\n};\n\nElement.debug = false;\n\nElement.register('r-elem', {\n});\n\nElement.register ('r-dom-probe', {\n});\n\n/* ****************************************** */\n\n/**\n * Finds the parent element given a selector.\n */\nHTMLElement.prototype.querySelectorParent = function (selector)\n{\n\tlet elem = this;\n\n\twhile (elem != null)\n\t{\n\t\tif (elem.matches(selector))\n\t\t\tbreak;\n\n\t\telem = elem.parentElement;\n\t}\n\n\treturn elem;\n};\n\nexport default Element;\n","\r\nimport base64 from 'base-64';\r\n\r\n/**\r\n * API interface utility functions.\r\n */\r\n\r\nconst Api =\r\n{\r\n\t/**\r\n\t * Flags constants.\r\n\t */\r\n\tREQUEST_PACKAGE_SUPPORTED:\t0x01,\r\n\tREQ64_SUPPORTED: \t\t\t0x02,\r\n\tJSON_RESPONSE_SUPPORTED: \t0x04,\r\n\tXML_RESPONSE_SUPPORTED: \t0x08,\r\n\tINCLUDE_CREDENTIALS:\t\t0x10,\r\n\tUNIQUE_STAMP:\t\t\t\t0x20,\r\n\r\n\t/**\r\n\t * Target URL for all the API requests. Set by calling `setEndPoint`.\r\n\t */\r\n\tapiUrl: \"/api\",\r\n\r\n\t/**\r\n\t * Capabilities flag.\r\n\t */\r\n\tflags: 0x01 | 0x02 | 0x04 | 0x08 | 0x10 | 0x20,\r\n\r\n\t/**\r\n\t * Indicates if all request data will be packed into a req64 parameter instead of individual fields.\r\n\t */\r\n\tuseReq64: false,\r\n\r\n\t/**\r\n\t * Number of retries to execute each API call before giving up and invoking error handlers.\r\n\t */\r\n\tretries: 0,\r\n\r\n\t/**\r\n\t * Headers for the request.\r\n\t */\r\n\theaders: { },\r\n\r\n\t/**\r\n\t * Level of the current request. Used to detect nested requests.\r\n\t */\r\n\t_requestLevel: 0,\r\n\r\n\t/**\r\n\t * Indicates if all API calls should be bundled in a request package. Activated by calling the packageBegin() function and finished with packageEnd().\r\n\t */\r\n\t_requestPackage: 0,\r\n\r\n\t/**\r\n\t * When in package-mode, this contains the package data to be sent upon a call to packageEnd().\r\n\t */\r\n\t_packageData: [],\r\n\r\n\t/**\r\n\t * Sets the API end-point URL address.\r\n\t */\r\n\tsetEndPoint: function (apiUrl, flags=null)\r\n\t{\r\n\t\tthis.apiUrl = apiUrl;\r\n\t\tthis.flags = flags ?? this.flags;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * Overridable filter that processes the response from the server and returns true if it was successful. The `res` parameter indicates the response data, and `req` the request data.\r\n\t */\r\n\tresponseFilter: function (res, req)\r\n\t{\r\n\t\treturn true;\r\n\t},\r\n\r\n\t/**\r\n\t * Starts \"package-mode\" (using the `rpkg` field). Any API calls after this will be bundled together.\r\n\t */\r\n\tpackageBegin: function ()\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t\treturn;\r\n\r\n\t\tthis._requestPackage++;\r\n\t},\r\n\r\n\t/**\r\n\t * Finishes \"package-mode\" and a single API request with the currently constructed package will be sent.\r\n\t */\r\n\tpackageEnd: function (callback)\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t\treturn;\r\n\r\n\t\tif (!this._requestPackage)\r\n\t\t\treturn;\r\n\r\n\t\tif (--this._requestPackage)\r\n\t\t\treturn;\r\n\r\n\t\tthis.packageSend(callback);\r\n\t},\r\n\r\n\t/**\r\n\t * Starts package-mode, executes the callback and finishes package-mode. Therefore any requests made by the callback will be packed together.\r\n\t */\r\n\tpackRequests: function (callback, responseCallback=null)\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.packageBegin();\r\n\t\tcallback();\r\n\t\tthis.packageEnd(responseCallback);\r\n\t},\r\n\r\n\t/**\r\n\t * Sends a single API request with the currently constructed package and maintains package-mode.\r\n\t */\r\n\tpackageSend: function (callback)\r\n\t{\r\n\t\tif (!(this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t\treturn;\r\n\r\n\t\tif (!this._packageData.length)\r\n\t\t\treturn;\r\n\r\n\t\tlet _packageData = this._packageData;\r\n\t\tthis._packageData = [];\r\n\r\n\t\tvar rpkg = \"\";\r\n\r\n\t\tfor (var i = 0; i < _packageData.length; i++)\r\n\t\t\trpkg += \"r\"+i+\",\"+base64.encode(this.encodeParams(_packageData[i][2]))+\";\";\r\n\r\n\t\tthis._showProgress();\r\n\r\n\t\tthis.apiCall (\r\n\t\t\t{ rpkg: rpkg },\r\n\r\n\t\t\t(res, req) =>\r\n\t\t\t{\r\n\t\t\t\tthis._hideProgress();\r\n\r\n\t\t\t\tfor (let i = 0; i < _packageData.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar response = res[\"r\"+i];\r\n\t\t\t\t\t\tif (!response)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (_packageData[i][1] != null) _packageData[i][1] (_packageData[i][2]);\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (_packageData[i][0] != null)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (this.responseFilter (response, _packageData[i][2]))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t_packageData[i][0] (response, _packageData[i][2]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (e) {\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (callback) callback();\r\n\t\t\t},\r\n\r\n\t\t\t(req) =>\r\n\t\t\t{\r\n\t\t\t\tthis._hideProgress();\r\n\r\n\t\t\t\tfor (let i = 0; i < _packageData.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (_packageData[i][1] != null) _packageData[i][1] (_packageData[i][2]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t},\r\n\r\n\t/**\r\n\t * Adds CSS class 'busy' to the HTML root element, works only if running inside a browser.\r\n\t */\r\n\t_showProgress: function ()\r\n\t{\r\n\t\tif ('document' in global) {\r\n\t\t\tthis._requestLevel++;\r\n\t\t\tif (this._requestLevel > 0) global.document.documentElement.classList.add('busy');\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Removes the 'busy' CSS class from the HTML element.\r\n\t */\r\n\t_hideProgress: function ()\r\n\t{\r\n\t\tif ('document' in global)\r\n\t\t{\r\n\t\t\tthis._requestLevel--;\r\n\t\t\tif (this._requestLevel) return;\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (this._requestLevel === 0)\r\n\t\t\t\t\tglobal.document.documentElement.classList.remove('busy');\r\n\t\t\t}, 250);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Sets an HTTP header.\r\n\t */\r\n\theader: function (name, value)\r\n\t{\r\n\t\tif (value === null)\r\n\t\t\tdelete this.headers[name];\r\n\t\telse\r\n\t\t\tthis.headers[name] = value;\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * Returns a parameter string for a GET request given an object with fields.\r\n\t */\r\n\tencodeParams: function (obj)\r\n\t{\r\n\t\tlet s = [];\r\n\r\n\t\tif (obj instanceof FormData)\r\n\t\t{\r\n\t\t\tfor (let i of obj.entries())\r\n\t\t\t\ts.push(encodeURIComponent(i[0]) + '=' + encodeURIComponent(i[1]));\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tfor (let i in obj)\r\n\t\t\t\ts.push(encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]));\r\n\t\t}\r\n\r\n\t\treturn s.join('&');\r\n\t},\r\n\r\n\t/**\r\n\t * Returns a URL given a relative or absolute URL.\r\n\t */\r\n\tgetUrl: function (url)\r\n\t{\r\n\t\tif (url.indexOf('//') !== -1)\r\n\t\t\treturn url;\r\n\r\n\t\treturn this.apiUrl + url;\r\n\t},\r\n\r\n\t/**\r\n\t * Appends a parameter to the URL.\r\n\t */\r\n\tappendParam: function (url, param)\r\n\t{\r\n\t\treturn url + (url.indexOf('?') == -1 ? '?' : '&') + param;\r\n\t},\r\n\r\n\t/**\r\n\t * Executes an API call to the URL stored in the `apiUrl` property. By default `httpMethod` is \"auto\", which will determine the best depending on the data to\r\n\t * be sent. Any connection error will be reported to the `failure` callback, and similarly any success to the `success` callback. The `params` object can be\r\n\t * a FormData object or just a regular object.\r\n\t */\r\n\tapiCall: function (params, success, failure, httpMethod=null, retries=null, relativeUrl='')\r\n\t{\r\n\t\tlet url = this.getUrl(relativeUrl);\r\n\r\n\t\tif (this.flags & Api.UNIQUE_STAMP)\r\n\t\t\turl = this.appendParam(url, '_='+Date.now());\r\n\r\n\t\thttpMethod = httpMethod ? httpMethod.toUpperCase() : null;\r\n\t\tif (httpMethod != 'GET' && httpMethod != 'POST')\r\n\t\t\thttpMethod = 'auto';\r\n\r\n\t\tif (retries === null)\r\n\t\t\tretries = this.retries;\r\n\r\n\t\tif (this._requestPackage && (this.flags & Api.REQUEST_PACKAGE_SUPPORTED))\r\n\t\t{\r\n\t\t\tif (!(params instanceof FormData))\r\n\t\t\t\tparams = {...params};\r\n\r\n\t\t\tthis._packageData.push([success, failure, params]);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._showProgress();\r\n\r\n\t\tlet data = params;\r\n\r\n\t\tlet options =\r\n\t\t{\r\n\t\t\tmode: 'cors',\r\n\t\t\theaders: {\r\n\t\t\t\t'Accept': 'text/html,application/xhtml+xml,application/xml,application/json;q=0.9',\r\n\t\t\t\t...this.headers\r\n\t\t\t},\r\n\t\t\tmethod: httpMethod,\r\n\t\t\tbody: null,\r\n\t\t\tmultipart: false\r\n\t\t};\r\n\r\n\t\tif (this.flags & Api.INCLUDE_CREDENTIALS)\r\n\t\t\toptions.credentials = 'include';\r\n\r\n\t\tif (typeof(data) !== 'string' && !(data instanceof Blob))\r\n\t\t{\r\n\t\t\tif (!(data instanceof FormData))\r\n\t\t\t{\r\n\t\t\t\tdata = new FormData();\r\n\r\n\t\t\t\tfor (let i in params)\r\n\t\t\t\t{\r\n\t\t\t\t\tif ((params[i] instanceof File) || (params[i] instanceof Blob))\r\n\t\t\t\t\t\tdata.append(i, params[i], params[i].name);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tdata.append(i, params[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i of data.entries())\r\n\t\t\t{\r\n\t\t\t\tif ((i[1] instanceof File) || (i[1] instanceof Blob))\r\n\t\t\t\t{\r\n\t\t\t\t\toptions.method = 'POST';\r\n\t\t\t\t\toptions.multipart = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.useReq64 && (this.flags & Api.REQ64_SUPPORTED) && !options.multipart)\r\n\t\t\t{\r\n\t\t\t\tlet tmp = new FormData();\r\n\t\t\t\ttmp.append('req64', base64.encode(this.encodeParams(data)));\r\n\t\t\t\tdata = tmp;\r\n\t\t\t}\r\n\r\n\t\t\tif (options.method == 'auto')\r\n\t\t\t{\r\n\t\t\t\tlet l = 0;\r\n\r\n\t\t\t\toptions.method = 'GET';\r\n\r\n\t\t\t\tfor (let i of data.entries())\r\n\t\t\t\t{\r\n\t\t\t\t\tl += i[0].length + i[1].length + 2;\r\n\r\n\t\t\t\t\tif (l > 960)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toptions.method = 'POST';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\r\n\t\t\t}\r\n\r\n\t\t\tif (options.method == 'GET')\r\n\t\t\t{\r\n\t\t\t\turl = this.appendParam(url, this.encodeParams(data));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif (!options.multipart)\r\n\t\t\t\t{\r\n\t\t\t\t\toptions.headers['Content-Type'] = 'application/x-www-form-urlencoded';\r\n\t\t\t\t\toptions.body = this.encodeParams(data);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\toptions.body = data;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif (typeof(data) === 'string')\r\n\t\t\t{\r\n\t\t\t\tif (data[0] === '<')\r\n\t\t\t\t{\r\n\t\t\t\t\tif (data.endsWith('</soap:Envelope>'))\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/soap+xml';\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/xml';\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tif (data[0] === '{')\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/json';\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\toptions.headers['Content-Type'] = 'application/octet-stream';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\toptions.headers['Content-Type'] = data.type;\r\n\r\n\t\t\toptions.method = 'POST';\r\n\t\t\toptions.body = data;\r\n\t\t}\r\n\r\n\t\tglobal.fetch(url, options)\r\n\t\t.then(result => this.decodeResult(result))\r\n\t\t.then(result =>\r\n\t\t{\r\n\t\t\tthis._hideProgress();\r\n\t\t\tif (!success) return\r\n\r\n\t\t\tif (this.responseFilter(result, params)) {\r\n\t\t\t\ttry { success(result, params); } catch(e) { }\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err =>\r\n\t\t{\r\n\t\t\tthis._hideProgress();\r\n\r\n\t\t\tif (retries == 0) {\r\n\t\t\t\tif (failure) failure(params);\r\n\t\t\t} else {\r\n\t\t\t\tthis.apiCall (data, success, failure, httpMethod, retries-1, relativeUrl);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Decodes a result obtained using fetch into a usable object.\r\n\t */\r\n\tdecodeResult: function (result)\r\n\t{\r\n\t\tlet type = result.headers.get('content-type').split(';')[0].toLowerCase();\r\n\r\n\t\tif ((this.flags & Api.JSON_RESPONSE_SUPPORTED) && type.indexOf('json') !== -1)\r\n\t\t\treturn result.json();\r\n\r\n\t\tif ((this.flags & Api.XML_RESPONSE_SUPPORTED) && type.indexOf('xml') !== -1)\r\n\t\t{\r\n\t\t\treturn new Promise((resolve, reject) =>\r\n\t\t\t{\r\n\t\t\t\tresult.text().then(data =>\r\n\t\t\t\t{\r\n\t\t\t\t\tdata = (new DOMParser).parseFromString(data, 'text/xml');\r\n\t\t\t\t\tresolve(data);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(reject);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result.blob();\r\n\t},\r\n\r\n\t/**\r\n\t * Makes a blob with the specified data and type.\r\n\t */\r\n\tgetBlob: function (data, type)\r\n\t{\r\n\t\treturn new Blob ([data], { type: type });\r\n\t},\r\n\r\n\t/**\r\n\t * Provided access to the base64 module to encode/decode data.\r\n\t */\r\n\tbase64:\r\n\t{\r\n\t\tencode: function (value)\r\n\t\t{\r\n\t\t\treturn base64.encode(value);\r\n\t\t},\r\n\r\n\t\tdecode: function (value)\r\n\t\t{\r\n\t\t\treturn base64.decode(value);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Executes a POST API call.\r\n\t */\r\n\tpost: function (params, success=null, failure=null)\r\n\t{\r\n\t\treturn this.apiCall(params, success, failure, 'POST');\r\n\t},\r\n\r\n\t/**\r\n\t * Executes a GET API call.\r\n\t */\r\n\tget: function (params, success=null, failure=null)\r\n\t{\r\n\t\treturn this.apiCall(params, success, failure, 'GET');\r\n\t},\r\n\r\n\t/**\r\n\t * Executes an automatic API call, returns a promise.\r\n\t */\r\n\tfetch: function (url, params=null)\r\n\t{\r\n\t\tif (params === null)\r\n\t\t{\r\n\t\t\tif (typeof(url) !== 'string')\r\n\t\t\t{\r\n\t\t\t\tparams = url;\r\n\t\t\t\turl = '';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.apiCall(params, resolve, reject, null, null, url);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Builds a URL from the given data.\r\n\t */\r\n\tmakeUrl: function (url, params=null)\r\n\t{\r\n\t\tif (params === null)\r\n\t\t{\r\n\t\t\tif (typeof(url) !== 'string')\r\n\t\t\t{\r\n\t\t\t\tparams = url;\r\n\t\t\t\turl = '';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.appendParam(this.getUrl(url), this.encodeParams(params));\r\n\t}\r\n};\r\n\r\nexport default Api;\r\n","\r\nimport { Model, ModelList, EventDispatcher } from 'rinn';\r\nimport Api from './api.js';\r\n\r\n/*\r\n**\tProvides several methods to quickly interface with a remote data-source as defined by Wind.\r\n*/\r\n\r\nexport default EventDispatcher.extend\r\n({\r\n\tclassName: 'DataSource',\r\n\tdebounceDelay: 250,\r\n\r\n\trequest: null,\r\n\r\n\tincludeCount: false,\r\n\tincludeEnum: false,\r\n\tincludeList: true,\r\n\r\n\teid: null,\r\n\tcount: 0,\r\n\tlist: null,\r\n\tenum: null,\r\n\r\n\t/*\r\n\t**\tConstructs the data source with the specified optional `config` parameters, any of the properties of this object can be specified\r\n\t**\tin the config. Uses the given basePath as prefix for the `f` parameter for subsequent API operations, a basePath of `candies` will\r\n\t**\tresult in calls to `candies.list`, `candies.count`, etc.\r\n\t*/\r\n\t__ctor: function (basePath, config)\r\n\t{\r\n\t\tthis._super.EventDispatcher.__ctor();\r\n\r\n\t\tthis.basePath = basePath;\r\n\r\n\t\tif (config) Object.assign(this, config);\r\n\r\n\t\tthis.request = new Model(this.request);\r\n\r\n\t\tthis.eid = Math.random().toString().substr(2);\r\n\t\tthis.count = 0;\r\n\r\n\t\tthis.list = new ModelList();\r\n\t\tthis.list.dataSource = this;\r\n\r\n\t\tthis.enum = new ModelList();\r\n\t\tthis.enum.dataSource = this;\r\n\r\n\t\tthis.request.addEventListener (this.eid+':propertyChanged', this.forwardRequestEvent, this);\r\n\r\n\t\tthis.list.addEventListener (this.eid+':itemsCleared', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemsChanged', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemRemoved', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemChanged', this.forwardListEvent, this);\r\n\t\tthis.list.addEventListener (this.eid+':itemAdded', this.forwardListEvent, this);\r\n\r\n\t\tthis.enum.addEventListener (this.eid+':itemsCleared', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemsChanged', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemRemoved', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemChanged', this.forwardEnumEvent, this);\r\n\t\tthis.enum.addEventListener (this.eid+':itemAdded', this.forwardEnumEvent, this);\r\n\t},\r\n\r\n\tforwardRequestEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('request' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\tforwardListEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('list' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\tforwardEnumEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('enum' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\t/*\r\n\t**\tExecutes one or more API functions (depending on `includeCount`, `includeEnum` and `includeList` properties) to retrieve the\r\n\t**\trequired data (uses debounce to prevent too-quick refreshes).\r\n\t**\r\n\t**\tRefresh mode can be: order, filter, range or full. Setting `mode` to `true` will cause a full refresh without debouncing.\r\n\t*/\r\n\trefresh: function (mode='full', callback=null)\r\n\t{\r\n\t\tif (typeof(mode) == 'function')\r\n\t\t{\r\n\t\t\tcallback = mode;\r\n\t\t\tmode = 'full';\r\n\t\t}\r\n\r\n\t\tif (this._timeout)\r\n\t\t{\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t\tthis._timeout = null;\r\n\t\t}\r\n\r\n\t\tconst fn = () =>\r\n\t\t{\r\n\t\t\tthis._timeout = null;\r\n\r\n\t\t\tApi.packageBegin();\r\n\r\n\t\t\tif (this.includeCount && (mode == 'full' || mode == 'filter')) this.fetchCount();\r\n\t\t\tif (this.includeEnum && (mode == 'full')) this.fetchEnum();\r\n\t\t\tif (this.includeList) this.fetchList();\r\n\r\n\t\t\tApi.packageEnd(callback);\r\n\t\t};\r\n\r\n\t\tif (mode === true)\r\n\t\t{\r\n\t\t\tmode = 'full';\r\n\t\t\tfn();\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis._timeout = setTimeout(fn, this.debounceDelay);\r\n\t},\r\n\r\n\t/*\r\n\t**\tSearches for the item in `list` that matches the specified `fields` and sends it to the callback. If no item is found (or if `forced` is true),\r\n\t**\ta call to API function `.get` will be executed with the fields as request parameters. Returns a promise.\r\n\t*/\r\n\tfetch: function (fields, forced=false)\r\n\t{\r\n\t\treturn new Promise((resolve, reject) =>\r\n\t\t{\r\n\t\t\tlet item = forced == true ? null : this.list.find(fields, true);\r\n\t\t\tif (!item)\r\n\t\t\t{\r\n\t\t\t\tthis.fetchOne(fields, (r) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tif (r && r.response == 200)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (r.data.length > 0)\r\n\t\t\t\t\t\t\tresolve(r.data[0]);\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\treject(r);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\treject(r);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tresolve(item.get());\r\n\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t**\tRemoves an item from the remote data source by executing the `.delete` API function, passes the given `fields` as request\r\n\t**\tparameters. Returns a promise.\r\n\t*/\r\n\tdelete: function (params)\r\n\t{\r\n\t\treturn new Promise((resolve, reject) =>\r\n\t\t{\r\n\t\t\tthis.fetchDelete(params, (r) =>\r\n\t\t\t{\r\n\t\t\t\tif (r.response == 200)\r\n\t\t\t\t\tresolve(r);\r\n\t\t\t\telse\r\n\t\t\t\t\treject(r.error);\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\tfetchList: function ()\r\n\t{\r\n\t\tlet data = {...this.request.get()};\r\n\r\n\t\tdata.f = this.basePath + '.list';\r\n\r\n\t\tthis.dispatchEvent('listLoading');\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tthis.list.setData(r.response == 200 ? r.data : null);\r\n\t\t\tthis.dispatchEvent('listLoaded');\r\n\t\t\tthis.dispatchEvent('listChanged');\r\n\t\t});\r\n\t},\r\n\r\n\tfetchEnum: function ()\r\n\t{\r\n\t\tlet data = {...this.request.get()};\r\n\r\n\t\tdata.f = this.basePath + '.enum';\r\n\r\n\t\tthis.dispatchEvent('enumLoading');\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tthis.enum.setData(r.response == 200 ? r.data : null);\r\n\t\t\tthis.dispatchEvent('enumLoaded');\r\n\t\t\tthis.dispatchEvent('enumChanged');\r\n\t\t});\r\n\t},\r\n\r\n\tfetchCount: function ()\r\n\t{\r\n\t\tlet data = {...this.request.get()};\r\n\r\n\t\tdata.f = this.basePath + '.count';\r\n\r\n\t\tthis.dispatchEvent('countLoading');\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tthis.count = r.response == 200 ? r.count : 0;\r\n\t\t\tthis.dispatchEvent('countLoaded');\r\n\t\t\tthis.dispatchEvent('countChanged');\r\n\t\t});\r\n\t},\r\n\r\n\tfetchOne: function (params, callback)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tdata.f = this.basePath + '.get';\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tcallback(r);\r\n\t\t});\r\n\t},\r\n\r\n\tfetchDelete: function (params, callback)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tdata.f = this.basePath + '.delete';\r\n\r\n\t\tApi.fetch(data).then(r => {\r\n\t\t\tcallback(r);\r\n\t\t});\r\n\t},\r\n\r\n\tfetchData: function (params)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tif (data.f[0] == '.')\r\n\t\t\tdata.f = this.basePath + data.f;\r\n\r\n\t\treturn Api.fetch(data);\r\n\t},\r\n\r\n\tmakeUrl: function (params)\r\n\t{\r\n\t\tlet data = {...this.request.get(), ...params};\r\n\r\n\t\tif (data.f[0] == '.')\r\n\t\t\tdata.f = this.basePath + data.f;\r\n\r\n\t\treturn Api.makeUrl(data);\r\n\t}\r\n});\r\n","\r\nimport { Model, ModelList } from 'rinn';\r\nimport Api from './api.js';\r\n\r\n/*\r\n**\tProvides an interface to connect with a listing API function.\r\n*/\r\n\r\nexport default ModelList.extend\r\n({\r\n\tclassName: 'DataList',\r\n\tdebounceDelay: 250,\r\n\r\n\trequest: null,\r\n\r\n\teid: null,\r\n\r\n\t/*\r\n\t**\tConstructs the data list with the specified optional `config` parameters, any of the properties of this object can be specified\r\n\t**\tin the config. The given `f` parameter is passed directly as a request parameter to the API.\r\n\t*/\r\n\t__ctor: function (f, config=null)\r\n\t{\r\n\t\tthis._super.ModelList.__ctor();\r\n\r\n\t\tif (config !==  null)\r\n\t\t\tObject.assign(this, config);\r\n\r\n\t\tif (!this.request)\r\n\t\t\tthis.request = { };\r\n\r\n\t\tthis.request.f = f;\r\n\t\tthis.request = new Model(this.request);\r\n\r\n\t\tthis.eid = Math.random().toString().substr(2);\r\n\t\tthis.dataList = this;\r\n\r\n\t\tthis.request.addEventListener (this.eid+':propertyChanged', this.forwardRequestEvent, this);\r\n\t},\r\n\r\n\tforwardRequestEvent: function (evt, args)\r\n\t{\r\n\t\tthis.prepareEvent('request' + evt.name[0].toUpperCase() + evt.name.substr(1), args).setSource(evt.source).resume();\r\n\t},\r\n\r\n\t/*\r\n\t**\tExecutes a request to retrieve the data for the list (uses debounce to prevent too-quick refreshes).\r\n\t*/\r\n\trefresh: function (callback=null, _callback=null)\r\n\t{\r\n\t\tif (this._timeout)\r\n\t\t{\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t\tthis._timeout = null;\r\n\t\t}\r\n\r\n\t\tif (callback === true)\r\n\t\t{\r\n\t\t\tthis.dispatchEvent('listLoading');\r\n\r\n\t\t\tApi.fetch(this.request.get()).then(r =>\r\n\t\t\t{\r\n\t\t\t\tthis.setData(r.response == 200 ? r.data : null);\r\n\t\t\t\tthis.dispatchEvent('listLoaded');\r\n\t\t\t\tthis.dispatchEvent('listChanged');\r\n\r\n\t\t\t\tif (_callback !== null)\r\n\t\t\t\t\t_callback();\r\n\t\t\t});\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst fn = () => {\r\n\t\t\tthis.refresh(true, callback);\r\n\t\t};\r\n\r\n\t\tthis._timeout = setTimeout(fn, this.debounceDelay);\r\n\t}\r\n});\r\n","\n/**\n**\tCollection of useful easing functions (imported from Cherry source code).\n*/\n\nconst Easing =\n{\n\t/**\n\t**\tInterpolates numeric values between two objects (`src` and `dst`) using the specified `duration` (in seconds) and `easing` function. Note that all four parameters\n\t**\t`src`, `dst`, `duration` and `easing` must be objects having the same number of values.\n\t*/\n\tinterpolate: function (src, dst, duration, easing, callback/* function(data, isFinished) */)\n\t{\n\t\tlet time = { };\n\t\tlet data = { };\n\t\tlet count = 0;\n\n\t\tfor (let x in src)\n\t\t{\n\t\t\ttime[x] = 0.0;\n\t\t\tdata[x] = src[x]\n\t\t\tcount++;\n\t\t}\n\n\t\tlet lastTime = Date.now()/1000;\n\t\tlet dt = 0;\n\n\t\tlet interpolator = function()\n\t\t{\n\t\t\tlet curTime = Date.now()/1000;\n\t\t\tdt = curTime - lastTime;\n\t\t\tlastTime = curTime;\n\n\t\t\tfor (let x in time)\n\t\t\t{\n\t\t\t\tif (time[x] == duration[x])\n\t\t\t\t\tcontinue;\n\n\t\t\t\ttime[x] += dt;\n\t\t\t\tif (time[x] >= duration[x])\n\t\t\t\t{\n\t\t\t\t\ttime[x] = duration[x];\n\t\t\t\t\tcount--;\n\t\t\t\t}\n\n\t\t\t\tlet t = easing[x] (time[x] / duration[x]);\n\t\t\t\tdata[x] = (1-t)*src[x] + t*dst[x];\n\t\t\t}\n\n\t\t\tcallback (data, count == 0);\n\n\t\t\tif (count != 0)\n\t\t\t\trequestAnimationFrame(interpolator);\n\t\t};\n\n\t\tinterpolator();\n\t},\n\n\t/* ******************************************** */\n\tLinear:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn t;\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\treturn t;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tBack:\n\t{\n\t\tk: 1.70158,\n\n\t\tIN: function (t, k)\n\t\t{\n\t\t\tif (k === undefined) k = Easing.Back.k;\n\t\t\treturn t*t*((k+1)*t - k);\n\t\t},\n\n\t\tOUT: function (t, k)\n\t\t{\n\t\t\treturn 1 - Easing.Back.IN(1 - t, k);\n\t\t},\n\n\t\tIN_OUT: function (t, k)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Back.IN(t*2, k)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Back.OUT((t-0.5)*2, k)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tBounce:\n\t{\n\t\tgetConst: function (t)\n\t\t{\n\t\t\tif (t < 1.0/2.75)\n\t\t\t\treturn 7.5625 * t * t;\n\t\t\telse if (t < 2.0/2.75)\n\t\t\t\treturn 7.5625 * (t -= 1.5/2.75)*t + 0.75;\n\t\t\telse if (t < 2.5/2.75)\n\t\t\t\treturn 7.5625 * (t -= 2.250/2.75) * t + 0.9375;\n\n\t\t\treturn 7.5625 * (t -= 2.625/2.75) * t + 0.984375;\n\t\t},\n\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Bounce.getConst(1-t);\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn Easing.Bounce.getConst(t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn (1 - Easing.Bounce.getConst(1-2*t))/2;\n\t\t\telse\n\t\t\t\treturn (Easing.Bounce.getConst((t-0.5)*2)/2)+0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tCirc:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn 1 - Math.sqrt(1 - t*t);\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Circ.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\t\treturn Easing.Circ.IN(t*2)/2;\n\t\t\t\telse\n\t\t\t\t\treturn Easing.Circ.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tCubic:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Cubic.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Cubic.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Cubic.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tExpo:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn Math.pow(2, 12*(t-1));\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn -Math.pow(2, -12*t) + 1;\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif ((t *= 2) < 1)\n\t\t\t\treturn Math.pow (2, 12 * (t - 1)) / 2;\n\t\t\telse\n\t\t\t\treturn (-Math.pow (2, -12 * (t - 1)) + 2) / 2;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tPower:\n\t{\n\t\tp: 12,\n\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn Math.pow(t, Easing.Power.p);\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Power.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Power.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Power.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tQuad:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Quad.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Quad.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Quad.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tQuartic:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t*t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Quartic.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\treturn Easing.Quartic.IN(t*2)/2;\n\t\t\telse\n\t\t\t\treturn Easing.Quartic.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tQuintic:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t*t*t*t*t;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn 1 - Easing.Quintic.IN(1 - t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\tif (t < 0.5)\n\t\t\t\t\treturn Easing.Quintic.IN(t*2)/2;\n\t\t\t\telse\n\t\t\t\t\treturn Easing.Quintic.OUT((t-0.5)*2)/2 + 0.5;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tSine:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn 1 - Math.sin (1.5708 * (1 - t));\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn Math.sin (1.5708 * t);\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\treturn (Math.cos (3.1416*t) - 1) / -2;\n\t\t}\n\t},\n\n\t/* ******************************************** */\n\tStep:\n\t{\n\t\tIN: function (t)\n\t\t{\n\t\t\treturn t != 1.0 ? 0 : 1.0;\n\t\t},\n\n\t\tOUT: function (t)\n\t\t{\n\t\t\treturn t != 1.0 ? 0 : 1.0;\n\t\t},\n\n\t\tIN_OUT: function (t)\n\t\t{\n\t\t\treturn t != 1.0 ? 0 : 1.0;\n\t\t}\n\t}\n};\n\nexport default Easing;\n","\nimport { Rinn, Class } from 'rinn';\n\n/**\n**\tClass to animate properties using rules (imported from Cherry source code).\n*/\n\nconst Anim = Class.extend\n({\n\tlist: null,\n\n\tinitialData: null,\n\tdata: null,\n\n\tstack: null,\n\tblock: null,\n\n\ttimeScale: 1, time: 0, blockTime: 0,\n\tindex: 0,\n\n\tpaused: false,\n\tfinished: false,\n\n\tonFinishedCallback: null,\n\tonUpdatedCallback: null,\n\n\t__ctor: function ()\n\t{\n\t\tthis.list = [ ];\n\n\t\tthis.initialData = { };\n\t\tthis.data = { };\n\n\t\tthis.stack = [ ];\n\t\tthis.block = this.list;\n\n\t\tthis.reset();\n\t},\n\n\t__dtor: function ()\n\t{\n\t},\n\n\tclone: function ()\n\t{\n\t\tlet a = new Anim();\n\n\t\ta.list = this.list;\n\t\ta.initialData = this.initialData;\n\n\t\treturn a.reset();\n\t},\n\n\tonFinished: function (callback)\n\t{\n\t\tthis.onFinishedCallback = callback;\n\t\treturn this;\n\t},\n\n\tonUpdated: function (callback)\n\t{\n\t\tthis.onUpdatedCallback = callback;\n\t\treturn this;\n\t},\n\n\t// Resets the animation to its initial state.\n\treset: function ()\n\t{\n\t\tthis.stack.length = 0;\n\t\tthis.blockTime = 0;\n\n\t\tthis.time = 0;\n\t\tthis.index = 0;\n\n\t\tthis.block = this.list;\n\n\t\tthis.paused = true;\n\t\tthis.finished = false;\n\t\tthis.handle = null;\n\n\t\tfor (let i in this.initialData)\n\t\t\tthis.data[i] = this.initialData[i];\n\n\t\treturn this;\n\t},\n\n\t// Sets the initial data.\n\tinitial: function (data)\n\t{\n\t\tthis.initialData = data;\n\t\treturn this.reset();\n\t},\n\n\t// Sets the time scale (animation speed).\n\tspeed: function (value)\n\t{\n\t\tthis.timeScale = value > 0.0 ? value : 1.0;\n\t\treturn this;\n\t},\n\n\t// Sets the output data object.\n\tsetOutput: function (data)\n\t{\n\t\tthis.data = data;\n\t\treturn this;\n\t},\n\n\t// Pauses the animation.\n\tpause: function ()\n\t{\n\t\tif (this.paused) return;\n\n\t\tclearInterval(this.handle);\n\t\tthis.paused = true;\n\t},\n\n\t// Resumes the animation.\n\tresume: function ()\n\t{\n\t\tif (!this.paused) return;\n\n\t\tlet lastTime = Date.now()/1000;\n\n\t\tthis.handle = setInterval(() =>\n\t\t{\n\t\t\tlet curTime = Date.now()/1000;\n\t\t\tlet dt = curTime - lastTime;\n\t\t\tlastTime = curTime;\n\n\t\t\tthis.update(dt);\n\n\t\t\tif (this.onUpdatedCallback)\n\t\t\t\tthis.onUpdatedCallback (this.data, this);\n\t\t},\n\t\t16);\n\n\t\tif (this.onUpdatedCallback)\n\t\t\tthis.onUpdatedCallback (this.data, this);\n\n\t\tthis.paused = false;\n\t},\n\n\t// Updates the animation by the specified delta time (seconds).\n\tupdate: function (dt)\n\t{\n\t\tif (this.paused) return false;\n\n\t\tif (this.index >= this.block.length)\n\t\t\treturn true;\n\n\t\tlet i = 0;\n\n\t\tlet _block;\n\t\tlet _index;\n\t\tlet _blockTime;\n\n\t\tthis.time += dt*this.timeScale;\n\n\t\twhile (this.index < this.block.length)\n\t\t{\n\t\t\tlet cmd = this.block[this.index];\n\t\t\tlet duration;\n\n\t\t\tswitch (cmd.op)\n\t\t\t{\n\t\t\t\tcase \"parallel\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd.blocks.length = 0;\n\t\t\t\t\t\tcmd.started = true;\n\n\t\t\t\t\t\tfor (i = 0; i < cmd.block.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcmd.blocks.push([cmd.block[i]]);\n\t\t\t\t\t\t\tcmd.indices[i] = 0;\n\t\t\t\t\t\t\tcmd.blockTimes[i] = this.blockTime;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t_block = this.block;\n\t\t\t\t\t_index = this.index;\n\t\t\t\t\t_blockTime = this.blockTime;\n\n\t\t\t\t\tlet n = 0;\n\t\t\t\t\tlet blockTime = _blockTime;\n\n\t\t\t\t\tfor (i = 0; i < cmd.blocks.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.block = cmd.blocks[i];\n\t\t\t\t\t\tthis.index = cmd.indices[i];\n\t\t\t\t\t\tthis.blockTime = cmd.blockTimes[i];\n\n\t\t\t\t\t\tif (this.update(0) === true)\n\t\t\t\t\t\t\tn++;\n\n\t\t\t\t\t\tif (this.blockTime > blockTime)\n\t\t\t\t\t\t\tblockTime = this.blockTime;\n\n\t\t\t\t\t\tcmd.blockTimes[i] = this.blockTime;\n\t\t\t\t\t\tcmd.blocks[i] = this.block;\n\t\t\t\t\t\tcmd.indices[i] = this.index;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.block = _block;\n\t\t\t\t\tthis.index = _index;\n\t\t\t\t\tthis.blockTime = _blockTime;\n\n\t\t\t\t\tif (cmd.fn) cmd.fn.call(this);\n\n\t\t\t\t\tif (n != cmd.blocks.length)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime = blockTime;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"serial\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd._block = cmd.block;\n\t\t\t\t\t\tcmd._index = 0;\n\t\t\t\t\t\tcmd._blockTime = this.blockTime;\n\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t_block = this.block;\n\t\t\t\t\t_index = this.index;\n\t\t\t\t\t_blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = cmd._block;\n\t\t\t\t\tthis.index = cmd._index;\n\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\n\t\t\t\t\ti = this.update(0);\n\n\t\t\t\t\tcmd._block = this.block;\n\t\t\t\t\tcmd._index = this.index;\n\t\t\t\t\tcmd._blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = _block;\n\t\t\t\t\tthis.index = _index;\n\t\t\t\t\tthis.blockTime = _blockTime;\n\n\t\t\t\t\tif (cmd.fn) cmd.fn.call(this);\n\n\t\t\t\t\tif (i !== true) return false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"repeat\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd._block = cmd.block;\n\t\t\t\t\t\tcmd._index = 0;\n\t\t\t\t\t\tcmd._blockTime = this.blockTime;\n\t\t\t\t\t\tcmd._count = cmd.count;\n\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t_block = this.block;\n\t\t\t\t\t_index = this.index;\n\t\t\t\t\t_blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = cmd._block;\n\t\t\t\t\tthis.index = cmd._index;\n\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\n\t\t\t\t\ti = this.update(0);\n\n\t\t\t\t\tcmd._block = this.block;\n\t\t\t\t\tcmd._index = this.index;\n\t\t\t\t\tcmd._blockTime = this.blockTime;\n\n\t\t\t\t\tthis.block = _block;\n\t\t\t\t\tthis.index = _index;\n\t\t\t\t\tthis.blockTime = _blockTime;\n\n\t\t\t\t\tif (cmd.fn) cmd.fn.call(this);\n\n\t\t\t\t\tif (i !== true) return false;\n\n\t\t\t\t\tif (cmd._count <= 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\t\tthis.blockTime = cmd._blockTime;\n\t\t\t\t\t\tthis.index++;\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd._index = 0;\n\t\t\t\t\t\tcmd._count--;\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"set\":\n\t\t\t\t\tthis.data[cmd.field] = cmd.value;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"restart\":\n\t\t\t\t\tthis.index = 0;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"wait\":\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"range\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (cmd.startValue === null)\n\t\t\t\t\t\t\tcmd._startValue = this.data[cmd.field];\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tcmd._startValue = cmd.startValue;\n\n\t\t\t\t\t\tcmd._endValue = cmd.endValue;\n\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\tdt = (this.time - this.blockTime) / duration;\n\t\t\t\t\telse\n\t\t\t\t\t\tdt = 1;\n\n\t\t\t\t\tif (cmd.easing && dt != 1.0)\n\t\t\t\t\t\tthis.data[cmd.field] = cmd.easing(dt)*(cmd._endValue - cmd._startValue) + cmd._startValue;\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.data[cmd.field] = dt*(cmd._endValue - cmd._startValue) + cmd._startValue;\n\n\t\t\t\t\tif (dt != 1) return false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"rand\":\n\t\t\t\t\tif (cmd.started == false)\n\t\t\t\t\t{\n\t\t\t\t\t\tcmd.started = true;\n\t\t\t\t\t\tcmd.last = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\tdt = (this.time - this.blockTime) / duration;\n\t\t\t\t\telse\n\t\t\t\t\t\tdt = 1;\n\n\t\t\t\t\tif (cmd.easing && dt != 1)\n\t\t\t\t\t\tcmd.cur = ~~(cmd.easing(dt)*cmd.count);\n\t\t\t\t\telse\n\t\t\t\t\t\tcmd.cur = ~~(dt*cmd.count);\n\n\t\t\t\t\tif (cmd.cur != cmd.last)\n\t\t\t\t\t{\n\t\t\t\t\t\twhile (true) {\n\t\t\t\t\t\t\ti = ~~(Math.random()*(cmd.endValue - cmd.startValue + 1)) + cmd.startValue;\n\t\t\t\t\t\t\tif (i != this.data[cmd.field]) break;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.data[cmd.field] = i;\n\t\t\t\t\t\tcmd.last = cmd.cur;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (dt != 1) return false;\n\n\t\t\t\t\tcmd.started = false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"randt\":\n\t\t\t\t\tduration = Rinn.typeOf(cmd.duration) == \"string\" ? this.data[cmd.duration] : cmd.duration;\n\n\t\t\t\t\tif (this.time < this.blockTime + duration)\n\t\t\t\t\t\tdt = (this.time - this.blockTime) / duration;\n\t\t\t\t\telse\n\t\t\t\t\t\tdt = 1;\n\n\t\t\t\t\tif (cmd.easing && dt != 1)\n\t\t\t\t\t\ti = cmd.easing(dt)*(cmd.count-1);\n\t\t\t\t\telse\n\t\t\t\t\t\ti = dt*(cmd.count-1);\n\n\t\t\t\t\tthis.data[cmd.field] = cmd.table[~~((i + cmd.count) % cmd.count)];\n\n\t\t\t\t\tif (dt != 1) return false;\n\n\t\t\t\t\tthis.blockTime += duration;\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"play\":\n\t\t\t\t\tcmd.snd.play();\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"exec\":\n\t\t\t\t\tcmd.fn.call(this, this);\n\t\t\t\t\tthis.index++;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this.block == this.list)\n\t\t{\n\t\t\tif (!this.finished && this.onFinishedCallback != null)\n\t\t\t\tthis.onFinishedCallback();\n\n\t\t\tthis.pause();\n\t\t\tthis.finished = true;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t// Runs the subsequent commands in parallel. Should end the parallel block by calling end().\n\tparallel: function ()\n\t{\n\t\tlet block = [ ];\n\n\t\tthis.block.push({ op: \"parallel\", started: false, block: block, blocks: [ ], indices: [ ], blockTimes: [ ] });\n\n\t\tthis.stack.push (this.block);\n\t\tthis.block = block;\n\n\t\treturn this;\n\t},\n\n\t// Runs the subsequent commands in series. Should end the serial block by calling end().\n\tserial: function ()\n\t{\n\t\tlet block = [ ];\n\n\t\tthis.block.push({ op: \"serial\", started: false, block: block });\n\n\t\tthis.stack.push (this.block);\n\t\tthis.block = block;\n\n\t\treturn this;\n\t},\n\n\t// Repeats a block the specified number of times.\n\trepeat: function (count)\n\t{\n\t\tlet block = [ ];\n\n\t\tthis.block.push({ op: \"repeat\", started: false, block: block, count: count });\n\n\t\tthis.stack.push (this.block);\n\t\tthis.block = block;\n\n\t\treturn this;\n\t},\n\n\t// Sets the callback of the current block.\n\tcallback: function (fn)\n\t{\n\t\tlet block = this.stack[this.stack.length-1];\n\t\tblock[block.length-1].fn = fn;\n\n\t\treturn this;\n\t},\n\n\t// Ends a parallel(), serial() or repeat() block.\n\tend: function ()\n\t{\n\t\tthis.block = this.stack.pop();\n\t\treturn this;\n\t},\n\n\t// Sets the value of a variable.\n\tset: function (field, value)\n\t{\n\t\tthis.block.push({ op: \"set\", field: field, value: value });\n\t\treturn this;\n\t},\n\n\t// Restarts the current block.\n\trestart: function (duration)\n\t{\n\t\tthis.block.push({ op: \"restart\" });\n\t\treturn this;\n\t},\n\n\t// Waits for the specified duration.\n\twait: function (duration)\n\t{\n\t\tthis.block.push({ op: \"wait\", duration: duration });\n\t\treturn this;\n\t},\n\n\t// Sets the range of a variable.\n\trange: function (field, duration, startValue, endValue, easing)\n\t{\n\t\tthis.block.push({ op: \"range\", started: false, field: field, duration: duration, startValue: startValue, endValue: endValue, easing: easing ? easing : null });\n\t\treturn this;\n\t},\n\n\t// Generates a certain amount of random numbers in the given range (inclusive).\n\trand: function (field, duration, count, startValue, endValue, easing)\n\t{\n\t\tthis.block.push({ op: \"rand\", started: false, field: field, duration: duration, count: count, startValue: startValue, endValue: endValue, easing: easing ? easing : null });\n\t\treturn this;\n\t},\n\n\t// Generates a certain amount of random numbers in the given range (inclusive). This uses a static random table to determine the next values.\n\trandt: function (field, duration, count, startValue, endValue, easing)\n\t{\n\t\tlet table = [ ];\n\n\t\tfor (let i = 0; i < count; i++)\n\t\t\ttable.push ((i % (endValue - startValue + 1)) + startValue);\n\n\t\tfor (let i = count >> 2; i > 0; i--)\n\t\t{\n\t\t\tlet a = ~~(Math.random() * count);\n\t\t\tlet b = ~~(Math.random() * count);\n\n\t\t\tlet c = table[b];\n\t\t\ttable[b] = table[a];\n\t\t\ttable[a] = c;\n\t\t}\n\n\t\tthis.block.push({ op: \"randt\", field: field, duration: duration, count: count, startValue: startValue, endValue: endValue, table: table, easing: easing ? easing : null });\n\t\treturn this;\n\t},\n\n\t// Plays a sound.\n\tplay: function (snd)\n\t{\n\t\tthis.block.push({ op: \"play\", snd: snd });\n\t\treturn this;\n\t},\n\n\t// Executes a function.\n\texec: function (fn)\n\t{\n\t\tthis.block.push({ op: \"exec\", fn: fn });\n\t\treturn this;\n\t}\n});\n\nexport default Anim;\n","/*\n**\telems/r-tabs\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-tabs data-container=\"div.tab-container\" data-base-route=\"@\" data-initial=\"tab1\">\n\t\t<a data-name=\"tab1\">Tab-1</a>\n\t\t<a data-name=\"tab2\">Tab-2</a>\n\t\t<a data-name=\"tab3\">Tab-3</a>\n\t</r-tabs>\n\n\t<div class=\"tab-container\">\n\t\t<div data-name=\"tab1\">\n\t\t\tThis is tab-1.\n\t\t</div>\n\n\t\t<div data-name=\"tab2\">\n\t\t\tThis is tab-2.\n\t\t</div>\n\n\t\t<div data-name=\"tab3\">\n\t\t\tThis is tab-3.\n\t\t</div>\n\t</div>\n\n\t.x-hidden {\n\t\tdisplay: none;\n\t}\n\n\tr-tabs [data-name].active {\n\t\tfont-weight: bold;\n\t}\n*/\n\nimport Element from '../element.js';\nimport Router from '../router.js';\n\nexport default Element.register ('r-tabs',\n{\n\t/**\n\t * Container element for tab content.\n\t */\n\tcontainer: null,\n\n\t/**\n\t * Active tab name.\n\t */\n\tactiveTab: null,\n\n\t/**\n\t**\tElement events.\n\t*/\n\t'event click [data-name]': function (evt)\n\t{\n\t\tevt.continuePropagation = true;\n\n\t\tif (this.dataset.baseRoute)\n\t\t{\n\t\t\tlocation = \"#\" + Router.realLocation(this.dataset.baseRoute.replace('@', evt.source.dataset.name));\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selectTab (evt.source.dataset.name);\n\t},\n\n\t/**\n\t**\tInitializes the Tabs element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis._routeHandler = (evt, args) =>\n\t\t{\n\t\t\tif (Router.location != '')\n\t\t\t{\n\t\t\t\tthis.querySelectorAll(\"[href]\").forEach(link =>\n\t\t\t\t{\n\t\t\t\t\tif (!link.href) return;\n\n\t\t\t\t\tif (Router.location.startsWith(link.href.substr(link.href.indexOf('#')+1)))\n\t\t\t\t\t\tlink.classList.add('active');\n\t\t\t\t\telse\n\t\t\t\t\t\tlink.classList.remove('active');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!args.route.changed)\n\t\t\t\treturn;\n\n\t\t\tthis.showTab (args.tabName);\n\t\t};\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tif (\"container\" in this.dataset)\n\t\t{\n\t\t\tif (this.dataset.container == ':previousElement')\n\t\t\t\tthis.container = this.previousElementSibling;\n\t\t\telse if (this.dataset.container == ':nextElement')\n\t\t\t\tthis.container = this.nextElementSibling;\n\t\t\telse if (this.dataset.container == ':none')\n\t\t\t\tthis.container = null;\n\t\t\telse\n\t\t\t\tthis.container = document.querySelector(this.dataset.container);\n\t\t}\n\t\telse\n\t\t\tthis.container = this.nextElementSibling;\n\n\t\tthis._hideTabsExcept(this.dataset.initial);\n\t},\n\n\t/**\n\t**\tAdds a handler to Router if the data-base-route attribute was set.\n\t*/\n\tonConnected: function()\n\t{\n\t\tif (this.dataset.baseRoute)\n\t\t\tRouter.addRoute (this.dataset.baseRoute.replace('@', ':tabName'), this._routeHandler);\n\t},\n\n\t/**\n\t**\tRemoves a handler previously added to Router if the data-base-route attribute was set.\n\t*/\n\tonDisconnected: function()\n\t{\n\t\tif (this.dataset.baseRoute)\n\t\t\tRouter.removeRoute(this.dataset.baseRoute.replace('@', ':tabName'), this._routeHandler);\n\t},\n\n\t/**\n\t**\tHides all tabs except the one with the specified exceptName, if none specified then all tabs will be hidden (adds `.x-hidden` CSS class),\n\t**\tadditionally the respective link item in the tab definition will have class `.active`.\n\t*/\n\t_hideTabsExcept: function (exceptName)\n\t{\n\t\tif (!exceptName) exceptName = '';\n\n\t\tif (this.container != null)\n\t\t{\n\t\t\tthis.container.querySelectorAll(':scope > [data-name]').forEach(i =>\n\t\t\t{\n\t\t\t\tif (i.dataset.name == exceptName)\n\t\t\t\t{\n\t\t\t\t\ti.classList.remove('x-hidden');\n\t\t\t\t\tthis.dispatch('tabShown', { name: i.dataset.name, el: i });\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ti.classList.add('x-hidden');\n\t\t\t\t\tthis.dispatch('tabHidden', { name: i.dataset.name, el: i });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.querySelectorAll(\"[data-name]\").forEach(link =>\n\t\t{\n\t\t\tif (link.dataset.name == exceptName)\n\t\t\t\tlink.classList.add('active');\n\t\t\telse\n\t\t\t\tlink.classList.remove('active');\n\t\t});\n\n\t\tthis.activeTab = exceptName;\n\t\tthis.dispatch('tabChanged', { name: exceptName });\n\t},\n\n\t/**\n\t**\tShows the tab with the specified name, ignores `data-base-route` and current route as well.\n\t*/\n\tshowTab: function (name)\n\t{\n\t\treturn this._hideTabsExcept (name);\n\t},\n\n\t/**\n\t**\tShows a tab given its name. The route will be changed automatically if `data-base-route` is enabled.\n\t*/\n\tselectTab: function (name)\n\t{\n\t\tif (this.dataset.baseRoute)\n\t\t{\n\t\t\tconst hash = \"#\" + Router.realLocation(this.dataset.baseRoute.replace('@', name));\n\n\t\t\tif (location.hash != hash)\n\t\t\t{\n\t\t\t\tlocation = hash;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.showTab (name);\n\t}\n});\n","/*\n**\telems/r-form\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n<r-form data-form-action=\"api-function-name\" [data-strict=\"true|false\"] [data-errors-at=\"\"] [data-method=\"post\"]>\n\t<input type=\"text\" data-field=\"username\"/>\n</r-form>\n\nr-form .message.x-hidden {\n    display: none;\n}\n\nr-form span.field-error {\n    display: block;\n    color: red;\n}\n*/\n\nimport { Template } from 'rinn';\nimport Element from '../element.js';\nimport Api from '../api.js';\n\nexport default Element.register ('r-form',\n{\n\t/**\n\t**\tElement events.\n\t*/\n\tevents:\n\t{\n\t\t'change [data-field]': '_fieldChanged',\n\n\t\t'click input[type=reset]': 'reset',\n\t\t'click .reset': 'reset',\n\n\t\t'click input[type=submit]': 'submit',\n\t\t'click button[type=submit]': 'submit',\n\t\t'click .submit': 'submit',\n\t\t'submit form': 'submit'\n\t},\n\n\t/*\n\t**\tInitial form model.\n\t*/\n\tmodel: { },\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tlet formElement = document.createElement('form');\n\t\tformElement.append(...this.childNodes);\n\t\tthis.append(formElement);\n\n\t\tlet def = { };\n\t\tlet names = this.model.get();\n\n\t\tthis.querySelectorAll('[data-field]').forEach((i) =>\n\t\t{\n\t\t\ti.name = i.dataset.field;\n\t\t\tnames[i.name] = i.type;\n\n\t\t\tlet val = i.dataset.default;\n\t\t\tif (val == undefined)\n\t\t\t{\n\t\t\t\tswitch (i.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'radio':\n\t\t\t\t\t\tif (!i.checked) return;\n\t\t\t\t\t\tval = i.value;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\tval = i.checked ? '1' : '0';\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'field':\n\t\t\t\t\t\tval = i.getValue();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'file':\n\t\t\t\t\t\tval = '';\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tval = '';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdef[i.dataset.field] = val;\n\t\t});\n\n\t\tfor (let name in names)\n\t\t{\n\t\t\tif (name in def)\n\t\t\t\tnames[name] = def[name];\n\t\t\telse\n\t\t\t\tnames[name] = '';\n\t\t}\n\n\t\tdef = names;\n\n\t\tthis.model.defaults = def;\n\t\tthis.model.reset();\n\n\t\tthis.clearMarkers();\n\t},\n\n\t/*\n\t**\tTransforms an string returned by the server to a local representation.\n\t*/\n\tfilterString: function (str, r)\n\t{\n\t\tif (!str || !('messages' in global))\n\t\t\treturn str;\n\n\t\tif (str.startsWith('@messages.'))\n\t\t{\n\t\t\tif (str.substr(10) in global.messages)\n\t\t\t\tstr = Template.eval(global.messages[str.substr(10)], r);\n\t\t}\n\n\t\treturn str;\n\t},\n\n\t_change: function(elem)\n\t{\n\t\tif ('createEvent' in document)\n\t\t{\n\t\t\tlet evt = document.createEvent('HTMLEvents');\n\t\t\tevt.initEvent('change', false, true);\n\t\t\telem.dispatchEvent(evt);\n\t\t}\n\t\telse\n\t\t\telem.fireEvent('onchange');\n\t},\n\n\t_setField: function (f, value, silent)\n\t{\n\t\tif (!f) return;\n\n\t\tfor (f of this.querySelectorAll('[data-field=\"'+f+'\"]'))\n\t\t{\n\t\t\tswitch (f.type || f.tagName.toLowerCase())\n\t\t\t{\n\t\t\t\tcase 'select':\n\t\t\t\t\tf.val = f.dataset.value = f.multiple ? (value ? value.split(',') : value) : value;\n\t\t\t\t\tf.value = f.val = f.dataset.value;\n\n\t\t\t\t\tif (silent !== true) this._change(f);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\tf.checked = parseInt(value) ? true : false;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\tf.checked = value == f.value;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'field':\n\t\t\t\t\tf.val = f.dataset.value = value;\n\t\t\t\t\tf.setValue(value);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'file':\n\t\t\t\t\tif ((value instanceof File) || (value instanceof Blob))\n\t\t\t\t\t{\n\t\t\t\t\t\tf.val = value;\n\t\t\t\t\t\tf.dataset.value = value;\n\t\t\t\t\t}\n\t\t\t\t\telse if (value instanceof FileList)\n\t\t\t\t\t{\n\t\t\t\t\t\tf.val = value;\n\t\t\t\t\t\tf.dataset.value = value;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tf.val = f.dataset.value = '';\n\t\t\t\t\t\tf.value = '';\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tf.val = f.dataset.value = value;\n\t\t\t\t\tf.value = value;\n\n\t\t\t\t\tif (silent !== true) this._change(f);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t},\n\n\t_getField: function (f, _value=null, fromFileFields=false)\n\t{\n\t\tif (!f) return null;\n\n\t\tif (typeof(f) != 'string')\n\t\t{\n\t\t\tlet value = f.value == null ? f.val : f.value;\n\t\t\tif (value === null) value = _value;\n\n\t\t\tswitch (f.type || f.tagName.toLowerCase())\n\t\t\t{\n\t\t\t\tcase 'select':\n\t\t\t\t\t_value = f.multiple ? (value ? value.join(',') : value) : value;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\t_value = f.checked ? '1' : '0';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\tif (f.checked) _value = f.value;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'field':\n\t\t\t\t\t_value = f.getValue();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'file':\n\t\t\t\t\t_value = fromFileFields ? (f.files && f.files.length ? (f.multiple ? f.files : f.files[0]) : null) : f.val;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t_value = value;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn _value === null ? '' : _value;\n\t\t}\n\n\t\t_value = null;\n\n\t\tfor (f of this.querySelectorAll('[data-field=\"'+f+'\"]'))\n\t\t\t_value = this._getField(f, _value);\n\n\t\treturn _value === null ? '' : _value;\n\t},\n\n\tgetField: function (name)\n\t{\n\t\treturn this._getField(name);\n\t},\n\n\tclearMarkers: function ()\n\t{\n\t\tthis.classList.remove('busy');\n\n\t\tthis.querySelectorAll('.message').forEach(i => i.classList.add('x-hidden') );\n\t\tthis.querySelectorAll('span.field-error').forEach(i => i.remove());\n\n\t\tthis.querySelectorAll('.field-error').forEach(i => { i.classList.remove('field-error'); i.classList.remove('is-invalid'); });\n\t\tthis.querySelectorAll('.field-passed').forEach(i => i.classList.remove('field-passed'));\n\t},\n\n\t_fieldChanged: function (evt)\n\t{\n\t\tlet f = evt.source;\n\n\t\tif (f.type == 'file')\n\t\t\tthis.model.set (f.dataset.field, this._getField(f, null, true), true);\n\t\telse\n\t\t\tthis.model.set (f.dataset.field, this._getField(f));\n\n\t\tevt.continuePropagation = true;\n\t},\n\n\tonModelPropertyChanged: function (evt, args)\n\t{\n\t\tthis._setField (args.name, args.value);\n\t},\n\n\t_onSuccess: function(r)\n\t{\n\t\tthis.classList.remove('busy');\n\t\tlet tmp;\n\n\t\tthis.dispatch ('formSuccess', r);\n\n\t\tif (r.message && (tmp = this.querySelector('.message.success')) != null)\n\t\t{\n\t\t\ttmp.innerHTML = this.filterString(r.message, r).replace(/\\n/g, '<br/>');\n\t\t\ttmp.classList.remove('x-hidden');\n\t\t\ttmp.onanimationend = () => tmp.classList.add('x-hidden');\n\t\t}\n\t},\n\n\t_onFailure: function(r)\n\t{\n\t\tthis.classList.remove('busy');\n\t\tlet tmp;\n\n\t\tthis.dispatch ('formError', r);\n\n\t\tif (r.fields)\n\t\t{\n\t\t\tfor (let i in r.fields)\n\t\t\t{\n\t\t\t\tlet f = this.querySelector('[data-field-container=\"'+i+'\"]');\n\t\t\t\tif (!f)\n\t\t\t\t{\n\t\t\t\t\tf = this.querySelector('[data-field=\"'+i+'\"]');\n\t\t\t\t\tif (!f) continue;\n\t\t\t\t}\n\n\t\t\t\tlet tmp = document.createElement('span');\n\t\t\t\ttmp.classList.add('field-error');\n\t\t\t\ttmp.innerHTML = this.filterString(r.fields[i], r).replace(/\\n/g, '<br/>');\n\n\t\t\t\tf.classList.add('field-error');\n\t\t\t\tf.classList.add('is-invalid');\n\n\t\t\t\tif (this.dataset.errorsAt == 'bottom')\n\t\t\t\t\tf.parentElement.append(tmp);\n\t\t\t\telse if (this.dataset.errorsAt == 'top')\n\t\t\t\t\tf.parentElement.prepend(tmp);\n\t\t\t\telse\n\t\t\t\t\tf.parentElement.insertBefore(tmp, f.nextElementSibling);\n\n\t\t\t\tsetTimeout((function (tmp) { return function() { tmp.classList.add('active'); } })(tmp), 25);\n\t\t\t}\n\n\t\t\tif (r.error && (tmp = this.querySelector('.message.error')) != null)\n\t\t\t{\n\t\t\t\ttmp.innerHTML = this.filterString(r.error, r).replace(/\\n/g, '<br/>');\n\t\t\t\ttmp.classList.remove('x-hidden');\n\t\t\t\ttmp.onanimationend = () => tmp.classList.add('x-hidden');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif ((tmp = this.querySelector('.message.error')) != null)\n\t\t\t{\n\t\t\t\ttmp.innerHTML = this.filterString(r.error, r).replace(/\\n/g, '<br/>') || ('Error: ' + r.response);\n\t\t\t\ttmp.classList.remove('x-hidden');\n\t\t\t\ttmp.onanimationend = () => tmp.classList.add('x-hidden');\n\t\t\t}\n\t\t}\n\t},\n\n\treset: function (nsilent)\n\t{\n\t\tthis.model.reset (nsilent);\n\t\tthis.clearMarkers();\n\n\t\tif (nsilent === false)\n\t\t{\n\t\t\tfor (var i in this.model.data)\n\t\t\t\tthis._setField (i, this.model.data[i], true);\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tsubmit: function ()\n\t{\n\t\tif (this.classList.contains('busy'))\n\t\t\treturn;\n\n\t\tlet data = { };\n\n\t\tif (this.dataset.strict == 'false')\n\t\t\tObject.assign(data, this.model.get());\n\n\t\tlet list = { };\n\t\tthis.querySelectorAll('[data-field]').forEach(e => list[e.dataset.field] = true);\n\t\tObject.keys(list).forEach(f => data[f] = this._getField(f));\n\n\t\tthis.model.set(data);\n\n\t\tlet f = this.dataset.formAction || this.formAction;\n\t\tif (!f) return;\n\n\t\tthis.clearMarkers();\n\n\t\tthis.classList.add('busy');\n\n\t\tif (typeof(f) != 'function')\n\t\t{\n\t\t\tdata.f = f;\n\t\t\tApi.apiCall(data, (r) => this[r.response == 200 ? '_onSuccess' : '_onFailure'](r), (r) => this._onFailure({ error: 'Unable to execute request.' }), this.dataset.method ?? 'POST');\n\t\t}\n\t\telse\n\t\t\tf(data, (r) => this[r.response == 200 ? '_onSuccess' : '_onFailure'](r));\n\t}\n});\n","/*\n**\telems/r-panel\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-panel data-route=\"name\">\n\t</r-panel>\n\n\tr-panel {\n\t\tdisplay: block;\n\t}\n\n\tr-panel:not(.active) {\n\t\tdisplay: none;\n\t}\n\n*/\n\nimport Element from '../element.js';\nimport Router from '../router.js';\n\nexport default Element.register ('r-panel',\n{\n\t/**\n\t**\tRoute object used by this element.\n\t*/\n\troute: null,\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.style.display = '';\n\n\t\t// Executed then the panel route is activated.\n\t\tthis._onActivate = (evt, args) =>\n\t\t{\n\t\t\tif (!args.route.changed)\n\t\t\t\treturn;\n\n\t\t\tthis.show(true);\n\t\t};\n\n\t\t// Executed then the panel route is deactivated.\n\t\tthis._onDeactivate = (evt, args) =>\n\t\t{\n\t\t\tthis.hide();\n\t\t};\n\n\t\tthis.hide();\n\t},\n\n\t/**\n\t**\tAdds a handler to Router if the data-route attribute was set.\n\t*/\n\tonConnected: function()\n\t{\n\t\tif (this.dataset.route)\n\t\t{\n\t\t\tthis.route = Router.addRoute (this.dataset.route, this._onActivate, this._onDeactivate);\n\t\t\tthis.classList.remove('active');\n\t\t}\n\t\telse\n\t\t\tthis.classList.add('active');\n\t},\n\n\t/**\n\t**\tRemoves a handler previously added to Router if the data-route attribute was set.\n\t*/\n\tonDisconnected: function()\n\t{\n\t\tif (this.dataset.route)\n\t\t\tRouter.removeRoute(this.dataset.route, this._onActivate, this._onDeactivate);\n\t},\n\n\t/**\n\t**\tHides the panel by removing the `active` class from the element. Fires `panelHidden` event.\n\t*/\n\thide: function ()\n\t{\n\t\tthis.classList.remove('active');\n\t\tthis.dispatch('panelHidden', this.route ? this.route.args : { });\n\t},\n\n\t/**\n\t**\tShows the panel visible by adding `active` class to the element. If `silent` is true and `data-route` enabled, the current route\n\t**\twill not be updated. Fires `panelShown` event.\n\t*/\n\tshow: function (silent=false)\n\t{\n\t\tif (this.dataset.route && !silent)\n\t\t{\n\t\t\tlet hash = \"#\" + this.dataset.route;\n\n\t\t\tif (window.location.hash.substr(0, hash.length) != hash)\n\t\t\t{\n\t\t\t\twindow.location = hash;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.classList.add('active');\n\t\tthis.dispatch('panelShown', this.route ? this.route.args : { });\n\t}\n});\n","/*\n**\telems/r-list\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-list data-list=\"window.dataList1\" data-container=\".x-data\" data-wrap=\"true|false\">\n\n\t\t<template data-mode=\"static|dynamic\">\n\t\t</template>\n\n\t\t<div class=\"x-empty\">\n\t\t\tNothing to show.\n\t\t</div>\n\n\t\t<div class=\"x-data\">\n\t\t</div>\n\n\t</r-list>\n\n\tCSS:\n\t\t.x-hidden {\n\t\t\tdisplay: none;\n\t\t}\n\n\tModifiers:\n\t\t.x-empty-null\t\tVisible when the list is in undefined state (before first load).\n\t\t.x-empty\t\t\tVisible when there is no data in the list.\n\t\t.x-not-empty \t\tVisible when there is data in the list.\n\t\t.x-loading \t\t\tVisible when the list is loading.\n*/\n\nimport { Rinn, ModelList, Template } from 'rinn';\nimport Element from '../element.js';\n\n/*\n**\tConnects to a ModelList and renders its contents using a template. When using \"dynamic\" template, the contents can be other custom elements, and\n**\tthe model of each item can be accessed by using data-model=\":list-item\", which will cause the item model to be added to the element.\n**\n**\tAdditionally root attribute data-wrap can be set to 'true' to wrap the template contents inside a div with a data-iid representing the ID of the\n**\titem, this will cause any changes to items to affect only the specific item in question.\n*/\n\nexport default Element.register ('r-list',\n{\n\tlist: null,\n\n\tcontainer: null,\n\ttemplate: null,\n\tisEmpty: false,\n\tisDynamicTemplate: false,\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tthis.container = this.querySelector(this.dataset.container || '.x-data');\n\t\tif (!this.container)\n\t\t{\n\t\t\tthis.container = document.createElement('div');\n\t\t\tthis.container.className = 'x-data';\n\t\t\tthis.appendChild(this.container);\n\t\t}\n\n\t\tlet tmp = this.template_elem = this.querySelector('template');\n\t\tif (tmp)\n\t\t{\n\t\t\tif (tmp.dataset.mode != 'dynamic')\n\t\t\t{\n\t\t\t\tthis.template = Template.compile(tmp.innerHTML);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.template = () => tmp.innerHTML;\n\t\t\t\tthis.isDynamicTemplate = true;\n\t\t\t}\n\n\t\t\ttmp.remove();\n\t\t}\n\t\telse\n\t\t\tthis.template = () => '';\n\n\t\tthis.container.textContent = ' ';\n\n\t\tthis.setEmpty(null);\n\t\tthis.setLoading(null);\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet list = this.getFieldByPath(this.dataset.list);\n\t\tif (!list)\n\t\t{\n\t\t\tconsole.error('List not found: ' + this.dataset.list);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setList (list);\n\t},\n\n\t/*\n\t**\tIndicates if the list is empty. Elements having x-empty, x-not-empty and x-empty-null will be updated.\n\t*/\n\tsetEmpty: function (value)\n\t{\n\t\tif (this.isEmpty === value)\n\t\t\treturn;\n\n\t\tif (value === true)\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-empty-null').forEach(i => i.classList.add('x-hidden'));\n\t\t}\n\t\telse if (value === false)\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-empty-null').forEach(i => i.classList.add('x-hidden'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-empty-null').forEach(i => i.classList.remove('x-hidden'));\n\t\t}\n\n\t\tthis.isEmpty = value;\n\t},\n\n\t/*\n\t**\tIndicates if the list is loading. Elements having x-loading will be updated.\n\t*/\n\tsetLoading: function (value)\n\t{\n\t\tif (value === true)\n\t\t\tthis.querySelectorAll('.x-loading').forEach(i => i.classList.remove('x-hidden'));\n\t\telse\n\t\t\tthis.querySelectorAll('.x-loading').forEach(i => i.classList.add('x-hidden'));\n\t},\n\n\t/**\n\t**\tSets the list model-list of the element.\n\t*/\n\tsetList: function (list)\n\t{\n\t\tif (!list || !Rinn.isInstanceOf(list, ModelList) || this.list === list)\n\t\t\treturn;\n\n\t\tif (this.list != null)\n\t\t{\n\t\t\tif (this.list.dataSource)\n\t\t\t\tthis.list.dataSource.removeEventListener (this.eid+':*');\n\n\t\t\tif (this.list.dataList)\n\t\t\t\tthis.list.dataList.removeEventListener (this.eid+':*');\n\n\t\t\tthis.list.removeEventListener (this.eid+':*');\n\t\t}\n\n\t\tthis.list = list;\n\n\t\tif (this.list.dataSource)\n\t\t{\n\t\t\tthis.list.dataSource.addEventListener (this.eid+':listLoading', this.onLoading, this);\n\t\t\tthis.list.dataSource.addEventListener (this.eid+':listLoaded', this.onLoaded, this);\n\t\t}\n\n\t\tif (this.list.dataList)\n\t\t{\n\t\t\tthis.list.dataList.addEventListener (this.eid+':listLoading', this.onLoading, this);\n\t\t\tthis.list.dataList.addEventListener (this.eid+':listLoaded', this.onLoaded, this);\n\t\t}\n\n\t\tthis.list.addEventListener (this.eid+':itemsCleared', this.onItemsCleared, this);\n\t\tthis.list.addEventListener (this.eid+':itemsChanged', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemRemoved', this.onItemRemoved, this);\n\t\tthis.list.addEventListener (this.eid+':itemChanged', this.onItemChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemAdded', this.onItemAdded, this);\n\t},\n\n\t/*\n\t**\tBuilds an item (inside a div) to be added to the container.\n\t*/\n\tbuildItem: function (iid, data, asHtml=false)\n\t{\n\t\tlet html = this.template(data.get());\n\t\tif (asHtml) return html;\n\n\t\tlet elem = document.createElement('div');\n\t\t\n\t\telem.dataset.iid = iid;\n\t\telem.innerHTML = html;\n\n\t\telem.querySelectorAll('[data-model=\":list-item\"]').forEach(i => {\n\t\t\ti.model = data;\n\t\t\ti.dataset.model = \"this.model\";\n\t\t});\n\n\t\tfor (let attr of this.template_elem.attributes)\n\t\t{\n\t\t\tif (attr.nodeName.startsWith('data-_') || attr.nodeName == 'data-mode')\n\t\t\t\tcontinue;\n\n\t\t\telem.setAttribute(attr.nodeName, attr.nodeValue);\n\t\t}\n\n\t\treturn elem;\n\t},\n\n\t/*\n\t**\tExecuted when the list is loading.\n\t*/\n\tonLoading: function()\n\t{\n\t\tthis.setLoading(true);\n\t},\n\n\t/*\n\t**\tExecuted when the list finished loading.\n\t*/\n\tonLoaded: function()\n\t{\n\t\tthis.setLoading(false);\n\t},\n\n\t/*\n\t**\tExecuted when the list is cleared.\n\t*/\n\tonItemsCleared: function()\n\t{\n\t\tthis.container._timeout = setTimeout(() => {\n\t\t\tthis.setEmpty(true);\n\t\t\tthis.container._timeout = null;\n\t\t\tthis.container.textContent = '';\n\t\t}, 300);\n\t},\n\n\t/*\n\t**\tExecuted when the items of the list changed.\n\t*/\n\tonItemsChanged: function()\n\t{\n\t\tif (this.list.length() == 0)\n\t\t\treturn;\n\n\t\tif (this.container._timeout)\n\t\t\tclearTimeout(this.container._timeout);\n\n\t\tthis.container._timeout = null;\n\t\tthis.container.textContent = '';\n\n\t\tlet i = 0;\n\n\t\tfor (let data of this.list.getData())\n\t\t{\n\t\t\tif (this.dataset.wrap != 'false')\n\t\t\t\tthis.container.append(this.buildItem(this.list.itemId[i++], data));\n\t\t\telse\n\t\t\t\tthis.container.innerHTML += this.buildItem(this.list.itemId[i++], data, true);\n\t\t}\n\n\t\tthis.setEmpty(i == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item is removed from the list.\n\t*/\n\tonItemRemoved: function(evt, args)\n\t{\n\t\tif (this.dataset.wrap == 'false')\n\t\t{\n\t\t\tthis.onItemsChanged();\n\t\t\treturn;\n\t\t}\n\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\telem.remove();\n\t\tthis.setEmpty(this.list.length() == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item changes.\n\t*/\n\tonItemChanged: function(evt, args)\n\t{\n\t\tif (this.isDynamicTemplate) return;\n\n\t\tif (this.dataset.wrap == 'false')\n\t\t{\n\t\t\tthis.onItemsChanged();\n\t\t\treturn;\n\t\t}\n\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\telem.innerHTML = this.template(args.item);\n\t},\n\n\t/*\n\t**\tExecuted when an item is added to the list.\n\t*/\n\tonItemAdded: function(evt, args)\n\t{\n\t\tif (args.position == 'head')\n\t\t{\n\t\t\tif (this.dataset.wrap != 'false')\n\t\t\t\tthis.container.prepend(this.buildItem(args.id, args.item));\n\t\t\telse\n\t\t\t\tthis.container.innerHTML = this.buildItem(args.id, args.item, true) + this.container.innerHTML;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.dataset.wrap != 'false')\n\t\t\t\tthis.container.append(this.buildItem(args.id, args.item));\n\t\t\telse\n\t\t\t\tthis.container.innerHTML += this.buildItem(args.id, args.item, true);\n\t\t}\n\n\t\tthis.setEmpty(false);\n\t},\n\n\t/**\n\t * \tForces re-rendering of the element.\n\t */\n\trefresh: function()\n\t{\n\t\tthis.onItemsChanged();\n\t}\n});\n","/*\n**\telems/r-item\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-item data-model=\"window.model1\">\n\t</r-item>\n*/\n\nimport Element from '../element.js';\n\nexport default Element.register ('r-item',\n{\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t},\n\n\t/**\n\t**\tExecuted when the children and root are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet model = this.getFieldByPath(this.dataset.model);\n\t\tif (!model) model = { };\n\n\t\tthis.setModel (model);\n\t}\n});\n","/*\n**\telems/r-paginator\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-paginator data-source=\"window.dataSource1\" data-page-size=\"25\">\n\t\t<span data-watch=\"count\">Showing [offsetStart] to [offsetEnd] out of [count]</span>\n\n\t\t<button data-action=\"firstPage\">First</button>\n\t\t<button data-action=\"prevPage\">&laquo;</button>\n\t\t<button data-action=\"nextPage\">&raquo;</button>\n\t\t<button data-action=\"lastPage\">Last</button>\n\t\t<button data-action=\"refresh\">Refresh</button>\n\n\t\t<input type=\"text\" data-property=\"pageSize\" />\n\t</r-paginator>\n*/\n\nimport { Rinn } from 'rinn';\nimport Element from '../element.js';\nimport DataSource from '../data-source.js';\n\n/*\n**\tConnects to a data source to provide pagination features.\n*/\n\nexport default Element.register ('r-paginator',\n{\n\tsource: null,\n\ttemplate: null,\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.setModel({\n\t\t\toffsetStart: 0,\n\t\t\toffsetEnd: 0,\n\t\t\tcount: 0, offset: 0,\n\t\t\tcurrentPageSize: this.dataset.pageSize || 25,\n\t\t\tpageSize: this.dataset.pageSize || 25\n\t\t});\n\n\t\tthis.listen('propertyChanged.pageSize', (evt, args) =>\n\t\t{\n\t\t\tif (this.model.get('currentPageSize') == args.value)\n\t\t\t\treturn;\n\n\t\t\tthis.model.set('currentPageSize', args.value);\n\t\t\tthis.updateOffset('range');\n\t\t});\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet source = this.getFieldByPath(this.dataset.source);\n\t\tif (!source)\n\t\t{\n\t\t\tconsole.error('data-source not found: ' + this.dataset.source);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setSource(source);\n\t},\n\n\t/**\n\t**\tSets the source model-list of the paginator.\n\t*/\n\tsetSource: function (source)\n\t{\n\t\tif (!source || !Rinn.isInstanceOf(source, DataSource) || this.source === source)\n\t\t\treturn;\n\n\t\tif (this.source != null)\n\t\t{\n\t\t\tthis.source.removeEventListener (this.eid+':*');\n\t\t\tthis.source.includeCount = false;\n\t\t}\n\n\t\tthis.source = source;\n\n\t\tthis.source.includeCount = true;\n\t\tthis.updateOffset();\n\n\t\tthis.source.addEventListener (this.eid+':requestPropertyChanged', this.onRequestPropertyChanged, this);\n\t\tthis.source.addEventListener (this.eid+':countChanged', this.onCountChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemRemoved', this.onItemRemoved, this);\n\t\tthis.source.addEventListener (this.eid+':listItemAdded', this.onItemAdded, this);\n\n\t\tthis.source.setNamespace(this.eid);\n\t\tthis.source.request.update(true);\n\t\tthis.source.setNamespace(null);\n\t},\n\n\t/*\n\t**\tUpdates several offset related fields in the paginator model. Optionally refreshes the data source with the specified mode.\n\t*/\n\tupdateOffset: function(mode=null)\n\t{\n\t\tthis.model.set('offsetStart', this.model.get('count') != 0 ? this.model.get('offset') + 1 : 0);\n\t\tthis.model.set('offsetEnd', Math.min(this.model.get('count'), this.model.get('offsetStart') + this.model.getInt('pageSize') - 1));\n\t\tthis.model.update('count');\n\n\t\tlet _count = this.source.request.get('count');\n\t\tlet _offset = this.source.request.get('offset');\n\n\t\tthis.source.request.set('count', this.model.getInt('pageSize'));\n\t\tthis.source.request.set('offset', this.model.get('offset'));\n\n\t\tif (mode && (_count != this.source.request.get('count') || _offset != this.source.request.get('offset')))\n\t\t\tthis.source.refresh(mode);\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the source request changes. The property is copied to the local model.\n\t*/\n\tonRequestPropertyChanged: function(evt, args)\n\t{\n\t\tif (args.name == 'count' || args.name == 'offset')\n\t\t\treturn;\n\n\t\tthis.model.set(args.name, args.value);\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the model has changed. The property is copied to the data source request model.\n\t*/\n\tonModelPropertyChanged: function (evt, args)\n\t{\n\t\tlet ignored = [\n\t\t\t'offsetStart',\n\t\t\t'offsetEnd',\n\t\t\t'count',\n\t\t\t'offset',\n\t\t\t'currentPageSize',\n\t\t\t'pageSize'\n\t\t];\n\n\t\tif (ignored.indexOf(args.name) != -1)\n\t\t\treturn;\n\n\t\tif (this.source.request.get(args.name) == args.value)\n\t\t\treturn;\n\n\t\tthis.source.request.set(args.name, args.value);\n\t\tthis.source.refresh('filter');\n\t},\n\n\t/*\n\t**\tExecuted when the remote count changes.\n\t*/\n\tonCountChanged: function(evt, args)\n\t{\n\t\tthis.model.set('count', evt.source.count, false);\n\t\tthis.updateOffset();\n\t},\n\n\t/*\n\t**\tExecuted when an item is removed from the list.\n\t*/\n\tonItemRemoved: function(evt, args)\n\t{\n\t\tthis.model.set('count', this.model.getInt('count') - 1, false);\n\t\tthis.updateOffset();\n\t},\n\n\t/*\n\t**\tExecuted when an item is added to the list.\n\t*/\n\tonItemAdded: function(evt, args)\n\t{\n\t\tthis.model.set('count', this.model.getInt('count') + 1, false);\n\t\tthis.updateOffset();\n\t},\n\n\t/*\n\t**\tMoves to the previous page.\n\t*/\n\tprevPage: function()\n\t{\n\t\tif (this.model.get('offset') <= 0)\n\t\t\treturn;\n\n\t\tlet offs = this.model.get('offset') - this.model.getInt('pageSize');\n\t\tif (offs < 0) offs = 0;\n\n\t\tthis.model.set('offset', offs);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tMoves to the next page.\n\t*/\n\tnextPage: function()\n\t{\n\t\tlet offs = this.model.get('offset') + this.model.getInt('pageSize');\n\t\tif (offs >= this.model.get('count')) return;\n\n\t\tthis.model.set('offset', offs);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tMoves to the first page.\n\t*/\n\tfirstPage: function()\n\t{\n\t\tthis.model.set('offset', 0);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tMoves to the last page.\n\t*/\n\tlastPage: function()\n\t{\n\t\tlet offs = this.model.get('count') - this.model.getInt('pageSize');\n\t\tif (offs < 0) offs = 0;\n\n\t\tthis.model.set('offset', offs);\n\t\tthis.updateOffset('range');\n\t},\n\n\t/*\n\t**\tRefreshes the data source.\n\t*/\n\trefresh: function()\n\t{\n\t\tthis.source.refresh('full');\n\t},\n\n\t/*\n\t**\tClears (set to empty) the specified fields from the data source's request parameters.\n\t*/\n\tclear: function(args)\n\t{\n\t\tfor (let i = 0; i < args.length; i++)\n\t\t\tthis.model.set(args[i], '');\n\t}\n});\n","/*\n**\telems/r-table\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-table data-source=\"window.dataSource1\">\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>A</th>\n\t\t\t\t\t<th>B</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\n\t\t\t<tbody class=\"x-data\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td>[a]</td>\n\t\t\t\t\t<td>[b]</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</r-table>\n\n\tCSS:\n\t\t.x-hidden {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\tth[data-sort] {\n\t\t\tcursor: pointer; text-decoration: underline;\n\t\t}\n\n\t\tth[data-sort][data-order=\"asc\"]:before {\n\t\t\tcontent: \"\\25B2\";\n\t\t}\n\n\t\tth[data-sort][data-order=\"desc\"]:before {\n\t\t\tcontent: \"\\25BC\";\n\t\t}\n\n\tModifiers:\n\t\t.x-empty\t\t\tAdd to elements that should be shown only when there is no data in the data source.\n\t\t.x-not-empty \t\tAdd to elements that should be shown only when there is data in the data source.\n\t\t[data-sort]\t\t\tAdded to th/td elements in thead, marks the column as sortable.\n*/\n\nimport { Rinn, Template } from 'rinn';\nimport Element from '../element.js';\nimport DataSource from '../data-source.js';\n\n/*\n**\tConnects to a DataSource and renders its contents as a table.\n*/\n\nexport default Element.register ('r-table',\n{\n\tsource: null,\n\ttemplate: null,\n\tcontainer: null,\n\tisEmpty: null,\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.setModel({ });\n\t},\n\n\t/**\n\t**\tExecuted when the children of the element are ready.\n\t*/\n\tready: function()\n\t{\n\t\tthis.container = this.querySelector(this.dataset.container || 'tbody.x-data');\n\t\tif (!this.container) throw new Error ('r-table requires a container');\n\n\t\tif (this.container.dataset.mode != 'dynamic')\n\t\t\tthis.template = Template.compile(this.container.innerHTML);\n\t\telse\n\t\t\tthis.template = () => this.container.innerHTML;\n\n\t\tthis.temporalBody = document.createElement('tbody');\n\t\tthis.container.textContent = ' ';\n\n\t\tthis.setEmpty(true);\n\t},\n\n\t/**\n\t**\tExecuted when the children and root elements are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet source = this.getFieldByPath(this.dataset.source);\n\t\tif (!source)\n\t\t{\n\t\t\tconsole.error('data-source not found: ' + this.dataset.source);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setSource (source);\n\t},\n\n\t/*\n\t**\tIndicates if the table is empty. Elements having .x-not-empty will be hidden.\n\t*/\n\tsetEmpty: function (value)\n\t{\n\t\tif (this.isEmpty === value)\n\t\t\treturn;\n\n\t\tif (value)\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.querySelectorAll('.x-empty').forEach(i => i.classList.add('x-hidden'));\n\t\t\tthis.querySelectorAll('.x-not-empty').forEach(i => i.classList.remove('x-hidden'));\n\t\t}\n\n\t\tthis.isEmpty = value;\n\t},\n\n\t/**\n\t**\tSets the data source of the element.\n\t*/\n\tsetSource: function (source)\n\t{\n\t\tif (!source || !Rinn.isInstanceOf(source, DataSource) || this.source === source)\n\t\t\treturn;\n\n\t\tif (this.source != null)\n\t\t\tthis.source.removeEventListener (this.eid+':*');\n\n\t\tthis.source = source;\n\n\t\tthis.source.addEventListener (this.eid+':requestPropertyChanged', this.onRequestPropertyChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemsCleared', this.onItemsCleared, this);\n\t\tthis.source.addEventListener (this.eid+':listItemsChanged', this.onItemsChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemRemoved', this.onItemRemoved, this);\n\t\tthis.source.addEventListener (this.eid+':listItemChanged', this.onItemChanged, this);\n\t\tthis.source.addEventListener (this.eid+':listItemAdded', this.onItemAdded, this);\n\n\t\tthis.source.setNamespace(this.eid);\n\t\tthis.source.request.update(true);\n\t\tthis.source.setNamespace(null);\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the source request changes. The property is copied to the local model.\n\t*/\n\tonRequestPropertyChanged: function(evt, args)\n\t{\n\t\tthis.model.set(args.name, args.value);\n\n\t\tif (args.name == 'sort')\n\t\t{\n\t\t\tthis.querySelectorAll('thead [data-sort]').forEach(i => i.dataset.order = '');\n\t\t}\n\t\telse if (args.name == 'order')\n\t\t{\n\t\t\tlet elem = this.querySelector('thead [data-sort=\"'+evt.source.get('sort')+'\"]');\n\t\t\tif (elem) elem.dataset.order = args.value;\n\t\t}\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the model has changed. The property is copied to the data source request model.\n\t*/\n\tonModelPropertyChanged: function (evt, args)\n\t{\n\t\tif (this.source.request.get(args.name) == args.value)\n\t\t\treturn;\n\n\t\tthis.source.request.set(args.name, args.value);\n\n\t\tlet ignored = [\n\t\t\t'count',\n\t\t\t'offset'\n\t\t];\n\n\t\tif (ignored.indexOf(args.name) != -1)\n\t\t\treturn;\n\n\t\tthis.source.refresh('filter');\n\t},\n\n\t/*\n\t**\tEvent handler invoked when a property of the model is removed.\n\t*/\n\tonModelPropertyRemoved: function (evt, args)\n\t{\n\t\tif (typeof(args.fields) == 'string')\n\t\t\tthis.source.request.remove(i);\n\t\telse\n\t\t\targs.fields.forEach(i => this.source.request.remove(i));\n\n\t\tthis.source.refresh('filter');\n\t},\n\n\t/*\n\t**\tBuilds an item to be added to the container.\n\t*/\n\tbuildItem: function (iid, data)\n\t{\n\t\tlet elem = this.temporalBody;\n\n\t\telem.innerHTML = this.template(data.get());\n\n\t\telem.querySelectorAll('[data-model=\":list-item\"]').forEach(i => {\n\t\t\ti.model = data;\n\t\t\ti.dataset.model = \"this.model\";\n\t\t});\n\n\t\telem = elem.firstElementChild;\n\t\telem.dataset.iid = iid;\n\n\t\treturn elem;\n\t},\n\n\t/*\n\t**\tExecuted when the list is cleared.\n\t*/\n\tonItemsCleared: function(evt, args)\n\t{\n\t\tthis.container._timeout = setTimeout(() => {\n\t\t\tthis.setEmpty(true);\n\t\t\tthis.container._timeout = null;\n\t\t\tthis.container.textContent = '';\n\t\t}, 300);\n\t},\n\n\t/*\n\t**\tExecuted when the items of the list changed.\n\t*/\n\tonItemsChanged: function(evt, args)\n\t{\n\t\tif (this.source.list.length() == 0)\n\t\t\treturn;\n\n\t\tif (this.container._timeout)\n\t\t\tclearTimeout(this.container._timeout);\n\n\t\tthis.container._timeout = null;\n\t\tthis.container.textContent = '';\n\n\t\tlet i = 0;\n\n\t\tfor (let data of this.source.list.getData())\n\t\t\tthis.container.append(this.buildItem(this.source.list.itemId[i++], data));\n\n\t\tthis.setEmpty(i == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item is removed from the list.\n\t*/\n\tonItemRemoved: function(evt, args)\n\t{\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\telem.remove();\n\t\tthis.setEmpty(this.source.list.length() == 0);\n\t},\n\n\t/*\n\t**\tExecuted when an item changes.\n\t*/\n\tonItemChanged: function(evt, args)\n\t{\n\t\tlet elem = this.container.querySelector('[data-iid=\"'+args.id+'\"]');\n\t\tif (!elem) return;\n\n\t\tlet _elem = this.buildItem(args.id, args.item);\n\t\tthis.container.replaceChild(_elem, elem);\n\t},\n\n\t/*\n\t**\tExecuted when an item is added to the list.\n\t*/\n\tonItemAdded: function(evt, args)\n\t{\n\t\tif (args.position == 'head')\n\t\t\tthis.container.prepend(this.buildItem(args.id, args.item));\n\t\telse\n\t\t\tthis.container.append(this.buildItem(args.id, args.item));\n\n\t\tthis.setEmpty(false);\n\t},\n\n\t/*\n\t**\tHandles clicks to data-sort elements.\n\t*/\n\t\"event click thead [data-sort]\": function(evt, args)\n\t{\n\t\tif (this.source.request.get('sort') == evt.source.dataset.sort)\n\t\t{\n\t\t\tthis.source.request.set('order', this.source.request.get('order') == 'asc' ? 'desc' : 'asc');\n\t\t\tthis.source.refresh('order');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.source.request.set('sort', evt.source.dataset.sort);\n\t\t\tthis.source.request.set('order', 'asc', true);\n\t\t\tthis.source.refresh('order');\n\t\t}\n\t},\n\n\t/*\n\t**\tRefreshes the data source.\n\t*/\n\trefresh: function()\n\t{\n\t\tthis.source.refresh('full');\n\t},\n\n\t/*\n\t**\tClears (set to empty) the specified fields from the data source's request parameters.\n\t*/\n\tclear: function(args)\n\t{\n\t\tfor (let i = 0; i < args.length; i++)\n\t\t\tthis.model.set(args[i], '');\n\t}\n});\n","/*\n**\telems/r-select\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-select data-list=\"window.dataList1\" data-blank=\"\"></r-select>\n*/\n\nimport { Rinn, ModelList } from 'rinn';\nimport Element from '../element.js';\n\n/*\n**\tConnects to a ModelList and renders its contents as a <select> element.\n*/\n\nexport default Element.register ('r-select',\n{\n\tlist: null,\n\tcontainer: null,\n\n\tvalue: '',\n\n\t/**\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.container = document.createElement('select');\n\t\tthis.parentElement.insertBefore(this.container, this);\n\n\t\tlet list = [];\n\n\t\tfor (let attr of this.attributes)\n\t\t{\n\t\t\tif (attr.nodeName.startsWith('data-_') || attr.nodeName == 'data-list' || attr.nodeName == 'data-blank')\n\t\t\t\tcontinue;\n\n\t\t\tthis.container.setAttribute(attr.nodeName, attr.nodeValue);\n\t\t\tlist.push(attr.nodeName);\n\t\t}\n\n\t\tlist.forEach(i => this.removeAttribute(i));\n\n\t\tthis.textContent = ' ';\n\t\tthis.style.display = 'none';\n\t},\n\n\t/**\n\t**\tExecuted when the children and parent of the element are ready.\n\t*/\n\trready: function()\n\t{\n\t\tlet list = this.getFieldByPath(this.dataset.list);\n\t\tif (!list)\n\t\t{\n\t\t\tconsole.error('List not found: ' + this.dataset.list);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setList(list);\n\n\t\tif (this.parentElement.lastElementChild !== this)\n\t\t\tthis.parentElement.append(this);\n\t},\n\n\t/**\n\t**\tSets the list model-list of the element.\n\t*/\n\tsetList: function (list)\n\t{\n\t\tif (!list || !Rinn.isInstanceOf(list, ModelList) || this.list === list)\n\t\t\treturn;\n\n\t\tif (this.list != null)\n\t\t\tthis.list.removeEventListener (this.eid+':*');\n\n\t\tthis.list = list;\n\n\t\tif (this.list.dataSource)\n\t\t\tthis.list.dataSource.includeEnum = true;\n\n\t\tthis.list.addEventListener (this.eid+':itemsCleared', this.onItemsCleared, this);\n\t\tthis.list.addEventListener (this.eid+':itemsChanged', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemRemoved', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemChanged', this.onItemsChanged, this);\n\t\tthis.list.addEventListener (this.eid+':itemAdded', this.onItemsChanged, this);\n\n\t\tthis.onItemsChanged();\n\t},\n\n\t/*\n\t**\tExecuted when the list is cleared.\n\t*/\n\tonItemsCleared: function(evt, args)\n\t{\n\t\tthis.container.textContent = '';\n\t},\n\n\t/*\n\t**\tExecuted when the items of the list changed.\n\t*/\n\tonItemsChanged: function(evt, args)\n\t{\n\t\tif (this.list.length() == 0)\n\t\t\treturn;\n\n\t\tlet list = this.list.getData();\n\t\tlet value, label, s = '';\n\n\t\tif (list[0].has('value')) value = 'value';\n\t\telse if (list[0].has('id')) value = 'id';\n\n\t\tif (list[0].has('label')) label = 'label';\n\t\telse if (list[0].has('name')) label = 'name';\n\n\t\tif ('blank' in this.dataset)\n\t\t\ts += '<option value=\"\">'+this.dataset.blank+'</option>';\n\n\t\tif (list[0].has('group'))\n\t\t{\n\t\t\tlet groups = { };\n\t\t\tlist.forEach(i => groups[i.get('group')] = null);\n\n\t\t\tfor (let i in groups)\n\t\t\t\tgroups[i] = { name: i, list: [] };\n\n\t\t\tlist.forEach(i => groups[i.get('group')].list.push(i));\n\n\t\t\tgroups = Object.values(groups);\n\t\t\tgroups.forEach(g => {\n\t\t\t\ts += '<optgroup label=\"'+g.name+'\">';\n\t\t\t\tg.list.forEach(i => s += '<option value=\"'+i.get(value)+'\">'+i.get(label)+'</option>');\n\t\t\t\ts += '</optgroup>';\n\t\t\t});\n\t\t}\n\t\telse\n\t\t\tlist.forEach(i => s += '<option value=\"'+i.get(value)+'\">'+i.get(label)+'</option>');\n\n\t\tthis.container.innerHTML = s;\n\t\tthis.container.value = this.container.dataset.value;\n\t},\n\n\t/**\n\t * \tForces re-rendering of the element.\n\t */\n\trefresh: function()\n\t{\n\t\tthis.onItemsChanged();\n\t}\n});\n","\nconst Utils =\n{\n\t/**\n\t**\tForces the browser to show a download dialog.\n\t*/\n\tshowDownload: function (filename, dataUrl)\n\t{\n\t\tvar link = document.createElement(\"a\");\n\t\tlink.href = dataUrl;\n\n\t\tlink.style.display = 'none';\n\t\tlink.download = filename;\n\t\tlink.target = \"_blank\";\n\n\t\tdocument.body.appendChild(link);\n\t\tlink.click();\n\t\tdocument.body.removeChild(link);\n\t},\n\n\t/**\n\t**\tForces the browser to show a file selection dialog.\n\t*/\n\tshowFilePicker: function (allowMultiple, accept, callback)\n\t{\n\t\tvar input = document.createElement(\"input\");\n\n\t\tinput.type = \"file\";\n\t\tinput.accept = accept;\n\t\tinput.style.display = 'none';\n\t\tinput.multiple = allowMultiple;\n\n\t\tdocument.body.appendChild(input);\n\n\t\tinput.onchange = function () {\n\t\t\tcallback(input.files);\n\t\t};\n\n\t\tdocument.body.onfocus = function ()\n\t\t{\n\t\t\tdocument.body.onfocus = null;\n\t\t\tdocument.body.removeChild(input);\n\t\t};\n\n\t\tinput.click();\n\t},\n\n\t/**\n\t**\tLoads a URL using FileReader and returns as a dataURL.\n\t*/\n\tloadAsDataUrl: function (file, callback)\n\t{\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function(e) {\n\t\t\tcallback (e.target.result, null);\n\t\t};\n\n\t\treader.onerror = function(e) {\n\t\t\tcallback (null, e);\n\t\t};\n\n\t\treader.readAsDataURL(file);\n\t},\n\n\t/**\n\t**\tLoads a URL using FileReader and returns as text.\n\t*/\n\tloadAsText: function (file, callback)\n\t{\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function(e) {\n\t\t\tcallback (e.target.result);\n\t\t};\n\n\t\treader.readAsText(file);\n\t},\n\n\t/**\n\t**\tLoads a URL using FileReader and returns as an array buffer.\n\t*/\n\tloadAsArrayBuffer: function (file, callback)\n\t{\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function(e) {\n\t\t\tcallback (e.target.result);\n\t\t};\n\n\t\treader.readAsArrayBuffer(file);\n\t},\n\n\t/**\n\t**\tLoads an array of URLs using FileReader and returns them as data url.\n\t*/\n\tloadAllAsDataUrl: function (fileList, callback)\n\t{\n\t\tvar result = [];\n\n\t\tif (!fileList || !fileList.length)\n\t\t{\n\t\t\tcallback(result);\n\t\t\treturn;\n\t\t}\n\n\t\tvar loadNext = function (i)\n\t\t{\n\t\t\tif (i == fileList.length)\n\t\t\t{\n\t\t\t\tcallback(result);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tUtils.loadAsDataUrl (fileList[i], function(url, err) {\n\t\t\t\tif (!err) {\n\t\t\t\t\tresult.push({ name: fileList[i].name, size: fileList[i].size, url: url });\n\t\t\t\t}\n\t\t\t\tloadNext(i+1);\n\t\t\t});\n\t\t};\n\n\t\tloadNext(0);\n\t},\n\n\t/*\n\t**\tLoads a URL as an image.\n\t*/\n\tloadImageFromUrl: function (url, callback)\n\t{\n\t\tlet image = new Image();\n\t\timage.onload = () => callback(image);\n\t\timage.onerror = () => callback(null);\n\t\timage.src = url;\n\t}\n};\n\nexport default Utils;\n","\nimport _Tabs from './elems/r-tabs.js';\nimport _Form from './elems/r-form.js';\nimport _Panel from './elems/r-panel.js';\nimport _List from './elems/r-list.js';\nimport _Item from './elems/r-item.js';\nimport _Paginator from './elems/r-paginator.js';\nimport _Table from './elems/r-table.js';\nimport _Select from './elems/r-select.js';\nimport _ImageCropper from './elems/r-image-cropper.js';\n\nexport default {\n\tTabs: _Tabs,\n\tForm: _Form,\n\tPanel: _Panel,\n\tList: _List,\n\tItem: _Item,\n\tPaginator: _Paginator,\n\tTable: _Table,\n\tSelect: _Select,\n\tImageCropper: _ImageCropper\n};\n","/*\n**\telems/r-image-cropper\n**\n**\tCopyright (c) 2019-2021, RedStar Technologies, All rights reserved.\n**\thttps://www.rsthn.com/\n**\n**\tTHIS LIBRARY IS PROVIDED BY REDSTAR TECHNOLOGIES \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n**\tINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A \n**\tPARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL REDSTAR TECHNOLOGIES BE LIABLE FOR ANY\n**\tDIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT \n**\tNOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; \n**\tOR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n**\tSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n**\tUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n\t<r-image-cropper>\n\t</r-image-cropper>\n*/\n\nimport Element from '../element.js';\nimport Utils from '../utils.js';\n\nexport default Element.register ('r-image-cropper',\n{\n\t/*\n\t**\tDefault aspect ratio.\n\t*/\n\taspectRatio: 1,\n\n\t/*\n\t**\tCurrent image scale.\n\t*/\n\timageScale0: 0, imageScale: 1,\n\n\t/*\n\t**\tImage translation offsets.\n\t*/\n\timageOffsX: 0, imageOffsY: 0,\n\n\t/*\n\t**\tPointer contexts.\n\t*/\n\tpointerA: null, pointerB: null,\n\n\t/*\n\t**\tClient bounding box.\n\t*/\n\tbounds: null,\n\n\t/*\n\t**\tInitializes the element.\n\t*/\n\tinit: function()\n\t{\n\t\tthis.canvas = document.createElement('canvas');\n\t\tthis.appendChild(this.canvas);\n\n\t\tthis.g = this.canvas.getContext('2d');\n\n\t\tthis.pointerA = { id: null, active: false, sx: 0, sy: 0, cx: 0, cy: 0, ix: 0, iy: 0 };\n\t\tthis.pointerB = { id: null, active: false, sx: 0, sy: 0, cx: 0, cy: 0, ix: 0, iy: 0 };\n\n\t\tthis.log = document.createElement('div');\n\t\tthis.appendChild(this.log);\n\t},\n\n\t/*\n\t**\tSets the image for the cropper from an image URL.\n\t*/\n\tsetImageUrl: function(url)\n\t{\n\t\tUtils.loadImageFromUrl(url, (image) => {\n\t\t\tthis.setImage(image);\n\t\t});\n\t},\n\n\t/*\n\t**\tSets the image for the cropper from an HTML File object.\n\t*/\n\tsetImageFile: function(file)\n\t{\n\t\tUtils.loadAsDataUrl(file, (url) => {\n\t\t\tUtils.loadImageFromUrl(url, (image) => {\n\t\t\t\tthis.setImage(image);\n\t\t\t});\n\t\t});\n\t},\n\n\t/*\n\t**\tSets the cropper image from an HTML Image element.\n\t*/\n\tsetImage: function(image)\n\t{\n\t\tthis.image = image;\n\n\t\tthis.reset();\n\n\t\tthis.imageScale = Math.max(this.canvas.width / this.image.width, this.canvas.height / this.image.height);\n\n\t\tthis.imageOffsX = (this.canvas.width - this.imageScale*this.image.width)*0.5;\n\t\tthis.imageOffsY = (this.canvas.height - this.imageScale*this.image.height)*0.5;\n\n\t\tthis.render();\n\t},\n\n\t/*\n\t**\tReturns the blob and URL representing the current canvas state.\n\t*/\n\tgetBlobAndUrl: function(callback, type='image/png', quality=0.9)\n\t{\n\t\tthis.canvas.toBlob((blob) => {\n\t\t\tcallback(blob, URL.createObjectURL(blob));\n\t\t},\n\t\ttype, quality);\n\t},\n\n\t/*\n\t**\tAuto-resizes the canvas to ensure the aspect ratio is maintained.\n\t*/\n\treset: function()\n\t{\n\t\tthis.bounds = this.getBoundingClientRect();\n\n\t\tthis.canvas.width = this.bounds.width;\n\t\tthis.canvas.height = this.bounds.width/this.aspectRatio;\n\t},\n\n\t/*\n\t**\tAuto-resizes the canvas to ensure the aspect ratio is maintained and renders the image.\n\t*/\n\trender: function()\n\t{\n\t\tthis.canvas.width = this.canvas.width;\n\n\t\tthis.g.fillStyle = '#000';\n\t\tthis.g.beginPath();\n\t\tthis.g.rect(0, 0, this.canvas.width, this.canvas.height);\n\t\tthis.g.fill();\n\n\t\tthis.g.translate(this.imageOffsX, this.imageOffsY);\n\t\tthis.g.scale(this.imageScale, this.imageScale);\n\t\tthis.g.drawImage(this.image, 0, 0);\n\t},\n\n\t/*\n\t**\tTranslates the image by the given offsets.\n\t*/\n\ttranslateImage: function(offsX, offsY)\n\t{\n\t\tthis.imageOffsX += offsX;\n\t\tthis.imageOffsY += offsY;\n\n\t\tthis.render(true);\n\t},\n\n\t/*\n\t**\tHandle mouse events on the canvas.\n\t*/\n\t\"event mousemove canvas\": function(evt)\n\t{\n\t\tif (this.pointerA.active)\n\t\t{\n\t\t\tthis.pointerA.cx = evt.clientX;\n\t\t\tthis.pointerA.cy = evt.clientY;\n\n\t\t\tthis.translateImage(this.pointerA.cx - this.pointerA.sx, this.pointerA.cy - this.pointerA.sy);\n\n\t\t\tthis.pointerA.sx = this.pointerA.cx;\n\t\t\tthis.pointerA.sy = this.pointerA.cy;\n\t\t}\n\n\t\tthis.pointerA.ix = ((evt.clientX-this.bounds.left) - this.imageOffsX) / this.imageScale;\n\t\tthis.pointerA.iy = ((evt.clientY-this.bounds.top) - this.imageOffsY) / this.imageScale;\n\t},\n\n\t\"event mousedown canvas\": function(evt)\n\t{\n\t\tthis.pointerA.active = true;\n\t\tthis.pointerA.sx = evt.clientX;\n\t\tthis.pointerA.sy = evt.clientY;\n\t},\n\n\t\"event mouseup canvas\": function(evt)\n\t{\n\t\tthis.pointerA.active = false;\n\t},\n\n\t\"event wheel canvas\": function(evt)\n\t{\n\t\tif (evt.deltaY > 0)\n\t\t\tthis.imageScale -= 0.045;\n\t\telse\n\t\t\tthis.imageScale += 0.045;\n\n\t\tif (this.imageScale < 0.1) this.imageScale = 0.1;\n\n\t\tthis.imageOffsX += -this.pointerA.ix*this.imageScale + (evt.clientX-this.bounds.left) - this.imageOffsX;\n\t\tthis.imageOffsY += -this.pointerA.iy*this.imageScale + (evt.clientY-this.bounds.top) - this.imageOffsY;\n\n\t\tthis.render();\n\t},\n\n\t/*\n\t**\tHandle touch events on the canvas.\n\t*/\n\t\"event touchmove canvas\": function(evt)\n\t{\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerA.cx = i.clientX;\n\t\t\t\tthis.pointerA.cy = i.clientY;\n\t\t\t}\n\t\t\telse if (this.pointerB.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerB.cx = i.clientX;\n\t\t\t\tthis.pointerB.cy = i.clientY;\n\t\t\t}\n\t\t}\n\n\t\tif (this.pointerA.active && this.pointerB.active)\n\t\t{\n\t\t\tlet d0 = Math.sqrt(Math.pow(this.pointerA.sx-this.pointerB.sx, 2) + Math.pow(this.pointerA.sy-this.pointerB.sy, 2));\n\t\t\tlet d1 = Math.sqrt(Math.pow(this.pointerA.cx-this.pointerB.cx, 2) + Math.pow(this.pointerA.cy-this.pointerB.cy, 2));\n\n\t\t\tlet d = d1 - d0;\n\t\t\tthis.imageScale += (d/10)*0.025;\n\t\t\tif (this.imageScale < 0.1) this.imageScale = 0.1;\n\n\t\t\tthis.imageOffsX += -this.pointerA.ix*this.imageScale + (this.pointerA.cx-this.bounds.left) - this.imageOffsX;\n\t\t\tthis.imageOffsY += -this.pointerA.iy*this.imageScale + (this.pointerA.cy-this.bounds.top) - this.imageOffsY;\n\n\t\t\tthis.pointerA.sx = this.pointerA.cx;\n\t\t\tthis.pointerA.sy = this.pointerA.cy;\n\n\t\t\tthis.pointerB.sx = this.pointerB.cx;\n\t\t\tthis.pointerB.sy = this.pointerB.cy;\n\n\t\t\tthis.render();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet p = this.pointerA.active ? this.pointerA : (this.pointerB.active ? this.pointerB : null);\n\t\t\tif (!p) return;\n\n\t\t\tthis.translateImage(p.cx - p.sx, p.cy - p.sy);\n\n\t\t\tp.sx = p.cx;\n\t\t\tp.sy = p.cy;\n\t\t}\n\t},\n\n\t\"event touchstart canvas\": function(evt)\n\t{\n\t\tthis.imageScale0 = this.imageScale;\n\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id === null)\n\t\t\t{\n\t\t\t\tthis.pointerA.id = i.identifier;\n\t\t\t\tthis.pointerA.active = true;\n\t\t\t\tthis.pointerA.sx = i.clientX;\n\t\t\t\tthis.pointerA.sy = i.clientY;\n\t\t\t\tthis.pointerA.ix = ((i.clientX-this.bounds.left) - this.imageOffsX) / this.imageScale;\n\t\t\t\tthis.pointerA.iy = ((i.clientY-this.bounds.top) - this.imageOffsY) / this.imageScale;\n\t\t\t}\n\t\t\telse if (this.pointerB.id === null)\n\t\t\t{\n\t\t\t\tthis.pointerB.id = i.identifier;\n\t\t\t\tthis.pointerB.active = true;\n\t\t\t\tthis.pointerB.sx = i.clientX;\n\t\t\t\tthis.pointerB.sy = i.clientY;\n\t\t\t\tthis.pointerB.ix = ((i.clientX-this.bounds.left) - this.imageOffsX) / this.imageScale;\n\t\t\t\tthis.pointerB.iy = ((i.clientY-this.bounds.top) - this.imageOffsY) / this.imageScale;\n\t\t\t}\n\t\t}\n\t},\n\n\t\"event touchend canvas\": function(evt)\n\t{\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerA.id = null;\n\t\t\t\tthis.pointerA.active = false;\n\t\t\t}\n\t\t\telse if (this.pointerB.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerB.id = null;\n\t\t\t\tthis.pointerB.active = false;\n\t\t\t}\n\t\t}\n\t},\n\n\t\"event touchcancel canvas\": function(evt)\n\t{\n\t\tfor (let i of evt.changedTouches)\n\t\t{\n\t\t\tif (this.pointerA.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerA.id = null;\n\t\t\t\tthis.pointerA.active = false;\n\t\t\t}\n\t\t\telse if (this.pointerB.id == i.identifier)\n\t\t\t{\n\t\t\t\tthis.pointerB.id = null;\n\t\t\t\tthis.pointerB.active = false;\n\t\t\t}\n\t\t}\n\t}\n});\n","\nimport { Rinn } from 'rinn';\n\n//!class db\n\nexport default\n{\n\t/**\n\t * Database connection.\n\t */\n\tdb: null,\n\n\t/**\n\t * Initializes the database connection.\n\t * @param {string} dbName\n\t * @param {number} version\n\t * @param {(db: IDBDatabase, txn: IDBTransaction, oldVersion: number) => void} upgradeCallback\n\t * @returns {Promise<void>}\n\t * !static init (dbName: string, version: number, upgradeCallback: (db: IDBDatabase, txn: IDBTransaction, oldVersion: number) => void) : Promise<void>;\n\t */\n\tinit: function (dbName, version, upgradeCallback)\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif (!global.indexedDB)\n\t\t\t{\n\t\t\t\treject ('IndexedDB is not available in your system.');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet req = indexedDB.open(dbName, version);\n\t\t\treq.onerror = (evt) =>\n\t\t\t{\n\t\t\t\tlet err = evt.target.error + '';\n\n\t\t\t\tif (err.indexOf('AbortError') !== -1)\n\t\t\t\t\terr = \"\\n\" + req.message;\n\n\t\t\t\treject('Unable to open database: ' + err);\n\t\t\t\treturn;\n\t\t\t};\n\n\t\t\treq.onupgradeneeded = async (evt) =>\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tconst db = evt.target.result;\n\t\t\t\t\tconst txn = evt.target.transaction;\n\n\t\t\t\t\tif (evt.oldVersion < 1)\n\t\t\t\t\t\tdb.createObjectStore('system', { keyPath: ['name'] });\n\n\t\t\t\t\tawait upgradeCallback(db, txn, evt.oldVersion);\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\treq.message = e.message;\n\t\t\t\t\treq.transaction.abort();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treq.onsuccess = async (evt) =>\n\t\t\t{\n\t\t\t\tthis.db = evt.target.result;\n\t\t\t\tresolve();\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Ensures the database is ready to be used, or throws an exception.\n\t */\n\tensureConnected: function()\n\t{\n\t\tif (!this.db)\n\t\t\talert('Error: Database not initialized.');\n\t},\n \n\t/**\n\t * Returns an index object for later use with methods that accept an IDBIndex in the `storeName` parameter.\n\t * @param {string} storeName\n\t * @param {string} indexName\n\t * @returns {IDBIndex}\n\t * !static index (storeName: string, indexName: string) : IDBIndex;\n\t */\n\tindex: function (storeName, indexName)\n\t{\n\t\tthis.ensureConnected();\n\n\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\n\t\tlet index = store.index(indexName);\n\t\tif (!index) throw new Error ('Unable to find index `' + indexName + '` in store ' + storeName);\n\n\t\treturn index;\n\t},\n\n\t/**\n\t * Runs a callback for each record in a data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string} id\n\t * @param { (value:object, cursor:IDBCursor) => Promise<boolean> } callback\n\t * @returns {Promise<void>}\n\t * !static forEach (storeName: string|IDBIndex|IDBObjectStore, id: string, callback: (value:object, cursor:IDBCursor) => Promise<boolean>) : Promise<void>;\n\t */\n\tforEach: function (storeName, id, callback)\n\t{\n\t\tthis.ensureConnected();\n\n\t\tif (typeof(id) === 'function')\n\t\t{\n\t\t\tcallback = id;\n\t\t\tid = null;\n\t\t}\n\n\t\treturn new Promise(async (resolve, reject) =>\n\t\t{\n\t\t\tlet request, store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tif (id === null)\n\t\t\t\trequest = store.openCursor();\n\t\t\telse\n\t\t\t\trequest = store.openCursor(id);\n\n\t\t\trequest.onsuccess = async (event) =>\n\t\t\t{\n\t\t\t\tlet cursor = event.target.result;\n\t\t\t\tif (!cursor)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet result = await callback (cursor.value, cursor);\n\t\t\t\tif (result === false)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcursor.continue();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns the count of all records from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @returns {Promise<number>}\n\t * !static count (storeName: string|IDBIndex|IDBObjectStore) : Promise<number>;\n\t */\n\tcount: function (storeName)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.count();\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns all records from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} filter\n\t * @returns {Promise<Array<object>>}\n\t * !static getAll (storeName: string|IDBIndex|IDBObjectStore, filter?: string|number|Array<string|number>) : Promise<Array<object>>;\n\t */\n\tgetAll: function (storeName, filter=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.getAll(filter);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns all keys from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} filter\n\t * @returns {Promise<Array<string|number|Array<string|number>>>}\n\t * !static getAllKeys (storeName: string|IDBIndex|IDBObjectStore, filter?: string|number|Array<string|number>) : Promise<Array<object>>;\n\t */\n\tgetAllKeys: function (storeName, filter=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.getAllKeys(filter);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Loads a list of records having unique values from the specified data store and returns the entire object or just the specified field.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string} [field]\n\t * @returns {Promise<Array<number|string|object>>}\n\t * !static getAllUnique (storeName: string|IDBIndex|IDBObjectStore) : Promise<Array<number|string|object>>;\n\t */\n\tgetAllUnique: function (storeName, fieldName=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.openCursor(null, 'nextunique');\n\t\t\tlet list = [];\n\n\t\t\trequest.onsuccess = (event) =>\n\t\t\t{\n\t\t\t\tlet cursor = event.target.result;\n\t\t\t\tif (!cursor)\n\t\t\t\t{\n\t\t\t\t\tresolve(list);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlist.push(fieldName ? cursor.value[fieldName] : cursor.value);\n\t\t\t\tcursor.continue();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns a single record from the specified data store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} id\n\t * @returns {Promise<object>}\n\t * !static get (storeName: string|IDBIndex|IDBObjectStore, id: string|number|Array<string|number>) : Promise<object>;\n\t */\n\tget: function (storeName, id)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.get(id);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve(evt.target.result || null);\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\n\t/**\n\t * Adds or overwrites a record in the specified data store (data must include the primary key).\n\t * @param {string} storeName\n\t * @param {object} data\n\t * @returns {Promise<void>}\n\t * !static put (storeName: string, data: object) : Promise<void>;\n\t */\n\tput: function (storeName, data)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\t\t\tlet request = store.put(data);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Returns a variable from the system table.\n\t * @param {string} name - Name of the property to read.\n\t * @param {boolean} full - When `true` the entire object will be returned.\n\t * @returns {any}\n\t * !static sysGet (name: string, full?: boolean) : any;\n\t */\n\tsysGet: async function (name, full=false)\n\t{\n\t\tlet data = await this.get('system', [name]);\n\t\treturn data ? (full ? data : data.value) : null;\n\t},\n\n\t/**\n\t * Writes a variable to the system table.\n\t * @param {string} name - Name of the property to write.\n\t * @param {any} value - Value to write.\n\t * @param {boolean} full - When `true` the entire value will be written as-is.\n\t * @returns {void}\n\t * !static sysPut (name: string, value: any, full?: boolean) : void;\n\t */\n\tsysPut: async function (name, value, full=false)\n\t{\n\t\tif (full)\n\t\t{\n\t\t\tvalue.name = name;\n\t\t\tawait this.put('system', value);\n\t\t}\n\t\telse\n\t\t\tawait this.put('system', { name: name, value: value });\n\t},\n\n\t/**\n\t * Returns a single record from the specified data store that matches the `partial` object and does NOT match the `notPartial` object.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {object} [partial]\n\t * @param {object} [notPartial]\n\t * @returns {Promise<object>}\n\t * !static findOne (storeName: string|IDBIndex|IDBObjectStore, partial?: object, notPartial?: object) : Promise<object>;\n\t */\n\tfindOne: function (storeName, partial=null, notPartial=null)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store;\n\n\t\t\tif (typeof(storeName) === 'string')\n\t\t\t\tstore = this.db.transaction(storeName, 'readonly').objectStore(storeName);\n\t\t\telse\n\t\t\t\tstore = storeName;\n\n\t\t\tlet request = store.openCursor();\n\n\t\t\trequest.onsuccess = (event) =>\n\t\t\t{\n\t\t\t\tlet cursor = event.target.result;\n\t\t\t\tif (!cursor)\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (partial === null || Rinn.partialCompare(cursor.value, partial))\n\t\t\t\t{\n\t\t\t\t\tif (notPartial !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Rinn.partialCompare(cursor.value, notPartial))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcursor.continue();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(cursor.value);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcursor.continue();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Deletes a record from the specified data store.\n\t * @param {string} storeName\n\t * @param {string|number|Array<string|number>} id\n\t * @returns {Promise<void>}\n\t * !static delete (storeName: string, id: string|number|Array<string|number>) : Promise<void>;\n\t */\n\tdelete: function (storeName, id)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\n\t\t\tlet request = store.delete(id);\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t},\n\n\t/**\n\t * Deletes all items in the specified store.\n\t * @param {string|IDBIndex|IDBObjectStore} storeName\n\t * @param {string|number|Array<string|number>} id\n\t * @returns {Promise<void>}\n\t * !static deleteAll (storeName: string|IDBIndex|IDBObjectStore, id: string|number|Array<string|number>) : Promise<void>;\n\t */\n\tdeleteAll: function (storeName, id=null)\n\t{\n\t\treturn this.forEach(storeName, id, async (value, cursor) => {\n\t\t\tawait cursor.delete();\n\t\t});\n\t},\n\n\t/**\n\t * Inserts a new record in the specified data store.\n\t * @param {string} storeName\n\t * @param {object} data\n\t * @returns {Promise<void>}\n\t * !static insert (storeName: string, data: object) : Promise<void>;\n\t */\n\tinsert: function (storeName, data)\n\t{\n\t\tthis.ensureConnected();\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tlet store = this.db.transaction(storeName, 'readwrite').objectStore(storeName);\n\t\t\tlet request = store.add(data);\n\n\t\t\trequest.onsuccess = (evt) => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\trequest.onerror = (evt) => {\n\t\t\t\treject(evt.target.error);\n\t\t\t};\n\t\t});\n\t}\n};\n\n//!/class\n","\n/**\n * Node for a linked list.\n */\nexport function Node (value)\n{\n\tthis.value = null;\n\tthis.next = null;\n\tthis.prev = null;\n\tthis.list = null;\n}\n\n/**\n * Creates a new node.\n * @param {any} value \n * @returns {Node}\n */\nNode.create = function (value)\n{\n\tlet node = new Node();\n\tnode.value = value;\n\treturn node;\n}\n\n/**\n * Unlinks and frees the node. Returns the node's value.\n * @returns {any}\n */\nNode.prototype.free = function ()\n{\n\tlet value = this.value;\n\tthis.unlink();\n\n\tthis.next = this.prev = null;\n\tthis.list = null;\n\n\tthis.value = null;\n\treturn value;\n}\n\n/**\n * Links the node after the given reference.\n * @param {Node} ref\n * @param {List} list\n * @returns {Node}\n */\nNode.prototype.linkAfter = function (ref, list)\n{\n\tthis.next = ref !== null ? ref.next : null;\n\tthis.prev = ref;\n\tthis.list = list;\n\n\tif (ref !== null) {\n\t\tif (ref.next !== null) ref.next.prev = this;\n\t\tref.next = this;\n\t}\n\n\tif (list.tail === ref)\n\t\tlist.tail = this;\n\n\tif (list.head === null)\n\t\tlist.head = this;\n\n\tlist.length++;\n\treturn this;\n}\n\n/**\n * Links the node before the given reference.\n * @param {Node} ref\n * @param {List} list\n * @returns {Node}\n */\nNode.prototype.linkBefore = function (ref, list)\n{\n\tthis.prev = ref !== null ? ref.prev : null;\n\tthis.next = ref;\n\tthis.list = list;\n\n\tif (ref !== null) {\n\t\tif (ref.prev !== null) ref.prev.next = this;\n\t\tref.prev = this;\n\t}\n\n\tif (list.head === ref)\n\t\tlist.head = this;\n\n\tif (list.tail === null)\n\t\tlist.tail = this;\n\n\tlist.length++;\n\treturn this;\n}\n\n/**\n * Unlinks the node by linking the `prev` and `next` nodes together (when available).\n * @returns {Node}\n */\nNode.prototype.unlink = function ()\n{\n\tif (this.prev) this.prev.next = this.next;\n\tif (this.next) this.next.prev = this.prev;\n\n\tif (this.list.head === this) this.list.head = this.next;\n\tif (this.list.tail === this) this.list.tail = this.prev;\n\n\tthis.list.length--;\n\treturn this;\n}\n\n/**\n * Doubly linked list.\n */\nexport function List ()\n{\n\tthis.head = null;\n\tthis.tail = null;\n\tthis.length = 0;\n}\n\n/**\n * Creates a new linked list.\n * @returns {List}\n */\nList.create = function()\n{\n\treturn new List();\n}\n\n/**\n * Frees the list and removes all nodes.\n */\nList.prototype.free = function()\n{\n\tthis.clear();\n}\n\n/**\n * Clears the list by freeing all nodes. Values are preserved.\n * @returns {List}\n */\nList.prototype.reset = function()\n{\n\twhile (this.head !== null)\n\t\tthis.head.free();\n\n\treturn this;\n}\n\n/**\n * Clears the list by freeing all nodes and values.\n * @returns {List}\n */\nList.prototype.clear = function()\n{\n\twhile (this.head !== null)\n\t{\n\t\tif (this.head.value !== null)\n\t\t\tthis.head.value.free();\n\n\t\tthis.head.free();\n\t}\n\n\treturn this;\n}\n\n/**\n * Returns the value at the head of the list.\n * @returns {any}\n */\nList.prototype.first = function ()\n{\n\treturn this.head !== null ? this.head.value : null;\n}\n\n/**\n * Returns the value at the tail of the list.\n * @returns {any}\n */\nList.prototype.last = function ()\n{\n\treturn this.tail !== null ? this.tail.value : null;\n}\n\n/**\n * Finds an specific value and returns the node, or `null` if not found.\n * @returns {Node}\n */\nList.prototype.find = function (value)\n{\n\tfor (let i = this.head; i !== null; i = i.next)\n\t{\n\t\tif (i.value === value)\n\t\t\treturn i;\n\t}\n\n\treturn null;\n}\n\n/**\n * Inserts a value at the head of the list.\n * @param {any} value\n * @returns {any}\n */\nList.prototype.unshift = function (value)\n{\n\tNode.create(value).linkBefore(this.head, this);\n\treturn value;\n}\n\n/**\n * Removes a value from the head of the list, or `null` if the list is empty.\n * @returns {any}\n */\nList.prototype.shift = function ()\n{\n\treturn this.head === null ? null : this.head.free();\n}\n\n/**\n * Inserts a value at the tail of the list.\n * @param {any} value\n * @returns {any}\n */\nList.prototype.push = function (value)\n{\n\tNode.create(value).linkAfter(this.tail, this);\n\treturn value;\n}\n\n/**\n * Removes a value from the tail of the list.\n * @returns {any}\n */\nList.prototype.pop = function ()\n{\n\treturn this.tail === null ? null : this.tail.free();\n}\n","\nimport { List } from './utils-jsx';\n\n/**\n */\nlet activeWatcher = null;\nlet signalsPropagating = false;\n\n/**\n */\nlet propagationQueue = List.create();\nlet propagationMicroTask = false;\n\n/**\n */\nfunction propagate (signal)\n{\n\tif (signal.isPropagating === true)\n\t\treturn;\n\n\tsignal.isPropagating = true;\n\n\tlet currentWatchers = signal.watchers;\n\tsignal.watchers = List.create();\n\n\twhile (currentWatchers.length) {\n\t\tcurrentWatchers.shift()();\n\t}\n\n\tcurrentWatchers.free();\n\n\tsignal.isPropagating = false;\n\tsignal.wasQueued = false;\n}\n\n/**\n */\nfunction propagateQueue ()\n{\n\tsignalsPropagating = true;\n\n\twhile (propagationQueue.length) {\n\t\tpropagate(propagationQueue.shift());\n\t}\n\n\tsignalsPropagating = false;\n\tpropagationMicroTask = false;\n}\n\n/**\n */\nfunction accessorHandler (signal, newValue, forced)\n{\n\tif (newValue === undefined)\n\t{\n\t\tif (activeWatcher !== null)\n\t\t{\n\t\t\tif (signal.watchers.find(activeWatcher) === null)\n\t\t\t\tsignal.watchers.push(activeWatcher);\n\t\t}\n\t\n\t\treturn signal.value;\n\t}\n\n\t// Do not trigger any propagation if the new value is the same as the current one.\n\tif (signal.value === newValue && forced === false)\n\t\treturn signal.accessor;\n\n\tsignal.previousValue = signal.value;\n\tsignal.value = newValue;\n\tsignal.accessor.value = newValue;\n\n\tif (signalsPropagating === true)\n\t{\n\t\tif (signal.isPropagating)\n\t\t\treturn signal.accessor;\n\n\t\tif (signal.wasQueued === false)\n\t\t{\n\t\t\tpropagationQueue.push(signal);\n\t\t\tsignal.wasQueued = true;\n\n\t\t\tif (propagationMicroTask === false)\n\t\t\t{\n\t\t\t\tqueueMicrotask(propagateQueue);\n\t\t\t\tpropagationMicroTask = true;\n\t\t\t}\n\t\t}\n\n\t\treturn signal.accessor;\n\t}\n\n\tsignalsPropagating = true;\n\tpropagate(signal);\n\tsignalsPropagating = false;\n\n\treturn signal.accessor;\n}\n\n/**\n * Creates a new signal.\n * @param {any} value?\n */\nexport function signal (value=null)\n{\n\tconst data = {\n\t\twatchers: List.create(),\n\t\tvalue: value,\n\t\tisPropagating: false,\n\t\twasQueued: false\n\t};\n\n\tdata.accessor = (newValue=undefined, forced=false) => {\n\t\treturn accessorHandler (data, newValue, forced);\n\t};\n\n\tdata.accessor.value = data.value;\n\treturn data.accessor;\n}\n\n/**\n * Creates a new signal side effect.\n * @param {function} fn\n */\nexport function effect (fn, id=null)\n{\n\tlet previousWatcher = null;\n\tlet active = false;\n\n\tconst watcher = function()\n\t{\n\t\tif (active === true) return;\n\t\tactive = true;\n\n\t\tpreviousWatcher = activeWatcher;\n\t\tactiveWatcher = watcher;\n\n\t\ttry {\n\t\t\tfn();\n\t\t}\n\t\tfinally {\n\t\t}\n\n\t\tactiveWatcher = previousWatcher;\n\t\tactive = false;\n\t};\n\n\twatcher.id = id;\n\twatcher();\n\n\treturn watcher;\n}\n\n/**\n * Creates a new variable.\n * @param {any} value?\n */\nexport function variable (value=null)\n{\n\tlet accessor = (newValue=undefined) =>\n\t{\n\t\tif (newValue === undefined)\n\t\t\treturn accessor.value;\n\n\t\taccessor.value = newValue;\n\t\treturn accessor;\n\t};\n\n\taccessor.value = value;\n\treturn accessor;\n}\n\n/**\n * Helper functions.\n */\nexport const _helpers =\n{\n\t/**\n\t * Replaces a node by the specified value and returns a new node. If the value is a string it will be converted to a node first. And\n\t * if the value is `null` the current node will be returned.\n\t * @param {Node} node\n\t * @param {Node|string|null|Array<Node|string>} value\n\t * @param {string} placeholder\n\t * @returns {Node}\n\t */\n\treplaceNode: function (node, value, placeholder)\n\t{\n\t\tlet result = value;\n\n\t\tif (node instanceof Array)\n\t\t{\n\t\t\tif (value instanceof Array)\n\t\t\t{\n\t\t\t\t// Clear children.\n\t\t\t\tif (value.length == 0)\n\t\t\t\t{\n\t\t\t\t\twhile (node.length > 1)\n\t\t\t\t\t\tnode.pop().remove();\n\n\t\t\t\t\tvalue = document.createElement(placeholder);\n\t\t\t\t\tnode[0].replaceWith(value);\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\n\t\t\t\tlet parent = node[0].parentElement;\n\t\t\t\tlet ref = parent.lastChild;\n\n\t\t\t\tif (ref === null || ref !== value[value.length-1])\n\t\t\t\t{\n\t\t\t\t\t//console.log('CHANGING BOTTOM');\n\t\t\t\t\tref = value[value.length-1];\n\t\t\t\t\tparent.appendChild(ref);\n\t\t\t\t}\n\n\t\t\t\tfor (let i of node)\n\t\t\t\t\ti._marked = false;\n\n\t\t\t\tref._marked = true;\n\t\t\t\tlet n = 0;\n\n\t\t\t\tfor (let i = value.length-2; i >= 0; i--)\n\t\t\t\t{\n\t\t\t\t\tvalue[i]._marked = true;\n\n\t\t\t\t\tif (value[i].nextSibling === value[i+1])\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tparent.insertBefore(value[i], value[i+1]);\n\t\t\t\t\tn++;\n\t\t\t\t}\n\n\t\t\t\t//console.log('MOVED ', n);\n\t\t\t\tn = 0;\n\n\t\t\t\tfor (let i of node)\n\t\t\t\t{\n\t\t\t\t\tif (i._marked === true)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\ti.remove();\n\t\t\t\t\tn++;\n\t\t\t\t}\n\n\t\t\t\t//console.log('REMOVED ', n);\n\t\t\t\treturn [...value];\n\t\t\t}\n\n\t\t\twhile (node.length > 1)\n\t\t\t\tnode.pop().remove();\n\n\t\t\tnode = node.length ? node[0] : null;\n\t\t}\n\n\t\tif (value === null || value === undefined)\n\t\t\tresult = value = document.createElement(placeholder);\n\n\t\tif (value instanceof Array)\n\t\t{\n\t\t\tlet elem = document.createDocumentFragment();\n\t\t\tresult = [];\n\n\t\t\tfor (let i of value)\n\t\t\t{\n\t\t\t\tif (!(i instanceof Node))\n\t\t\t\t{\n\t\t\t\t\tif (i instanceof Array)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet t = document.createElement('div');\n\t\t\t\t\t\tt.innerHTML = i[0];\n\t\t\t\t\t\ti = t.children[0];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\ti = document.createTextNode(i);\n\t\t\t\t}\n\n\t\t\t\tresult.push(i);\n\t\t\t\telem.appendChild(i);\n\t\t\t}\n\n\t\t\tvalue = elem;\n\n\t\t\tif (result.length == 0)\n\t\t\t\tresult = value = document.createElement(placeholder);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!(value instanceof Node))\n\t\t\t\tresult = value = document.createTextNode(value);\n\t\t}\n\n\t\tif (node === null)\n\t\t\treturn result;\n\n\t\tnode.replaceWith(value);\n\t\treturn result;\n\t},\n\n\t/**\n\t * Spreads the given attributes on the node.\n\t * @param {Node} node\n\t * @param {object} data \n\t */\n\tspreadAttributes (node, data)\n\t{\n\t\tfor (let i in data)\n\t\t\tthis.setAttribute(node, i, data[i]);\n\t},\n\n\t/**\n\t * Sets an attribute of a node.\n\t * @param {Node} node\n\t * @param {string} name\n\t * @param {string|Array|object} data\n\t */\n\tsetAttribute (node, name, data)\n\t{\n\t\tif (data instanceof Array)\n\t\t{\n\t\t\tif (name === 'class')\n\t\t\t\tnode.className = data.join(' ');\n\t\t\telse\n\t\t\t\tnode[name] = data;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (name === 'style' && typeof data !== 'string')\n\t\t\t{\n\t\t\t\tObject.assign(node.style, data);\n\t\t\t}\n\t\t\telse if (name.startsWith('data-'))\n\t\t\t{\n\t\t\t\tnode.dataset[name.substring(5)] = data;\n\t\t\t}\n\t\t\telse if (name.startsWith('on'))\n\t\t\t{\n\t\t\t\tnode[name.toLowerCase()] = data;\n\t\t\t}\n\t\t\telse\n\t\t\t\tnode.setAttribute(name, data);\n\t\t}\n\t}\n};\n","\nimport _Router from './router.js'; export const Router = _Router;\n//![import \"./router\"]\nimport _Element from './element.js'; export const Element = _Element; export const CElement = _Element;\n//![import \"./element\"]\nimport _Api from './api.js'; export const Api = _Api;\n//![import \"./api\"]\nimport _DataSource from './data-source.js'; export const DataSource = _DataSource;\n//![import \"./data-source\"]\nimport _DataList from './data-list.js'; export const DataList = _DataList;\n//![import \"./data-list\"]\nimport _Easing from './easing.js'; export const Easing = _Easing;\n//![import \"./easing\"]\nimport _Anim from './anim.js'; export const Anim = _Anim;\n//![import \"./anim\"]\nimport _Elements from './elements.js'; export const Elements = _Elements;\n//![import \"./elements\"]\nimport _Utils from './utils.js'; export const Utils = _Utils;\n//![import \"./utils\"]\nimport _db from './db.js'; export const db = _db;\n//![import \"./db\"]\n\nimport * as _Rinn from 'rinn';\nexport const Rinn = _Rinn.Rinn;\nexport const Class = _Rinn.Class;\nexport const Event = _Rinn.Event;\nexport const EventDispatcher = _Rinn.EventDispatcher;\nexport const Model = _Rinn.Model;\nexport const ModelList = _Rinn.ModelList;\nexport const Schema = _Rinn.Schema;\nexport const Flattenable = _Rinn.Flattenable;\nexport const Collection = _Rinn.Collection;\nexport const Template = _Rinn.Template;\n\n/**\n * JSX Runtime.\n */\nexport { signal, effect, variable, _helpers } from './runtime-jsx';\n"],"names":["$7718a52dfca15325$var$_Router","$k7heJ$EventDispatcher","extend","route","this","_super","EventDispatcher","__ctor","_compileRoute","value","params","replace","m","exec","push","routeRegex","addHandler","handler","unrouted","context","addEventListener","removeHandler","removeEventListener","dispatch","matches","match","s_args","active","dispatchEvent","args","str","i","length","changed","alreadyAttached","globalThis","onhashchange","onLocationChanged","bind","silent","location1","realLocation","location","ignoreHashChangeEvent","hash","onRoute","onUnroute","routes","Route","sortedRoutes","sort","a","b","undefined","cLocation","pLocation","k","state","j","rLocation","$5808f050ebbd5b77$var$elementPrototypes","$5808f050ebbd5b77$var$elementClasses","$5808f050ebbd5b77$var$Element","eid","isRoot","root","isReady","readyReenter","readyLocked","modelt","$k7heJ$Model","model","contents","events","evt","continuePropagation","source","_long_press","elem","setTimeout","dx","_pos_fx","_pos_sx","dy","_pos_fy","_pos_sy","Math","sqrt","dispatchOn","clientX","clientY","touches","clearTimeout","opts","dataset","action","split","longPress","enter","_list_watch","_list_visible","_list_property","style","display","random","toString","substr","tmp","setModel","Object","keys","reverse","forEach","init","debug","console","log","tagName","parentElement","bindEvents","setInnerHTML","toLowerCase","appendChild","document","createElement","markReady","ready","rready","list","collectWatchers","ref","getFieldByPath","findCustomParent","checkReady","rootReady","getRoot","onRefAdded","remove","childNodes","result","evaluate","XPathResult","ANY_TYPE","iterateNext","path","$parcel$global","shift","findRoot","update","$k7heJ$Rinn","ensureTypeOf","onModelPreChanged","onModelPropertyChanging","onModelPropertyPreChanged","onModelPropertyRemoved","setNamespace","getModel","addClass","classString","trim","classList","add","removeClass","setStyle","styleString","indexOf","name","toUpperCase","getWidth","getBoundingClientRect","width","getHeight","height","evtstr","hdl","typeOf","selector","listen","keyCode","bindRoutes","routeStr","$7718a52dfca15325$export$2e2bcd8739ae039","getRoute","unbindRoutes","_eventHandler","target","HTMLElement","call","detail","elems","querySelectorAll","preventDefault","stopPropagation","eventName","eventCatcher","eventImmediate","callback0","callback1","self","firstCapture","firstCaptureCount","queue","q","pop","removed","createEventObject","bubbles","MouseEvent","CustomEvent","innerHTML","modified","_list_watch_length","_list_visible_length","_list_property_length","_template","$k7heJ$Template","compile","_watch","RegExp","watch","removeAttribute","j1","selfWatch","i1","_visible","visible","selfVisible","i2","onchange","onblur","type","checked","set","getValue","onmouseup","property","selfProperty","filter","onCreated","elementConnected","onConnected","elementDisconnected","onDisconnected","element","onRefRemoved","data","get","fields","test","removeProperty","setProperty","onModelChanged","trigger","val","setValue","onModelPropertyChanged","preparePrototype","proto","__prototypePrepared","hasOwnProperty","startsWith","register","protos","newElement","constructor","super","invokeConstructor","entries","prototype","srcElement","connectReference","flags","connectedCallback","xref","disconnectedCallback","override","clone","__check","__init","__ready","__rready","name1","f","dummy","customElements","define","expand","hookAppend","functionName","newFunction","hook1","hook2","unhook","hookPrepend","querySelector","contains","fn","window","querySelectorParent","$5808f050ebbd5b77$export$2e2bcd8739ae039","$d584b999ce7bb535$var$Api","REQUEST_PACKAGE_SUPPORTED","REQ64_SUPPORTED","JSON_RESPONSE_SUPPORTED","XML_RESPONSE_SUPPORTED","INCLUDE_CREDENTIALS","UNIQUE_STAMP","apiUrl","useReq64","retries","res","req","_requestPackage","callback","responseCallback","packageBegin","packageEnd","_packageData","rpkg","$k7heJ$base64","encode","encodeParams","apiCall","_hideProgress","response","responseFilter","e","_requestLevel","documentElement","headers","obj","s","FormData","encodeURIComponent","join","url","param","success","failure","httpMethod","relativeUrl","getUrl","appendParam","Date","now","Accept","method","body","multipart","options","credentials","Blob","endsWith","File","append","l","fetch","then","decodeResult","catch","err","json","Promise","resolve","reject","className","debounceDelay","request","includeCount","includeEnum","includeList","count","basePath","config","assign","$k7heJ$ModelList","dataSource","enum","forwardRequestEvent","forwardListEvent","forwardEnumEvent","prepareEvent","setSource","resume","mode","_timeout","$d584b999ce7bb535$export$2e2bcd8739ae039","fetchCount","fetchEnum","fetchList","forced","find","item","fetchOne","r","fetchDelete","error","setData","ModelList","dataList","_callback","$0a74aeaee0e1468a$var$Easing","interpolate","src","dst","duration","easing","time","x","lastTime","dt","interpolator","curTime","t","requestAnimationFrame","Linear","IN","OUT","IN_OUT","Back","Bounce","getConst","Circ","Cubic","Expo","pow","Power","p","Quad","Quartic","Quintic","Sine","sin","cos","Step","$0a74aeaee0e1468a$export$2e2bcd8739ae039","$54865aa6b345efd5$var$Anim","$k7heJ$Class","initialData","stack","block","timeScale","blockTime","index","paused","finished","onFinishedCallback","onUpdatedCallback","reset","__dtor","onFinished","onUpdated","handle","initial","speed","setOutput","pause","clearInterval","setInterval","_block","_index","_blockTime","cmd","op","started","blocks","indices","blockTimes","n","_count","field","startValue","_startValue","_endValue","endValue","last","cur","table","snd","play","parallel","serial","repeat","end","restart","wait","range","rand","randt","c","$54865aa6b345efd5$export$2e2bcd8739ae039","$4a9d88aa888e9f4d$export$2e2bcd8739ae039","container","activeTab","baseRoute","selectTab","_routeHandler","link","href","showTab","tabName","previousElementSibling","nextElementSibling","_hideTabsExcept","addRoute","removeRoute","exceptName","el","$ec74230761e3bde8$export$2e2bcd8739ae039","formElement","def","names","default","defaults","clearMarkers","filterString","messages","eval","_change","createEvent","initEvent","fireEvent","_setField","multiple","parseInt","FileList","_getField","_value","fromFileFields","files","getField","_fieldChanged","_onSuccess","message","onanimationend","_onFailure","tmp1","errorsAt","prepend","insertBefore","nsilent","submit","strict","formAction","$9c0636c07ff6144e$export$2e2bcd8739ae039","_onActivate","show","_onDeactivate","hide","$a4fb830b2d507403$export$2e2bcd8739ae039","template","isEmpty","isDynamicTemplate","template_elem","textContent","setEmpty","setLoading","setList","isInstanceOf","onLoading","onLoaded","onItemsCleared","onItemsChanged","onItemRemoved","onItemChanged","onItemAdded","buildItem","iid","asHtml","html","attr","attributes","nodeName","setAttribute","nodeValue","getData","wrap","itemId","id","position","refresh","$7061e6454a23ef4a$export$2e2bcd8739ae039","$8586bcf20c2e54e9$export$2e2bcd8739ae039","offsetStart","offsetEnd","offset","currentPageSize","pageSize","updateOffset","$fe13c50c6c3e66d8$export$2e2bcd8739ae039","onRequestPropertyChanged","onCountChanged","min","getInt","_offset","prevPage","offs","nextPage","firstPage","lastPage","clear","$a1b0099052e4f8e1$export$2e2bcd8739ae039","Error","temporalBody","order","firstElementChild","_elem","replaceChild","$e668322859586774$export$2e2bcd8739ae039","lastElementChild","label","has","blank","groups","values","g","$a86ae7da7dd6c514$var$Utils","showDownload","filename","dataUrl","download","click","removeChild","showFilePicker","allowMultiple","accept","input","onfocus","loadAsDataUrl","file","reader","FileReader","onload","onerror","readAsDataURL","loadAsText","readAsText","loadAsArrayBuffer","readAsArrayBuffer","loadAllAsDataUrl","fileList","loadNext","size","loadImageFromUrl","image","Image","$a86ae7da7dd6c514$export$2e2bcd8739ae039","$5c1b3a60e2432554$export$2e2bcd8739ae039","Tabs","Form","Panel","List","Item","Paginator","Table","Select","ImageCropper","aspectRatio","imageScale0","imageScale","imageOffsX","imageOffsY","pointerA","pointerB","bounds","canvas","getContext","sx","sy","cx","cy","ix","iy","setImageUrl","setImage","setImageFile","max","render","getBlobAndUrl","quality","toBlob","blob","URL","createObjectURL","fillStyle","beginPath","rect","fill","translate","scale","drawImage","translateImage","offsX","offsY","left","top","deltaY","changedTouches","identifier","d0","d","$5c284bd1d2bc0d7d$export$2e2bcd8739ae039","db","dbName","version","upgradeCallback","indexedDB","open","onupgradeneeded","async","txn","transaction","oldVersion","createObjectStore","keyPath","abort","onsuccess","ensureConnected","alert","storeName","indexName","objectStore","store","openCursor","event","cursor","continue","getAll","getAllKeys","getAllUnique","fieldName","put","sysGet","full","sysPut","findOne","partial","notPartial","partialCompare","delete","deleteAll","insert","$93a67b7b0ed52912$export$85c928794f8d04d4","next","prev","$93a67b7b0ed52912$export$54c2e3dc7acea9f5","head","tail","create","node","free","unlink","linkAfter","linkBefore","first","unshift","$09e89c15f3c11137$var$activeWatcher","$09e89c15f3c11137$var$signalsPropagating","$09e89c15f3c11137$var$propagationQueue","$09e89c15f3c11137$var$propagationMicroTask","$09e89c15f3c11137$var$propagate","signal","isPropagating","currentWatchers","watchers","wasQueued","$09e89c15f3c11137$var$propagateQueue","$09e89c15f3c11137$export$e2ef10f86a8d60e8","accessor","newValue","previousValue","queueMicrotask","$09e89c15f3c11137$var$accessorHandler","$09e89c15f3c11137$export$dc573d8a6576cdb3","previousWatcher","watcher","$09e89c15f3c11137$export$3a9d57cefcd2c285","$09e89c15f3c11137$export$359074a4e1146a4d","replaceNode","placeholder","Array","replaceWith","parent","lastChild","_marked","nextSibling","createDocumentFragment","i3","Node","children","createTextNode","spreadAttributes","substring","$9ffb7151b8b2d038$export$55185c17a0fcbe46","$9ffb7151b8b2d038$export$db77ccec0bb4ccac","$9ffb7151b8b2d038$export$9864de54bd63ed8a","$9ffb7151b8b2d038$export$bf71da7aebe9ddc1","$9ffb7151b8b2d038$export$accd73d198d77d2f","$9ffb7151b8b2d038$export$d3568da47c78d35c","$52a9c945778cbfd0$export$2e2bcd8739ae039","$9ffb7151b8b2d038$export$cea96571ebbff9dd","$9ffb7151b8b2d038$export$deefd61317ad2797","$9ffb7151b8b2d038$export$3abb4be70fa2c84e","$9ffb7151b8b2d038$export$d2ca453b913dcdea","$9ffb7151b8b2d038$export$f932f06c7eb6abeb","$9ffb7151b8b2d038$export$eefcfe56efaaa57d","$9ffb7151b8b2d038$export$4c85e640eb41c31b","$9ffb7151b8b2d038$export$d61e24a684f9e51","$k7heJ$Event","$9ffb7151b8b2d038$export$ec8b666c5fe2c75a","$9ffb7151b8b2d038$export$a1edc412be3e1841","$9ffb7151b8b2d038$export$59eced47f477f85a","$9ffb7151b8b2d038$export$19342e026b58ebb7","$k7heJ$Schema","$9ffb7151b8b2d038$export$3a9581c9ade29768","$k7heJ$Flattenable","$9ffb7151b8b2d038$export$fb8073518f34e6ec","$k7heJ$Collection","$9ffb7151b8b2d038$export$14416b8d99d47caa"],"version":3,"file":"riza.m.js.map"}